//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 5.0 - Бухгалтерский контур
// Акт взаимозачетов контрагентов
//------------------------------------------------------------------------------

#doc
Акт взаимозачетов контрагентов
#end
.set name = 'VZachet'
.HIDE
.Fields
 a

 cFil0
 cFil1
 AktNo
 k1
 kontr1
 k2
 kontr2
 we
 wer
 d
 dobr
 SumDoDeb
 SumDoCred
 SumNalDeb
 SumNalCred
 sum
 begd
 endd
 namepl1
 namepl2
 namepl3

 num1
 d1
 s1
 num2
 schet
 d2
 s2
 namenal1
 nalog1
 namenal2
 nalog2
.Endfields
.{
 A - ^
.{ ReePlPorFl CheckEnter
cFil0 ^
cFil1 ^
.}
!.end

.{ PlPorLoop CheckEnter
 AktNo          - ^
 k1             - ^
 kontr1         - ^
 k2             - ^
 kontr2         - ^
 we             - ^
 wer 	        - ^
 d              - ^
 dobr           - ^
 SumDoDeb       - ^
 SumDoCred - ^
 SumNalDeb - ^
 SumNalCred - ^

 sum        - ^
 begd       - ^
 endd    - ^
 namepl1 - ^
 namepl2 - ^
 namepl3 - ^

.{ BaseDocLoop CheckEnter
 num1  - ^
 d1    - ^
 s1    - ^
 num2  - ^
 schet - ^
 d2    - ^
 s2    - ^

.{ NalogLoop CheckEnter
 namenal1 - ^
 nalog1   - ^
 namenal2 - ^
 nalog2   - ^
.}
.}
.}
.}
.endform
!==================================================================
.linkform 'vzachet1' prototype is 'vzachet'
!==================================================================
.Group 'Отчеты для печати'
.nameinlist 'Отчет для собственной организации'
.Fields
 CommonFormHeader
 AktNo kontr1 kontr2 wer namepl1 namepl2 namepl3 d kontr1 kontr2
!.{
 num1
 if (d1 <> DateToStr(date(0,0,0), 'DD/MM/YY'), d1, '')
 s1
 num2
 schet
 if (d2 <> DateToStr(date(0,0,0), 'DD/MM/YY'), d2, '')
 s2
!.{
 namenal1 nalog1 namenal2 nalog2
!.}
!.}
 SumDoDeb SumDoCred SumNalDeb SumNalCred
 sum
 kontr1 kontr2 sum wer
.Endfields
^
.{
.{ ReePlPorFl CheckEnter
.}
.{ PlPorLoop CheckEnter
                              Акт N @@@@@@@@
                     взаимозачета между предприятиями:
                     @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                     @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                     @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

 И Содержание:
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ И

 И          По состоянию на @@@@@@@@@@@@ погашается задолженность:
──────────────────────────────────────┬───────────────────────────────────────────────────
По счетам, предъявленным предприятию  │         По счетам, предъявленным предприятием
          @@@@@@@@@@@@@@@@@@@@@@@@@@  │                    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@
──────────────────────────────────────┼───────────────────────────────────────────────────
N ДО         Дата           Сумма     │  N ДО     N счета        Дата          Сумма
──────────────────────────────────────┼───────────────────────────────────────────────────
.{ BaseDocLoop CheckEnter
@@@@@@@@  @@@@@@@@@@@ &#&'&&&&&&&&&.&&│@@@@@@@@ @@@@@@@@@@@@@ @@@@@@@@@@@ &#&'&&&&&&&&&.&&
.{ NalogLoop CheckEnter
       @@@@@@@@@@     &#&'&&&&&&&&&.&&│                     @@@@@@@@@@@   &#&'&&&&&&&&&.&&
.}
.}
──────────────────────────────────────┴───────────────────────────────────────────────────
   Итого по ДО:       &#&'&&&&&&&&&.&&                 Итого по ДО:       &#&'&&&&&&&&&.&&
   Итого налогов:     &#&'&&&&&&&&&.&&                 Итого налогов:     &#&'&&&&&&&&&.&&
   Зачет на сумму:  &#&'&&&&&&&&&.&&
   ^ платежным поручением
   перечислил на расчетный счет ^
   сумму &#&'&&&&&&&&&.&& за ^


   Начальник финансового отдела

   Главный бухгалтер И
.}
.}
.endform

!==================================================================
.linkform 'vzachet2' prototype is 'vzachet'
!==================================================================
.Group 'Отчеты для печати'
.nameinlist 'Извещение для дебитора'
.Fields
CommonFormHeader
wer kontr1 AktNo namepl1 namepl2 namepl3 d wer
!.{
num1
if (d1 <> DateToStr(date(0,0,0), 'DD/MM/YY'), d1, '')
s1
!.{
 namenal1 nalog1
!.}
!.}
sum
.Endfields
^
.{
.{ ReePlPorFl CheckEnter
.}
.{ PlPorLoop CheckEnter
@@@@@@@@@@@@@@@@@@@@                       Главному бухгалтеру
                                           предприятия
                                           ^


            ИЗВЕЩЕНИЕ О ПРОВЕДЕНИИ ВЗАИМОЗАЧЕТА N @@@@@@@@@@@@@

Содержание:
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

По состоянию на @@@@@@@@@@@ погашается задолженность:
──────────────────────────────────────────────────
    По  счетам,  предъявленным  предприятием
          @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
──────────────────────────────────────────────────
N ДО            Дата                  Сумма
──────────────────────────────────────────────────
.{ BaseDocLoop CheckEnter
@@@@@@@@@@@   @@@@@@@@@@@         &#&'&&&&&&&&&.&&
.{ NalogLoop CheckEnter
                    @@@@@@@@@@@   &#&'&&&&&&&&&.&&
.}
.}
──────────────────────────────────────────────────
   Зачет на сумму:  &#&'&&&&&&&&&.&&


   Начальник финансового отдела

   Главный бухгалтер
.}
.}
.endform

!==================================================================
.linkform 'vzachet3' prototype is 'vzachet'
!==================================================================
.Group 'Отчеты для печати'
.nameinlist 'Акт для дебитора'
.Fields
CommonFormHeader
AktNo wer kontr1 namepl1 namepl2 namepl3 d wer
!.{
num1
if (d1 <> DateToStr(date(0,0,0), 'DD/MM/YY'), d1, '')
s1
!.{
 namenal1 nalog1
!.}
!.}
sum
.Endfields
^
.{
.{ ReePlPorFl CheckEnter
.}
.{ PlPorLoop CheckEnter
                                Акт N @@@@@@@@
                        взаимозачета между предприятиями
                        @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                        @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

Содержание:
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

По состоянию на @@@@@@@@@@@ погашается задолженность:
──────────────────────────────────────────────────
    По  счетам,  предъявленным  предприятием
          @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
──────────────────────────────────────────────────
N ДО            Дата                  Сумма
──────────────────────────────────────────────────
.{ BaseDocLoop CheckEnter
@@@@@@@@@@@    @@@@@@@@@@@        &#&'&&&&&&&&&.&&
.{ NalogLoop CheckEnter
                    @@@@@@@@@@@   &#&'&&&&&&&&&.&&
.}
.}
──────────────────────────────────────────────────
   Зачет на сумму:  &#&'&&&&&&&&&.&&



   Начальник финансового отдела

   Главный бухгалтер
.}
.}
.endform

!==================================================================
.linkform 'vzachet4' prototype is 'vzachet'
!==================================================================
.Group 'Отчеты для печати'
.nameinlist 'Извещение для кредитора'
.Fields
CommonFormHeader
wer kontr2 AktNo namepl1 namepl2 namepl3 d wer
!.{
num2
schet
if (d2 <> DateToStr(date(0,0,0), 'DD/MM/YY'), d2, '')
s2
!.{
namenal2 nalog2
!.}
!.}
sum
.Endfields
^
.{
.{ ReePlPorFl CheckEnter
.}
.{ PlPorLoop CheckEnter
@@@@@@@@@@@@@@@@@@@@                       Главному бухгалтеру
                                           предприятия
                                           ^


            ИЗВЕЩЕНИЕ О ПРОВЕДЕНИИ ВЗАИМОЗАЧЕТА N @@@@@@@@@@@@@

Содержание:
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

По состоянию на @@@@@@@@@@@ погашается задолженность:
────────────────────────────────────────────────────────
       По счетам, предъявленным предприятию
                  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@
────────────────────────────────────────────────────────
  N ДО       N счета         Дата           Сумма
────────────────────────────────────────────────────────
.{ BaseDocLoop CheckEnter
@@@@@@@@   @@@@@@@@@@@@@  @@@@@@@@@@@   &#&'&&&&&&&&&.&&
.{ NalogLoop CheckEnter
                          @@@@@@@@@@@   &#&'&&&&&&&&&.&&
.}
.}
────────────────────────────────────────────────────────
   Зачет на сумму:  &#&'&&&&&&&&&.&&


   Начальник финансового отдела

   Главный бухгалтер
.}
.}
.endform

!==================================================================
.linkform 'vzachet5' prototype is 'vzachet'
!==================================================================
.Group 'Отчеты для печати'
.nameinlist 'Акт для кредитора'
.Fields
CommonFormHeader
AktNo wer kontr2 namepl1 namepl2 namepl3 d wer
!.{
num2
schet
if (d2 <> DateToStr(date(0,0,0), 'DD/MM/YY'), d2, '')
s2
!.{
namenal2 nalog2
!.}
!.}
sum
.Endfields
^
.{
.{ ReePlPorFl CheckEnter
.}
.{ PlPorLoop CheckEnter
                                Акт N @@@@@@@@
                        взаимозачета между предприятиями
                        @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                        @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

Содержание
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

По состоянию на @@@@@@@@@@@ погашается задолженность:
────────────────────────────────────────────────────────
       По счетам, предъявленным предприятию
                  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@
────────────────────────────────────────────────────────
  N ДО       N счета         Дата           Сумма
────────────────────────────────────────────────────────
.{ BaseDocLoop CheckEnter
@@@@@@@@   @@@@@@@@@@@@@   @@@@@@@@@@@  &#&'&&&&&&&&&.&&
.{ NalogLoop CheckEnter
                          @@@@@@@@@@@   &#&'&&&&&&&&&.&&
.}
.}
────────────────────────────────────────────────────────
   Зачет на сумму:  &#&'&&&&&&&&&.&&


   Начальник финансового отдела

   Главный бухгалтер
.}
.}
.endform

!==========================================================================================
.linkform 'vzachet6' prototype is 'vzachet'
!==========================================================================================
.Group 'Реестр'
.nameinlist 'Реестр актов взаимозачета'
.var
aa : boolean
AllSum: double
.endvar
.{
.begin
 aa := false;
 AllSum := 0;
end.
.Fields
CommonFormHeader
.Endfields
^
 И
                              Реестр актов взаимозачета

.{ ReePlPorFl CheckEnter
.{?INTERNAL; (not aa)
.Fields
cFil0 cFil1
.Endfields
.begin
 aa := true;
end.
 БПрименен фильтр... Б
.}
  ^ ^
.}
───────┬──────────┬──────────┬─────────────────────┬────────────────────┬──────────────────
 Номер │   Дата   │   Дата   │       Дебитор       │      Кредитор      │   Сумма зачета
 акта  │ выписки  │ обработки│                     │                    │
───────┼──────────┼──────────┼─────────────────────┼────────────────────┼──────────────────
.{ PlPorLoop CheckEnter
.begin
 AllSum :=  double(sum) + AllSum;
end.
.fields
 AktNo
 if (d <> DateToStr(date(0,0,0), 'DD/MM/YY'), d, '')
 if (dobr <> DateToStr(date(0,0,0), 'DD/MM/YY'), dobr, '')
 kontr1
 kontr2
 sum
.endfields
@@@@@@@│@@@@@@@@@@│@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@│&#&'&&&&&&&&.&&
.{ BaseDocLoop CheckEnter
.{ NalogLoop CheckEnter
.}
.}
.}
───────┴──────────┴──────────┴─────────────────────┴────────────────────┴────────────────── И
.fields
  AllSum
.endfields
 Б ИТОГО:                                                    &#&'&&&&&&&&.&& Б
.}
.endform

