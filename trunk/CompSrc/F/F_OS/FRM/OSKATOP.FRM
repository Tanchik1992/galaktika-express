//------------------------------------------------------------------------------
//                                                      (c) Корпорация ГАЛАКТИКА
// Галактика 8.1 - Бухгалтерский контур
// Реестр операций по карточке
//------------------------------------------------------------------------------
#doc
  Форма для печати реестра операций по карточке
#end
.form 'Oskatop'
.hide
.fields
  KatOsNRec   : comp // ссылка на крточку
  NastrOsNRec : comp // ссылка на метод учета
  KatOsCMol   : comp // ссылка на МОЛ
  KatOsCPodr  : comp // ссылка на подразделение
  KatOscMc    : comp // ссылка на МЦ 

  ТипКарточки : word // 15 - ОС, 16 - НМА

  Инвентарный_Номер
  Наименование

  ДатаВыпуска
  ДатаПоступления
  ДатаВвода
  ДатаВыбытия

  Стоимость_Поступ
  Износ_Поступ

  Подразделение_Имя_Тек
  Подразделение_Код_Тек
  МОЛ_Имя_Тек
  МОЛ_Код_Тек

!.{
  SpMoveOsNRec        : comp    // ссылка на спецификацию операции
  ОперацияПроведена   : boolean // true если проведена, false если не проведена.
  ПерваяОперация      : boolean // true если выводимая операция является первой

  ДатаОперации
  НомерОперации
  ТипОперации_Имя
  ТипОперации_Код     : word // MoveOs.SysOper

! значения до операции
  KatPodrBeforeNRec   : comp // ссылка на подразделение до операции
  KatMolBeforeNRec    : comp // ссылка на МОЛ до операции
  KatOsHighBeforeNRec : comp // ссылка на вышестоящее ОС (сложный объект) до операции
  GrOsBeforeNRec      : comp // ссылка на группу ОС до операци
  VidBeforeNRec       : comp // ссылка на вид до операции
  NormaBeforeNRec     : comp // ссылка на норму амортизации до операции

  Стоимость_до
  Износ_до
  ИзносМес_до

  Подразделение_Имя_до
  Подразделение_Код_до

  МОЛ_Имя_до
  МОЛ_Код_до

  Инвентарный_Номер_Выш_до
  Наименование_Выш_до

  Количество_до

  Группа_Имя_до
  Группа_Код_до

  Вид_Имя_до
  Вид_Код_до

  Норма_Имя_до
  Норма_Код_до
  Норма_Знач_до

! значения после операции
  KatPodrAfterNRec    : comp // ссылка на подразделение до операции                  
  KatMolAfterNRec     : comp // ссылка на МОЛ до операции                            
  KatOsHighAfterNRec  : comp // ссылка на вышестоящее ОС (сложный объект) до операции
  GrOsAfterNRec       : comp // ссылка на группу ОС до операци                       
  VidAfterNRec        : comp // ссылка на вид до операции                            
  NormaAfterNRec      : comp // ссылка на норму амортизации до операции              

  Стоимость_после
  Износ_после
  ИзносМес_после

  Подразделение_Имя_после
  Подразделение_Код_после

  МОЛ_Имя_после
  МОЛ_Код_после

  Инвентарный_Номер_Выш_после
  Наименование_Выш_после

  Количество_после

  Группа_Имя_после
  Группа_Код_после

  Вид_Имя_после
  Вид_Код_после

  Норма_Имя_после
  Норма_Код_после
  Норма_Знач_после
!.}
.endfields
^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^
.{
^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^
^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^
^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^
.}
.endform

.linkform 'OsKatOp_01' prototype is 'Oskatop'
.NameInList 'Список операций по карточке'
.group 'Основные средства'
.p 60
.defo landscape
.fields
  Инвентарный_Номер
  Наименование

  Количество_до
  Стоимость_до
  Износ_до

  Подразделение_Имя_до
  МОЛ_Имя_до

  Инвентарный_Номер_Выш_до

  Группа_Имя_до
  Вид_Имя_до
  Норма_Код_до

  if(ОперацияПроведена,'*','')
  ДатаОперации
  НомерОперации
  ТипОперации_Имя

  Количество_после
  Стоимость_после
  if ( (ТипОперации_Код = 1) OR (ТипОперации_Код = 3), Double(Стоимость_после)-Double(Стоимость_до), 0.0 )
  Износ_после
  ИзносМес_после

  Подразделение_Имя_после
  МОЛ_Имя_после

  Инвентарный_Номер_Выш_после

  Группа_Имя_после
  Вид_Имя_после
  Норма_Код_после
.endfields
 И                  ОПЕРАЦИИ ПО ИНВЕНТАРНОЙ КАРТОЧКЕ №  Б^ Б УЧЕТА ОСНОВНЫХ СРЕДСТВ
         Б@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Й
 Ш
.{
.[h
                                                                                                                                                                                                                       лист @np@
─┬──────────┬─────────┬──────────────────────┬───────┬────────────────────┬────────────────────┬────────────────────┬──────────────┬───────────────┬───────────────┬─────────────────┬────────────────────┬────────────────────┬─────────
 │   Дата   │  Номер  │     Тип операции     │Кол-во │      Стоимость     │ Величина изменения │    Сумма износа    │Износ за месяц│ Подразделение │      Мол      │   Вышестоящий   │       Группа       │         Вид        │Код нормы
 │          │         │                      │       │                    │      стоимости     │                    │              │               │               │     объект      │                    │                    │
─┴──────────┴─────────┴──────────────────────┴───────┴────────────────────┴────────────────────┴────────────────────┴──────────────┴───────────────┴───────────────┴─────────────────┴────────────────────┴────────────────────┴─────────
.]h
.{?INTERNAL;ПерваяОперация and ТипОперации_Код != 1;
                                              &&&&&&& &'&&&&&&&&&&&&&&&.&&                      &'&&&&&&&&&&&&&&&.&&                @@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@ @@@@@@@@@
.}
@ @@@@@@@@@@ @@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@ &&&&&&& &'&&&&&&&&&&&&&&&.&& &#'&&&&&&&&&&&&&&.&& &'&&&&&&&&&&&&&&&.&& &'&&&&&&&&&.&& @@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@ @@@@@@@@@
.[f
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.]f
.}
* - операция проведена Ш
.endform

.linkform 'OsKatOp_02' prototype is 'Oskatop'
.NameInList 'Список операций по карточке'
.group 'Нематериальные активы'
.p 60
.defo landscape
.fields
  Инвентарный_Номер
  Наименование

  Количество_до
  Стоимость_до
  Износ_до

  Подразделение_Имя_до
  МОЛ_Имя_до

  Вид_Имя_до
  Норма_Код_до

  if(ОперацияПроведена,'*','')
  ДатаОперации
  НомерОперации
  ТипОперации_Имя

  Количество_после
  Стоимость_после
  if ( (ТипОперации_Код = 1) OR (ТипОперации_Код = 3), Double(Стоимость_после)-Double(Стоимость_до), 0.0 )
  Износ_после
  ИзносМес_после

  Подразделение_Имя_после
  МОЛ_Имя_после

  Вид_Имя_после
  Норма_Код_после
.endfields
 И              ОПЕРАЦИИ ПО ИНВЕНТАРНОЙ КАРТОЧКЕ №  Б^ Б УЧЕТА НЕМАТЕРИАЛЬНЫХ АКТИВОВ
         Б@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Й
 Ш
.{
.[h
                                                                                                                                                                                                                       лист @np@
─┬──────────┬─────────┬──────────────────────┬───────┬────────────────────┬────────────────────┬────────────────────┬──────────────┬────────────────────────────┬────────────────────────────┬─────────────────────────────────┬─────────
 │   Дата   │  Номер  │     Тип операции     │Кол-во │      Стоимость     │ Величина изменения │    Сумма износа    │Износ за месяц│        Подразделение       │            Мол             │               Вид               │Код нормы
 │          │         │                      │       │                    │      стоимости     │                    │              │                            │                            │                                 │
─┴──────────┴─────────┴──────────────────────┴───────┴────────────────────┴────────────────────┴────────────────────┴──────────────┴────────────────────────────┴────────────────────────────┴─────────────────────────────────┴─────────
.]h
.{?INTERNAL;ПерваяОперация and ТипОперации_Код != 1;
                                              &&&&&&& &'&&&&&&&&&&&&&&&.&&                      &'&&&&&&&&&&&&&&&.&&                @@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@
.}
@ @@@@@@@@@@ @@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@ &&&&&&& &'&&&&&&&&&&&&&&&.&& &#'&&&&&&&&&&&&&&.&& &'&&&&&&&&&&&&&&&.&& &'&&&&&&&&&.&& @@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@
.[f
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.]f
.}
* - операция проведена Ш
.endform
