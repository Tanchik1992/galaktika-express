//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 5.85 - ФРО и Налоговый учет
// Печать налоговых регистров
// Внимание! Существует slk-отчет в формате Excel
//------------------------------------------------------------------------------

#doc
Печать налоговых регистров
#end

.Set Name = 'NalRegSb'
.Hide
.Fields
  RegTypeStr : String Num      : string  dFrom  : Date
  InvNum     : String ObjName  : String  SumPr  : Double  InFuture : Boolean
  NoDoc      : String KatklProchName : String
  SumRs1     : Double SumRs4   : Double  SumRs2 : Double  SumRs3      : Double
  dDoc       : Date   DateEnd  : Date    DopWrd1: Word
  Refin      : Double
  Templ      : String VidRash  : String  OsAlgName : String
  RasprMode  : String

  DatDoc     : Date SumRs     : Double  THO    : String
.endFields
! Подкачка Excel форматов
! Эта строчка нужна пока не будет решена 102.31867
#include ExcelFormat.frn


   ^ ^ ^
   ^
   ^
   ^ ^
   ^ ^
   ^ ^
   ^ ^ ^ ^ ^ ^ ^
   ^
   ^
   ^
.{
   ^ ^ ^
.}

.endForm

//-----------------------------------------------------------------------------

.LinkFORM NalRegSb01 Prototype Is NalRegSb
.NameInList 'Убыток от реализации амортизируемого имущества'
.Group 'Форма регистра для амортизируемого имущества'
.p 80
.Defo Portrait
.Fields
  CommonFormHeader
  '"'+RegTypeStr+'"' Num dFrom
  InvNum   ObjName
  SumPr   if ( InFuture, 'Входит', 'Не входит')
  SumRs1  SumRs4
  SumRs2  SumRs3
  SumRs1-SumRs2
  Templ
  VidRash
  OsAlgName
  RasprMode
.endFields
 И.[h
                                      Лист @Np@
.]h
^
                                  НАЛОГОВЫЙ РЕГИСТР
      @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                                N ^ от ^

      Инв.номер @@@@@@@@@@@@@
      Наименование объекта @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
      Убытки от реал-ии   &&&&&&&&&&&&.&&   В расх. буд. периодов &&&&&&&&&&&&&
      Первонач. стоимость &&&&&&&&&&&&.&&   Цена реализации     &&&&&&&&&&&&.&&
      Сумма амортизации   &&&&&&&&&&&&.&&   Расходы реализации  &&&&&&&&&&&&.&&
      Остаточн. стоимость &&&&&&&&&&&&.&&
      Шаблон       @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
      Вид расхода  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
      Алгоритм     @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
      ^
.{
.[h
     ─────────────┬─────────────────┬───────────────────────────────────────────
          Дата    │      Сумма      │    ТХО
     ─────────────┴─────────────────┴───────────────────────────────────────────
.]h
.Fields
  DatDoc   SumRs  THO
.endFields
      @@@@@@@@@@   &#&&&&&&&&&&&.&&   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.}
 И
.endForm

//-----------------------------------------------------------------------------

.LinkFORM NalRegSb02 Prototype Is NalRegSb
.NameInList 'Уступка долга после наступления срока платежа'
.Group 'Форма регистра для уступок долга до наступления срока платежа'
.p 80
.Defo Portrait
.Fields
  CommonFormHeader
  '"'+RegTypeStr+'"' Num dFrom
  SumPr  if ( InFuture, 'Входит', 'Не входит')
  NoDoc
  SumRs1 SumRs2
  SumRs2-SumRs1
  dDoc  DateEnd
  Refin
  Templ
  VidRash
  OsAlgName
  RasprMode
.endFields
 И.[h
                                      Лист @Np@
.]h
^
                                  НАЛОГОВЫЙ РЕГИСТР
      @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                                N ^ от ^

      Принимаемый убыток  &&&&&&&&&&&.&&     В расх. буд. периодов &&&&&&&&&&&&&
      Номер уступки       &&&&&&&&&&&&&&     Цена продажи         &&&&&&&&&&&.&&
      Сумма долга         &&&&&&&&&&&.&&     Убыток от уступки    &&&&&&&&&&&.&&
      Дата уступки        &&&&&&&&&&&&&&     Дата погашения       &&&&&&&&&&&&&&
      Ставка рефинансирования &&&&&&&&&%
      Шаблон        @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
      Вид расхода   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
      Алгоритм      @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
      ^
.{
.[h
     ─────────────┬─────────────────┬───────────────────────────────────────────
          Дата    │      Сумма      │    ТХО
     ─────────────┴─────────────────┴───────────────────────────────────────────
.]h
.Fields
  DatDoc   SumRs  THO
.endFields
      @@@@@@@@@@   &#&&&&&&&&&&&.&&   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.}
 И
.endForm

//-----------------------------------------------------------------------------

.LinkFORM NalRegSb03 Prototype Is NalRegSb
.NameInList 'Уступка долга после наступления срока платежа'
.Group 'Форма регистра для уступок долга после наступления срока платежа'
.p 80
.Defo Portrait
.Fields
  CommonFormHeader
  '"'+RegTypeStr+'"' Num dFrom
  SumPr  if ( InFuture, 'Входит', 'Не входит')
  NoDoc
  SumRs1 SumRs2
  SumRs2-SumRs1
  dDoc  DateEnd
  Refin
  Templ
  VidRash
  OsAlgName
  RasprMode
.endFields
 И.[h
                                      Лист @Np@
.]h
^
                                  НАЛОГОВЫЙ РЕГИСТР
      @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                                N ^ от ^

      Принимаемый убыток  &&&&&&&&&&&.&&     В расх. буд. периодов &&&&&&&&&&&&&
      Номер уступки       &&&&&&&&&&&&&&     Цена продажи         &&&&&&&&&&&.&&
      Сумма долга         &&&&&&&&&&&.&&     Убыток от уступки    &&&&&&&&&&&.&&
      Дата уступки        &&&&&&&&&&&&&&     Дата погашения       &&&&&&&&&&&&&&
      Ставка рефинансирования &&&&&&&&&%
      Шаблон        @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
      Вид расхода   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
      Алгоритм      @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
      ^
.{
.[h
     ─────────────┬─────────────────┬───────────────────────────────────────────
          Дата    │      Сумма      │    ТХО
     ─────────────┴─────────────────┴───────────────────────────────────────────
.]h
.Fields
  DatDoc   SumRs  THO
.endFields
      @@@@@@@@@@   &#&&&&&&&&&&&.&&   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.}
 И
.endForm

//-----------------------------------------------------------------------------

.LinkFORM NalRegSb04 Prototype Is NalRegSb
.NameInList 'Убытки прошлых лет'
.Group 'Форма регистра для убытков прошлых лет'
.p 80
.Defo Portrait
.Fields
  CommonFormHeader
  '"'+RegTypeStr+'"' Num dFrom
  SumPr   if ( InFuture, 'Входит', 'Не входит')
  DopWrd1
  Templ
  VidRash
  OsAlgName
  RasprMode  
.endFields
 И.[h
                                      Лист @Np@
.]h
^
                                  НАЛОГОВЫЙ РЕГИСТР
      @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                                N ^ от ^

      Сумма убытка        &&&&&&&&&&&.&&   В расх. буд. периодов &&&&&&&&&&&&&&
      Убыток за                 &&&& год
      Шаблон       @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
      Вид расхода  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
      Алгоритм     @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
      ^
.{
.[h
     ─────────────┬─────────────────┬───────────────────────────────────────────
          Дата    │      Сумма      │    ТХО
     ─────────────┴─────────────────┴───────────────────────────────────────────
.]h
.Fields
  DatDoc   SumRs  THO
.endFields
      @@@@@@@@@@   &#&&&&&&&&&&&.&&  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.}
 И
.endForm

//-----------------------------------------------------------------------------

.LinkFORM NalRegSb05 Prototype Is NalRegSb
.NameInList 'Расходы по добровольному страхованию работников'
.Group 'Форма регистра для расходов по добровольному страхованию работников'
.p 80
.Defo Portrait
.Fields
  CommonFormHeader
  '"'+RegTypeStr+'"' Num dFrom
  SumPr   if ( InFuture, 'Входит', 'Не входит')
  SumRs1  
  SumRs2  SumRs3
  Templ  
  VidRash  
  OsAlgName 
  RasprMode  
.endFields
 И.[h
                                      Лист @Np@
.]h
^
                                  НАЛОГОВЫЙ РЕГИСТР
      @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                                N ^ от ^

      Принятая сумма          &&&&&&&&&&&.&&  В расх. буд. периодов &&&&&&&&&&&
      Факт. сумма страхования &&&&&&&&&&&.&&  Фонд оплаты труда  &&&&&&&&&&&.&&
      Норма                   &&&&&&&&&&&.&&
      Шаблон       @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
      Вид расхода  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
      Алгоритм     @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
      ^
.{
.[h
     ─────────────┬─────────────────┬───────────────────────────────────────────
          Дата    │      Сумма      │    ТХО
     ─────────────┴─────────────────┴───────────────────────────────────────────
.]h
.Fields
  DatDoc   SumRs  THO
.endFields
      @@@@@@@@@@   &#&&&&&&&&&&&.&&   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.}
 И
.endForm

//-----------------------------------------------------------------------------

.LinkFORM NalRegSb06 Prototype Is NalRegSb
.NameInList 'Резервы по сомнительным долгам'
.Group 'Форма регистра для резервов по сомнительным долгам'
.p 80
.Defo Portrait
.Fields
  CommonFormHeader
  '"'+RegTypeStr+'"' Num dFrom
  SumPr   if ( InFuture, 'Входит', 'Не входит')
  SumRs1  SumRs4 
  SumRs2  SumRs3 
  Refin
  Templ  
  VidRash  
  OsAlgName 
  RasprMode  
.endFields
 И.[h
                                      Лист @Np@
.]h
^
                                  НАЛОГОВЫЙ РЕГИСТР
      @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                                N ^ от ^

      Сумма убытка        &&&&&&&&&&&.&&   В расх. буд. периодов &&&&&&&&&&&&&&
      Задолж. свыше 90 дн.&&&&&&&&&&&.&&   Выручка за отч.период &&&&&&&&&&&.&&
      Задолж. 45..90 дн.  &&&&&&&&&&&.&&   Безнадежная задолж.   &&&&&&&&&&&.&&
      Ставка рефинансирования    &&&&&&%
      Шаблон       @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
      Вид расхода  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
      Алгоритм     @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
      ^
.{
.[h
     ─────────────┬─────────────────┬───────────────────────────────────────────
          Дата    │      Сумма      │    ТХО
     ─────────────┴─────────────────┴───────────────────────────────────────────
.]h
.Fields
  DatDoc   SumRs  THO
.endFields
      @@@@@@@@@@   &#&&&&&&&&&&&.&&   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.}
 И
.endForm

//-----------------------------------------------------------------------------

.LinkFORM NalRegSb07 Prototype Is NalRegSb
.NameInList 'Прочие налоговые операции'
.Group 'Форма регистра для прочих налоговых операций'
.Group 'Форма регистра по умолчанию'
.p 80
.Defo Portrait
.Fields
  CommonFormHeader
  '"'+RegTypeStr+'"' Num dFrom 
  SumPr   if ( InFuture, 'Входит', 'Не входит')
  KatklProchName 
  SumRs1  SumRs2   
  Templ  
  VidRash  
  OsAlgName 
  RasprMode  
.endFields
 И.[h
                                      Лист @Np@
.]h
^
                                  НАЛОГОВЫЙ РЕГИСТР
      @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                                N ^ от ^

      Сумма, принятая к учету &&&&&&&&&&&.&&  В расх. буд. периодов &&&&&&&&&&&
      Вид операции: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
      Фактическое значение    &&&&&&&&&&&.&&  Норма               &&&&&&&&&&.&&
      Шаблон       @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
      Вид расхода  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
      Алгоритм     @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
      ^
.{
.[h
     ─────────────┬─────────────────┬───────────────────────────────────────────
          Дата    │      Сумма      │    ТХО                                         
     ─────────────┴─────────────────┴───────────────────────────────────────────
.]h
.Fields
  DatDoc   SumRs  THO
.endFields
      @@@@@@@@@@   &#&&&&&&&&&&&.&&   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.}
 И
.endForm

//-----------------------------------------------------------------------------

.LinkFORM NalRegSb08 Prototype Is NalRegSb
.NameInList 'Расходы будущих периодов'
.Group 'Форма регистра для расходов будущих периодов'
.p 80
.Defo Portrait
.Fields
  CommonFormHeader
  '"'+RegTypeStr+'"' Num dFrom 
  SumPr
  KatklProchName 
  VidRash  
  RasprMode  
.endFields
 И.[h
                                      Лист @Np@
.]h
^
                                  НАЛОГОВЫЙ РЕГИСТР
      @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                                N ^ от ^

      Сумма, принятая к учету &&&&&&&&&&&.&&
      Вид операции: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
      Вид расхода  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
      ^
.{
.[h
     ─────────────┬─────────────────┬───────────────────────────────────────────
          Дата    │      Сумма      │    ТХО                                         
     ─────────────┴─────────────────┴───────────────────────────────────────────
.]h
.Fields
  DatDoc   SumRs  THO
.endFields
      @@@@@@@@@@   &#&&&&&&&&&&&.&&   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.}
 И
.endForm

//-----------------------------------------------------------------------------
