//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 6.00 - Векселя и кредиты
// Печать результатов распределения платежного документа
//------------------------------------------------------------------------------

#doc
Печать результатов распределения платежного документа
#end

.set name='OplVeksl'
.hide

.fields
  MyNr            /* Nrec из AppVeks или GrefKred */
  TipDk           /* 81..88,185,186               */
  TipKred         /* TiDk из GrefKred             */
  DocName         /* Вид документа                */
  NoAppKred       /* Номер акта или графика       */
  DatAppKred      /* Дата акта или графика        */
  NoDoc           /* Номер спецификации           */
  DatVip          /* Дата документа               */
  StageTip        /* Тип этапа погашения кредита  */
  Sum_Veksl       /* Сумма документа              */
  SumCommon       /* Сумма платежа                */
  Val2            /* Валюта документа             */
!-----------
  NoDoc2          /* Номер платёжного документа   */
  Dat_Op          /* Дата платёжного документа    */
  Sum             /* Сумма платёжного документа   */
  Val             /* Валюта платёжного документа  */
.endfields

^ ^ ^
^ ^ ^
.{
^ ^ ^ ^ ^ ^
.{ VekslOpLoop CheckEnter
^ ^ ^ ^
.}
.}

.endform

!------------------------------------------------------
!------------------------------------------------------
!------------------------------------------------------
.linkform 'OplVeksl01' prototype is 'OplVeksl'
.group 'Распределение по спецификациям'
.nameinlist 'Результаты распределения'
.defo Landscape
.p 45
.fields
  CommonFormHeader
  DocName
  NoAppKred
  if (Longint(StrToDate(DatAppKred,'DD/MM/YYYY'))<>0, DatAppKred, '')
  NoDoc
  if (Longint(StrToDate(DatVip,'DD/MM/YYYY'))<>0, DatVip, '')
  Sum_Veksl
  SumCommon
  Val2
!-----------
  NoDoc2
  if (Longint(StrToDate(Dat_Op,'DD/MM/YYYY'))<>0, Dat_Op, '')
  Sum
  Val
.endfields
 С^ С
              Б  ^ ^ от ^ Б
.{
.[h
 С                                                                                                                  лист @Np@
─────────────┬──────────┬─────────────────────┬─────────────────────┬──────┬─────────────┬──────────┬─────────────────────┬──────
  N док-та   │   Дата   │  Сумма по операции  │    Сумма платежа    │Валюта│N плат.док-та│   Дата   │    Сумма оплаты     │Валюта
─────────────┴──────────┴─────────────────────┴─────────────────────┴──────┴─────────────┴──────────┴─────────────────────┴──────
.]h
@@@@@@@@@@@@@ @@@@@@@@@@ &'&&&&&&&&&&&&&&&&.&& &'&&&&&&&&&&&&&&&&.&& @@@@@@
.{ VekslOpLoop CheckEnter
                                                                            @@@@@@@@@@@@@ @@@@@@@@@@ &'&&&&&&&&&&&&&&&&.&& @@@@@@
.}
───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── С
.}
.endform

!------------------------------------------------------
!------------------------------------------------------
!------------------------------------------------------
.linkform 'OplVeksl02' prototype is 'OplVeksl'
.group 'Распределение по план-графикам кредитов'
.nameinlist 'Результаты распределения'
.defo Landscape
.p 45
.fields
  CommonFormHeader
  DocName
  NoAppKred
  if (Longint(StrToDate(DatAppKred,'DD/MM/YYYY'))<>0, DatAppKred, '')
  if (Longint(StrToDate(DatVip,'DD/MM/YYYY'))<>0, DatVip, '')
  Sum_Veksl
  SumCommon
  Val2
!-----------
  NoDoc2
  if (Longint(StrToDate(Dat_Op,'DD/MM/YYYY'))<>0, Dat_Op, '')
  Sum
.endfields
 С^ С
          Б  ^ ^ от ^ Б
.{
.[h
 С                                                                                             лист @Np@
──────────┬─────────────────────┬─────────────────────┬──────┬─────────────┬──────────┬─────────────────────
   Дата   │     Сумма этапа     │ Сумма по документам │Валюта│N плат.док-та│   Дата   │       Сумма
──────────┴─────────────────────┴─────────────────────┴──────┴─────────────┴──────────┴─────────────────────
.]h
@@@@@@@@@@ &'&&&&&&&&&&&&&&&&.&& &'&&&&&&&&&&&&&&&&.&& @@@@@@
.{ VekslOpLoop CheckEnter
                                                              @@@@@@@@@@@@@ @@@@@@@@@@ &'&&&&&&&&&&&&&&&&.&&
.}
──────────────────────────────────────────────────────────────────────────────────────────────────────────── С
.}
.endform

!------------------------------------------------------
!------------------------------------------------------
!------------------------------------------------------
.linkform 'OplVeksl03' prototype is 'OplVeksl'
.group 'Распределение по план-графикам погашения кредитов'
.nameinlist 'Результаты распределения'
.defo Landscape
.p 45
.fields
  CommonFormHeader
  DocName
  NoAppKred
  if (Longint(StrToDate(DatAppKred,'DD/MM/YYYY'))<>0, DatAppKred, '')
  if (Longint(StrToDate(DatVip,'DD/MM/YYYY'))<>0, DatVip, '')
  StageTip
  Sum_Veksl
  SumCommon
  Val2
!-----------
  NoDoc2
  if (Longint(StrToDate(Dat_Op,'DD/MM/YYYY'))<>0, Dat_Op, '')
  Sum
.endfields
 С^ С
              Б  ^ ^ от ^ Б
.{
.[h
 С                                                                                                                 лист @Np@
──────────┬───────────────────┬─────────────────────┬─────────────────────┬──────┬─────────────┬──────────┬─────────────────────
   Дата   │     Тип этапа     │     Сумма этапа     │  Погашенная сумма   │Валюта│N плат.док-та│   Дата   │       Сумма
──────────┴───────────────────┴─────────────────────┴─────────────────────┴──────┴─────────────┴──────────┴─────────────────────
.]h
@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&&&&&&.&& &'&&&&&&&&&&&&&&&&.&& @@@@@@
.{ VekslOpLoop CheckEnter
                                                                                  @@@@@@@@@@@@@ @@@@@@@@@@ &'&&&&&&&&&&&&&&&&.&&
.}
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── С
.}
.endform
