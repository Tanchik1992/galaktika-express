ID;PWXL;N;E
P;PGeneral
P;P0
P;P0.00
P;P#,##0
P;P#,##0.00
P;P#,##0_Ns_.;;\-#,##0_Ns_.
P;P#,##0_Ns_.;;[Red]\-#,##0_Ns_.
P;P#,##0.00_Ns_.;;\-#,##0.00_Ns_.
P;P#,##0.00_Ns_.;;[Red]\-#,##0.00_Ns_.
P;P#,##0"$";;\-#,##0"$"
P;P#,##0"$";;[Red]\-#,##0"$"
P;P#,##0.00"$";;\-#,##0.00"$"
P;P#,##0.00"$";;[Red]\-#,##0.00"$"
P;P0%
P;P0.00%
P;P0.00E+00
P;P##0.0E+0
P;P#" "?/?
P;P#" "??/??
P;Pdd/mm/yyyy
P;Pdd/mmm/yy
P;Pdd/mmm
P;Pmmm/yy
P;Ph:mm\ AM/PM
P;Ph:mm:ss\ AM/PM
P;Ph:mm
P;Ph:mm:ss
P;Pdd/mm/yyyy\ h:mm
P;Pmm:ss
P;Pmm:ss.0
P;P@
P;P[h]:mm:ss
P;P_-* #,##0"$"_-;;\-* #,##0"$"_-;;_-* "-""$"_-;;_-@_-
P;P_-* #,##0_Ns_._-;;\-* #,##0_Ns_._-;;_-* "-"_Ns_._-;;_-@_-
P;P_-* #,##0.00"$"_-;;\-* #,##0.00"$"_-;;_-* "-"??"$"_-;;_-@_-
P;P_-* #,##0.00_Ns_._-;;\-* #,##0.00_Ns_._-;;_-* "-"??_Ns_._-;;_-@_-
P;P"NHANAa";;"NHANAa";;"NBINJaNAo"
P;P"NAENDnNAoNAeNBiNAa";;"NAENDnNAoNAeNBiNAa";;"NHENCiNqNHu"
P;P"NCANCeNHe";;"NCANCeNHe";;"NCANCuNCeNHe"
P;Pmm/yyyy
P;FArial Cyr;M200
P;FArial Cyr;M200
P;FArial Cyr;M200
P;FArial Cyr;M200
P;EArial Cyr;M200
P;EArial Cyr;M200
P;EArial Cyr;M200
P;EArial Cyr;M200
P;EArial Cyr;M200
P;EArial Cyr;M200
P;EArial Cyr;M200
P;EArial Cyr;M200
P;EArial Cyr;M200
P;EArial Cyr;M200
P;EArial Cyr;M200
P;EArial Cyr;M200
P;EArial Cyr;M200
P;EArial Cyr;M200
P;EArial Cyr;M200
P;EArial Cyr;M200
P;EArial Cyr;M200
P;EArial Cyr;M200
P;EArial Cyr;M200
P;EArial Cyr;M200
P;EArial Cyr;M200
P;EArial Cyr;M200
P;EArial Cyr;M200
P;EArial Cyr;M200
P;EArial Cyr;M160
P;EArial Cyr;M160;SB
P;EArial Cyr;M140
P;EArial Cyr;M200;SB
P;EArial Cyr;M160;SI
P;EArial Cyr;M160;SB
P;EArial Cyr;M160;SB
F;P0;DG0G8;M255
B;Y254;X12;D0 0 253 11
O;L;D;V0;K47;G100 0.001
F;W1 1 6
F;W2 2 11
F;W3 3 13
F;W5 6 10
F;W7 7 13
F;W8 8 11
F;W9 9 10
F;W11 11 9
F;W12 12 12
F;M205;R113
F;M205;R114
F;M205;R115
F;M205;R116
F;M205;R117
F;M205;R118
F;M205;R119
F;M205;R120
F;M205;R121
F;M205;R122
F;M205;R123
F;M205;R124
F;M205;R125
F;M205;R127
F;M205;R144
F;M205;R146
F;M205;R214
F;M205;R225
F;M205;R227
F;M205;R238
F;M205;R239
F;M205;R240
F;M205;R249
F;M205;R250
C;Y1;X1;K"#include Responsible.frn"
C;Y2;K"! NDa================================================================================*<"
C;Y3;K"! *6                        (c)  2002 NCeNCiNsNHiNCiNsNAaNHoNAeNHy NDANAANHENAANCENAONAENCENAA"
C;X5;K"*6"
C;Y4;X1;K"! *6 NHINsNCiNJaNCeNAo"
C;X3;K"NDANAANHENAANCENAONAENCENAA"
C;X5;K"*6"
C;Y5;X1;K"! *6 NDNNAeNDnNAoNJaNAiNAa"
C;X3;K"NBANBoNDoNDaNAaNHeNAoNJaNsNDnNCeNAeNBe NCeNCiNBiNAoNBoNs"
C;X5;K"*6"
C;Y6;X1;K"! *6 NCANJaNsNDnNAeNHy"
C;X3;K"5.84, 7.1"
C;X5;K"*6"
C;Y7;X1;K"! *6 NBINAaNKcNBiNAa/7NJaNBiNAeNJa"
C;X3;K"NAENAoNCiNDaNCiNCaNAaNHy NCaNJaNHaNCiNAiNCiNDnNAoNHu NBiNAaNHeNAe/7NAeNHy NKcNAa NHiNJaNsNAeNCiNHa NCINDN (UIN 4711) NAe NBINAINAA (UIN 4712)."
C;X5;K"*6"
C;Y8;X1;K"! *6 NCINAoNCaNJaNAoNDnNAoNCaNJaNBiNBiNCuNBe"
C;X3;K"NCENBoNKcNBiNJaNHoNCiNCa NAANHeNJaNCeNDnNAaNBiNHaNs NBINAeNCeNCiNHeNAaNJaNCaNAe/7"
C;X5;K"*6"
C;Y9;X1;K"! *6 NHINAaNsNAaNAiNJaNAoNsNCu"
C;X3;K"NJANDnNAoNHu"
C;X5;K"*6"
C;Y10;X1;K"! L================================================================================-"
C;Y11;K".LinkForm 'OsItog_05_Excel' Prototype is 'OsItog'"
C;Y12;K"!============================================================================="
C;Y13;K"!============================================================================="
C;Y14;K".NameInList 'NbNJaNDaNAeNDnNAoNs NBo/7NJaNAoNAa NAaNAiNCiNsNAoNAeNKcNAaNHoNAeNAe (NDn NBiNAaNsNAaNDnNAoNAaN|NAuNAeNAi NAeNAoNCiNDaNCiNAi) NCa NCoNCiNsNAiNAaNAoNJa Excel'"
C;Y15;K".Group 'NbNJaNDaNAeNDnNAoNs NBo/7NJaNAoNAa NAaNAiNCiNsNAoNAeNKcNAaNHoNAeNAe NCINDN'"
C;Y16;K".p 60"
C;Y17;K".defo landscape"
C;Y18;K".var"
C;Y19;K"  nRecKatOs   : comp;;"
C;Y20;K"  currArcDate : date;;"
C;Y21;K"  aMonthSum   : array[1..12] of double;;"
C;Y22;K" SumStoim    : double;;"
C;Y23;K"  SumOstStoim : double;;"
C;Y24;K"  GrItogStoim : double;;"
C;Y25;K"  GrItogOstSt : double;;"
C;Y26;K"  currMonth   : word;;"
C;Y27;K"  currOtchPer : date;;"
C;Y28;K"  bUseKatOs   : boolean;;"
C;Y29;K"  dPoprKoef   : double;;"
C;Y30;K"  dStoim      : double;;"
C;Y31;K"  dIznos      : double;;"
C;Y32;K"  dFullIznos  : double;;"
C;Y33;K"  dOstStoim   : double;;"
C;Y34;K"  dBazStoim   : double;;"
C;Y35;K"  dSrokPol    : double;;"
C;Y36;K"  dSrokOst    : double;;"
C;Y37;K"  dSumAmort   : double;;"
C;Y38;K"  dStoimSumAll: double;;"
C;Y39;K"  dOstStSumAll: double;;"
C;Y40;K"  wFormIzn: word;;"
C;Y41;K"  wEdIzmSrok  : word;;"
C;Y42;K".endvar"
C;Y43;K"#ResponsibleLinkVar"
C;Y44;K".create view NalAmort"
C;Y45;K"as select *"
C;Y46;K"from"
C;Y47;K"  KatOs, ArcIznos, SpKatOs, NastrOs, VidNorma, "
C;Y48;K"  Synonym GrOs  GrOsKat,"
C;Y49;K"  Synonym GrOs  GrOsArc,"
C;Y50;K"  Synonym OsAlg OsAlgKat,"
C;Y51;K"  Synonym OsAlg OsAlgArc"
C;Y52;K"where"
C;Y53;K"(("
C;Y54;K"  nRecKatOs       == KatOs.nRec        and"
C;Y55;K"  KatOs.nRec      == ArcIznos.cKatOs   and"
C;Y56;K"  nRec_NastrOs    == ArcIznos.cNastrOs and"
C;Y57;K"  currArcDate     == ArcIznos.Data     and"
C;Y58;K"  KatOs.cGrup     == GrOsKat.nRec      and"
C;Y59;K"  ArcIznos.cGrup  == GrOsArc.nRec      and"
C;Y60;K"  KatOs.nRec      == SpKatOs.cKatOs    and"
C;Y61;K"  nRec_NastrOs    == SpKatOs.cNastrOs  and"
C;Y62;K"  SpKatos.cMetod  == OsAlgKat.nRec     and"
C;Y63;K"  ArcIznos.cMetod == OsAlgArc.nRec     and"
C;Y64;K"  nRec_NastrOs    == NastrOs.nRec      and"
C;Y65;K"  KatOs.cVid      == VidNorma.nRec"
C;Y67;K"))"
C;Y68;K";;"
C;Y69;K".{"
C;Y70;K"#ResponsibleLinkInit(OSITOG)"
C;Y71;K".Fields"
C;Y72;K"CommonFormHeader"
C;Y73;K"NHANAaNAoNAa_NDn"
C;Y74;K"NHANAaNAoNAa_NHiNCi"
C;Y75;K"NBINAaNAeNAiNJaNBiNCiNCaNAaNBiNAeNJa_NCiNsNDaNAaNBiNAeNKcNAaNHoNAeNAe"
C;Y76;K"NAINJaNAoNCiNHa"
C;Y77;K"NCO_NHaNJaNHeNAeNAoNJaNHeNHu"
C;Y78;K"NHANJaNHeNAeNAoNJaNHeNHu_NHiNsNCiNHiNAeNDnNHuN|"
C;Y79;K"NCANAaNHeN|NAoNAa_NAiNJaNAoNCiNHaNAa"
C;Y80;K"NDANsNBoNHiNHiNAeNsNCiNCaNCeNAa"
C;Y81;K"NDNNCiNsNAoNAeNsNCiNCaNCeNAa"
C;Y82;K"!---------------- FilterOS"
C;Y83;K"NCONAeNHeNHuNAoNs"
C;Y84;K"!---------------- GruppaOS"
C;Y85;K"NCANJaNAoNCeNAa"
C;Y86;K"if (NAENAoNCiNDaNCi_NCaNJaNsNDo_NCeNCiNBiNJaNHo <> 0, DoubleToStr(NAENAoNCiNDaNCi_NCaNJaNsNDo_NCeNCiNBiNJaNHo, efSumFormatExcel), '')"
C;Y87;K"if (NAENAoNCiNDaNCi_NCaNJaNsNDo_NCeNCiNBiNJaNHo_NAe_NCaNCuNBaNCuNCaNyNAeNJa <> 0, DoubleToStr(NAENAoNCiNDaNCi_NCaNJaNsNDo_NCeNCiNBiNJaNHo_NAe_NCaNCuNBaNCuNCaNyNAeNJa, efSumFormatExcel), '')"
C;Y88;K"!---------------- NameOS"
C;Y89;K"if (Longint(NHANAaNAoNAa_NDn)<>0, DoubleToStr(currMonth,'77') + DateToStr(NHANAaNAoNAa_NDn, '.YYYY'), '')"
C;Y90;K"if (NCANCuNBaNCuNHe_NCa_NAoNJaNCeNBoNAuNJaNAi_NHiNJaNsNAeNCiNHaNJa, '*'+NalAmort.KatOs.InNum, NalAmort.KatOs.InNum)"
C;Y91;K"NalAmort.KatOs.NameOs"
C;Y92;K"if (bUseKatOs, NalAmort.GrOsKat.NameGr, NalAmort.GrOsArc.NameGr)"
C;Y93;K"if (bUseKatOs, NalAmort.OsAlgKat.Name, NalAmort.OsAlgArc.Name)"
C;Y94;K"if (dPoprKoef <> 0, DoubleToStr(dPoprKoef, efSumFormatExcel), '')"
C;Y95;K"if (dStoim <> 0, DoubleToStr(dStoim, efSumFormatExcel), '')"
C;Y96;K"if (dOstStoim <> 0, DoubleToStr(dOstStoim, efSumFormatExcel), '')"
C;Y97;K"if (dBazStoim <> 0, DoubleToStr(dBazStoim, efSumFormatExcel), '')"
C;Y98;K"if (dSrokPol <> 0, DoubleToStr(dSrokPol, '66666'), '')"
C;Y99;K"if (dSrokOst <> 0, DoubleToStr(dSrokOst, '66666'), '')"
C;Y100;K"if (dSumAmort <> 0, DoubleToStr(dSumAmort, efSumFormatExcel), '')"
C;Y101;K"!---------------- ItogOS"
C;Y102;K"NAENAoNCiNDaNCi"
C;Y103;K"if (GrItogStoim <> 0, DoubleToStr(GrItogStoim, efSumFormatExcel), '')"
C;Y104;K"if (GrItogOstSt <> 0, DoubleToStr(GrItogOstSt,efSumFormatExcel), '')"
C;Y105;K"if (NAENAoNCiNDaNCi_NCeNCiNBiNJaNHo <> 0, DoubleToStr(NAENAoNCiNDaNCi_NCeNCiNBiNJaNHo, efSumFormatExcel), '')"
C;Y106;K"if (NAENAoNCiNDaNCi_NCeNCiNBiNJaNHo_NAe_NCaNCuNBaNCuNCaNyNAeNJa <> 0, DoubleToStr(NAENAoNCiNDaNCi_NCeNCiNBiNJaNHo_NAe_NCaNCuNBaNCuNCaNyNAeNJa, efSumFormatExcel), '')"
C;Y108;K"NDN_NBo/7NJaNAoNCiNAi_NCaNCuNBaNCuNCaNyNAeNDo_NCa_NHiNJaNsNAeNCiNHaNJa"
C;Y109;K"if (dStoimSumAll <> 0, DoubleToStr(dStoimSumAll, efSumFormatExcel), '')"
C;Y110;K"if (dOstStSumAll <> 0, DoubleToStr(dOstStSumAll, efSumFormatExcel), '')"
C;Y111;K"if (NAENAoNCiNDaNCi_NCeNCiNBiNJaNHo_NAe_NCaNCuNBaNCuNCaNyNAeNJa <> 0, DoubleToStr(NAENAoNCiNDaNCi_NCeNCiNBiNJaNHo_NAe_NCaNCuNBaNCuNCaNyNAeNJa, efSumFormatExcel), '')"
C;Y112;K".EndFields"
F;SM29;Y113
C;K"^"
F;SM29;X2
F;SM29;X3
F;SM29;X4
F;SM29;X5
F;SM29;X6
F;SM29;X7
F;SM29;Y114;X1
F;SM29;X2
F;SM29;X3
F;SM29;X4
F;SM29;X5
F;SM29;X6
F;P0;FG0C;SDM30;X7
C;K"NbNJaNDaNAeNDnNAoNs-NsNAaNDn/7NJaNAo"
F;SM29;Y115;X1
F;SM29;X2
F;SM29;X3
F;SM29;X4
F;SM29;X5
F;SM29;X6
F;P0;FG0C;SDM30;X7
C;K"NBO/7NJaNAo NAaNAiNCiNsNAoNAeNKcNAaNHoNAeNAe NCiNDnNBiNCiNCaNBiNCuNDo NDnNsNJaNHaNDnNAoNCa"
F;SM29;Y116;X1
F;SM29;X2
F;SM29;X3
F;SM29;X4
F;SM29;X5
F;SM29;X6
F;P0;FG0C;SDM30;X7
C;K"NKcNAa NHiNJaNsNAeNCiNHa NDn ^ NHiNCi ^"
F;SM29;Y117;X1
F;SM29;X2
F;SM29;X3
F;SM29;X4
F;SM29;X5
F;SM29;X6
F;P0;FG0C;SDM30;X7
F;SBM29;Y118;X1
F;P0;FG0C;SDBM30;X2
C;K"^"
F;SBM29;X3
F;SM29;X4
F;SM29;X5
F;SM29;X6
F;P0;FG0C;SDM30;X7
F;SM29;Y119;X1
F;P0;FG0C;SM31;X2
C;K"(NBiNAaNAeNAiNJaNBiNCiNCaNAaNBiNAeNJa NCiNsNDaNAaNBiNAeNKcNAaNHoNAeNAe)"
F;SM29;X3
F;SM29;X4
F;SM29;X5
F;SM29;X6
F;P0;FG0C;SDM30;X7
F;SM29;Y120;X1
F;SM29;X2
F;SM29;X3
F;SM29;X4
F;SM29;X5
F;SM29;X6
F;SM29;X7
F;SM29;Y121;X1
C;K"NAINJaNAoNCiNHa:"
F;SM29;X2
F;SM29;X3
C;K"^"
F;SM29;X4
F;SM29;X5
F;SM29;X6
F;SM29;X7
F;SM29;Y122;X1
C;K"NHANJaNBiNJaNqNBiNAaNHy NJaNHaNAeNBiNAeNHoNAa:"
F;SM29;X2
F;SM29;X3
C;K"^ ( ^ ) ^"
F;SM29;X4
F;SM29;X5
F;SM29;X6
F;SM29;X7
F;SM29;Y123;X1
C;K"NDANsNBoNHiNHiNAeNsNCiNCaNCeNAa:"
F;SM29;X2
F;SM29;X3
C;K"^"
F;SM29;X4
F;SM29;X5
F;SM29;X6
F;SM29;X7
F;SM29;Y124;X1
C;K"NDNNCiNsNAoNAeNsNCiNCaNCeNAa:"
F;SM29;X2
F;SM29;X3
C;K"^"
F;SM29;X4
F;SM29;X5
F;SM29;X6
F;SM29;X7
F;SM29;Y125;X1
F;P0;FG0L;SM29;X2
C;K"NCONAeNHeNHuNAoNsNCu:"
F;SM29;X3
F;SM29;X4
F;SM29;X5
F;SM29;X6
F;SM29;X7
C;Y126;X1;K".{ CheckEnter FilterOS3"
F;Y127
F;X2
C;K" ^"
F;X3
F;X4
F;X5
F;X6
F;X7
C;Y128;X1;K".}"
C;Y129;K".begin"
C;Y130;K"  wEdIzmSrok  := wGetTune('OS.SrokIspEdIzm');;"
C;Y131;K"if (NalAmort.GetFirst NastrOs = tsOk)"
C;Y132;K"    case NalAmort.NastrOs.TiDk of"
C;Y133;K"      15: wFormIzn := wGetTune('OS.FormIzn');;"
C;Y134;K"      16: wFormIzn := wGetTune('NMA.FormIzn');;"
C;Y135;K"    end;;"
C;Y136;K"end."
C;Y137;K".{"
F;SDM32;Y138
C;K".[h"
F;SLRTM29;Y139
F;P0;FG0C;SDRTM30;X2
C;K"NAENBiNCaNJaNBiNAoNAaNsNBiNCuNBe"
F;P0;FG0C;SDRTM30;X3
C;K"NBINAaNAeNAiNJaNBiNCiNCaNAaNBiNAeNJa"
F;P0;FG0C;SDRTM30;X4
F;P0;FG0C;SDRTM30;X5
C;K"NAANHeNDaNCiNsNAeNAoNAi"
F;P0;FG0C;SDRTM30;X6
C;K"NHINCiNHiNsNAaNCaNCi/7NBiNCuNBe"
F;P0;FG0C;SDRTM30;X7
C;K"NHINJaNsNCaNCiNBiNAa/7NAaNHeNHuNBiNAaNHy"
F;P0;FG0C;SDRTM30;X8
C;K"NCINDnNAoNAaNAoNCi/7NBiNAaNHy"
F;P0;FG0C;SDRTM30;X9
C;K"NBANAaNKcNCiNCaNAaNHy "
F;P0;FG0L;SDLTM30;X10
C;K" NDNNsNCiNCe NAeNDnNHiNCiNHeNHuNKcNCiNCaNAaNBiNAeNHy,"
F;P0;FG0L;SDRTM30;X11
F;P0;FG0C;SDRTM30;X12
C;K"NDNNBoNAiNAiNAa"
F;P0;FG0C;SDLRM30;Y140;X1
C;K"NHINJaNsNAeNCiNHa"
F;P0;FG0C;SDRM30;X2
C;K"NBiNCiNAiNJaNs"
F;P0;FG0C;SDRM30;X3
C;K"NCiNBaNBuNJaNCeNAoNAa"
F;P0;FG0C;SDRM30;X4
C;K"NDANsNBoNHiNHiNAa NCINDN"
F;P0;FG0C;SDRM30;X5
C;K"NBiNAa/7NAeNDnNHeNJaNBiNAeNHy"
F;P0;FG0C;SDRM30;X6
C;K"NCeNCi/=NCoNCoNAeNHoNAeNJaNBiNAo"
F;P0;FG0C;SDRM30;X7
C;K"NDnNAoNCiNAeNAiNCiNDnNAoNHu"
F;P0;FG0C;SDRM30;X8
C;K"NDnNAoNCiNAeNAiNCiNDnNAoNHu"
F;P0;FG0C;SDRM30;X9
C;K"NDnNAoNCiNAeNAiNCiNDnNAoNHu "
F;P0;FG0C;SDBM30;X10
C;K"                     NAiNJaNDn."
F;SRBM29;X11
F;P0;FG0C;SDRM30;X12
C;K"NAaNAiNCiNsNAoNAeNKcNAaNHoNAeNAe"
F;P0;FG0C;SDLRBM30;Y141;X1
F;P0;FG0C;SDRBM30;X2
F;P0;FG0C;SDRBM30;X3
F;P0;FG0C;SDRBM30;X4
F;P0;FG0C;SDRBM30;X5
C;K"NAaNAiNCiNsNAoNAeNKcNAaNHoNAeNAe"
F;P0;FG0C;SDRBM30;X6
F;P0;FG0C;SDRBM30;X7
F;P0;FG0C;SDRBM30;X8
F;P0;FG0C;SDRBM30;X9
F;P0;FG0C;SDRBM30;X10
C;K"NHINCiNHeNJaNKcNBiNCuNBe"
F;P0;FG0C;SDRBM30;X11
C;K"NCINDnNAoNAaNCaNyNAeNBeNDnNHy"
F;SRBM29;X12
F;SDM32;Y142;X1
C;K".]h"
C;Y143;K".{ CheckEnter GruppaOS3"
F;SLTM29;Y144
C;K"@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@"
F;STM29;X2
F;STM29;X3
F;STM29;X4
F;STM29;X5
F;STM29;X6
F;STM29;X7
F;STM29;X8
F;STM29;X9
F;STM29;X10
F;STM29;X11
F;P4;FF2G;SLRTBM29;X12
C;K"&"
C;Y145;X1;K".{?Internal;;(NeedSum1 and (NBO/7NJaNAo_NCaNCuNBaNCuNCaNyNAeNDo <> 4 ));;"
F;SLBM29;Y146
F;SBM29;X2
F;SBM29;X3
F;SBM29;X4
F;SBM29;X5
F;SBM29;X6
F;SBM29;X7
F;SBM29;X8
F;SBM29;X9
F;SBM29;X10
F;P0;FG0R;SIBM33;X11
C;K"*"
F;P4;FF2G;SILRTBM33;X12
C;K"&"
C;Y147;X1;K".}                                                                                      "
C;Y148;K".}"
C;Y149;K".{ CheckEnter NameOS3"
C;Y150;K".begin"
C;Y151;K"  dSumAmort := 0;;"
C;Y152;K"  nRecKatOs := KatOS_NRec;;"
C;Y153;K"  if (NalAmort.GetFirst KatOs <> tsOk) {};;"
C;Y154;K"  aMonthSum[1]  := N{NBiNCaNAaNsNHu;;"
C;Y155;K"  aMonthSum[2]  := NCONJaNCaNsNAaNHeNHu;;"
C;Y156;K"  aMonthSum[3]  := NAINAaNsNAo;;"
C;Y157;K"  aMonthSum[4]  := NAANHiNsNJaNHeNHu;;"
C;Y158;K"  aMonthSum[5]  := NAINAaNBe;;"
C;Y159;K"  aMonthSum[6]  := NAEN|NBiNHu;;"
C;Y160;K"  aMonthSum[7]  := NAEN|NHeNHu;;"
C;Y161;K"  aMonthSum[8]  := NAANCaNDaNBoNDnNAo;;"
C;Y162;K"  aMonthSum[9]  := NDNNJaNBiNAoNHyNBaNsNHu;;"
C;Y163;K"  aMonthSum[10] := NCINCeNAoNHyNBaNsNHu;;"
C;Y164;K"  aMonthSum[11] := NBINCiNHyNBaNsNHu;;"
C;Y165;K"  aMonthSum[12] := NHANJaNCeNAaNBaNsNHu;;"
C;Y166;K"  currMonth := 0;;"
C;Y167;K"  SumOstStoim := 0;;"
C;Y168;K"  SumStoim    := 0;;"
C;Y169;K"end."
C;Y170;K".{while currMonth < 12"
C;Y171;K".begin"
C;Y172;K"  currMonth := currMonth + 1;;"
C;Y173;K"  currArcDate := date(Last_Day(date(1,currMonth,Year(NHANAaNAoNAa_NDn))), currMonth, Year(NHANAaNAoNAa_NDn));;"
C;Y174;K"  if (NalAmort.GetFirst Katos <> tsOk) {};;"
C;Y175;K"  if (NalAmort.GetFirst ArcIznos <> tsOk) {};;"
C;Y176;K"  if (NalAmort.GetFirst NastrOs <> tsOk) {};;"
C;Y177;K"  currOtchPer := NalAmort.KatOs.OtchPer;;"
C;Y178;K"  if (currArcDate >= currOtchPer)"
C;Y179;K"  {"
C;Y180;K"    bUseKatOs  := true;;"
C;Y181;K"    dPoprKoef  := NalAmort.NastrOs.KIAO * NalAmort.VidNorma.Norma * NalAmort.SpKatOs.Poprkoef;;"
C;Y182;K"    dStoim     := if (NalAmort.NastrOs.Field4 = 0, NalAmort.SpKatOs.Stoim * NalAmort.KatOs.Kol, NalAmort.SpKatOs.Stoim);;"
C;Y183;K"    dIznos     := if (wFormIzn = 0, NalAmort.SpKatOs.SumIzn, NalAmort.SpKatOs.SumIzn + NalAmort.SpKatOs.SIznM);;"
C;Y184;K"    dFullIznos := if (NalAmort.NastrOs.Field4 = 0, dIznos * NalAmort.KatOs.Kol, dIznos);;"
C;Y185;K"    dSrokPol   := NalAmort.SpKatOs.SrokIsp;;"
C;Y186;K"    dSrokOst   := NalAmort.SpKatOs.SrokIsp - (NalAmort.SpKatOs.IspPs + NalAmort.SpKatOs.IspCur);;"
C;Y187;K"  }"
C;Y188;K"  else"
C;Y189;K"  {"
C;Y190;K"    bUseKatOs  := false;;"
C;Y191;K"    dPoprKoef  := NalAmort.ArcIznos.KoofIz * NalAmort.ArcIznos.KoofYsk * NalAmort.ArcIznos.KoofSm;;"
C;Y192;K"    dStoim     := if (NalAmort.NastrOs.Field4 = 0, NalAmort.ArcIznos.Stoim * NalAmort.ArcIznos.Kol, NalAmort.ArcIznos.Stoim);;"
C;Y193;K"    dIznos     := if (wFormIzn = 0, NalAmort.ArcIznos.SumIzn, NalAmort.ArcIznos.SumIzn + NalAmort.ArcIznos.SIznM);;"
C;Y194;K"    dFullIznos := if (NalAmort.NastrOs.Field4 = 0, dIznos * NalAmort.ArcIznos.Kol, dIznos);;"
C;Y195;K"    dSrokPol   := NalAmort.ArcIznos.SrokIsp;;"
C;Y196;K"    dSrokOst   := NalAmort.ArcIznos.SrokIsp - (NalAmort.SpKatOs.IspPs + NalAmort.ArcIznos.IspCur);;"
C;Y197;K"  }"
C;Y198;K"  if (wEdIzmSrok = 1)"
C;Y199;K"  {"
C;Y200;K"    dSrokPol := dSrokPol * 12;;"
C;Y201;K"    dSrokOst := dSrokOst * 12;;"
C;Y202;K"  }"
C;Y203;K"  dOstStoim := dStoim - dFullIznos;;"
C;Y204;K"  if (aMonthSum[currMonth] <> 0)"
C;Y205;K"  {"
C;Y206;K"    SumOstStoim := dOstStoim;;"
C;Y207;K"    SumStoim := dStoim;;"
C;Y208;K"  }"
C;Y209;K"  dBazStoim := dStoim*0.2;;"
C;Y210;K"  if (dOstStoim >= dBazStoim) dBazStoim := 0;;"
C;Y211;K"  dSumAmort := dSumAmort + aMonthSum[currMonth];;"
C;Y212;K"end."
C;Y213;K".{?Internal;;aMonthSum[currMonth]<>0"
F;P39;FG0G;SLRTBM29;Y214
C;K"@@@@@@@@@"
F;SRTBM29;X2
C;K"@@@@@@@@@@@@@@@@@"
F;SRTBM29;X3
C;K"@@@@@@@@@@@@@@@@@@@@@@@@@@@@"
F;SRTBM29;X4
C;K"@@@@@@@@@@@@@@@@@"
F;SRTBM29;X5
C;K"@@@@@@@@@@@@@@@@@@@"
F;SRTBM29;X6
C;K"&"
F;P4;FF2G;SRTBM29;X7
C;K"&"
F;P4;FF2G;SRTBM29;X8
C;K"&"
F;P4;FF2G;SRTBM29;X9
C;K"&"
F;SRTBM29;X10
C;K"&"
F;SRTBM29;X11
C;K"&"
F;P4;FF2G;SRTBM29;X12
C;K"&"
C;Y215;X1;K".}"
C;Y216;K".}"
C;Y217;K".begin"
C;Y218;K"  GrItogStoim := GrItogStoim + SumStoim;;"
C;Y219;K"  GrItogOstSt := GrItogOstSt + SumOstStoim;;"
C;Y220;K"  dStoimSumAll := dStoimSumAll + SumStoim;;"
C;Y221;K"  dOstStSumAll := dOstStSumAll + SumOstStoim;;"
C;Y222;K"end."
C;Y223;K".}"
C;Y224;K".{ CheckEnter ItogOS3"
F;SLTM29;Y225
C;K"@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@"
F;STM29;X2
F;STM29;X3
F;STM29;X4
F;STM29;X5
F;STM29;X6
F;P4;FF2G;SLRTBM29;X7
C;K"&"
F;P4;FF2G;SLRTBM29;X8
C;K"&"
F;STM29;X9
F;STM29;X10
F;STM29;X11
F;P4;FF2G;SLRTBM29;X12
C;K"&"
C;Y226;X1;K".begin"
F;Y227
C;K"  GrItogStoim := 0;;"
F;X2
F;X3
F;X4
F;X5
F;X6
F;X7
F;X8
F;X9
F;X10
F;X11
F;X12
C;Y228;X1;K"  GrItogOstSt := 0;;"
C;Y229;K"end."
C;Y230;K".{?Internal;;(NBO/7NJaNAo_NCaNCuNBaNCuNCaNyNAeNDo <> 4 );;"
F;SLBM29;Y231
F;SBM29;X2
F;SBM29;X3
F;SBM29;X4
F;SBM29;X5
F;SBM29;X6
F;SBM29;X7
F;SBM29;X8
F;SBM29;X9
F;SBM29;X10
F;P0;FG0R;SIBM33;X11
C;K"*"
F;P4;FF2G;SILRTBM33;X12
C;K"&"
C;Y232;X1;K".}"
C;Y233;K".}"
C;Y234;K".}"
C;Y235;K".{?Internal;;(NBO/7NJaNAo_NCaNCuNBaNCuNCaNyNAeNDo <> 4 );;"
F;SIM33;Y236
C;K"          * - NDn NBo/7NJaNAoNCiNAi NCaNCuNBaNCuNCaNyNAeNDo NCa NCiNAo/7NJaNAoNBiNCiNAi ^"
F;SIM33;X2
F;SIM33;X3
F;SIM33;X4
F;SM29;X5
F;SM29;X6
F;SM29;X7
F;SM29;X8
F;SM29;X9
F;SM29;X10
F;SM29;X11
F;SM29;X12
C;Y237;X1;K".}"
F;SM29;Y238
F;SM29;X2
F;SM29;X3
F;SM29;X4
F;SM29;X5
F;SM29;X6
F;SM29;X7
F;SM29;X8
F;SM29;X9
F;SM29;X10
F;SM29;X11
F;SM29;X12
F;SDM30;Y239;X1
C;K"NAENAONCINDANCI"
F;SM29;X2
F;SM29;X3
F;SM29;X4
F;SM29;X5
F;SM29;X6
F;P4;FF2G;SDLRTBM34;X7
C;K"&"
F;P4;FF2G;SDRTBM34;X8
C;K"&"
F;SM29;X9
F;SM29;X10
F;SM29;X11
F;P4;FF2G;SDLRTBM34;X12
C;K"&"
F;Y240;X1
F;X2
F;X3
F;X4
F;X5
F;X6
F;X7
F;X8
F;X9
F;X10
F;X11
F;X12
C;Y241;X1;K".{While (NBINCiNAiNJaNs_NCINAoNCaNJaNAoNDnNAoNCaNJaNBiNBiNCiNDaNCi_NHeNAeNHoNAa < NCENCiNHeNAe/7NJaNDnNAoNCaNCi_NCiNAoNCaNJaNAoNDnNAoNCaNJaNBiNBiNCuNDo_NHeNAeNHo)"
C;Y242;K".begin"
C;Y243;K"NBINCiNAiNJaNs_NCINAoNCaNJaNAoNDnNAoNCaNJaNBiNBiNCiNDaNCi_NHeNAeNHoNAa  := NBINCiNAiNJaNs_NCINAoNCaNJaNAoNDnNAoNCaNJaNBiNBiNCiNDaNCi_NHeNAeNHoNAa  + 1;;"
C;Y244;K"end."
C;Y245;K".fields"
C;Y246;K" NAINAaNDnNDnNAeNCa_NCINAoNCaNJaNAoNDnNAoNCaNJaNBiNBiNCiNJa_NHeNAeNHoNCi_NHANCiNHeNqNBiNCiNDnNAoNHu [NBINCiNAiNJaNs_NCINAoNCaNJaNAoNDnNAoNCaNJaNBiNBiNCiNDaNCi_NHeNAeNHoNAa ]"
C;Y247;K" NAINAaNDnNDnNAeNCa_NCINAoNCaNJaNAoNDnNAoNCaNJaNBiNBiNCiNJa_NHeNAeNHoNCi_NCONAENCI[NBINCiNAiNJaNs_NCINAoNCaNJaNAoNDnNAoNCaNJaNBiNBiNCiNDaNCi_NHeNAeNHoNAa ]"
C;Y248;K".endfields"
F;SDM35;Y249
C;K" ^"
F;SM29;X2
F;X3
F;X4
F;SBM29;X5
C;K" "
F;SM29;X6
F;SBM29;X7
C;K" ^"
F;SBM29;X8
F;SBM29;X9
F;SBM0;X10
F;SBM0;X11
F;SBM0;X12
F;SM29;Y250;X1
F;SM29;X2
F;X3
F;X4
F;P0;FG0C;SM31;X5
C;K"(NHiNCiNHaNHiNAeNDnNHu)"
F;P0;FG0C;SM31;X6
F;P0;FG0C;SM31;X7
F;X8
F;P0;FG0C;SM31;X9
C;K"(NAE.NCI.NCONAaNAiNAeNHeNAeNHy)"
F;X10
F;X11
F;X12
C;Y252;X1;K".}"
C;Y253;K".}"
C;Y254;K".EndForm"
E
