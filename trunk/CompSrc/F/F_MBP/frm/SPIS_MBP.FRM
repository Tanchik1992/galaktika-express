//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 7.12 - Спецоснастка
// Групповые документы на списание спецоснастки
//------------------------------------------------------------------------------

#doc
Формирование различных печатных форм из документов спецоснастки следующих
типов: ведомость начисления износа, акт на списание, акт о недостаче.<br>
#end
#include Commission.frn // комиссии
.set name = 'Spis_MBP'
.NameInList 'Базовая форма для групповых документов на списание МБП'
.hide
.fields
  DocNRec  : Comp     //
  Nom      : String   // 01
  Dat      : Date     // 02
  Podr     : String   // 03
  MOL      : String   // 04
  MOLShort : String
  MainBuh  : String
  MyOrg    : String   // 05
  ОКПО     : String   // 06
#CommissionFields
.endfields
.{
1234
^^^^^^^^^
#CommissionBody(SpisMBPProt)
.{SpSpis CheckEnter
.fields
  SpNRec    : Comp     //
  MBPName   : String   // 05
  MBPNum    : String   // 06
  MBPEd     : String   // 07
  explDate  : Date     // 08
  Price     : Double   // 09
  Srok      : String
  InvN      : String
  Pass      : String
  Kol       : Double   // 10  Для начисления износа кол-во на момент операции
  SumPr     : Double   // 11  Для начисления износа сумма на момент операции
  tPerc     : Double   // 12
  tSumIsn   : Double   // 13
  Perc      : Double   // 14
  SumIsn    : Double   // 15
  PrKod     : String   // 16
  PrName    : String   // 17
  PersFIO   : String
  TabNum    : String
  OstStoim  : Double
  PageBreak : Boolean
.endfields
56789 01234567
^^^^^^^^^^^^^^^^^
^^^
.}
^
.}
.endform

!======================================================================================================================

.linkform 'Spis_MBP_01' prototype is 'Spis_MBP'
.Group 'Акт на списание МБП' // CCCP
.NameInList 'Акт на списание (форма № МБ-8)'
.var
  Cnt : LongInt
  TotCnt : Double
  TotSum : Double
.endvar
#CommissionLinkVar
.{
#CommissionLinkInit(SpisMBPProt)
.fields
  CommonFormHeader
  Nom
  DateToStr(Dat,'DD')
  DateToStr(Dat,'Mon')
  DateToStr(Dat,'YYYY')
  Podr
.endfields
.begin
  Cnt := 0;
  TotSum := 0;
  TotCnt := 0;
end.
 ^
                                                     УТВЕРЖДАЮ:
                                         ______________________________
                                                   должность
                                         ____________   _______________
                                            подпись      И.,О.,фамилия

                                            "___"______________20___г.


                             А К Т  №  Б@@@@@@@@@@@@@@@ Б

        АКТ НА СПИСАНИЕ МАЛОЦЕННЫХ И БЫСТРОИЗНАШИВАЮЩИХСЯ ПРЕДМЕТОВ
                               " Б^ Б"  Б^ Б  Б^ Бг.
 Р  Комиссия, назначенная приказом от "____"_______________20___г.  №________, осмотрела принятые
  за ________________20___г. находившиеся в эксплуатации  малоценные и быстроизнашивающиеся пред-
  меты и признала их пришедшими в негодность и подлежащими сдаче в утиль.
               ┌──────────────────┬──────────────────────────────┬──────────────────┬─────────────────────────────────┐
               │                  │                              │                  │       Корреспондирующий счет    │
               │   Вид операции   │     Цех (отдел), участок     │     Кладовая     ├────────────────┬────────────────┤
               │                  │                              │                  │ счет, субсчет  │код аналит.учета│
               ├──────────────────┼──────────────────────────────┼──────────────────┼────────────────┼────────────────┤
               │                  │@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│                  │                │                │
               └──────────────────┴──────────────────────────────┴──────────────────┴────────────────┴────────────────┘
┌─────────────────────────────────────┬──────┬──────────┬───────┬───────────┬──────────────┬──────────────────────────┐
│              Предмет                │      │   Дата   │       │           │              │      Причина списания    │
├───┬──────────────────────┬──────────┤Един. │ поступл. │ Коли- │           │              ├───────┬──────────────────┤
│ № │     Наименование     │Номенклат.│измер.│ в эксп-  │ чест- │    Цена   │    Сумма     │  Код  │   Наименование   │
│п/п│                      │  номер   │      │ луатацию │  во   │           │              │       │                  │
├───┼──────────────────────┼──────────┼──────┼──────────┼───────┼───────────┼──────────────┼───────┼──────────────────┤
.{SpSpis CheckEnter
.begin
  Cnt := Cnt + 1;
  TotSum := TotSum + if ( wGetTune( 'Fin.MBP.OstStoim') = 0, SumPr, SumPr - SumIsn);
  TotCnt := TotCnt + Kol;
end.
.fields
  Cnt
  MBPName
  MBPNum
  MBPEd
  explDate
  Kol
  Price
  if ( wGetTune( 'Fin.MBP.OstStoim') = 0, SumPr, SumPr - SumIsn)
  PrKod
  PrName
.endfields
│&&.│@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@│@@@@@@│@@@@@@@@@@│&&&&.&&│&&&&&&&&.&&│&&&&&&&&&&&.&&│@@@@@@@│@@@@@@@@@@@@@@@@@@│
.}
└───┴──────────────────────┴──────────┴──────┴──────────┴───────┴───────────┴──────────────┴───────┴──────────────────┘
.fields
  TotCnt
  TotSum
  DoubleToStr( TotCnt, '\2p\m4')+
    if ( Pos( 'ноль', DoubleToStr( TotCnt, '\2p5')) <> 0, '',
      DoubleToStr( TotCnt, 'целых \2p5'))
 Р Председатель_комиссии_Должность
 Председатель_комиссии_ФИО
 Р.endfields

 Б  Итого :                                              &&&&.&&   на сумму  &&&&&&&&&&&.&&

    @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ С
 Р  ───────────────────────────────────────────────────────────────────────────────────────────────────
                                 общее количество предметов прописью

  Номера и даты актов выбытия________________________________________________________________________
  ___________________________________________________________________________________________________
  Перечисленные в настоящем акте предметы в присутствии комиссии превращены в утиль, который подлежит
  оприходованию:
  ┌───────────────────────────────────────────┬─────────────────┬───────┬────────────┬─────────────────┬──────────────┐
  │                   Утиль                   │ Един. измерения │ Коли- │            │                 │  Порядковый  │
  ├────────────────────────────┬──────────────┼───────────┬─────┤ чест- │    Цена    │      Сумма      │ номер записи │
  │        Наименование        │ код (номенк- │  наимено- │ код │  во   │            │                 │ по складской │
  │                            │ лат. номер)  │   вание   │     │       │            │                 │  картотеке   │
  ├────────────────────────────┼──────────────┼───────────┼─────┼───────┼────────────┼─────────────────┼──────────────┤
  │              1             │      2       │     3     │  3  │   4   │     5      │        6        │      7       │
  ├────────────────────────────┼──────────────┼───────────┼─────┼───────┼────────────┼─────────────────┼──────────────┤
  ├────────────────────────────┼──────────────┼───────────┼─────┼───────┼────────────┼─────────────────┼──────────────┤
  ├────────────────────────────┼──────────────┼───────────┼─────┼───────┼────────────┼─────────────────┼──────────────┤
  ├────────────────────────────┼──────────────┼───────────┼─────┼───────┼────────────┼─────────────────┼──────────────┤
  ├────────────────────────────┼──────────────┼───────────┼─────┼───────┼────────────┼─────────────────┼──────────────┤
  ├────────────────────────────┼──────────────┼───────────┼─────┼───────┼────────────┼─────────────────┼──────────────┤
  ├────────────────────────────┼──────────────┼───────────┼─────┼───────┼────────────┼─────────────────┼──────────────┤
  └────────────────────────────┴──────────────┴───────────┴─────┴───────┴────────────┴─────────────────┴──────────────┘
   Утиль, не подлежащий учету, уничтожен.

   Председатель комиссии:  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  ________________________   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                 Должность                      подпись                        и., о., фамилия
 Р.{While (Номер_члена_комиссии < Количество_членов_комиссии)
.begin
  Номер_члена_комиссии := Номер_члена_комиссии + 1;
end.
.fields
  if (Номер_члена_комиссии = word(1), 'Члены комиссии:', '')
  Массив_Член_комиссии_Должность [Номер_члена_комиссии]
  Массив_Член_комиссии_ФИО       [Номер_члена_комиссии]
.endfields
 Р    @@@@@@@@@@@@@@@ Р
 Р                          Д@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  ________________________   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                 должность                      подпись                        и., о., фамилия
 Р.}
.{?INTERNAL;(Количество_членов_комиссии = 0)
 Р     Члены комиссии:      Д Д___________________________  ________________________   Д______________________________________ Д
                                 должность                      подпись                        и., о., фамилия
                          Д Д___________________________  ________________________   Д______________________________________ Д
                                 должность                      подпись                        и., о., фамилия
                         ___________________________  ________________________   Д______________________________________ Д
                                 должность                      подпись                        и., о., фамилия
 Р.}

   Утиль по накладной № ___________________сдан.

   "_____"_______________20___г.

.}
.endform

!======================================================================================================================

.linkform 'Spis_MBP_02' prototype is 'Spis_MBP'
.Group 'Акт на списание МБП'
.Group 'Акт на списание МБП (Россия)'
.NameInList 'Расходный ордер'
.var
  Npp : LongInt
  TotCnt : Double
  TotSum : Double
.endvar
#CommissionLinkVar
.{
#CommissionLinkInit(SpisMBPProt)
.fields
 CommonFormHeader
 Nom
 DateToStr(Dat,'DD/MM/YYYY')
 Podr MOL
.endfields
.begin
 Npp := 0
 TotSum := 0
 TotCnt := 0
end.
 ^

              РАСХОДНЫЙ ОРДЕР №  Б^ Б  от  Б^ Б

  Подразделение: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  МОЛ: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

 Р┌───┬────────────┬───────────────────────────────┬───────────┬──────────────┬───────────────┬──────────────┐
│ № │ Номенклат. │  Наименование МБП             │  Единица  │  Количество  │     Цена      │   Стоимость  │
│п/п│   номер    │                               │ измерения │              │               │              │
├───┼────────────┼───────────────────────────────┼───────────┼──────────────┼───────────────┼──────────────┤
.{SpSpis CheckEnter
.begin
 Npp := Npp + 1
 TotSum := TotSum + if ( wGetTune( 'Fin.MBP.OstStoim') = 0, SumPr, SumPr - SumIsn)
 TotCnt := TotCnt + Kol
end.
.fields
 Npp
 MBPNum
 MBPName
 MBPEd
 Kol  Price  if ( wGetTune( 'Fin.MBP.OstStoim') = 0, SumPr, SumPr - SumIsn)
.endfields
│&&.│ @@@@@@@@@@@│ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│ @@@@@@@@@@│&&&&&&&&&&&.&&│&&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│
.}
└───┴────────────┴───────────────────────────────┴───────────┴──────────────┴───────────────┴──────────────┘ Р

.fields
  TotCnt
  TotSum
.endfields
 С Итого :                                                      &&&&&&&&&&&.&&                 &&&&&&&&&&&.&& С

.}
.endform

!======================================================================================================================

.linkform 'Spis_MBP_03' prototype is 'Spis_MBP'
.Group 'Ведомость начисления износа'
.NameInList 'Расширенная ведомость начисления износа'
.var
  Cnt : LongInt
  TotCnt : Double
  TotIzn : Double
  TotSum : Double
.endvar
#CommissionLinkVar
.{
#CommissionLinkInit(SpisMBPProt)
.fields
 CommonFormHeader
 Nom
 DateToStr(Dat,'DD/MM/YYYY')
 Podr
 MOL
.endfields
.begin
 Cnt := 0
 TotCnt := 0
 TotIzn := 0
 TotSum := 0
end.
 ^

                 ВЕДОМОСТЬ НАЧИСЛЕНИЯ ИЗНОСА МБП
                      №  Б^ Б от  Б^ Б

  Подразделение : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  МОЛ           : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

 Р┌───┬────────────┬───────────────────────┬───────────┬────────┬──────────────┬───────┬──────────────┬────────┬──────────────┬─────────┬──────────────┐
│ № │ Номенклат. │   Наименование МБП    │  Единица  │ Кол-во │  Стоимость   │ Износ │    Сумма     │Начислен│ Сумма начис- │Суммарный│  Общая сумма │
│п/п│   номер    │                       │ измерения │        │              │   %   │    износа    │ износ %│леного износа │ износ % │    износа    │
├───┼────────────┼───────────────────────┼───────────┼────────┼──────────────┼───────┼──────────────┼────────┼──────────────┼─────────┼──────────────┤
.{SpSpis CheckEnter
.begin
 Cnt := Cnt + 1
 TotCnt := TotCnt + Kol
 TotIzn := TotIzn + SumIsn
 TotSum := TotSum + if ( wGetTune( 'Fin.MBP.OstStoim') = 0, SumPr, SumPr-tSumIsn)
end.
.fields
 Cnt
 MBPNum
 MBPName
 MBPEd
 Kol
 if ( wGetTune( 'Fin.MBP.OstStoim') = 0, SumPr, SumPr-tSumIsn)
 tPerc
 tSumIsn
 Perc
 SumIsn
 tPerc + Perc
 tSumIsn + SumIsn
.endfields
│&&.│ @@@@@@@@@@@│ @@@@@@@@@@@@@@@@@@@@@@│ @@@@@@@@@@│&&&&&.&&│&&&&&&&&&&&.&&│ &&&.&&│&&&&&&&&&&&.&&│ &&&&.&&│&&&&&&&&&&&.&&│ &&&&&.&&│&&&&&&&&&&&.&&│
.}
└───┴────────────┴───────────────────────┴───────────┴────────┴──────────────┴───────┴──────────────┴────────┴──────────────┴─────────┴──────────────┘ Р

.fields
  TotCnt
  TotSum
  TotIzn
.endfields
 С Итого :                                              &&&&&.&& &&&&&&&&&&&.&&                                 &&&&&&&&&&&.&& С
.}
.endform

!======================================================================================================================

.linkform 'Spis_MBP_04' prototype is 'Spis_MBP'
.Group 'Ведомость начисления износа'
.NameInList 'Краткая ведомость начисления износа'
.var
  Cnt : LongInt
  TotCnt : Double
  TotIzn : Double
  TotSum : Double
.endvar
#CommissionLinkVar
.{
#CommissionLinkInit(SpisMBPProt)
.fields
 CommonFormHeader
 Nom
 DateToStr(Dat,'DD/MM/YYYY')
 Podr
 MOL
.endfields
.begin
 Cnt := 0
 TotCnt := 0
 TotIzn := 0
 TotSum := 0
end.
 ^

                 ВЕДОМОСТЬ НАЧИСЛЕНИЯ ИЗНОСА МБП
                      №  Б^ Б от  Б^ Б

  Подразделение : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  МОЛ           : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

 Р┌───┬────────────┬───────────────────────┬───────────┬────────┬──────────────┬────────┬──────────────┐
│ № │ Номенклат. │   Наименование МБП    │  Единица  │ Кол-во │  Стоимость   │Начислен│ Сумма начис- │
│п/п│   номер    │                       │ измерения │        │              │ износ %│ленного износа│
├───┼────────────┼───────────────────────┼───────────┼────────┼──────────────┼────────┼──────────────┤
.{SpSpis CheckEnter
.begin
 Cnt := Cnt + 1
 TotCnt := TotCnt + Kol
 TotIzn := TotIzn + SumIsn
 TotSum := TotSum + if ( wGetTune( 'Fin.MBP.OstStoim') = 0, SumPr, SumPr-tSumIsn)
end.
.fields
 Cnt
 MBPNum
 MBPName
 MBPEd
 Kol
 if ( wGetTune( 'Fin.MBP.OstStoim') = 0, SumPr, SumPr-tSumIsn)
 Perc
 SumIsn
.endfields
│&&.│ @@@@@@@@@@@│ @@@@@@@@@@@@@@@@@@@@@@│ @@@@@@@@@@│&&&&&.&&│&&&&&&&&&&&.&&│ &&&&.&&│&&&&&&&&&&&.&&│
.}
└───┴────────────┴───────────────────────┴───────────┴────────┴──────────────┴────────┴──────────────┘ Р

.fields
  TotCnt
  TotSum
  TotIzn
.endfields
 С Итого :                                              &&&&&.&& &&&&&&&&&&&.&&          &&&&&&&&&&&.&& С
.}
.endform

!======================================================================================================================

.linkform 'Spis_MBP_05' prototype is 'Spis_MBP'
.Group 'Акт на списание МБП (Россия)'
.NameInList 'Акт на списание (форма № МБ-8)'
.f "MBPSPAKT.OUT"
.defo LandScape
.p 50
.var
  PageNumber : word;
  PageSeparator : boolean;

  TotCnt : Double
  TotSum : Double
  IznSum : Double
  StrCount : word
.endvar
.[h skip
.{?INTERNAL; (PageSeparator)
 Р                                                                                                                                                    Оборотная сторона формы № МБ-8 Р
.}
.begin
  PageNumber := PageNumber + 1;
  PageSeparator := true;
end.
.]h
#CommissionLinkVar
.{
#CommissionLinkInit(SpisMBPProt)
.fields
  CommonFormHeader
  Nom  MyOrg  ОКПО
  Podr
  DateToStr( Dat, 'DD/MM/YYYY')
  Podr
.endfields
.begin
  TotCnt := 0;
  TotSum := 0;
  IznSum := 0;
  StrCount := 0;
end.
 Р ^
                                                                                                                                       Типовая межотраслевая форма № МБ-8
                                                                                                                                       Утверждена постановлением Госкомстата России
                                                                                                                                       от 30.10.97 № 71а

                                                                                                                                                   УТВЕРЖДАЮ:
                                                                                                                                                ________________
                                               БАКТ №  Д@@@@@@@@@@ Е                                                                                      должность
                               Бна списание малоценных и быстроизнашивающихся Б                                                                ____________   ___________________
                                                  Бпредметов Б                                                                                    подпись     расшифровка подписи

                                                                                                                                     "___"______________20___г.
                                                                                                                                                                      ┌────────────┐
                                                                                                                                                                      │    Коды    │
                                                                                                                                                                      ├────────────┤
                                                                                                                                                        Форма по ОКУД │  0320004   │
                                                                                                                                                                      ├────────────┤
 Организация   Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е                     по ОКПО │@~@@@@@@@@@@│
 Структурное подразделение   Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е                             └────────────┘
                                                                                   ┌──────────┬──────────┬─────────────────────────────┬────────────────┬──────────────────────────┐
                                                                                   │   Дата   │   Код    │          Cтруктурное        │      Вид       │  Корреспондирующий счет  │
                                                                                   │  состав- │   вида   │         подразделение       │  деятельности  ├─────────┬────────────────┤
                                                                                   │   ления  │ операции │                             │                │  счет,  │  код аналити-  │
                                                                                   │          │          │                             │                │ субсчет │ ческого учета  │
                                                                                   ├──────────┼──────────┼─────────────────────────────┼────────────────┼─────────┼────────────────┤
                                                                                    Б│@@@@@@@@@@│          │@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│                │         │                │
                                                                                   └──────────┴──────────┴─────────────────────────────┴────────────────┴─────────┴────────────────┘ Б
 Комиссия, назначенная приказом от "  "__________20   г. №______ осмотрела принятые за _______________ 20   г., находившиеся в
 эксплуатации малоценные и быстроизнашивающиеся предметы и признала их пришедшими в негодность и подлежащими сдаче в утиль (лом)
.{SpSpis CheckEnter
.[h
┌────────────────────────────────────────────┬───────────────────┬────────┬──────────┬──────────────┬───────────────────────────┬──────┬──────────────────────────┬────────────────┐
│                    Предмет                 │ Единица измерения │        │          │              │      Сумма, руб. коп.     │      │      Причина списания    │                │
├───────────────────┬────────────┬───────────┼─────┬─────────────┤        │   Дата   │              ├─────────────┬─────────────┤      ├────────────────┬─────────┤                │
│   Наименование    │Номенклатур-│ Инвентар- │ Код │ Наименование│  Коли- │ поступле-│    Цена,     │  Без учета  │   Аморти-   │ Срок │                │         │ Номер паспорта │
│                   │ ный  номер │ ный номер │     │             │ чество │   ния    │   руб.коп.   │     НДС     │   зации     │службы│  Наименование  │   Код   │                │
├───────────────────┼────────────┼───────────┼─────┼─────────────┼────────┼──────────┼──────────────┼─────────────┼─────────────┼──────┼────────────────┼─────────┼────────────────┤
│         1         │     2      │     3     │  4  │      5      │   6    │    7     │      8       │      9      │     10      │  11  │       12       │   13    │       14       │
├───────────────────┼────────────┼───────────┼─────┼─────────────┼────────┼──────────┼──────────────┼─────────────┼─────────────┼──────┼────────────────┼─────────┼────────────────┤
.begin
  PageNumber := PageNumber + 1;
  PageSeparator := true;
end.
.]h
.begin
 TotCnt := TotCnt + Kol
 TotSum := TotSum + if ( wGetTune( 'Fin.MBP.OstStoim') = 0, SumPr, SumPr - SumIsn)
 IznSum := IznSum + SumIsn

 if (GroupWrap(MBPName, 1 , 19)<> '' or GroupWrap(MBPNum, 1 , 12)<>'')
   StrCount := StrCount + 1
 if (GroupWrap(MBPName, 2 , 19)<> '' or GroupWrap(MBPNum, 2 , 12)<>'')
   StrCount := StrCount + 1
 if (GroupWrap(MBPName, 3 , 19)<> '' or GroupWrap(MBPNum, 3 , 12)<>'')
   StrCount := StrCount + 1;
 if (GroupWrap(MBPName, 4 , 19)<> '')
   StrCount := StrCount + 1;
 if (GroupWrap(MBPName, 5 , 19)<> '')
   StrCount := StrCount + 1;
 if (GroupWrap(MBPName, 6 , 19)<> '')
   StrCount := StrCount + 1;
 if (GroupWrap(MBPName, 7 , 19)<> '')
   StrCount := StrCount + 1;
 if (GroupWrap(MBPName, 8 , 19)<> '')
   StrCount := StrCount + 1;
end.
.{?INTERNAL; ((StrCount > 7) and (PageNumber = 1))
└───────────────────┴────────────┴───────────┴─────┴─────────────┴────────┴──────────┴──────────────┴─────────────┴─────────────┴──────┴────────────────┴─────────┴────────────────┘
.fields
  'true' : 's'
.endFields
^│                   │            │           │     │             │        │          │              │             │             │      │                │         │                │
.}
.fields
 MBPName  MBPNum  InvN
 MBPEd  Kol    if ( LongInt( explDate) > 0, DateToStr( explDate, 'DD/MM/YYYY'), '')
 Price  if ( wGetTune( 'Fin.MBP.OstStoim') = 0, SumPr, SumPr - SumIsn)
 if(Round(SumIsn, 2) > 0, DoubleToStr(SumIsn, '\2p[|-]3666''666''666''666''666.88'), '-')
 Srok  PrName  PrKod  Pass
.endfields
│@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@│@@@@@@@@@@@│     │@@@@@@@@@@@@@│&&&&&.&&│&&&&&&&&&&│&'&&&&&&&&&.&&│&'#&&&&&&&.&&│&'#&&&&&&&.&&│@~@@@@│@@@@@@@@@@@@@@@@│@@@@@@@@@│@@@@@@@@@@@@@@@@│
.}
.fields
  TotCnt  TotSum
  if(Round(IznSum, 2) > 0, DoubleToStr(IznSum, '\2p[|-]3666''666''666''666''666.88'),  '-')
  DoubleToStr( TotCnt, '\2p\m4')+
    if ( Pos( 'ноль', DoubleToStr( TotCnt, '\2p5')) <> 0, '',
      DoubleToStr( TotCnt, 'целых \2p5'))
.endfields
└───────────────────┴────────────┴───────────┴─────┴─────────────┼────────┼──────────┼──────────────┼─────────────┼─────────────┼──────┴────────────────┴─────────┴────────────────┘
                                                           БИтого  │&#&&&.&&│    X     │      X       │&'#&&&&&&&.&&│&'#&&&&&&&.&&│
                                                                 └────────┴──────────┴──────────────┴─────────────┴─────────────┘ Б
 Общее количество предметов   Е@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
                                                                               прописью
.fields
  'true' : 's'
.endfields
^
.{?INTERNAL; (PageNumber = 1)
                                                                                                                                                    Оборотная сторона формы № МБ-8
.begin
  PageSeparator := false;
end.
.}
 Номера и даты актов выбытия_______________________________________________________________________________________________________________________________________________________

 Перечисленные в настоящем акте в присутствии комиссии превращены в утиль (лом), который подлежит оприходованию:
┌──────────┬──────────────┬────────────────────────┬─────────────────────────────────────┬───────────────────┬────────────┬───────────────────┬───────────────────┬────────────────┐
│          │              │                        │              Утиль (лом)            │ Единица измерения │            │                   │                   │   Порядковый   │
│ Код вида │     Вид      │      Структурное       ├──────────────────────┬──────────────┼─────────────┬─────┤ Количество │       Цена,       │      Сумма,       │  номер записи  │
│ операции │ деятельности │     подразделение      │     Наименование     │ Номенклатур- │ Наименование│ Код │            │     руб. коп.     │     руб. коп.     │  по складской  │
│          │              │                        │                      │  ный номер   │             │     │            │                   │                   │   картотеке    │
├──────────┼──────────────┼────────────────────────┼──────────────────────┼──────────────┼─────────────┼─────┼────────────┼───────────────────┼───────────────────┼────────────────┤
│    1     │      2       │           3            │           4          │       5      │      6      │  7  │      8     │         9         │        10         │       11       │
├──────────┼──────────────┼────────────────────────┼──────────────────────┼──────────────┼─────────────┼─────┼────────────┼───────────────────┼───────────────────┼────────────────┤
├──────────┼──────────────┼────────────────────────┼──────────────────────┼──────────────┼─────────────┼─────┼────────────┼───────────────────┼───────────────────┼────────────────┤
├──────────┼──────────────┼────────────────────────┼──────────────────────┼──────────────┼─────────────┼─────┼────────────┼───────────────────┼───────────────────┼────────────────┤
├──────────┼──────────────┼────────────────────────┼──────────────────────┼──────────────┼─────────────┼─────┼────────────┼───────────────────┼───────────────────┼────────────────┤
├──────────┼──────────────┼────────────────────────┼──────────────────────┼──────────────┼─────────────┼─────┼────────────┼───────────────────┼───────────────────┼────────────────┤
├──────────┼──────────────┼────────────────────────┼──────────────────────┼──────────────┼─────────────┼─────┼────────────┼───────────────────┼───────────────────┼────────────────┤
├──────────┼──────────────┼────────────────────────┼──────────────────────┼──────────────┼─────────────┼─────┼────────────┼───────────────────┼───────────────────┼────────────────┤
└──────────┴──────────────┴────────────────────────┴──────────────────────┴──────────────┴─────────────┴─────┼────────────┼───────────────────┼───────────────────┼────────────────┘
 Утиль, не подлежащий учету, уничтожен.                                                                 БИтого │            │                   │                   │
                                                                                                             └────────────┴───────────────────┴───────────────────┘
.fields
 Председатель_комиссии_Должность
 Председатель_комиссии_ФИО
.endfields
   Председатель комиссии Б:  Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д   Б________________________ Б   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                     Бдолжность                      подпись                    расшифровка подписи Б
 Б.{While (Номер_члена_комиссии < Количество_членов_комиссии)
.begin
  Номер_члена_комиссии := Номер_члена_комиссии + 1;
end.
.fields
  if (Номер_члена_комиссии = word(1), 'Члены комиссии:', '')
  Массив_Член_комиссии_Должность [Номер_члена_комиссии]
  Массив_Член_комиссии_ФИО       [Номер_члена_комиссии]
.endfields С
 Р    @@@@@@@@@@@@@@@ Р
 Р                          Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  Б ________________________  Б  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                     Бдолжность                      подпись                    расшифровка подписи Б
 Б.}
.{?INTERNAL;(Количество_членов_комиссии = 0) С
 Р     Члены комиссии:      Б_____________________________  ________________________  _________________________________________ Б
                                    Б должность                      подпись                    расшифровка подписи Б
                          Б_____________________________  ________________________  _________________________________________ Б
                                    Б должность                      подпись                    расшифровка подписи Б
                          Б_____________________________  ________________________  _________________________________________ Б
                                    Б должность                      подпись                    расшифровка подписи Б
 Б.} С
 С  Утиль (лом) по накладной №  ____________________ сдан
    "  " ____________ 20   г.
 Р А

.begin
  PageNumber := 0;
  PageSeparator := false;
end.
.}
.endform

!======================================================================================================================

.linkform 'Spis_MBP_06' prototype is 'Spis_MBP'
.Group 'Акт на списание МБП'
.Group 'Акт на списание МБП (Россия)'
.NameInList 'Акт выбытия (форма № МБ-4)'
.P 40
.PAPER PA4
.ORIENT PORTRAIT
.LL 80
.var
  TotSum : Double
  IznSum : Double
  KolStr,
  KolStr2  : integer
  KolPage  : integer
  KolPage2 : integer
  KolLine,
  i        : integer
  arKolStr : array[1..2] of integer;
  arDate   : array[1..2] of String;
  arFIO    : array[1..2] of String;
  arTabN   : array[1..2] of String;
  arPerc   : array[1..2] of Double;
  arOstSt  : array[1..2] of Double;
  Header, NomAct, Org, OKPO, Podraz, DatAct: string
.endvar
#CommissionLinkVar
.{
#CommissionLinkInit(SpisMBPProt)
.begin
  KolStr   := 0
  KolStr2  := 0
  KolPage  := 0
  KolPage2 := 0
  Header := CommonFormHeader
  NomAct := Nom
  Org    :=  MyOrg
  OKPO   := ОКПО
  Podraz := Podr
  DatAct := DateToStr( Dat, 'DD/MM/YYYY')
end.
.{SpSpis CheckEnter
.[h
.begin
 TotSum := 0
 IznSum := 0
 KolPage := KolPage + 1
 KolStr2 := KolStr2 + KolStr
 KolStr := 0
end.
.fields
  Header
  NomAct
  Org
  OKPO
  Podraz
  DatAct
  Podraz
.endfields
  Р^
                                                                                      Типовая межотраслевая форма № MБ-4
                                                                                      Утверждена постановлением Госкомстата России
                                                                                      от 30.10.97 № 71а

                                       БАКТ № Б  Е@@@@@@@@@@ Е                                                              ┌─────────────┐
                    Бвыбытия малоценных и быстроизнашивающихся предметов Б                                              │     Коды    │
                                                                                                                    ├─────────────┤
                                                                                                      Форма по ОКУД │   0320002   │
                                                                                                                    ├─────────────┤
 Организация   Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е          по ОКПО │@~@@@@@@@@@@@│
 Структурное подразделение   Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е                  └─────────────┘
                      ┌──────────┬──────────┬────────────────────────────┬──────────────┬──────────────────────────┬──────────────┐
                      │   Дата   │   Код    │       Cтруктурное          │     Вид      │  Корреспондирующий счет  │ Учетная еди- │
                      │  состав- │   вида   │      подразделение         │ деятельности ├─────────┬────────────────┤ ница выпуска │
                      │   ления  │ операции │                            │              │  счет,  │  код аналити-  │  продукции   │
                      │          │          │                            │              │ субсчет │ ческого учета  │(работ, услуг)│
                      ├──────────┼──────────┼────────────────────────────┼──────────────┼─────────┼────────────────┼──────────────┤
                      │ Б@@@@@@@@@@ Б│          │ Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б│              │         │                │              │
                      └──────────┴──────────┴────────────────────────────┴──────────────┴─────────┴────────────────┴──────────────┘
┌──────────────────────────────────┬─────────────────┬──────┬──────────────┬───────────────────────────┬──────────────────────────┐
│            Предмет               │Единица измерения│      │              │      Сумма, руб. коп.     │      Причина выбытия     │
├─────────────────────┬────────────┼───┬─────────────┤ Коли-│    Цена,     ├─────────────┬─────────────┼─────────┬────────────────┤
│    Наименование,    │Номенклатур-│Код│ Наименование│чество│   руб.коп.   │  Без учета  │   Аморти-   │         │                │
│  сорт,размер,марка  │ ный  номер │   │             │      │              │     НДС     │   зации     │   Код   │  Наименование  │
├─────────────────────┼────────────┼───┼─────────────┼──────┼──────────────┼─────────────┼─────────────┼─────────┼────────────────┤
│         1           │     2      │ 3 │      4      │   5  │      6       │      7      │      8      │    9    │       10       │
├─────────────────────┼────────────┼───┼─────────────┼──────┼──────────────┼─────────────┼─────────────┼─────────┼────────────────┤
.]h
.begin
 i := 0;
end.
.{While ((GroupWrap(MBPName, i + 1, 21) <> '') or (GroupWrap(MBPNum, i + 1, 12) <> '') or (GroupWrap(PrName, i + 1, 17) <> ''))
.begin
 i := i + 1;
end.
.}
.begin
 KolLine := KolLine + i;

 if (4 - KolLine < 0)
   i := 4 - KolLine + i;
 else
    i := 0;
end.
.{While ((i > 0) and (KolStr > 0))
│                     │            │   │             │      │              │             │             │         │                │
.begin
  i := i - 1;
end.
.}
.begin
 TotSum := TotSum + if ( wGetTune( 'Fin.MBP.OstStoim') = 0, SumPr, SumPr - SumIsn)
 IznSum := IznSum + SumIsn
 KolStr := KolStr + 1
 arDate [KolStr2 + KolStr] := if ( LongInt( explDate) > 0, DateToStr( explDate, 'DD/MM/YYYY'), '')
 arFIO  [KolStr2 + KolStr] := PersFIO
 arTabN [KolStr2 + KolStr] := TabNum
 arPerc [KolStr2 + KolStr] := tPerc
 arOstSt[KolStr2 + KolStr] := OstStoim
end.
.fields
 MBPName  MBPNum  MBPEd  Kol  Price
 if (wGetTune('Fin.MBP.OstStoim') = 0, SumPr, SumPr - SumIsn)
 SumIsn  PrKod  PrName
.endfields
│@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@│   │@@@@@@@@@@@@@│&&&.&&│&'&&&&&&&&&.&&│&'#&&&&&&&.&&│&'#&&&&&&&.&&│@@@@@@@@@│@@@@@@@@@@@@@@@@│
.[f
.begin
  arKolStr[KolPage] := KolStr
  KolLine := KolLine - 4;
end.
.fields
  TotSum  IznSum
.endfields
└─────────────────────┴────────────┴───┴─────────────┴──────┴──────────────┼─────────────┼─────────────┼─────────┴────────────────┘
                                                                     БИтого Б  │ Б&'#&&&&&&&.&& Б│ Б&'#&&&&&&&.&& Б│
 Причина выбытия __________________________________________________        └─────────────┴─────────────┘
                 __________________________________________________________________________________________________________________
                 __________________________________________________________________________________________________________________

  БМастер (исполнитель работ) Б   _________________     _______________________
                                   подпись            расшифровка подписи

.]f
.}
.begin
  KolStr := 0
  KolStr2 := 0
end.
.{While (KolPage2 < KolPage)
.begin
  KolStr2 := KolStr2 + KolStr
  KolStr := 0
  KolPage2 := KolPage2 + 1
end.

.{?INTERNAL;KolPage2 > 1
 
.}
                                                                                                    Оборотная сторона формы № МБ-4
 ┌───────────────────────┬─────────┬──────────┬──────────────┬───────────────────────────────────────────────────────┬─────────────┐
 │                       │         │          │              │               Расчет удержания с виновных             │             │
 │                       │         │          │              │                 Вид и способ удержания                │             │
 │   Фамилия, И., О.     │Табельный│   Дата   │   Подпись    ├───────┬────────────┬──────────────────────┬───────────┤   Подпись   │
 │                       │  номер  │  выдачи  │   сдавшего   │       │ стоимость  │  код вида удержания  │   сумма   │  виновного  │
 │                       │         │          │  малоценные  │процент│ за вычетом ├──────────────────────┤  ежеме-   │  в поломке  │
 │                       │         │          │  и быстроиз- │аморти-│амортизации,├─────────┬────────────┤  сячного  │   (утере)   │
 │                       │         │          │ нашивающиеся │ зации │ руб. коп.  │ размер  │   cумма    │  взноса,  │             │
 │                       │         │          │   предметы   │       │            │(процент)│ удержания, │  руб.коп  │             │
 │                       │         │          │              │       │            │удержания│  руб. коп. │           │             │
 ├───────────────────────┼─────────┼──────────┼──────────────┼───────┼────────────┼─────────┼────────────┼───────────┼─────────────┤
 │           1           │    2    │    3     │       4      │   5   │     6      │    7    │      8     │     9     │     10      │
 ├───────────────────────┼─────────┼──────────┼──────────────┼───────┼────────────┼─────────┼────────────┼───────────┼─────────────┤ Б
.{While (KolStr < arKolStr[KolPage2])
.begin
  KolStr := KolStr + 1
end.
.fields
  arFIO  [KolStr2 + KolStr]
  arTabN [KolStr2 + KolStr]
  arDate [KolStr2 + KolStr]
  arPerc [KolStr2 + KolStr]
  arOstSt[KolStr2 + KolStr]
.endfields
 Б │@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@│@~@@@@@@@@│              │&'#&.&&│&'#&&&&&&.&&│         │            │           │             │
.}
 └───────────────────────┴─────────┴──────────┴──────────────┴───────┴────────────┴─────────┴────────────┴───────────┴─────────────┘ Б
 Б Руководитель подразделения _________________  _____________  ___________________
                                должность         подпись     расшифровка подписи
 Кладовщик  _____________   ___________________
               подпись      расшифровка подписи
 Бухгалтер  _____________   ___________________
               подпись      расшифровка подписи

    "  " ___________20   г. Б
.}

.}
.endform

//-------------------------------------------------------------------------

.linkForm 'MBP_Nedost' prototype is 'Spis_MBP'
.nameInList 'Акт инвентаризации о недостаче МБП'
.Group 'Недостача'
.var
  totSum : Double
.endVar
#CommissionLinkVar
.{
#CommissionLinkInit(SpisMBPProt)
.Fields
  CommonFormHeader
  Nom  DateToStr( Dat, 'DD/MM/YYYY')  Podr  MOL
  MBPName  MBPNum  MBPEd  Kol  Price
.endFields
 И ^

                          АКТ ИНВЕНТАРИЗАЦИИ О НЕДОСТАЧЕ МБП
                            № ^ от ^

Подразделение: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
МОЛ          : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.begin
  totSum := 0
end.
──────────────────────────────┬────────────┬───────────────┬──────────┬───────────────
           Название           │ Ном.номер  │Единица измерен│Количество│      Цена
──────────────────────────────┴────────────┴───────────────┴──────────┴───────────────
.{SpSpis CheckEnter
.begin
  totSum := totSum + Kol * Price
end.
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@ @@@@@@@@@@@@@@@ &&&&&&&.&& &'&&&&&&&&&&.&&
.}
──────────────────────────────────────────────────────────────────────────────────────

.Fields
  totSum
  DoubleToStr( totSum, '\2p\m4')+
    if ( Pos( 'ноль', DoubleToStr( totSum, '\2p5')) <> 0, '',
      DoubleToStr( totSum, 'целых \2p5'))
.endFields
Сумма по акту: &'&&&&&&&&&&.&& руб.
     Прописью: ^
 И
.}
.endForm

!========================================================================================================

.linkform 'Spis_MBP_08' prototype is 'Spis_MBP'
.NameInList 'Акт на списание инструмента (Форма № М-36п)'
.Group 'Акт на списание МБП (Беларусь)'
.f "MBPM_36p.OUT"
.defo LandScape
.p 50
.var
  Cnt : LongInt
  TotCnt : Double
  TotSum : Double
.endvar
#CommissionLinkVar
.{
#CommissionLinkInit(SpisMBPProt)
.fields
 CommonFormHeader
 MyOrg
 ОКПО
 Podr
 Nom
 DateToStr(Dat,'DD/MM/YYYY')
.endfields
.begin
  Cnt := 0;
  TotSum := 0;
  TotCnt := 0;
end.
 Р ^
                                                                                                                                                                          Форма № М-36п
                                                                                                                                                                          ┌────────────┐
                                                                                                                                                                          │    Код     │
                                                                                                                                                                          ├────────────┤
                                                                                                                                                            Форма по ОКУД │            │
                                                                                                                                                                          ├────────────┤
   Организация  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@   по ОКЮЛП │@~@@@@@@@@@@│
                                                                                                                                                                          ├────────────┤
   Структурное подразделение  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@            │            │
                                                                                                                                                                          └────────────┘

                                       АКТ                                                             УТВЕРЖДАЮ
                             НА СПИСАНИЕ ИНСТРУМЕНТА                                                   _________________________  _______________  _____________________________________
                      (ПРИСПОСОБЛЕНИЙ) И ОБМЕН ИХ НА ГОДНЫЕ                                                   должность               подпись                фамилия, инициалы
                                                                                                       "____" __________________ 20____ г.
                                                                                                                                                                               Таблица 1
  ┌──────────────┬──────────────┬─────────────────────────────────────────────────────┬─────────────────────────────────────────────────────────────────────────────────────────────────┐
  │              │              │         Информация об утверждении комиссией         │                                               Коды                                              │
  │     Номер    │     Дата     ├────────────────────────┬────────────────────────────┼─────────────────────────────────┬───────────────────────────────┬───────────────────────────────┤
  │   документа  │  составления │      номер приказа     │           дата             │            отправителя          │           получателя          │          вида операции        │
  ├──────────────┼──────────────┼────────────────────────┼────────────────────────────┼─────────────────────────────────┼───────────────────────────────┼───────────────────────────────┤
  │       1      │       2      │            3           │             4              │                 5               │                6              │                7              │
  ├──────────────┼──────────────┼────────────────────────┼────────────────────────────┼─────────────────────────────────┼───────────────────────────────┼───────────────────────────────┤
  │@@@@@@@@@@@@@@│@~@@@@@@@@@@@@│                        │                            │                                 │                               │                               │
  └──────────────┴──────────────┴────────────────────────┴────────────────────────────┴─────────────────────────────────┴───────────────────────────────┴───────────────────────────────┘
                                                                                                                                                                               Таблица 2
.{SpSpis CheckEnter
.[h1
  ┌────┬──────┬─────────┬─────────────────────────┬──────┬─────────┬───────────────┬─────────────────────┬─────────────────────┬──────────────────────┬─────────────────────────────────┐
  │    │      │         │                         │      │         │               │ Пришло в негодность │   Выдано в порядке  │ Списано с цеха ввиду │                                 │
  │ №  │ Код  │         │       Наименование      │Марка,│ Единица │      Цена,    │ и подлежит списанию │   обмена и списано  │отсутствия инструмента│        Лом списанного           │
  │п/п │затрат│Номенкла-│        инструмента      │размер│измерения│      руб.     │                     │                     │       на складе      │          инструмента            │
  │    │      │ турный  │                         │      │         │               ├──────┬──────────────┼──────┬──────────────┼──────┬───────────────┼───────┬───────────┬─────────────┤
  │    │      │ номер   │                         │      │         │               │коли- │     сумма,   │коли- │     сумма,   │коли- │     сумма,    │вес, кг│   цена,   │    сумма,   │
  │    │      │         │                         │      │         │               │чество│      руб.    │чество│      руб.    │чество│      руб.     │       │    руб.   │     руб.    │
  ├────┼──────┼─────────┼─────────────────────────┼──────┼─────────┼───────────────┼──────┼──────────────┼──────┼──────────────┼──────┼───────────────┼───────┼───────────┼─────────────┤
  │ 1  │  2   │    3    │             4           │  5   │    6    │       7       │   8  │       9      │  10  │      11      │  12  │       13      │   14  │    15     │      16     │
  ├────┼──────┼─────────┼─────────────────────────┼──────┼─────────┼───────────────┼──────┼──────────────┼──────┼──────────────┼──────┼───────────────┼───────┼───────────┼─────────────┤
.]h
.[h2

                                                                                                                                                         Оборотная сторона формы № М-36п
  ┌────┬──────┬─────────┬─────────────────────────┬──────┬─────────┬───────────────┬──────┬──────────────┬──────┬──────────────┬──────┬───────────────┬───────┬───────────┬─────────────┐
  │ 1  │  2   │    3    │             4           │  5   │    6    │       7       │   8  │       9      │  10  │      11      │  12  │       13      │   14  │    15     │      16     │
  ├────┼──────┼─────────┼─────────────────────────┼──────┼─────────┼───────────────┼──────┼──────────────┼──────┼──────────────┼──────┼───────────────┼───────┼───────────┼─────────────┤
.]h
.begin
 Cnt := Cnt + 1
 TotCnt := TotCnt + Kol
 TotSum := TotSum + if ( wGetTune( 'Fin.MBP.OstStoim') = 0, SumPr, SumPr - SumIsn)
end.
.fields
 Cnt
 MBPNum
 MBPName
 MBPEd
 Price
 Kol
 if ( wGetTune( 'Fin.MBP.OstStoim') = 0, SumPr, SumPr - SumIsn)
.endfields
  │&&&&│      │@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@@@@@@│      │@@@@@@@@@│&#&&&&&&&&&&.&&│&#&&&&│&#&&&&&&&&&.&&│      │              │      │               │       │           │             │
.[f
  └────┴──────┴─────────┴─────────────────────────┴──────┴─────────┴───────────────┴──────┴──────────────┴──────┴──────────────┴──────┴───────────────┴───────┴───────────┴─────────────┘

.]f
.}
.fields
 TotCnt TotSum
 И  ИПредседатель_комиссии_Должность
 Председатель_комиссии_ФИО
.endfields

                                                                                                                                                         Оборотная сторона формы № М-36п
  ┌────┬──────┬─────────┬─────────────────────────┬──────┬─────────┬───────────────┬──────┬──────────────┬──────┬──────────────┬──────┬───────────────┬───────┬───────────┬─────────────┐
  │ 1  │  2   │    3    │             4           │  5   │    6    │       7       │   8  │       9      │  10  │      11      │  12  │       13      │   14  │    15     │      16     │
  ├────┼──────┼─────────┼─────────────────────────┼──────┼─────────┼───────────────┼──────┼──────────────┼──────┼──────────────┼──────┼───────────────┼───────┼───────────┼─────────────┤
  │    │      │         │                         │      │         │               │      │              │      │              │      │               │       │           │             │
  ├────┼──────┼─────────┼─────────────────────────┼──────┼─────────┼───────────────┼──────┼──────────────┼──────┼──────────────┼──────┼───────────────┼───────┼───────────┼─────────────┤
  │    │      │         │                         │      │         │               │      │              │      │              │      │               │       │           │             │
  ├────┼──────┼─────────┼─────────────────────────┼──────┼─────────┼───────────────┼──────┼──────────────┼──────┼──────────────┼──────┼───────────────┼───────┼───────────┼─────────────┤
  │    │      │         │                         │      │         │               │      │              │      │              │      │               │       │           │             │
  ├────┼──────┼─────────┼─────────────────────────┼──────┼─────────┼───────────────┼──────┼──────────────┼──────┼──────────────┼──────┼───────────────┼───────┼───────────┼─────────────┤
  │    │      │         │                         │      │         │               │      │              │      │              │      │               │       │           │             │
  ├────┼──────┼─────────┼─────────────────────────┼──────┼─────────┼───────────────┼──────┼──────────────┼──────┼──────────────┼──────┼───────────────┼───────┼───────────┼─────────────┤
  │    │      │         │                         │      │         │               │      │              │      │              │      │               │       │           │             │
  ├────┼──────┼─────────┼─────────────────────────┼──────┼─────────┼───────────────┼──────┼──────────────┼──────┼──────────────┼──────┼───────────────┼───────┼───────────┼─────────────┤
  │    │      │         │                         │      │         │               │      │              │      │              │      │               │       │           │             │
  ├────┼──────┼─────────┼─────────────────────────┼──────┼─────────┼───────────────┼──────┼──────────────┼──────┼──────────────┼──────┼───────────────┼───────┼───────────┼─────────────┤
  │    │      │         │                         │      │         │               │      │              │      │              │      │               │       │           │             │
  └────┴──────┴─────────┴─────────────────────────┴──────┴─────────┴───────────────┼──────┼──────────────┼──────┼──────────────┼──────┼───────────────┼───────┼───────────┼─────────────┤
                                       Итого . . . . . . . . . . . . . . . . . . . │&#&&&&│&#&&&&&&&&&.&&│      │              │      │               │       │           │             │
                                                                                   └──────┴──────────────┴──────┴──────────────┴──────┴───────────────┴───────┴───────────┴─────────────┘
 Б
   Председатель комиссии Б:  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  ________________________   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
                                    должность                      подпись                         Бфамилия, инициалы Б
 Б.{While (Номер_члена_комиссии < Количество_членов_комиссии)
.begin
  Номер_члена_комиссии := Номер_члена_комиссии + 1;
end.
.fields
  if (Номер_члена_комиссии = word(1), 'Члены комиссии:', '')
  Массив_Член_комиссии_Должность [Номер_члена_комиссии]
  Массив_Член_комиссии_ФИО       [Номер_члена_комиссии]
.endfields С
 Р    @@@@@@@@@@@@@@@ Р
 Р                          Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  Б ________________________  Б  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                    должность                      подпись                        Бфамилия, инициалы Б
 Б.}
.{?INTERNAL;(Количество_членов_комиссии = 0) С
 Р     Члены комиссии:      Б_____________________________  ________________________  _________________________________________ Б
                                    должность                      подпись                        Бфамилия, инициалы Б
                          Б_____________________________  ________________________  _________________________________________ Б
                                    должность                      подпись                         Бфамилия, инициалы Б
                          Б_____________________________  ________________________  _________________________________________ Б
                                    должность                      подпись                         Бфамилия, инициалы Б
 Б.}
.fields
 Mol Mol
.endfields
  Негодный инструмент сдал    ___________________  ___________________   Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                  должность              подпись                       фамилия, инициалы
                    принял    ___________________  ___________________  _________________________________________________
                                  должность              подпись                       фамилия, инициалы
            Обмен разрешил    ___________________  ___________________  _________________________________________________
                                  должность              подпись                       фамилия, инициалы


  Выданный взамен пришедшего в негодность инструмент получил   ___________________  ___________________   Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                                                    должность              подпись                       фамилия, инициалы

  Приложение: накладная на сдачу металлолома № _______________________ от  "____" __________________ 20____ г.

  Проверил бухгалтер ___________________  _________________________________________________
                           подпись                       фамилия, инициалы

.}
.endForm

!======================================================================================================== Р

.linkform 'Spis_MBP_09' prototype is 'Spis_MBP'
.NameInList 'Ведомость на изъятие инструмента (Форма № М-30п)'
.Group 'Акт на списание МБП (Беларусь)'
.f "MBPM_30p.OUT"
.p 80
.fields
 CommonFormHeader
 MyOrg
 ОКПО
 Podr
 Nom
 DateToStr( Dat, 'DD/MM/YYYY')
.endfields
.var
  PrintObr : Boolean;
.endvar
#CommissionLinkVar
.{
#CommissionLinkInit(SpisMBPProt)
.begin
  PrintObr := True;
end.
 Р ^
                                                                                                                      Форма № М-30п
                                                                                                                      ┌────────────┐
                                                                                                                      │    Коды    │
                                                                                                                      ├────────────┤
                                                                                                        Форма по ОКУД │            │
                                                                                                                      ├────────────┤
   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д   по ОКЮЛП │@~@@@@@@@@@@│
                                           наименование организации                                                   ├────────────┤
   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д            │            │
                                   наименование структурного подразделения                                            └────────────┘

                                                            БВЕДОМОСТЬ
                                    НА ИЗЪЯТИЕ ПОСТОЯННОГО ЗАПАСА ИНСТРУМЕНТА (ПРИСПОСОБЛЕНИЙ) Б
                                                                                                                    Таблица 1
       ┌────────────┬─────────────┬────────────────────────────────────────────────┬─────────────────────────────────────────┐
       │            │             │                        Код                     │           Корреспондирующий счет        │
       │   Номер    │    Дата     ├────────────────┬───────────────┬───────────────┼────────────────────┬────────────────────┤
       │ документа  │ составления │ вида операции  │  отправителя  │   получателя  │    счет, субсчет   │   код аналитичес-  │
       │            │             │                │               │               │                    │      кого учета    │
       ├────────────┼─────────────┼────────────────┼───────────────┼───────────────┼────────────────────┼────────────────────┤
       │     1      │      2      │        3       │       4       │       5       │          6         │          7         │
       ├────────────┼─────────────┼────────────────┼───────────────┼───────────────┼────────────────────┼────────────────────┤
       │@@@@@@@@@@@@│@~@@@@@@@@@@@│                │               │               │                    │                    │
       └────────────┴─────────────┴────────────────┴───────────────┴───────────────┴────────────────────┴────────────────────┘
                                                                                                                           Таблица 2
.{SpSpis CheckEnter
.[h1
 ┌─────────────────────────────────────────────────────────────┬─────────────────────────┬─────────────────────────────────────────┐
 │                     Инструмент (приспособление)             │    Единица измерения    │                 Изъятие                 │
 │                                                             │                         │            поcтоянного запаса           │
 ├──────────────────────────────────────────────┬──────────────┼────────┬────────────────┼──────────┬───────────────┬──────────────┤
 │                 наименование,                │номенклатурный│  код   │  наименование  │количество│     цена,     │    сумма,    │
 │                 размер, марка                │    номер     │        │                │          │      руб.     │     руб.     │
 ├──────────────────────────────────────────────┼──────────────┼────────┼────────────────┼──────────┼───────────────┼──────────────┤
 │                        1                     │       2      │   3    │       4        │    5     │       6       │      7       │
 ├──────────────────────────────────────────────┼──────────────┼────────┼────────────────┼──────────┼───────────────┼──────────────┤
.]h
.[h2
                                                                                                    Оборотная сторона формы № М-30п
 ┌──────────────────────────────────────────────┬──────────────┬────────┬────────────────┬──────────┬───────────────┬──────────────┐
 │                        1                     │       2      │   3    │       4        │    5     │       6       │      7       │
 ├──────────────────────────────────────────────┼──────────────┼────────┼────────────────┼──────────┼───────────────┼──────────────┤
.]h
.fields
  MBPName
  MBPNum
  MBPEd
  Kol
  Price
  if ( wGetTune( 'Fin.MBP.OstStoim') = 0, SumPr, SumPr - SumIsn)
.endfields
 │@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@│        │@@@@@@@@@@@@@@@@│&#&&&&&&&&│&#&&&&&&&&&&.&&│&#&&&&&&&&&.&&│
.[f1
.begin
  PrintObr := True;
end.
 └──────────────────────────────────────────────┴──────────────┴────────┴────────────────┴──────────┴───────────────┴──────────────┘

.]f
.[f2
.fields
  Mol
.endfields
.begin
  PrintObr := False;
end.
 └──────────────────────────────────────────────┴──────────────┴────────┴────────────────┴──────────┴───────────────┴──────────────┘

 Начальник инструментального
 (планового) отдела        ___________________  _________________________________________________
                                  подпись                        фамилия, инициалы
 Начальник цеха            ___________________  _________________________________________________
                                  подпись                        фамилия, инициалы
 Бухгалтер                 ___________________  _________________________________________________
                                  подпись                        фамилия, инициалы
 Инструменты отпустил      ___________________   Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                  подпись                        фамилия, инициалы
 Инструменты принял
 на ответственное хранение ___________________  _________________________________________________
                                  подпись                        фамилия, инициалы
.]f
.}
.{?INTERNAL;PrintObr
.fields
  Mol
.endfields
                                                                                                    Оборотная сторона формы № М-30п
 ┌──────────────────────────────────────────────┬──────────────┬────────┬────────────────┬──────────┬───────────────┬──────────────┐
 │                        1                     │       2      │   3    │       4        │    5     │       6       │      7       │
 ├──────────────────────────────────────────────┼──────────────┼────────┼────────────────┼──────────┼───────────────┼──────────────┤
 │                                              │              │        │                │          │               │              │
 ├──────────────────────────────────────────────┼──────────────┼────────┼────────────────┼──────────┼───────────────┼──────────────┤
 │                                              │              │        │                │          │               │              │
 ├──────────────────────────────────────────────┼──────────────┼────────┼────────────────┼──────────┼───────────────┼──────────────┤
 │                                              │              │        │                │          │               │              │
 ├──────────────────────────────────────────────┼──────────────┼────────┼────────────────┼──────────┼───────────────┼──────────────┤
 │                                              │              │        │                │          │               │              │
 ├──────────────────────────────────────────────┼──────────────┼────────┼────────────────┼──────────┼───────────────┼──────────────┤
 │                                              │              │        │                │          │               │              │
 ├──────────────────────────────────────────────┼──────────────┼────────┼────────────────┼──────────┼───────────────┼──────────────┤
 │                                              │              │        │                │          │               │              │
 ├──────────────────────────────────────────────┼──────────────┼────────┼────────────────┼──────────┼───────────────┼──────────────┤
 │                                              │              │        │                │          │               │              │
 └──────────────────────────────────────────────┴──────────────┴────────┴────────────────┴──────────┴───────────────┴──────────────┘

 Начальник инструментального
 (планового) отдела        ___________________  _________________________________________________
                                  подпись                        фамилия, инициалы
 Начальник цеха            ___________________  _________________________________________________
                                  подпись                        фамилия, инициалы
 Бухгалтер                 ___________________  _________________________________________________
                                  подпись                        фамилия, инициалы
 Инструменты отпустил      ___________________   Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                  подпись                        фамилия, инициалы
 Инструменты принял
 на ответственное хранение ___________________  _________________________________________________
                                  подпись                        фамилия, инициалы
.} Р

.}
.endform

!======================================================================================================================
