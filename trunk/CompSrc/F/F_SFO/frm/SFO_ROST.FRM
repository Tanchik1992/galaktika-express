//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 7.12 - Спецодежда
// Печать ростовочной ведомости
//------------------------------------------------------------------------------

#doc
Печать Ростовочной ведомости.<br>
#end
.set name = 'SFO_RostVed'
.hide
.fields
dFrom : Date  dTo : Date
isVacancyEnabled : String
fltName : String
Podr
NomNum SFOName              NormPer  UsePer  OutPer  NeedPer  OnStock  Sub
                Size Height NormPerS UsePerS OutPerS NeedPerS OnStockS SubS
.endfields
Начало периода ^
Конец периода  ^
^ вакансий
.{ cirFiltRost CheckEnter // Установленные фильтры
  ^
.}
.{
Подразделение ^
.{
Код ^
Наименование ^
Количество по нормам на начало периода ^
В пользовании на начало периода ^
Выбывает к концу периода ^
Наличие на складах ^
Потребность на период ^
Запас/нехватка ^
 по размеру/росту:
.if SizesSFO
.{
  Размер ^
  Рост ^
  Количество по нормам на начало периода ^
  В пользовании на начало периода ^
  Выбывает к концу периода ^
  Наличие на складах ^
  Потребность на период ^
  Запас/нехватка ^
.}
.end
.}
.}
.endform

! По выбранным подразделениям

.linkform SFO_RostVed01 prototype is SFO_RostVed
.group 'Ростовочная ведомость по подразделениям'
.fields
CommonFormHeader
DateToStr( dFrom, 'DD/MM/YYYY') DateToStr( dTo, 'DD/MM/YYYY')
isVacancyEnabled
fltName : 'T:-'
Podr
NomNum SFOName            NormPer  UsePer  OutPer  NeedPer
              Size Height NormPerS UsePerS OutPerS NeedPerS
.endfields
 С ^
                                                  РОСТОВОЧНАЯ ВЕДОМОСТЬ
                                           на период с @~@@@@@@@@ по @~@@@@@@@@
                                               по специальной одежде, обуви
 ^
 Установленные фильтры: Б
.{ cirFiltRost CheckEnter
   ^
.}

 ────────┬────────────────────────┬────────┬──────┬─────────────────┬────────────────┬──────────────┬──────────────
   БКод Б    │  БНаименование Б           │  БРазмер Б │  БРост Б │ БК-во по нормам на Б│ БВ пользовании на Б│  БВыбывает к Б   │  БПотребность Б
         │                        │        │      │      Бпериод Б      │  Бначало периода Б │  Бконцу периода Б│   Бна период Б
 ────────┴────────────────────────┴────────┴──────┴─────────────────┴────────────────┴──────────────┴──────────────
.{
 Б Подразделение: ^ Б

.{
 @@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@                  &&&&&&&&&&&&&&&&  &&&&&&&&&&&&&&&  &&&&&&&&&&&&&   Б&'&&&&&&&&&&& Б
.if SizesSFO
                  Бв том числе: Б
.{
                                   @@@@@@@@ @@@@@@@ &&&&&&&&&&&&&&&&  &&&&&&&&&&&&&&&  &&&&&&&&&&&&&   Б&'&&&&&&&&&&& Б
.}

.end
.}
 ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.} Р
.endform

! По всему предприятию

.linkform SFO_RostVed02 prototype is SFO_RostVed
.group 'Ростовочная ведомость по предприятию'
.fields
CommonFormHeader
DateToStr( dFrom, 'DD/MM/YYYY') DateToStr( dTo, 'DD/MM/YYYY')
isVacancyEnabled
fltName : 'T:-'
!Podr
NomNum SFOName            NormPer  UsePer  OutPer  NeedPer  OnStock Sub
              Size Height NormPerS UsePerS OutPerS NeedPerS OnStockS SubS
.endfields
 С ^
                                                    РОСТОВОЧНАЯ ВЕДОМОСТЬ
                                             на период с @~@@@@@@@@ по @~@@@@@@@@
                                                 по специальной одежде, обуви
 ^
 Установленные фильтры: Б
.{ cirFiltRost CheckEnter
   ^
.}
 И
 ────────┬────────────────────────┬──────┬──────┬─────────────────┬────────────────┬──────────────┬─────────────┬────────────┬────────────────
   БКод Б    │  БНаименование Б           │ БРазмер Б│  БРост Б │ БК-во по нормам н Ба│ БВ пользовании на Б│  БВыбывает к Б   │  БПотребность Б │    БНаличие Б  │  БЗапас/нехватка Б
         │                        │      │      │      Бпериод Б      │  Бначало периода Б │  Бконцу периода Б│   Бна период Б  │   Бна складе Б │
 ────────┴────────────────────────┴──────┴──────┴─────────────────┴────────────────┴──────────────┴─────────────┴────────────┴────────────────
.{
.{
 Б @@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@ Б                &&&&&&&&&&&&&&&&  &&&&&&&&&&&&&&&  &&&&&&&&&&&&&   Б&'&&&&&&&&&& &'&&&&&&&&&& &'&&&&&&&&&&&&& Б&
.if SizesSFO
                  Бв том числе: Б
.{
                                   &&&&&& &&&&&&& &&&&&&&&&&&&&&&&  &&&&&&&&&&&&&&&  &&&&&&&&&&&&&   Б&'&&&&&&&&&& &'&&&&&&&&&& &'&&&&&&&&&&&&&& Б
.}

.end
.}
 ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.} Ш
.endform
