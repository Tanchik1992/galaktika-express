//------------------------------------------------------------------------------
//                                                      (c) Корпорация ГАЛАКТИКА
//------------------------------------------------------------------------------
// Галактика 7.12 - Почтамт
// Печать формы 130 - отчет
//------------------------------------------------------------------------------

!-------------------------------------------------------------------------------
#doc
Форма 130.
#end
.set name = 'Diary130'
.nameinlist 'Базовая форма 130'
.hide
.fields
! Шапка формы
Структура                 : string
ДатаНачала                : date
ДатаОкончания             : date
Подразделение             : string
СсылкаДокумент            : comp
СсылкаСтруктура           : comp
СсылкаПодразделение       : comp
! Тело формы
ОстатокНачалоНал          : double
ОстатокНачалаБезНал       : double
! Раздел
СсылкаРаздел              : comp
КодРаздела                : string
НаименованиеРаздела       : string
УровеньРаздела            : longint
СуммаРазделНал            : double
СуммаРазделБезНал         : double
СуммаРазделДоход          : double
СуммаРазделНДС            : double
! Операция
СсылкаОперация            : comp
КодОперации               : string
НаименованиеОперации      : string
УровеньОперации           : longint
СуммаНал                  : double
СуммаБезНал               : double
СуммаДоход                : double
СуммаНДС                  : double
! Подразделение по операции
СсылкаПодр_Операция       : comp
КодПодр_Операция          : string
НаименованиеПодр_Операция : string
СуммаПодрНал              : double
СуммаПодрБезНал           : double
СуммаПодрДоход            : double
СуммаПодрНДС              : double
! Даты по подразделению
ДатаОперации              : date
СуммаДатаНал              : double
СуммаДатаБезНал           : double
СуммаДатаДоход            : double
СуммаДатаНДС              : double
!
ОстатокКонецНал           : double
ОстатокКонецБезНал        : double
.endfields
!-------------------------------------------------------------------------------
! Структура базовой формы
!-------------------------------------------------------------------------------
--------------------------------------------------------------------------------
                     Форма 130
Структура            ^
                   с @@@@@@@@@@ по @@@@@@@@@@
Подразделение        ^
Документ      (NRec) ^
Структура     (NRec) ^
Подразделение (NRec) ^
                                 Нал          Безнал          Доход           НДС
.{
.{
.case
.when DiarySp_Line
.when DiarySaldoIn
Остаток на Начало           &'&&&&&&&&&.&& &'&&&&&&&&&.&&
.when DiaryPart
Раздел NRec    ^
       Код     ^
       Имя     ^
       Уровень @@@          &'&&&&&&&&&.&& &'&&&&&&&&&.&& &'&&&&&&&&&.&& &'&&&&&&&&&.&&
.when DiarySp
Операция NRec ^
         Код  ^
         Имя  ^
         Уровень @@@        &'#&&&&&&&&.&& &'#&&&&&&&&.&& &'#&&&&&&&&.&& &'#&&&&&&&&.&&
.when DiarySp_Podr
Подразделение NRec ^
              Код  ^
              Имя  ^
                            &'#&&&&&&&&.&& &'#&&&&&&&&.&& &'#&&&&&&&&.&& &'#&&&&&&&&.&&
.when DiarySp_Date
           Дата @@@@@@@@@@  &'#&&&&&&&&.&& &'#&&&&&&&&.&& &'#&&&&&&&&.&& &'#&&&&&&&&.&&
.when DiarySaldoOut
Остаток на Конец            &'&&&&&&&&&.&& &'&&&&&&&&&.&&
.end
.}
.}
-------------------------------------------------------------------------------=
!-------------------------------------------------------------------------------
.endform
!-------------------------------------------------------------------------------

!-------------------------------------------------------------------------------
! Основная форма
!-------------------------------------------------------------------------------
.linkform 'Diary130_01' prototype is 'Diary130'
.nameinlist 'Форма 130'
.lm 20
.fields
CommonFormHeader
ДатаНачала
ДатаОкончания
Структура
Подразделение
!
ОстатокНачалоНал
ОстатокНачалаБезНал
!
PadCh('',' ',3*УровеньРаздела)+НаименованиеРаздела:'t:-'
КодРаздела
СуммаРазделНал
СуммаРазделБезНал
СуммаРазделДоход
СуммаРазделНДС
!
PadCh('',' ',3*УровеньОперации)+НаименованиеОперации:'t:r'
КодОперации
СуммаНал
СуммаБезНал
СуммаДоход
СуммаНДС
!
ОстатокКонецНал
ОстатокКонецБезНал
.endfields
!-------------------------------------------------------------------------------
 Р^

 Б                                                   Ф о р м а  130 С
 Р
 Б                                        за период с  В@@@@@@@@@@ В по  В@@@@@@@@@@ У
 Р
 БСтруктура: Б      В^ В
 БПодразделение: Б  В^ В
.{
.[H
 Б                                                                                                                Лист @np@
──────────────────────────────────┬──────────┬──────────────────┬──────────────────┬──────────────────┬──────────────────
     Наименование показателя      │   Код    │    Наличными     │   Безналичными   │      Доход       │       НДС
──────────────────────────────────┴──────────┴──────────────────┴──────────────────┴──────────────────┴────────────────── С
 Р.]H
.{
.case
.when DiarySp_Line
.when DiarySaldoIn
 ГОстаток на начало                             &'&&&&&&&&&&&&&.&& &'&&&&&&&&&&&&&.&&
───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── У
 Р.when DiaryPart
 Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@ &'&&&&&&&&&&&&&.&& &'&&&&&&&&&&&&&.&& &'&&&&&&&&&&&&&.&& &'&&&&&&&&&&&&&.&& С
 Р.when DiarySp
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@ &'#&&&&&&&&&&&&.&& &'#&&&&&&&&&&&&.&& &'#&&&&&&&&&&&&.&& &'#&&&&&&&&&&&&.&&
.when DiarySp_Podr
.when DiarySp_Date
.when DiarySaldoOut
 Г─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Остаток на Конец                              &'&&&&&&&&&&&&&.&& &'&&&&&&&&&&&&&.&&
───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── У
 Р.end
.}
.} Р
!-------------------------------------------------------------------------------
.endform
!-------------------------------------------------------------------------------

!-------------------------------------------------------------------------------
! Основная форма с детализацией по подразделениям и датам
!-------------------------------------------------------------------------------
.linkform 'Diary130_02' prototype is 'Diary130'
.nameinlist 'Форма 130 (с детализацией по подразделениям и датам)'
.lm 20
.fields
CommonFormHeader
ДатаНачала
ДатаОкончания
Структура
Подразделение
!
LPadCh(PadCh('','─',45-3*(УровеньОперации+1)),' ',45):'t:-'
!
ОстатокНачалоНал
ОстатокНачалаБезНал
!
PadCh('',' ',3*УровеньРаздела)+НаименованиеРаздела:'t:-'
КодРаздела
СуммаРазделНал
СуммаРазделБезНал
СуммаРазделДоход
СуммаРазделНДС
!
PadCh('',' ',3*УровеньОперации)+НаименованиеОперации:'t:r'
КодОперации
СуммаНал
СуммаБезНал
СуммаДоход
СуммаНДС
!
PadCh('',' ',3*(УровеньОперации+1))+НаименованиеПодр_Операция:'t:r'
КодПодр_Операция
СуммаПодрНал
СуммаПодрБезНал
СуммаПодрДоход
СуммаПодрНДС
!
ДатаОперации
СуммаДатаНал
СуммаДатаБезНал
СуммаДатаДоход
СуммаДатаНДС
!
ОстатокКонецНал
ОстатокКонецБезНал
.endfields
!-------------------------------------------------------------------------------
 Р^

 Б                                                   Ф о р м а  130 С
 Р
 Б                                        за период с  В@@@@@@@@@@ В по  В@@@@@@@@@@ У
 Р
 БСтруктура: Б      В^ В
 БПодразделение: Б  В^ В
.{
.[H
 Б                                                                                                                Лист @np@
──────────────────────────────────┬──────────┬──────────────────┬──────────────────┬──────────────────┬──────────────────
     Наименование показателя      │   Код    │    Наличными     │   Безналичными   │      Доход       │       НДС
──────────────────────────────────┴──────────┴──────────────────┴──────────────────┴──────────────────┴────────────────── С
 Р.]H
.{
.case
.when DiarySp_Line
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@────────────────────────────────────────────────────────────────────────────
.when DiarySaldoIn
 ГОстаток на начало                             &'&&&&&&&&&&&&&.&& &'&&&&&&&&&&&&&.&&
───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── У
 Р.when DiaryPart
 Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@ &'&&&&&&&&&&&&&.&& &'&&&&&&&&&&&&&.&& &'&&&&&&&&&&&&&.&& &'&&&&&&&&&&&&&.&& С
 Р.when DiarySp
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@ &'#&&&&&&&&&&&&.&& &'#&&&&&&&&&&&&.&& &'#&&&&&&&&&&&&.&& &'#&&&&&&&&&&&&.&&
.when DiarySp_Podr
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@ &'#&&&&&&&&&&&&.&& &'#&&&&&&&&&&&&.&& &'#&&&&&&&&&&&&.&& &'#&&&&&&&&&&&&.&&
.when DiarySp_Date
                         В@@@@@@@@@@ В            &'#&&&&&&&&&&&&.&& &'#&&&&&&&&&&&&.&& &'#&&&&&&&&&&&&.&& &'#&&&&&&&&&&&&.&&
.when DiarySaldoOut
 Г─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Остаток на Конец                              &'&&&&&&&&&&&&&.&& &'&&&&&&&&&&&&&.&&
───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── У
 Р.end
.}
.} Р
!-------------------------------------------------------------------------------
.endform
!-------------------------------------------------------------------------------
