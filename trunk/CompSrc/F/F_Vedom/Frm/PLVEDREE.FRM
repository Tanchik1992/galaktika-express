//-----------------------------------------------------------------------------------
//                                                           (c) корпорация ГАЛАКТИКА
// Галактика 5.50 - Касса
// Реестр платежных ведомостей
//-----------------------------------------------------------------------------------

#doc
Реестр платежных ведомостей.
#end
.set name='PlVedRee'
.hide
.fields
BegDate EndDate
PlatVedNrec: comp
NoDok NamePrizn DForm DataN datOk PodrName Name1 Summa sFond
SpVedPrizn TabN SpdForm FIO SumUd SumOpl
sum1 sum2
.endfields
 BegDate      ^
 EndDate      ^
.{
.{
Ведомость
 PlatVedNrec  ^
 NoDok        ^
 NamePrizn    ^
 DForm        ^
 DataN        ^
 DatOk        ^
 PodrName     ^
 Name1        ^
 Summa        ^
 sFond        ^
.{
  Спецификация
    SpVedPrizn ^
    TabN       ^
    SpdForm      ^
    FIO        ^
    SumUd      ^
    SumOpl     ^
.}
.}
Итоговые суммы
sum1 ^
sum2 ^
.}
.endform


.linkform 'PlVedRee01' prototype is 'PlVedRee'
.nameinlist 'Краткий реестр платежных ведомостей (без спецификаций)'
.fields
CommonFormHeader
if(BegDate<>'','с '+string(BegDate)+' по '+string(EndDate),'')
NoDok NamePrizn DForm Summa sFond DataN datOk PodrName Name1
sum1
sum2
.endfields
^
.{
.[H
                                                                    ПЛАТЕЖНЫЕ ВЕДОМОСТИ
                                                               @~@@@@@@@@@@@@@@@@@@@@@@@@@@@

───────┬───────────────────┬───────────┬────────────────┬────────────────┬─────────────┬────────────┬───────────────┬────────────────────
 Номер │  Статус ведомости │ Дата форм.│      Сумма     │    Выплачено   │ Дата начала │ Дата окон. │ Подразделение │    Наименование
───────┴───────────────────┴───────────┴────────────────┴────────────────┴─────────────┴────────────┴───────────────┴────────────────────
.]H
.{
@@@@@@@ @@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@ &#&'&&&&&&&&&.&& &#&'&&&&&&&&&.&& @@@@@@@@@@@@@ @@@@@@@@@@@@ @@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@
.{
.}
.}
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Итого по реестру :                      &#&'&&&&&&&&&.&& &#&'&&&&&&&&&.&&
.}
.endform

.linkform 'PlVedRee02' prototype is 'PlVedRee'
.nameinlist 'Подробный реестр платежных ведомостей (со спецификациями)'
.var
isSpecOut: boolean
.endvar
.fields
CommonFormHeader
if(BegDate<>'','с '+string(BegDate)+' по '+string(EndDate),'')
NoDok NamePrizn DForm Summa sFond DataN datOk PodrName Name1
if(isSpecOut,'Спецификации:','')
SpVedPrizn TabN SpdForm SumUd SumOpl FIO
sum1 sum2
.endfields
^
.{
.[H
                                                                    ПЛАТЕЖНЫЕ ВЕДОМОСТИ
                                                               @~@@@@@@@@@@@@@@@@@@@@@@@@@@@

───────┬───────────────────┬───────────┬────────────────┬────────────────┬─────────────┬────────────┬───────────────┬────────────────────
 Номер │  Статус ведомости │ Дата форм.│      Сумма     │    Выплачено   │ Дата начала │ Дата окон. │ Подразделение │    Наименование
───────┴───────────────────┴───────────┴────────────────┴────────────────┴─────────────┴────────────┴───────────────┴────────────────────
.]H
.{
.BEGIN
 isSpecOut:=True;
END.
@@@@@@@ @@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@ &#&'&&&&&&&&&.&& &#&'&&&&&&&&&.&& @@@@@@@@@@@@@ @@@@@@@@@@@@ @@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@
.{
@@@@@@@@@@@@@ @@@@ @@@@@@@@ @@@@@@@@@@@ &#&'&&&&&&&&&.&& &#&'&&&&&&&&&.&& @@@@@@@@@@@@@@@@@@@@@@@@@@
.BEGIN
  isSpecOut:=False;
END.
.}
.}
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Итого по реестру :                      &#&'&&&&&&&&&.&& &#&'&&&&&&&&&.&&
.}
.endform

