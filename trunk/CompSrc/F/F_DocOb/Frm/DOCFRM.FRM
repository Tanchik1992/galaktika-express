! ╔═══════════════════════════════════════════════════════════════════════╗
! ║                    (c) 1996, АО "Новый Атлант", НТО "Топ Софт"        ║
! ║   Система   :   "Документооборот "                                    ║
! ║   Модуль    : DOCFRM.FRM ___________________________________          ║
! ║   Версия    : 4.20.00                                                 ║
! ║   Назначение: Файл описания форм                                      ║
! ║                                                _____________          ║
! ║   Разработал: Кравец Алексей Викторович                               ║
! ║   Изменения :                                                         ║
! ║        Автор: ________________ Дата: __________________               ║
! ║        Цель : _________________________________________               ║
! ║        Автор: ________________ Дата: __________________               ║
! ║        Цель : _________________________________________               ║
! ╚═══════════════════════════════════════════════════════════════════════╝

!==========================================================================
!
!
!                            Документы по фильтру
!
!
!==========================================================================

#doc
#Doc_DocOb
Список документов, удовлетворяющих фильтру.
#end
.FORM docfilt
.namefrn 'nul'

                Список документов, удовлетворяющих фильтру.

.{Doc   CheckEnter
  Секция: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
        Шкаф: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
            Полка: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                 Папка: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                      Документ:  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
Тип документа:@@@@@@@@@@@@@@@@@@@@@@@@@@@@@  No:@@@@@@@@@@@@@@@@@@@@@@@
Название документа:@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
Дата создания:@@@@@@@@@  Время создания:@@@@@@@@@
Ответственное лицо:@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
Организация:@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
Состояние документа:@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
Входящий номер :@@@@@@@@@@@@@@  Имя файла:@@@@@@@@@@@@@@@@@@@@@@@@@@@@
              Примечание:
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@     Содержание документа:
==========================================================================
.{
^
.}
==========================================================================
.}
==========================================================================
  Всего документов: @@@@@@@@@

.ENDFORM

!==========================================================================
!
!
!              Базовая форма "отчеты в разрезе мест хранения"
!
!
!==========================================================================

#doc
#Doc_DocOb
Отчет о системе хранения документов.
#end
.FORM DocReport
.namefrn 'nul'
.hide
.fields
 бууслИмяДокОдинРаз
 буСекция    буШкаф   буПолка  буПапка
 буТипДок    буИмяДок буКарт0  буКарт1   буКарт2  буКарт3
 буКарт4     буКарт5  буКарт6  буДата    буВремя  буОтвЛицо
 буНомерДок  буОрганизац       буСостДок буКодДок буИмяФайла
 буСодержДок
 услСекция  услШкаф  услПолка  услПапка
 услТипДок  услИмяДок  услКарт0  услКарт1  услКарт2  услКарт3
 услКарт4  услКарт5  услКарт6  услДата  услВремя  услОтвЛицо
 услНомерДок  услОрганизац  услСостДок  услКодДок  услИмяФайла
 услСодержДок
 услВсеговПапИмя  услВсеговПапЧисло
 услВсеговПолИмя  услВсеговПолЧисло
 услВсеговШкаИмя  услВсеговШкаЧисло
 услВсеговСекИмя  услВсеговСекЧисло
 услВсегоВобщем
.endfields
.{SectReport  CheckEnter
.{ShkafReport CheckEnter
.{PolkaReport CheckEnter
.{PapkaReport CheckEnter
.{DocReport   CheckEnter
!
! Вывод безусловно всех полей для отчетов на основе присоединенных форм
!

                  Отчет о системе хранения документов.

.if ifDocNameOneTime
^
.end
^ ^ ^
^ ^ ^
^ ^ ^
^ ^ ^
^ ^ ^
^ ^ ^
^ ^ ^
.{BezuslDocTxt  CheckEnter
^
.}
.if ifSect
  Секция: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.end
.if ifShkaf
        Шкаф: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.end
.if ifPolka
            Полка: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.end
.if ifPapka
                 Папка: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.end
.if ifDocType
                        Тип документа: ^
.end
.if ifDocName
                      Документ:  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.end
.if ifDocResum
                        Примечание:
.if ifDocResum0
                          ^
.end
.if ifDocResum1
                          ^
.end
.if ifDocResum2
                          ^
.end
.if ifDocResum3
                          ^
.end
.if ifDocResum4
                          ^
.end
.if ifDocResum5
                          ^
.end
.if ifDocResum6
                          ^
.end
.end
.if ifDate
                          Дата создания документа: ^ время: ^
.end
.if ifWhoResp
                          Ответственное лицо: ^
.end
.if ifDocNum
                          Номер документа: ^
.end
.if ifDocOrg
                          Организация: ^
.end
.if ifSostDoc
                          Состояние документа: ^
.end
.if ifCodeDoc
                          Код документа: ^
.end
.if ifFileName
                          Имя файла: ^
.end
.if ifDocContent
                          Содержимое документа:
.{DocTxt  CheckEnter
^
.}
.end
            ────────────────────────────────────────────────────
.}
.if ifNDocPapka
                 ---------------------------------------------------------
                 Всего в папке: ^  ^ документов.
.end
.}
.if ifNDocPolka
            ---------------------------------------------------------
            Всего на полке: ^  ^ документов.
.end
.}
.if ifNDocShkaf
        ---------------------------------------------------------
        Всего в шкафу: ^  ^ документов.
.end
.}
.if ifNDocSect
  ---------------------------------------------------------
  Всего в секции: ^  ^ документов.
.end
.}
.if ifNDocTotal
=========================================================================
  Всего документов: @@@@@@@@@
.end

.ENDFORM

!==========================================================================
!
!
!              Отчет в разрезе мест хранения стандартный
!
!
!==========================================================================

.linkform 'Список документов'  prototype is DocReport
.group 'Отчеты на основе присоединенных форм'
.fields
 услСекция  услШкаф  услПолка  услПапка
 услТипДок  услИмяДок  услКарт0  услКарт1  услКарт2  услКарт3
 услКарт4  услКарт5  услКарт6  услДата  услВремя  услОтвЛицо
 услНомерДок  услОрганизац  услСостДок  услКодДок  услИмяФайла
 услСодержДок
 услВсеговПапИмя  услВсеговПапЧисло
 услВсеговПолИмя  услВсеговПолЧисло
 услВсеговШкаИмя  услВсеговШкаЧисло
 услВсеговСекИмя  услВсеговСекЧисло
 услВсегоВобщем
.endfields

                      Отчет о системе хранения документов.

.{SectReport  CheckEnter
.{ShkafReport CheckEnter
.{PolkaReport CheckEnter
.{PapkaReport CheckEnter
.{DocReport CheckEnter
.if ifDocNameOneTime
.end
.{BezuslDocTxt  CheckEnter
.}
.if ifSect
  Секция: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.end
.if ifShkaf
        Шкаф: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.end
.if ifPolka
            Полка: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.end
.if ifPapka
                 Папка: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.end
.if ifDocType
                        Тип документа: ^
.end
.if ifDocName
                      Документ:  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.end
.if ifDocResum
                        Примечание:
.if ifDocResum0
                          ^
.end
.if ifDocResum1
                          ^
.end
.if ifDocResum2
                          ^
.end
.if ifDocResum3
                          ^
.end
.if ifDocResum4
                          ^
.end
.if ifDocResum5
                          ^
.end
.if ifDocResum6
                          ^
.end
.end
.if ifDate
                          Дата создания документа: ^ время: ^
.end
.if ifWhoResp
                          Ответственное лицо: ^
.end
.if ifDocNum
                          Номер документа: ^
.end
.if ifDocOrg
                          Организация: ^
.end
.if ifSostDoc
                          Состояние документа: ^
.end
.if ifCodeDoc
                          Код документа: ^
.end
.if ifFileName
                          Имя файла: ^
.end
.if ifDocContent
                          Содержимое документа:
.{DocTxt  CheckEnter
^
.}
.end
            ────────────────────────────────────────────────────
.}
.if ifNDocPapka
                 ---------------------------------------------------------
                 Всего в папке: ^  ^ документов.
.end
.}
.if ifNDocPolka
            ---------------------------------------------------------
            Всего на полке: ^  ^ документов.
.end
.}
.if ifNDocShkaf
        ---------------------------------------------------------
        Всего в шкафу: ^  ^ документов.
.end
.}
.if ifNDocSect
  ---------------------------------------------------------
  Всего в секции: ^  ^ документов.
.end
.}
.if ifNDocTotal
=========================================================================
  Всего документов: @@@@@@@@@
.end

.ENDFORM

!==========================================================================
!
!
!                           Список документов
!
!
!==========================================================================

.linkform 'Отчет в разрезе мест хранения стандартный'prototype is DocReport
.group 'Отчеты в разрезе мест хранения'
.fields
 буНомерДок
 буСекция буДата  буВремя  буИмяДок буШкаф  буПолка  буПапка
.endfields

               Отчет в разрезе мест хранения стандартный.

┌───────────┬──────────────────────┬─────────────────┬────────────────────┐
│ Номер док.│    Место хранения    │    Дата/время   │      Название      │
.{SectReport  CheckEnter
.{ShkafReport CheckEnter
.{PolkaReport CheckEnter
.{PapkaReport CheckEnter
.{DocReport CheckEnter
!
! Вывод безусловно полей для отчетов на основе присоединенных форм
!
.if ifDocNameOneTime
.end
├───────────┼──────────────────────┼─────────────────┼────────────────────┤
│@@@@@@@@@@ │Секция:               │                 │                    │
│           │@@@@@@@@@@@@@@@@@@@@  │@@@@@@@@@@ @@@@@@│ @@@@@@@@@@@@@@@@@@@│
│           │Шкаф:                 │                 │                    │
│           │@@@@@@@@@@@@@@@@@@@@  │                 │                    │
│           │Полка:                │                 │                    │
│           │@@@@@@@@@@@@@@@@@@@@  │                 │                    │
│           │Папка:                │                 │                    │
│           │@@@@@@@@@@@@@@@@@@@@  │                 │                    │
.{BezuslDocTxt  CheckEnter
.}
.if ifSect
.end
.if ifShkaf
.end
.if ifPolka
.end
.if ifPapka
.end
.if ifDocType
.end
.if ifDocName
.end
.if ifDocResum
.if ifDocResum0
.end
.if ifDocResum1
.end
.if ifDocResum2
.end
.if ifDocResum3
.end
.if ifDocResum4
.end
.if ifDocResum5
.end
.if ifDocResum6
.end
.end
.if ifDate
.end
.if ifWhoResp
.end
.if ifDocNum
.end
.if ifDocOrg
.end
.if ifSostDoc
.end
.if ifCodeDoc
.end
.if ifFileName
.end
.if ifDocContent
.{DocTxt  CheckEnter
.}
.end
.}
.if ifNDocPapka
.end
.}
.if ifNDocPolka
.end
.}
.if ifNDocShkaf
.end
.}
.if ifNDocSect
.end
.}
└───────────┴──────────────────────┴─────────────────┴────────────────────┘
.if ifNDocTotal
.end

.ENDFORM

!------------------------------------------------------------------------
!
!
!                               Контроль входящих основная
!
!
!------------------------------------------------------------------------

#doc
#Doc_DocOb
Контроль входящих пакетов.
#end
.FORM documcheckinb
.namefrn 'nul'
.nameinlist 'Основная форма'
.FIELDS
 VhodPunkt
 PaketName  MarName
 SrochnPaketa
 DatPostupPaket WremjaPostupPaket
 DlitPlanDni DlitPlanChas DlitPlanMin
 PaketLate
 DocName DocNumber
  PnkPrevName
  DataNachObr WremNachObr
  WremEndObr
  Dej
  Result
  WhoObr SysName
  DateObrDoc TimeObrDoc
  Zamech
.ENDFIELDS

                         Контроль входящих пакетов.

.{loop1 CheckEnter
.{loop2 CheckEnter
.if ifNeedPnktObr
  Пункт обработки: "^"
.end
    Пакет: "^" На маршруте: "^"
      Срочность пакета: "^"
      Дата поступления: @@@@@@@@ время: @@@@@@@@
      Длительность обработки плановая дни: @@@@ часы: @@ минуты:@@
      Просроченный ли пакет: "^"
.{loop3 CheckEnter
      Документ: "^"  Номер "^"
.{loop4 CheckEnter
        Пункт на котором обрабатывался
        документ: "^"
        Начало обработки в пункте дата: @@@@@@@@ время: @@@@@@@
        Длительность обработки реальная минут: @@@@@@@
.{loop5 CheckEnter
            Действие:  "^"
            Результат: "^"
            Кто обрабатывал имя: "^"
            Системный идентификатор: "^"
            Дата обработки: ^
            Время: ^
            Замечание:
.{loop6 CheckEnter
"^"
.}
.}
.}
.}
            ────────────────────────────────────────────────────
.}
.}
.ENDFORM

!------------------------------------------------------------------------
!                   Контроль входящих присоединенная
!------------------------------------------------------------------------

.linkform 'Контроль входящих' prototype is documcheckinb
.FIELDS
 VhodPunkt
 PaketName MarName
 DocName DocNumber
  PnkPrevName  Dej  Result
  WhoObr SysName   DateObrDoc TimeObrDoc
.ENDFIELDS

                        Контроль входящих пакетов.

.{loop1 CheckEnter
.{loop2 CheckEnter
.if ifNeedPnktObr
Пункт обработки: "^"
.end
    Пакет: "^" на маршруте: "^"
.{loop3 CheckEnter
      Документ: "^"  номер: "^"
┌────────────────────────┬─────────┬───────────────────────────┬────────────────┐
│       Действие         │Результат│   Имя,      Идентификатор │   Дата    Время│
.{loop4 CheckEnter
├────────────────────────┴─────────┴───────────────────────────┴────────────────┤
│Пункт на котором обрабатывался документ: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│
│                        │         │                           │                │
.{loop5 CheckEnter
│@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@│@@@@@@@@@@@@@@@@ @@@@@@@@@@│@@@@@@@@@@ @@@@@│
.{loop6 CheckEnter
.}
.}
.}
└────────────────────────┴─────────┴───────────────────────────┴────────────────┘

.}
            ────────────────────────────────────────────────────
.}
.}
.ENDFORM


!------------------------------------------------------------------------
!
!                          Контроль исходящих
!
!------------------------------------------------------------------------

#doc
#Doc_DocOb
Контроль исходящих пакетов.
#end
.FORM documcheckout
.namefrn 'nul'
.nameinlist 'Основная форма'
.FIELDS
пункт
имя_пакета состояние_пакета
маршрут_пакета
дата_поступл_пакета время_поступл_пакета
дата_окончания_обработки время_окончания_обработки
        кто_отправил_пакет_имя кто_отправил_пакет_сетевое
        дата_планируемого_окончания  время_планируемого_окончания
        срочность_пакета
        кто_снял_пакет  кто_снял_пакет_сетевое
          название_документа
            тип_документа
                       примечания_по_документу0
                       примечания_по_документу1
                       примечания_по_документу2
                       примечания_по_документу3
                       примечания_по_документу4
                       примечания_по_документу5
                       примечания_по_документу6
           дата_создания_документа
           время_создания_документа
           ответственное_лицо
           номер_документа
           организация
           состояние_документа
           код_документа
           имя_файла
                 пункт_обработки
                      дата_поступления_пакета  время_поступления_пакета
                      продолжит_обработки_пакета
                      состояние_обработки_пакета
                      действие
                        результат
                        кто_обработал_ФИО
                            кто_обработал_сетевое
                        дата_обработки время_обработки
                           примечание
.ENDFIELDS

                        Контроль исходящих пакетов.

.{loop0 CheckEnter
.if ifNeedPnktObr
Пункт обработки исходящий: "^"
.end
      Пакет: "^" состояние: "^"
        маршрут пакета: "^"
        дата поступл пакета на маршрут: ^ время: ^
        дата окончания обработки пакета: ^ время: ^
        кто отправил пакет ФИО: "^" сетевое: "^"
        дата планируемого окончания прохождения маршрута: ^ время: ^
        срочность пакета: "^"
        кто снял пакет с маршрута ФИО: "^" сетевое: "^"
.{loop1 CheckEnter
          Название документа: "^"
            тип документа: "^"
                       примечания по документу:
            "^"
            "^"
            "^"
            "^"
            "^"
            "^"
            "^"
           дата создания документа: "^"
           время создания документа: "^"
           ответственное лицо: "^"
           номер документа: "^"
           организация: "^"
           состояние документа: "^"
           код документа: "^"
           имя файла: "^"
.{loop2 CheckEnter
                 Пункт обработки: "^"
                      дата поступления пакета: ^ время: ^
                      продолжительность обработки пакета минут: ^
                      состояние обработки пакета: "^"
.{loop3 CheckEnter
                      Действие: "^"
                        результат: "^"
                        кто обработал ФИО: "^"
                            сетевое: "^"
                        дата обработки: ^ время: ^
                           Примечание:
.{loop4 CheckEnter
"^"
.}
.}
.}
.}
            ────────────────────────────────────────────────────
.}
.ENDFORM

!------------------------------------------------------------------------
!           Контроль исходящих присоединенная
!------------------------------------------------------------------------

.linkform 'Контроль исходящих' prototype is documcheckout
.FIELDS
пункт
имя_пакета состояние_пакета
маршрут_пакета срочность_пакета
          название_документа     номер_документа
                 пункт_обработки
                      действие
                        результат
                        кто_обработал_ФИО
                            кто_обработал_сетевое
                        дата_обработки время_обработки
.ENDFIELDS

                        Контроль исходящих пакетов.

.{loop0 CheckEnter
.if ifNeedPnktObr
Пункт обработки исходящий: "^"
.end
      Пакет: "^" состояние: "^"
               маршрут пакета: "^"
               срочность: "^"
.{loop1 CheckEnter
          Название документа: "^"   номер документа: "^"
┌────────────┬──────────────┬──────────────────────────────┬────────────────┐
│  Действие  │   Результат  │ Кто обработал ФИО   сетевое  │  дата    время │
.{loop2 CheckEnter
├────────────┴──────────────┴──────────────────────────────┴────────────────┤
│Пункт обработки: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ │
.{loop3 CheckEnter
│@@@@@@@@@@@@│@@@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@│@@@@@@@@@ @@@@@@│
.{loop4 CheckEnter
.}
.}
.}
└────────────┴──────────────┴──────────────────────────────┴────────────────┘
.}
            ────────────────────────────────────────────────────
.}
.ENDFORM

!------------------------------------------------------------------------
!
!                          Контроль исходящих по пунктам
!
!------------------------------------------------------------------------

#doc
#Doc_DocOb
Контроль исходящих пакетов по пунктам.
#end
.FORM documcheckoutpnk
.namefrn 'nul'
.nameinlist 'Основная форма'
.FIELDS
пункт
имя_пакета состояние_пакета
маршрут_пакета
дата_поступл_пакета время_поступл_пакета
дата_окончания_обработки время_окончания_обработки
        кто_отправил_пакет_имя кто_отправил_пакет_сетевое
        дата_планируемого_окончания  время_планируемого_окончания
        срочность_пакета
        кто_снял_пакет  кто_снял_пакет_сетевое

        пункт_обработки
             дата_поступления_пакета  время_поступления_пакета
             плановое_время_обработки
             продолжит_обработки_пакета
             состояние_обработки_пакета
             просрочен_ли_пакет

                название_документа
                  тип_документа
                             примечания_по_документу0
                             примечания_по_документу1
                             примечания_по_документу2
                             примечания_по_документу3
                             примечания_по_документу4
                             примечания_по_документу5
                             примечания_по_документу6
                 дата_создания_документа
                 время_создания_документа
                 ответственное_лицо
                 номер_документа
                 организация
                 состояние_документа
                 код_документа
                 имя_файла

                      действие
                        результат
                        кто_обработал_ФИО
                            кто_обработал_сетевое
                        дата_обработки время_обработки
                           примечание
.ENDFIELDS

                    Контроль исходящих пакетов по пунктам.

.{loop0 CheckEnter
.if ifNeedPnktObr
Пункт обработки исходящий: "^"
.end
      Пакет: "^" состояние: "^"
        маршрут пакета: "^"
        дата поступл пакета на маршрут: ^ время: ^
        дата окончания обработки пакета: ^ время: ^
        кто отправил пакет ФИО: "^" сетевое: "^"
        дата планируемого окончания прохождения маршрута: ^ время: ^
        срочность пакета: "^"
        кто снял пакет с маршрута ФИО: "^" сетевое: "^"
.{loop1 CheckEnter
          Пункт обработки: "^"
               дата поступления пакета: ^ время: ^
               плановое время обработки минут: ^
               продолжительность обработки пакета минут: ^
               состояние обработки пакета: "^"
               просрочен ли пакет: "^"
.{loop2 CheckEnter
                Название документа: "^"
                  тип документа: "^"
                             примечания по документу:
                  "^"
                  "^"
                  "^"
                  "^"
                  "^"
                  "^"
                  "^"
                 дата создания документа: "^"
                 время создания документа: "^"
                 ответственное лицо: "^"
                 номер документа: "^"
                 организация: "^"
                 состояние документа: "^"
                 код документа: "^"
                 имя файла: "^"
.{loop3 CheckEnter
                      Действие: "^"
                        результат: "^"
                        кто обработал ФИО: "^"
                            сетевое: "^"
                        дата обработки: ^ время: ^
                           Примечание:
.{loop4 CheckEnter
"^"
.}
.}
.}
.}
            ────────────────────────────────────────────────────
.}
.ENDFORM

!------------------------------------------------------------------------
!           Контроль исходящих присоединенная
!------------------------------------------------------------------------

.linkform 'Контроль исходящих в разрезе пунктов' prototype is documcheckoutpnk
.FIELDS
пункт
имя_пакета состояние_пакета
маршрут_пакета срочность_пакета

        пункт_обработки
             состояние_обработки_пакета
             дата_поступления_пакета  время_поступления_пакета
             плановое_время_обработки
             продолжит_обработки_пакета
             просрочен_ли_пакет

                  название_документа     номер_документа

                      действие
                        результат
                        кто_обработал_ФИО
                            кто_обработал_сетевое
                        дата_обработки время_обработки
.ENDFIELDS

                    Контроль исходящих пакетов по пунктам.

.{loop0 CheckEnter
.if ifNeedPnktObr
Пункт обработки исходящий: "^"
.end
      Пакет: "^" состояние: "^"
               маршрут пакета: "^"
               срочность: "^"
.{loop1 CheckEnter
           Пункт обработки: "^"
                 состояние обработки пакета: "^"
                 дата поступления пакета: ^  время поступления пакета: ^
                 плановое время обработки: ^
                 продолжительность обработки пакета минут: ^
                 просрочен ли пакет: "^"
┌────────────┬──────────────┬──────────────────────────────┬────────────────┐
│  Действие  │   Результат  │ Кто обработал ФИО   сетевое  │  дата    время │
.{loop2 CheckEnter
├────────────┴──────────────┴──────────────────────────────┴────────────────┤
│Название документа: @@@@@@@@@@@@@@@@@@@@@@@@  номер документа: @@@@@@@@@@@@│
.{loop3 CheckEnter
│@@@@@@@@@@@@│@@@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@│@@@@@@@@@ @@@@@@│
.{loop4 CheckEnter
.}
.}
.}
└────────────┴──────────────┴──────────────────────────────┴────────────────┘
.}
            ────────────────────────────────────────────────────
.}
.ENDFORM

!------------------------------------------------------------------------
!           Контроль исходящих присоединенная 2
!------------------------------------------------------------------------

.linkform 'Контроль графика движения' prototype is documcheckoutpnk
.FIELDS
пункт
имя_пакета состояние_пакета
маршрут_пакета срочность_пакета

        пункт_обработки
             состояние_обработки_пакета
             дата_поступления_пакета  время_поступления_пакета
             плановое_время_обработки
             продолжит_обработки_пакета
             просрочен_ли_пакет
.ENDFIELDS

                          Контроль графика движения.

.{loop0 CheckEnter
.if ifNeedPnktObr
Пункт обработки исходящий: "^"
.end
      Пакет: "^" состояние: "^"
               маршрут пакета: "^"
               срочность: "^"
.{loop1 CheckEnter
           Пункт обработки: "^"
                 состояние обработки пакета: "^"
                 дата поступления пакета: ^  время поступления пакета: ^
                 плановое время обработки: ^
                 продолжительность обработки пакета минут: ^
                 просрочен ли пакет: "^"
.{loop2 CheckEnter
.{loop3 CheckEnter
.{loop4 CheckEnter
.}
.}
.}
.}
            ────────────────────────────────────────────────────
.}
.ENDFORM

!------------------------------------------------------------------------
!
!
!                          Лист согласования
!
!
!------------------------------------------------------------------------

#doc
#Doc_DocOb
Лист согласования документа.
#end
.FORM soglaslist
.namefrn 'nul'
.nameinlist 'Основная форма'
.FIELDS
Название_маршрута
Примечание_по_маршруту0
Примечание_по_маршруту1
Примечание_по_маршруту2
Примечание_по_маршруту3
Примечание_по_маршруту4
Примечание_по_маршруту5
Примечание_по_маршруту6
      Наименование_пакета
      Дата_поступления_пакета_на_маршут
      Время_поступления_пакета_на_маршут
      Дата_окончания_обработки_пакета_на_маршуте
      Время_окончания_обработки_пакета_на_маршуте
      Кто_отправил_пакет
      Кто_отправил_пакет_системное_имя
      В_каком_пункте_подготовлен_отправлен_пакет
      Дата_планируемого_окончания_прохождения
      Время_планируемого_окончания_прохождения
      Отметка_о_срочности_пакета
      Состояние_пакета
      Кто_снял_пакет_с_маршрута
      Кто_снял_пакет_с_маршрута_системное_имя
          Пункт_обработки
          Дата_поступления_пакета
          Время_поступления_пакета
          Продолжит_обработки_пакета_минут
             Действие
             Результат
             Кем_было_обработано_действие
             Кем_было_обработано_действие_системное_имя
             Дата_обработки_действия
             Время_обработки_действия
                Замечание_по_обработке
.ENDFIELDS

                          Лист согласования документа.

.{loop1 CheckEnter
Название маршрута: "^"
Примечания по маршруту:
"^"
"^"
"^"
"^"
"^"
"^"
"^"
.{loop2 CheckEnter
       Наименование пакета: "^"
       Дата поступления пакета на маршут: ^
       Время поступления пакета на маршут: ^
       Дата окончания обработки пакета на маршуте: ^
       Время окончания обработки пакета на маршуте: ^
       Кто отправил пакет: "^"
       Кто отправил пакет системное имя: "^"
       В каком пункте подготовлен/отправлен пакет: "^"
       Дата планируемого окончания прохождения: ^
       Время планируемого окончания прохождения: ^
       Отметка о срочности пакета: "^"
       Состояние пакета: "^"
       Кто снял пакет с маршрута: "^"
       Кто снял пакет с маршрута системное имя: "^"
.{loop3 CheckEnter
           Пункт обработки: "^"
           Дата поступления пакета: ^
           Время поступления пакета: ^
           Продолжит обработки пакета минут: "^"
.{loop4 CheckEnter
                Действие: "^"
                Результат: "^"
                Кем было обработано действие: "^"
                Кем было обработано действие системное имя: "^"
                Дата обработки действия: ^
                Время обработки действия: ^
                   Замечание по обработке:
.{loop5 CheckEnter
"^"
.}
.}
.}
            ────────────────────────────────────────────────────
.}
────────────────────────────────────────────────────────────────────────────
.}
.ENDFORM


!------------------------------------------------------------------------
!
!                Лист согласования присоединенная форма
!
!------------------------------------------------------------------------
.linkform 'Лист согласования документа' prototype is soglaslist
.FIELDS
Название_маршрута
      Наименование_пакета
      Дата_поступления_пакета_на_маршут
      Время_поступления_пакета_на_маршут
          Пункт_обработки
          Дата_поступления_пакета
          Время_поступления_пакета
             Действие
             Результат
             Кем_было_обработано_действие
             Кем_было_обработано_действие_системное_имя
             Дата_обработки_действия
             Время_обработки_действия
.ENDFIELDS

                          Лист согласования документа.

.{loop1 CheckEnter
Название маршрута: "^"
.{loop2 CheckEnter
       Наименование пакета: "^"
       Дата поступления пакета на маршут: ^
       Время поступления пакета на маршут: ^
┌────────────┬──────────────┬──────────────────────────────┬────────────────┐
│  Действие  │   Результат  │ Кто обработал ФИО   сетевое  │  дата    время │
.{loop3 CheckEnter
├────────────┴──────────────┴──────────────────────────────┴────────────────┤
│Пункт обработки: @@@@@@@@@@@@@@@@@@@@@@@@ поступление дата @@@@@@@@@ @@@@@@│
.{loop4 CheckEnter
│@@@@@@@@@@@@│@@@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@│@@@@@@@@@ @@@@@@│
.{loop5 CheckEnter
.}
.}
.}
└────────────┴──────────────┴──────────────────────────────┴────────────────┘
.}
────────────────────────────────────────────────────────────────────────────
.}
.ENDFORM

!========================================================================
!
!
!   Реестр документов пришедших в пакете в пункт обработки
!   основаная форма
!
!========================================================================

#doc
#Doc_DocOb
Реестр документов пришедших в пакете в пункт обработки.
#end
.FORM ReestrDocInPunkt
.namefrn 'nul'
.hide
.fields
Название_пункта_обрабоки
Название_документа
Название_файла_для_документа
Название_действия_над_документом
.endfields

            Реестр документов пришедших в пакете в пункт обработки.

^
.{loopOnDocum  CheckEnter
^ ^
.{loopOnDejstv  CheckEnter
^
.}
.}
.ENDFORM

!========================================================================
!
!
!   Реестр документов пришедших в пакете в пункт обработки
!   присоединенная форма
!
!========================================================================
.linkform 'Реестр выгруженных документов' prototype is ReestrDocInPunkt

.fields
Название_пункта_обрабоки
Название_документа
Название_файла_для_документа
Название_действия_над_документом
.endfields
             Список документов выгруженных из пункта обработки
             "^"
┌─────────────────────────────┬────────────┬───────────────────────────────┐
│     Название документа      │   Файл     │  Действия в пункте обработки  │
├─────────────────────────────┼────────────┼───────────────────────────────┤
.{loopOnDocum  CheckEnter
│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@│                               │
.{loopOnDejstv  CheckEnter
│                             │            │"@@@@@@@@@@@@@@@@@@@@@@@@@@@@@"│
.}
.}
└─────────────────────────────┴────────────┴───────────────────────────────┘
.ENDFORM

!========================================================================
!
!   Основаная форма
!   Отчет об истории порождения документа
!
!========================================================================
#doc
#Doc_DocOb
Отчет об истории порождения документа.
#end
.Form DocVersio
.namefrn 'nul'
.DEFO LANDSCAPE
.hide

.fields
Название_документа
Сетевое_имя_создавшего
Имя_создавшего
На_базе_какого_документа
Какой_документ_получился
Дата_создания
Время_создания
.endfields

                  Отчет об истории порождения документа.

^
.{loopOnDocum  CheckEnter
^ ^ ^
^ ^ ^
.}

.ENDFORM

!========================================================================
!
!   Присоединенная форма
!   Отчет об истории порождения документа
!
!========================================================================
.linkform 'Отчет об истории порождения документа' prototype is DocVersio
.DEFO LANDSCAPE
.fields
Название_документа
Сетевое_имя_создавшего
Имя_создавшего
На_базе_какого_документа
Какой_документ_получился
Дата_создания
Время_создания
.endfields
                                                             Отчет об истории порождения документа
                                                              "^"
┌─────────────────────────────────────────────────────────────┬───────────────────────────────────────┬───────────────────────────────────────┬─────────┬─────┐
│                             КТО                             │     На базе какого документа          │         Получился документ            │   Дата  │Время│
├──────────────────────────────┬──────────────────────────────┼───────────────────────────────────────┼───────────────────────────────────────┼─────────┼─────┤
.{loopOnDocum  CheckEnter
│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@│@@@@@│
.}
└──────────────────────────────┴──────────────────────────────┴───────────────────────────────────────┴───────────────────────────────────────┴─────────┴─────┘ 
.ENDFORM

!========================================================================
!
!   Основаная форма
!   Документы порожденные из данного
!
!========================================================================
#doc
#Doc_DocOb
Документы порожденные из данного.
#end
.Form DocResult
.namefrn 'nul'
.DEFO LANDSCAPE
.hide

.fields
Название_документа
Сетевое_имя_создавшего
Имя_создавшего
На_базе_какого_документа
Какой_документ_получился
Дата_создания
Время_создания
Сетевое_имя_имеющего_доступ
Имя_имеющего_доступ
.endfields
^
.{loopOnDocum  CheckEnter
^ ^ ^
^ ^ ^
.{loopOnDocumRights  CheckEnter
^ ^
.}
.}

.ENDFORM

!========================================================================
!
!   Присоединенная форма
!   Документы порожденные из данного
!
!========================================================================
.linkform 'Отчет об истории порождения документа' prototype is DocResult
.DEFO LANDSCAPE
.fields
Название_документа
Сетевое_имя_создавшего
Имя_создавшего
На_базе_какого_документа
Какой_документ_получился
Дата_создания
Время_создания
Сетевое_имя_имеющего_доступ
Имя_имеющего_доступ
.endfields
                                                             Документы порожденные из документа
                                                              "^"
┌─────────────────────────────────────────────────────────────┬───────────────────────────────────────┬───────────────────────────────────────┬─────────┬─────┐
│                             КТО                             │     На базе какого документа          │         Получился документ            │   Дата  │Время│
├──────────────────────────────┬──────────────────────────────┼───────────────────────────────────────┼───────────────────────────────────────┼─────────┼─────┤
.{loopOnDocum  CheckEnter
│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@│@@@@@│
.{loopOnDocumRights  CheckEnter
│право>@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│                                       │                                       │         │     │
.}
.}
└──────────────────────────────┴──────────────────────────────┴───────────────────────────────────────┴───────────────────────────────────────┴─────────┴─────┘ 
.ENDFORM

!========================================================================
!
!   Основаная форма
!   Копии документа
!
!========================================================================
#doc
#Doc_DocOb
Места хранения копий документа.
#end
.form DocBasCopiesReport
.namefrn 'nul'
.HIDE
.fields
Документ
Секция        Шкаф
Полка         Папка
Сетевое_имя   Имя_пользователя
Всего_копий
.endfields

                         Места хранения копий документа

┌───────────────────────────────────────────────────────────────────────────┐
│          Документ: "@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@"             │
.{loopOnDocum  CheckEnter
├─────────────────────────────────────┬─────────────────────────────────────┤
│Секция:                              │Шкаф:                                │
│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│
│Полка:                               │Папка:                               │
│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│
.if ifDocBasIsAdmin
│Пользователи с правами на документ   │                                     │
│Сетевое имя:                         │Имя пользователя:                    │
.{loopOnDocumRights  CheckEnter
│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│
.}
.end
.}
└─────────────────────────────────────┴─────────────────────────────────────┘
Всего копий документа (вероятно не видимых из-за отсутствия прав): ^
.ENDFORM

!========================================================================
!
!   Присоединенная форма
!   Копии документа
!
!========================================================================
.linkform  'Копии документа' prototype is DocBasCopiesReport
.fields
Документ
Секция        Шкаф
Полка         Папка
Сетевое_имя   Имя_пользователя
Всего_копий
.endfields

                         Места хранения копий документа

┌───────────────────────────────────────────────────────────────────────────┐
│          Документ: "@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@"             │
.{loopOnDocum  CheckEnter
├─────────────────────────────────────┬─────────────────────────────────────┤
│Секция:                              │Шкаф:                                │
│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│
│Полка:                               │Папка:                               │
│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│
.if ifDocBasIsAdmin
│Пользователи с правами на документ   │                                     │
│Сетевое имя:                         │Имя пользователя:                    │
.{loopOnDocumRights  CheckEnter
│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│
.}
.end
.}
└─────────────────────────────────────┴─────────────────────────────────────┘
Всего копий документа (вероятно не видимых из-за отсутствия прав): ^
.ENDFORM

!========================================================================
!
!   Основаная форма
!   Печать маршрута
!
!========================================================================
#doc
#Doc_DocOb
Представление маршрута.
#end
.form MarchPrint
.namefrn 'nul'
.fields
Маршрут
Документ
.endfields

              Представление маршрута: "^"


.{loopOnDocumRights  CheckEnter
^
.}
.ENDFORM

