/*
 ╔═══════════════════════════════════════════════════════════════════════════╗
 ║                     (c) 1994,97 корпорация ГАЛАКТИКА                      ║
 ║ Проект        : ГАЛАКТИКА                                                 ║
 ║ Система       : Заработная плата                                          ║
 ║ Версия        : 5.00                                                      ║
 ║ Назначение    : Реестры по видам удержаний (кроме кода 198)               ║
 ║ Ответственный : Маслакова Татьяна Владимировна                            ║
 ╚═══════════════════════════════════════════════════════════════════════════╝
*/
#doc
Реестры по видам удержаний (кроме кода 198)
#end
.set name='reesuder'
.hide
.p 80
.fields
Pred1
NameReestr1
Получатель1
Расч_счет1 Код1
Банк1
Код_МФО1 Mes1 God1
Npp TabN Nom_lsch FIO Summa :double
ItogSumma_Reestr
NomList  StrSumma1
StrSumma2
Рук_пред Гл_бухг
Pole
ItogSumma
.endFields
 И
.{
.{
    Предприятие   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    ^
    Получатель    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    Расчетный счет получателя @@@@@@@@@@@@@@@  Код получателя @@@@@@@@@@
    Банк          @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    Код МФО банка @@@@@@@@@@@@       за ^ месяц &&&& г.
─────┬─────────┬───────────────────────────────────────────┬───────────────────
 No- │Табельный│              Фамилия И.О.                 │   Сумма
 п/п │  номер  │                                           │перечисления
─────┼─────────┼───────────────────────────────────────────┼───────────────────
.{
 ^ ^ ^ ^ ^
.}
.}
                          ВСЕГО К ПЕРЕЧИСЛЕНИЮ            &'#&&&&&&&&&&&&&&&.&&
Количество листов &&&     @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                          @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                          (сумма прописью)

   Рук. предприятия ^
                                                 _______________
                                                    (подпись)
   Гл. бухгалтер ^
                                                 _______________
                                                    (подпись)
                                                        @@@
.if BPRees
.end
.}
.if ItogRees
      ИТОГО УДЕРЖАНО С РАБОЧИХ И СЛУЖАЩИХ
      ДЛЯ ПЕРЕЧИСЛЕНИЯ __________________:                &'#&&&&&&&&&&&&&&&.&&
.end
 И
.endform

.linkform 'reesuder_01' prototype is 'reesuder'
.group'fullTabN'
.nameinlist 'Полная форма реестра с табельными номерами'
.p 80
.var
    SumList : double
    KolList : double
    Pred2       : string
    NameReestr2 : string
    Получатель2 : string
    Расч_счет2  : string
    Код2        : string
    Банк2       : string
    Код_МФО2    : string
    Mes2        : string
    God2        : string
.endvar
.begin
  SumList := 0
  KolList := 1
end.

 И
.{
.{
.[h OverWrite
.begin
    Pred2       := Pred1
    NameReestr2 := NameReestr1
    Получатель2 := Получатель1
    Расч_счет2  := Расч_счет1
    Код2        := Код1
    Банк2       := Банк1
    Код_МФО2    := Код_МФО1
    Mes2        := Mes1
    God2        := God1
end.
.fields
Pred2
NameReestr2
Получатель2
Расч_счет2 Код2
Банк2
Код_МФО2 Mes2 God2
.endfields
    Предприятие   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    ^
    Получатель    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    Расчетный счет получателя @@@@@@@@@@@@@@@  Код получателя @@@@@@@@@@
    Банк          @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    Код МФО банка @@@@@@@@@@@@       за ^ месяц &&&& г.
─────┬─────────┬───────────────────────────────────────────┬───────────────────
 No- │Табельный│              Фамилия И.О.                 │   Сумма
 п/п │  номер  │                                           │перечисления
─────┼─────────┼───────────────────────────────────────────┼───────────────────
.]h
.{
.fields
  Npp TabN FIO Summa
.endfields
.begin
!Round - добавлен исходя из
! решения проблемы в ПИР 4.363
  SumList := Round(SumList,2) + Round(Summa,2)
end.
&&&&&│@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│&'#&&&&&&&&&&&&&&&&
.}
.[f OverWrite
.fields
  KolList
  SumList
.endfields
─────┴─────────┴───────────────────────────────────────────┴───────────────────
 Б Итого по листу  &'&&:                                     &'&&&&&&&&&&&&&&&.&& Б
.begin
  SumList := 0
  KolList := KolList +1
end.

.]f
.}
.begin
  KolList := KolList - 1
end.
.fields
ItogSumma_Reestr
KolList  StrSumma1
StrSumma2
Рук_пред Гл_бухг
Pole
'true':'s'
.endFields
 Б                          ВСЕГО К ПЕРЕЧИСЛЕНИЮ            &'#&&&&&&&&&&&&&&&.&& Б
Количество листов &'&&    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                          @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                          (сумма прописью)

   Рук. предприятия ^
                                                 _______________
                                                    (подпись)
   Гл. бухгалтер ^
                                                 _______________
                                                    (подпись)
                                                        @@@
.if BPRees
 ^
.end
.}
.fields
 ItogSumma
.endFields
.if ItogRees
      ИТОГО УДЕРЖАНО С РАБОЧИХ И СЛУЖАЩИХ
      ДЛЯ ПЕРЕЧИСЛЕНИЯ __________________:                &'#&&&&&&&&&&&&&&&.&&
.end
 И
.endform


.linkform 'reesuder_02' prototype is 'reesuder'
.group'fullLSch'
.nameinlist 'Полная форма реестра с лицевыми счетами'
.p 80
.var
    SumList : double
    KolList : double
    Pred2       : string
    NameReestr2 : string
    Получатель2 : string
    Расч_счет2  : string
    Код2        : string
    Банк2       : string
    Код_МФО2    : string
    Mes2        : string
    God2        : string
.endvar

.begin
  SumList := 0
  KolList := 1
end.

 И
.{
.{
.[h OverWrite
.begin
    Pred2       := Pred1
    NameReestr2 := NameReestr1
    Получатель2 := Получатель1
    Расч_счет2  := Расч_счет1
    Код2        := Код1
    Банк2       := Банк1
    Код_МФО2    := Код_МФО1
    Mes2        := Mes1
    God2        := God1
end.
.fields
Pred2
NameReestr2
Получатель2
Расч_счет2 Код2
Банк2
Код_МФО2 Mes2 God2
.endfields
 Р    Предприятие   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    ^
    Получатель    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    Расчетный счет получателя @@@@@@@@@@@@@@@  Код получателя @@@@@@@@@@
    Банк          @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    Код МФО банка @@@@@@@@@@@@       за ^ месяц &&&& г.
─────┬──────────────────────────────┬───────────────────────────────────────────┬───────────────────
 No- │ Номер лицевого счета         │              Фамилия И.О.                 │   Сумма
 п/п │                              │                                           │перечисления
─────┼──────────────────────────────┼───────────────────────────────────────────┼─────────────────── Ш
 И.]h
.{
.fields
  Npp Nom_lsch FIO Summa
.endfields
.begin
!Round - добавлен исходя из
! решения проблемы в ПИР 4.363
  SumList := Round(SumList,2) + Round(Summa,2)
end.
 Р&&&&&│&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│&'#&&&&&&&&&&&&&&&& Ш
 И.}
.[f OverWrite
.fields
  KolList
  SumList
  DoubleToString(0,SumList)
!  Рук_пред Гл_бухг
.endfields
 Р─────┴──────────────────────────────┴───────────────────────────────────────────┴───────────────────
 Итого по листу  &'&&:                                                        &'&&&&&&&&&&&&&&&.&&

     @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                                  (сумма по листу прописью) Ш
 И.begin
  SumList := 0
  KolList := KolList +1
end.

.]f
.}
.begin
  KolList := KolList - 1
end.
.fields
ItogSumma_Reestr
KolList  StrSumma1
StrSumma2
Рук_пред Гл_бухг
Pole
'true':'s'
.endFields
 С                          ВСЕГО К ПЕРЕЧИСЛЕНИЮ                                &'#&&&&&&&&&&&&&&&.&&
Количество листов &'&&    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                          @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                          (сумма прописью) Щ
 И   Рук. предприятия ^
                                                 _______________
                                                    (подпись)
   Гл. бухгалтер ^
                                                 _______________
                                                    (подпись)
                                                         @@@
.if BPRees
 ^
.end
.}
.fields
 ItogSumma
.endFields
.if ItogRees
 Р      ИТОГО УДЕРЖАНО С РАБОЧИХ И СЛУЖАЩИХ
      ДЛЯ ПЕРЕЧИСЛЕНИЯ __________________:                                      &'#&&&&&&&&&&&&&&&.&& Ш
 И.end
 И
.endform


.linkform 'reesuder_03' prototype is 'reesuder'
.group'fullTabNListSum'
.nameinlist 'Полная форма реестра с табельными номерами'
.p 80
.var
    SumList : double
    KolList : double
    Pred2       : string
    NameReestr2 : string
    Получатель2 : string
    Расч_счет2  : string
    Код2        : string
    Банк2       : string
    Код_МФО2    : string
    Mes2        : string
    God2        : string
.endvar

.begin
  SumList := 0
  KolList := 1
end.

 И
.{
.{
.[h OverWrite
.begin
    Pred2       := Pred1
    NameReestr2 := NameReestr1
    Получатель2 := Получатель1
    Расч_счет2  := Расч_счет1
    Код2        := Код1
    Банк2       := Банк1
    Код_МФО2    := Код_МФО1
    Mes2        := Mes1
    God2        := God1
end.
.fields
Pred2
NameReestr2
Получатель2
Расч_счет2 Код2
Банк2
Код_МФО2 Mes2 God2
.endfields
    Предприятие   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    ^
    Получатель    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    Расчетный счет получателя @@@@@@@@@@@@@@@  Код получателя @@@@@@@@@@
    Банк          @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    Код МФО банка @@@@@@@@@@@@       за ^ месяц &&&& г.
─────┬─────────┬───────────────────────────────────────────┬───────────────────
 No- │Табельный│              Фамилия И.О.                 │   Сумма
 п/п │  номер  │                                           │перечисления
─────┼─────────┼───────────────────────────────────────────┼───────────────────
.]h
.{
.fields
  Npp TabN FIO Summa
.endfields
.begin
!Round - добавлен исходя из
! решения проблемы в ПИР 4.363
  SumList := Round(SumList,2) + Round(Summa,2)
end.
&&&&&│@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│&'#&&&&&&&&&&&&&&&&
.}
.[f OverWrite
.fields
  KolList
  SumList
  DoubleToString(0,SumList)
!  Рук_пред Гл_бухг
.endfields
─────┴─────────┴───────────────────────────────────────────┴───────────────────
 Б Итого по листу  &'&&:                                     &'&&&&&&&&&&&&&&&.&& Б

     @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                                  (сумма по листу прописью)
.begin
  SumList := 0
  KolList := KolList +1
end.

.]f
.}
.begin
  KolList := KolList - 1
end.
.fields
ItogSumma_Reestr
KolList  StrSumma1
StrSumma2
Рук_пред Гл_бухг
Pole
'true':'s'
.endFields
 Б                          ВСЕГО К ПЕРЕЧИСЛЕНИЮ            &'#&&&&&&&&&&&&&&&.&& Б
Количество листов &'&&    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                          @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                          (сумма прописью)
   Рук. предприятия ^
                                                 _______________
                                                    (подпись)
   Гл. бухгалтер ^
                                                 _______________
                                                    (подпись)
                                                        @@@
.if BPRees
 ^
.end
.}
.fields
 ItogSumma
.endFields
.if ItogRees
      ИТОГО УДЕРЖАНО С РАБОЧИХ И СЛУЖАЩИХ
      ДЛЯ ПЕРЕЧИСЛЕНИЯ __________________:                &'#&&&&&&&&&&&&&&&.&&
.end
 И
.endform