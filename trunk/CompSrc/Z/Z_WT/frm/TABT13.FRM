/*
 ╔═══════════════════════════════════════════════════════════════════════════╗
 ║                     (c) 1994,2000 корпорация ГАЛАКТИКА                    ║
 ║ Проект        : ГАЛАКТИКА                                                 ║
 ║ Система       : Заработная плата                                          ║
 ║ Версия        : 5.70                                                      ║
 ║ Назначение    : Табель учета использования рабочего времени               ║
 ║                 (Типовая форма N Т-13)                                    ║
 ║ Ответственный : Маслакова Татьяна Владимировна                            ║
 ╚═══════════════════════════════════════════════════════════════════════════╝
*/
#doc
Табель учета использования рабочего времени
(Типовая форма N Т-13)
#end
.form TabT13
.p 80
.hide
.fields
  Pred
  Podr
  PeriodBeginning PeriodEnding

  Day_1 Day_2 Day_3 Day_4 Day_5 Day_6 Day_7 Day_8 Day_9 Day_10 Day_11 Day_12 Day_13 Day_14 Day_15
  Day_16 Day_17 Day_18 Day_19 Day_20 Day_21 Day_22 Day_23 Day_24 Day_25 Day_26 Day_27 Day_28 Day_29 Day_30 Day_31

  AnalitikName

  D1  D2  D3  D4  D5  D6  D7  D8  D9  D10 D11 D12 D13 D14 D15
  перв_пол_дни
  VidOpl1 Коррсчет1 Day1 Chas1 VidOpl2 Коррсчет2 Day2 Chas2 KodNejavki1 DayNejavok1 ChasNejavok1 KodNejavki2 DayNejavok2 ChasNejavok2
  Npp FIO месяц_дни TabN
  Ch1 Ch2 Ch3 Ch4
  Ch5 Ch6 Ch7 Ch8
  Ch9 Ch10 Ch11 Ch12
  Ch13 Ch14 Ch15
  перв_пол_часы
  VidOpl3 Коррсчет3 Day3 Chas3 VidOpl4 Коррсчет4 Day4 Chas4 KodNejavki3 DayNejavok3 ChasNejavok3 KodNejavki4 DayNejavok4 ChasNejavok4
  Dolg
  D16  D17  D18  D19  D20  D21  D22  D23  D24  D25  D26  D27  D28  D29  D30  D31
  втор_пол_дни
  VidOpl5 Коррсчет5 Day5 Chas5 VidOpl6 Коррсчет6 Day6 Chas6 KodNejavki5 DayNejavok5 ChasNejavok5 KodNejavki6 DayNejavok6 ChasNejavok6
  месяц_часы
  Ch16 Ch17 Ch18 Ch19
  Ch20 Ch21 Ch22 Ch23
  Ch24 Ch25 Ch26 Ch27
  Ch28 Ch29 Ch30 Ch31
  втор_пол_часы
  VidOpl7 Коррсчет7 Day7 Chas7 VidOpl8 Коррсчет8 Day8 Chas8 KodNejavki7 DayNejavok7 ChasNejavok7 KodNejavki8 DayNejavok8 ChasNejavok8
.endfields
.if Show_Analitik
.else
.end
.{ checkenter
 ^
 ^
 ^^
 ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^
.{
 ^
.{
 ^^^^^^^^^^^^^^^  ^ ^^^^^^^^ ^^^^^^
 ^^ ^^^^^^^^^^^^^^^  ^ ^^^^^^^^ ^^^^^^
 ^ ^
 ^^^^^^^^^^^^^^^^ ^ ^^^^^^^^ ^^^^^^
 ^ ^
 ^^^^^^^^^^^^^^^^ ^ ^^^^^^^^ ^^^^^^
.}
.}
.{ checkenter FirstPage
.}
.}
.endform
!
!
!
.linkform 'TabT13_01' prototype is 'TabT13'
.nameinlist 'Унифицированная форма №Т-13'
.group 'Т-13'
.p 56
.var
  FirstLine: boolean;
  AnFirstLine: boolean;
  LineCount: integer;
  LinesPerPage: integer;
  TimePrec: word;
  lShow_Analitik: boolean;
.endvar
.fields
! CommonFormHeader
 Pred
 Podr
 PeriodBeginning PeriodEnding

 Day_1 Day_2 Day_3 Day_4 Day_5 Day_6 Day_7 Day_8 Day_9 Day_10 Day_11 Day_12 Day_13 Day_14 Day_15
 Day_16 Day_17 Day_18 Day_19 Day_20 Day_21 Day_22 Day_23 Day_24 Day_25 Day_26 Day_27 Day_28 Day_29 Day_30 Day_31

 AnalitikName

 D1  D2  D3  D4  D5  D6  D7  D8  D9  D10 D11 D12 D13 D14 D15
 перв_пол_дни
 VidOpl1 Коррсчет1 Day1 Chas1 VidOpl2 Коррсчет2 Day2 Chas2 KodNejavki1 DayNejavok1 KodNejavki2 DayNejavok2
 Npp
 LogicSubStr(GetSurnameWithInitials(FIO), 22, false, false)
 TabN
 месяц_дни

  // отработанные часы
  Time2StrDefPrec(Ch1, TimePrec) Time2StrDefPrec(Ch2, TimePrec) Time2StrDefPrec(Ch3, TimePrec) Time2StrDefPrec(Ch4, TimePrec)
  Time2StrDefPrec(Ch5, TimePrec) Time2StrDefPrec(Ch6, TimePrec) Time2StrDefPrec(Ch7, TimePrec) Time2StrDefPrec(Ch8, TimePrec)
  Time2StrDefPrec(Ch9, TimePrec) Time2StrDefPrec(Ch10, TimePrec) Time2StrDefPrec(Ch11, TimePrec) Time2StrDefPrec(Ch12, TimePrec)
  Time2StrDefPrec(Ch13, TimePrec) Time2StrDefPrec(Ch14, TimePrec) Time2StrDefPrec(Ch15, TimePrec)

  Time2StrDefPrec(перв_пол_часы, TimePrec)

 VidOpl3 Коррсчет3 Day3 Chas3 VidOpl4 Коррсчет4 Day4 Chas4 KodNejavki3 DayNejavok3 KodNejavki4 DayNejavok4
 LogicSubStr(Dolg, 22, true, true)
 LogicSubStr(Dolg, 22, true, true)
 D16  D17  D18  D19  D20  D21  D22  D23  D24  D25  D26  D27  D28  D29  D30  D31
 втор_пол_дни
 VidOpl5 Коррсчет5 Day5 Chas5 VidOpl6 Коррсчет6 Day6 Chas6 KodNejavki5 DayNejavok5 KodNejavki6 DayNejavok6
 LogicSubStr(Dolg, 22, true, true)

  Time2StrDefPrec(месяц_часы, TimePrec)

  Time2StrDefPrec(Ch16, TimePrec) Time2StrDefPrec(Ch17, TimePrec) Time2StrDefPrec(Ch18, TimePrec) Time2StrDefPrec(Ch19, TimePrec)
  Time2StrDefPrec(Ch20, TimePrec) Time2StrDefPrec(Ch21, TimePrec) Time2StrDefPrec(Ch22, TimePrec) Time2StrDefPrec(Ch23, TimePrec)
  Time2StrDefPrec(Ch24, TimePrec) Time2StrDefPrec(Ch25, TimePrec) Time2StrDefPrec(Ch26, TimePrec) Time2StrDefPrec(Ch27, TimePrec)
  Time2StrDefPrec(Ch28, TimePrec) Time2StrDefPrec(Ch29, TimePrec) Time2StrDefPrec(Ch30, TimePrec) Time2StrDefPrec(Ch31, TimePrec)

  Time2StrDefPrec(втор_пол_часы, TimePrec)

  vidOpl7 Коррсчет7 Day7 Chas7 VidOpl8 Коррсчет8 Day8 Chas8 KodNejavki7 DayNejavok7 KodNejavki8 DayNejavok8

.endfields
.if Show_Analitik
.begin
  lShow_Analitik := true;
end.
.else
.begin
  lShow_Analitik := false;
end.
.end
.{ checkenter
 Ш                                                                                                                                                                                                     Унифицированная форма № Т-13
                                                                                                                                                                                                     Утверждена постановлением Госкомстата
                                                                                                                                                                                                     России от 05.01.2004 № 1

                                                                                                                                                                                                                                  ┌───────┐
                                                                                                                                                                                                                                  │  Код  │
                                                                                                                                                                                                                                  ├───────┤
                                                                                                                                                                                                                    Форма по ОКУД │0301008│
                                                                                                                                                                                                                                  ├───────┤
  Е@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е        по ОКПО │       │
                                                                                              наименование организации                                                                                                            ├───────┤
                                                                                                                                                                                                                                  │       │
  Е@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е                └───────┘
                                                                                      наименование структурного подразделения

                                                                                                                                                                                            ┌─────────┬───────────┐ ┌─────────────────────┐
                                                                                                                                                                                            │  Номер  │   Дата    │ │   Отчетный период   │
                                                                                                                                                                                            │документа│составления│ ├──────────┬──────────┤
                                                                                                                                                                                            │         │           │ │    с     │    по    │
                                                                                                                                                                                            ├─────────┼───────────┤ ├──────────┼──────────┤
                                                                                                                                                                                            │         │           │ │@@@@@@@@@@│@@@@@@@@@@│
                                                                                                       ТАБЕЛЬ                                                                               └─────────┴───────────┘ └──────────┴──────────┘
                                                                                                УЧЕТА РАБОЧЕГО ВРЕМЕНИ
╔═════╦══════════════════════╦══════════╦═══════════════════════════════════════════════════════════════════════════════════════════════╦═════════════╦═════════════════════════════════════════════════════════╦═════════════════════════╗
║Номер║Фамилия, инициалы,    ║ Табельный║                   Отметки о явках и неявках на работу по числам месяца                        ║Отработано за║        Данные для начисления заработной платы           ║   Неявки по причинам    ║
║по   ║должность             ║    номер ║                                                                                               ║             ║            по видам и направлениям затрат               ║                         ║
║по-  ║(специальность,       ║          ╟─────┬─────┬─────┬─────┬─────┬─────┬─────┬─────┬─────┬─────┬─────┬─────┬─────┬─────┬─────┬─────╫──────┬──────╫─────────────────────────────────────────────────────────╫─────┬──────┬─────┬──────╢
║рядку║профессия)            ║          ║     │     │     │     │     │     │     │     │     │     │     │     │     │     │     │     ║поло- │месяц ║                   код вида оплаты                       ║код  │дни   │код  │дни   ║
║     ║                      ║          ║  && │  && │  && │  && │  && │  && │  && │  && │  && │ &&  │ &&  │ &&  │ &&  │ &&  │ &&  │ Х   ║вину  │      ╟────────────────────────────┬────────────────────────────╢     │(часы)│     │(часы)║
║     ║                      ║          ║     │     │     │     │     │     │     │     │     │     │     │     │     │     │     │     ║месяца│      ╟────────────────────────────┴────────────────────────────╢     │      │     │      ║
║     ║                      ║          ║     │     │     │     │     │     │     │     │     │     │     │     │     │     │     │     ║(I,II)│      ║                 корреспондирующий счет                  ║     │      │     │      ║
║     ║                      ║          ╟─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────╫──────┴──────╫────────────────────────────┬────────────────────────────╢     │      │     │      ║
║     ║                      ║          ║     │     │     │     │     │     │     │     │     │     │     │     │     │     │     │     ║     дни     ╟──────┬─────────┬───────────┼──────┬─────────┬───────────╢     │      │     │      ║
║     ║                      ║          ║ &&  │ &&  │ &&  │ &&  │ &&  │ &&  │ &&  │ &&  │ &&  │ &&  │ &&  │ &&  │ &&  │ &&  │ &&  │ &&  ╟─────────────║код   │коррес-  │дни        │код   │коррес-  │дни        ║     │      │     │      ║
║     ║                      ║          ║     │     │     │     │     │     │     │     │     │     │     │     │     │     │     │     ║    часы     ║вида  │пондирую-│(часы)     │вида  │пондирую-│(часы)     ║     │      │     │      ║
║     ║                      ║          ║     │     │     │     │     │     │     │     │     │     │     │     │     │     │     │     ║             ║оплаты│щий счет │           │оплаты│щий счет │           ║     │      │     │      ║
╟─────╫──────────────────────╫──────────╫─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────╫──────┬──────╫──────┼─────────┼───────────┼──────┼─────────┼───────────╫─────┼──────┼─────┼──────╢
║  1  ║             2        ║     3    ║                                            4                                                  ║   5  │   6  ║  7   │     8   │     9     │  7   │    8    │    9      ║  10 │   11 │  10 │  11  ║
 Ш.{?internal; lShow_Analitik;
 Ш╠═════╩══════════════════════╩══════════╩═══════════════════════════════════════════════════════════════════════════════════════════════╩══════╧══════╩══════╧═════════╧═══════════╧══════╧═════════╧═══════════╩═════╧══════╧═════╧══════╣ Ш
.}
.{?internal; not lShow_Analitik;
 Ш╠═════╬══════════════════════╬══════════╬═════╤═════╤═════╤═════╤═════╤═════╤═════╤═════╤═════╤═════╤═════╤═════╤═════╤═════╤═════╤═════╬══════╪══════╬══════╪═════════╪═══════════╪══════╪═════════╪═══════════╬═════╪══════╪═════╪══════╣
 Ш.}
 Ш.begin
  FirstLine := true;
  LineCount := 39;
  LinesPerPage := 56;
  TimePrec := if(boGetTune('UP.ZAR.WT.EnhancedTimeFormat'), 0, 2);
end.
.{
 Ш.{?internal; lShow_Analitik;
.begin
  //должны уместится имя аналитики и хотя бы один табельный номер
  LineCount := LineCount + if (FirstLine, 9, 10);
end.
.{?internal;(LineCount > LinesPerPage - 1);
 Ш╚═════╩══════════════════════╩══════════╩═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╩══════╧══════╩══════╧═════════╧═══════════╧══════╧═════════╧═══════════╩═════╧══════╧═════╧══════╝ Ш
.begin
  LineCount := LineCount - if (FirstLine, 9, 10) + 1;
end.
.{ while (LineCount < LinesPerPage)
!забиваем пустыми строками до конца страницы

.begin
  LineCount := LineCount + 1;
end.
.}
 Ш╔═════╦══════════════════════╦══════════╦═══════════════════════════════════════════════════════════════════════════════════════════════╦══════╤══════╦══════╤═════════╤═══════════╤══════╤═════════╤═══════════╦═════╤══════╤═════╤══════╗
║  1  ║             2        ║     3    ║                                            4                                                  ║   5  │   6  ║  7   │     8   │     9     │  7   │    8    │    9      ║  10 │   11 │  10 │  11  ║
╠═════╩══════════════════════╩══════════╩═══════════════════════════════════════════════════════════════════════════════════════════════╩══════╧══════╩══════╧═════════╧═══════════╧══════╧═════════╧═══════════╩═════╧══════╧═════╧══════╣
 Ш.begin
  FirstLine := true;
  LineCount := 10;
end.
.}
.{?internal;not FirstLine;
 Ш╠═════╩══════════════════════╩══════════╩═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╩══════╧══════╩══════╧═════════╧═══════════╧══════╧═════════╧═══════════╩═════╧══════╧═════╧══════╣
 Ш.}
 Ш║ Аналитика: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Ш Ш@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ ║ Ш
 Ш╠═════╦══════════════════════╦══════════╦═════╤═════╤═════╤═════╤═════╤═════╤═════╤═════╤═════╤═════╤═════╤═════╤═════╤═════╤═════╤═════╦══════╤══════╦══════╤═════════╤═══════════╤══════╤═════════╤═══════════╦═════╤══════╤═════╤══════╣ Ш
.begin
  AnFirstLine := True;
  //восстановим счетчик за вычетом аналитики
  LineCount := LineCount - if (FirstLine, 7, 8);
end.
.} Ш
.{
.begin
  //с учетом разделительной линии между данными по двум табельным номерам (FirstLine = false), или без
  LineCount := LineCount + if (FirstLine, 7, 8);
end.
.{?internal;(LineCount > LinesPerPage - 1);
╚═════╩══════════════════════╩══════════╩═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╩══════╧══════╩══════╧═════════╧═══════════╧══════╧═════════╧═══════════╩═════╧══════╧═════╧══════╝
.begin
  LineCount := LineCount - if (FirstLine, 7, 8) + 1;
end.
.{ while (LineCount < LinesPerPage)
!забиваем пустыми строками до конца страницы

.begin
  LineCount := LineCount + 1;
end.
.}
╔═════╦══════════════════════╦══════════╦═══════════════════════════════════════════════════════════════════════════════════════════════╦══════╤══════╦══════╤═════════╤═══════════╤══════╤═════════╤═══════════╦═════╤══════╤═════╤══════╗
║  1  ║             2        ║     3    ║                                            4                                                  ║   5  │   6  ║  7   │     8   │     9     │  7   │    8    │    9      ║  10 │   11 │  10 │  11  ║
╠═════╬══════════════════════╬══════════╬═════╤═════╤═════╤═════╤═════╤═════╤═════╤═════╤═════╤═════╤═════╤═════╤═════╤═════╤═════╤═════╬══════╪══════╬══════╪═════════╪═══════════╪══════╪═════════╪═══════════╬═════╪══════╪═════╪══════╣
.begin
  FirstLine := true;
  LineCount := 10;
end.
.}
.{?internal;(not FirstLine)  Шand (not AnFirstLine) Ш;
╠═════╬══════════════════════╬══════════╬═════╪═════╪═════╪═════╪═════╪═════╪═════╪═════╪═════╪═════╪═════╪═════╪═════╪═════╪═════╪═════╬══════╪══════╬══════╪═════════╪═══════════╪══════╪═════════╪═══════════╬═════╪══════╪═════╪══════╣
.}
║     ║                      ║          ║@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│  Х  ║&&&.&&│      ║@@@@@@│@@@@@@@@@│&&.& &&&.&&│@@@@@@│@@@@@@@@@│&&.& &&&.&&║@~@@@│ &&&& │@~@@@│&&&&  ║
║&&&&&║@@@@@@@@@@@@@@@@@@@@@@║&&&&&&&&&&╟─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────╫──────┤&&&.&&╟──────┼─────────┤           ├──────┼─────────┤           ║─────┼──────┼─────┼──────╢
║     ║                      ║          ║&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│  Х  ║&&&&&&│      ║@@@@@@│@@@@@@@@@│&&.& &&&.&&│@@@@@@│@@@@@@@@@│&&.& &&&.&&║@~@@@│ &&&& │@~@@@│&&&&  ║
║     ║@@@@@@@@@@@@@@@@@@@@@@║          ╟─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────╫──────┼──────╟──────┼─────────┼───────────┼──────┼─────────┼───────────╢─────┼──────┼─────┼──────╢
║     ║@@@@@@@@@@@@@@@@@@@@@@║          ║@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@│@~@@@║&&&.&&│      ║@@@@@@│@@@@@@@@@│&&.& &&&.&&│@@@@@@│@@@@@@@@@│&&.& &&&.&&║@~@@@│&&&&  │@~@@@│&&&&  ║
║     ║@@@@@@@@@@@@@@@@@@@@@@║          ╟─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────╫──────┤&&&.&&╟──────┼─────────┤           ├──────┼─────────┤           ║─────┼──────┼─────┼──────╢
║     ║                      ║          ║&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&│&&&&&║&&&&&&│      ║@@@@@@│@@@@@@@@@│&&.& &&&.&&│@@@@@@│@@@@@@@@@│&&.& &&&.&&║@~@@@│&&&&  │@~@@@│&&&&  ║
.begin
  FirstLine := false;
   ШAnFirstLine := false; Ш
end.
.}
.}
╚═════╩══════════════════════╩══════════╩═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╧═════╩══════╧══════╩══════╧═════════╧═══════════╧══════╧═════════╧═══════════╩═════╧══════╧═════╧══════╝

Ответственное                                         Руководитель
лицо ___________ _________ _____________________      структурного подразделения ___________ _________ _____________________  "__" __________ 20__ года
      должность   подпись   расшифровка подписи                                   должность   подпись   расшифровка подписи
                                                      Работник
                                                      кадровой службы            ___________ _________ _____________________  "__" __________ 20__ года
                                                                                  должность   подпись   расшифровка подписи Ш
.begin
  LineCount := if((LineCount + 8) > LinesPerPage, LineCount + 8 - LinesPerPage, LineCount + 8);
end.
.{ while (LineCount < LinesPerPage)
!забиваем пустыми строками до конца страницы

.begin
  LineCount := LineCount + 1;
end.
.}
.{ checkenter FirstPage
.}
.}
 а
.endform