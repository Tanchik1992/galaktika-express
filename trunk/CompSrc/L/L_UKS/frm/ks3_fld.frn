.fields
!Шапка
  strHeader
  #OrgOnlyNoUNN (Инвестор)
  Инвестор_ОКПО
  #OrgOnlyNoUNN (Заказчик)
  Заказчик_ОКПО
  #OrgOnlyNoUNN (Подрядчик)
  Подрядчик_ОКПО
#ifdef KS_3_GR
  Стройка + if(Стройка_Адрес <> '', ' Адрес: ' + Стройка_Адрес, '')
#else
  Объект  + if (Trim(Объект_Аббр) = '', '', ', инв.№' + Объект_Аббр)
#end
  Заказчик_ОКДП
  Договор_Номер
  if (Договор_Дата = Date(0, 0, 0), '', DateToStr(Договор_Дата, 'DD'))
  if (Договор_Дата = Date(0, 0, 0), '', DateToStr(Договор_Дата, 'MM'))
  if (Договор_Дата = Date(0, 0, 0), '', DateToStr(Договор_Дата, 'YYYY'))
  Номер Дата
  if (Период_С  = Date(0,0,0), '', DateToStr(Период_С,  'DD.MM.YYYY'))
  if (Период_По = Date(0,0,0), '', DateToStr(Период_По, 'DD.MM.YYYY'))

#ifdef KS_IN_NDE
  Цена_НДЕ
  if (IsBasePrice, DoubleToStr(Итого_Баз_НДЕ,     Cena_PrR), DoubleToStr(Итого_НДЕ,     Cena_PrR))
  if (IsBasePrice, DoubleToStr(Итого_Баз_Год_НДЕ, Cena_PrR), DoubleToStr(Итого_Год_НДЕ, Cena_PrR))
  if (IsBasePrice, DoubleToStr(Итого_Баз_Пер_НДЕ, Cena_PrR), DoubleToStr(Итого_Пер_НДЕ, Cena_PrR))
#else
  Цена_Валюта
  if (IsBasePrice, DoubleToStr(Итого_Баз,     Cena_Pr), DoubleToStr(Итого,     Cena_Pr))
  if (IsBasePrice, DoubleToStr(Итого_Баз_Год, Cena_Pr), DoubleToStr(Итого_Год, Cena_Pr))
  if (IsBasePrice, DoubleToStr(Итого_Баз_Пер, Cena_Pr), DoubleToStr(Итого_Пер, Cena_Pr))
#end

!Название объекта
#ifdef KS_3_GR
  StrNN
#ifdef KS_IN_NDE
  Цена_НДЕ
#else
  Цена_Валюта
#end
  InsAfterAllSimbol(Об_Имя)
#end

!новая страница
  StrNN
#ifdef KS_IN_NDE
  Цена_НДЕ
#else
  Цена_Валюта
#end
!итого по странице
#ifdef KS_IN_NDE
  DoubleToStr(Sum1Itog,    Cena_PrR)
  DoubleToStr(Sum1ItogNDS, Cena_PrR)
  DoubleToStr(Sum1Itog + if (isNalogs, 0, Sum1ItogNal), Cena_PrR)
#else
  DoubleToStr(Sum1Itog,    Cena_Pr)
  DoubleToStr(Sum1ItogNDS, Cena_Pr)
  DoubleToStr(Sum1Itog + if (isNalogs, 0, Sum1ItogNal), Cena_Pr)
#end
#ifdef KS_IN_NDE
  DoubleToStr(Sum1Itog, Cena_PrR)
#else
  DoubleToStr(Sum1Itog, Cena_Pr)
#end

!новая страница
  StrNN
#ifdef KS_IN_NDE
  Цена_НДЕ
#else
  Цена_Валюта
#end
!спецификация документа
  iNpp  Сп_Имя  Сп_Код
#ifdef KS_IN_NDE
  if (IsBasePrice, DoubleToStr(Сп_НачБ_НДЕ, Cena_PrR), DoubleToStr(Сп_Нач_НДЕ, Cena_PrR))
  if (IsBasePrice, DoubleToStr(Сп_ГодБ_НДЕ, Cena_PrR), DoubleToStr(Сп_Год_НДЕ, Cena_PrR))
  if (IsBasePrice, DoubleToStr(Сп_ПерБ_НДЕ, Cena_PrR), DoubleToStr(Сп_Пер_НДЕ, Cena_PrR))
#else
  if (IsBasePrice, DoubleToStr(Сп_НачБ, Cena_Pr), DoubleToStr(Сп_Нач, Cena_Pr))
  if (IsBasePrice, DoubleToStr(Сп_ГодБ, Cena_Pr), DoubleToStr(Сп_Год, Cena_Pr))
  if (IsBasePrice, DoubleToStr(Сп_ПерБ, Cena_Pr), DoubleToStr(Сп_Пер, Cena_Pr))
#end
!итого по странице
#ifdef KS_IN_NDE
  DoubleToStr(Sum1Itog,    Cena_PrR)
  DoubleToStr(Sum1ItogNDS, Cena_PrR)
  DoubleToStr(Sum1Itog + if (isNalogs, 0, Sum1ItogNal), Cena_PrR)
#else
  DoubleToStr(Sum1Itog,    Cena_Pr)
  DoubleToStr(Sum1ItogNDS, Cena_Pr)
  DoubleToStr(Sum1Itog + if (isNalogs, 0, Sum1ItogNal), Cena_Pr)
#end
#ifdef KS_IN_NDE
  DoubleToStr(Sum1Itog, Cena_PrR)
#else
  DoubleToStr(Sum1Itog, Cena_Pr)
#end

!новая страница
  StrNN
#ifdef KS_IN_NDE
  Цена_НДЕ
#else
  Цена_Валюта
#end
!итого по объекту
#ifdef KS_3_GR
 #ifdef KS_IN_NDE
  if (IsBasePrice, DoubleToStr(Об_НачБ_НДЕ, Cena_PrR), DoubleToStr(Об_Нач_НДЕ, Cena_PrR))
  if (IsBasePrice, DoubleToStr(Об_ГодБ_НДЕ, Cena_PrR), DoubleToStr(Об_Год_НДЕ, Cena_PrR))
  if (IsBasePrice, DoubleToStr(Об_ПерБ_НДЕ, Cena_PrR), DoubleToStr(Об_Пер_НДЕ, Cena_PrR))
 #else
  if (IsBasePrice, DoubleToStr(Об_НачБ, Cena_Pr), DoubleToStr(Об_Нач, Cena_Pr))
  if (IsBasePrice, DoubleToStr(Об_ГодБ, Cena_Pr), DoubleToStr(Об_Год, Cena_Pr))
  if (IsBasePrice, DoubleToStr(Об_ПерБ, Cena_Pr), DoubleToStr(Об_Пер, Cena_Pr))
 #end
  Об_Имя
 #ifdef KS_IN_NDE
  DoubleToStr(Об_НачБ_НДЕ, Cena_PrR)
  DoubleToStr(Об_ГодБ_НДЕ, Cena_PrR)
  DoubleToStr(Об_ПерБ_НДЕ, Cena_PrR)
 #else
  DoubleToStr(Об_НачБ, Cena_Pr)
  DoubleToStr(Об_ГодБ, Cena_Pr)
  DoubleToStr(Об_ПерБ, Cena_Pr)
 #end
#end

!итого по странице
#ifdef KS_IN_NDE
  DoubleToStr(Sum1Itog,    Cena_PrR)
  DoubleToStr(Sum1ItogNDS, Cena_PrR)
  DoubleToStr(Sum1Itog + if (isNalogs, 0, Sum1ItogNal), Cena_PrR)
#else
  DoubleToStr(Sum1Itog,    Cena_Pr)
  DoubleToStr(Sum1ItogNDS, Cena_Pr)
  DoubleToStr(Sum1Itog + if (isNalogs, 0, Sum1ItogNal), Cena_Pr)
#end
#ifdef KS_IN_NDE
  DoubleToStr(Sum1Itog, Cena_PrR)
#else
  DoubleToStr(Sum1Itog, Cena_Pr)
#end

!новая страница
  StrNN
#ifdef KS_IN_NDE
  Цена_НДЕ
#else
  Цена_Валюта
#end
!Итого по налогам
#ifdef KS_3_GR
 #ifdef KS_IN_NDE
  DoubleToStr(Об_Нач_Нал_НДЕ, Cena_PrR)
  DoubleToStr(Об_Год_Нал_НДЕ, Cena_PrR)
  DoubleToStr(Об_Пер_Нал_НДЕ, Cena_PrR)
 #else
  DoubleToStr(Об_Нач_Нал, Cena_Pr)
  DoubleToStr(Об_Год_Нал, Cena_Pr)
  DoubleToStr(Об_Пер_Нал, Cena_Pr)
 #end
#end

#ifdef KS_3_GR
!Итого по объекту
  Об_Имя
#ifdef KS_IN_NDE
  DoubleToStr(Об_Нач_Всего_НДЕ, Cena_PrR)
  DoubleToStr(Об_Год_Всего_НДЕ, Cena_PrR)
  DoubleToStr(Об_Пер_Всего_НДЕ, Cena_PrR)
#else
  DoubleToStr(Об_Нач_Всего, Cena_Pr)
  DoubleToStr(Об_Год_Всего, Cena_Pr)
  DoubleToStr(Об_Пер_Всего, Cena_Pr)
#end
#end

!итого по странице
#ifdef KS_IN_NDE
  DoubleToStr(Sum1Itog,    Cena_PrR)
  DoubleToStr(Sum1ItogNDS, Cena_PrR)
  DoubleToStr(Sum1Itog + if (isNalogs, 0, Sum1ItogNal), Cena_PrR)
#else
  DoubleToStr(Sum1Itog,    Cena_Pr)
  DoubleToStr(Sum1ItogNDS, Cena_Pr)
  DoubleToStr(Sum1Itog + if (isNalogs, 0, Sum1ItogNal), Cena_Pr)
#end
#ifdef KS_IN_NDE
  DoubleToStr(Sum1Itog, Cena_PrR)
#else
  DoubleToStr(Sum1Itog, Cena_Pr)
#end

!итого по странице
#ifdef KS_IN_NDE
  DoubleToStr(Sum1Itog,    Cena_PrR)
  DoubleToStr(Sum1ItogNDS, Cena_PrR)
  DoubleToStr(Sum1Itog + if (isNalogs, 0, Sum1ItogNal), Cena_PrR)
#else
  DoubleToStr(Sum1Itog,    Cena_Pr)
  DoubleToStr(Sum1ItogNDS, Cena_Pr)
  DoubleToStr(Sum1Itog + if (isNalogs, 0, Sum1ItogNal), Cena_Pr)
#end
#ifdef KS_IN_NDE
  DoubleToStr(Sum1Itog, Cena_PrR)
#else
  DoubleToStr(Sum1Itog, Cena_Pr)
#end

!итого по документу
#ifdef KS_IN_NDE
  DoubleToStr(Итого_Пер_НДЕ,       Cena_PrR)
  DoubleToStr(Итого_НДС_Пер_НДЕ,   Cena_PrR)
  DoubleToStr(Итого_С_НДС_Пер_НДЕ, Cena_PrR)
#else
  DoubleToStr(Итого_Пер,       Cena_Pr)
  DoubleToStr(Итого_НДС_Пер,   Cena_Pr)
  DoubleToStr(Итого_С_НДС_Пер, Cena_Pr)
#end
#ifdef KS_IN_NDE
  DoubleToStr(Итого_Баз_Пер_НДЕ,   Cena_PrR)
#else
  DoubleToStr(Итого_Баз_Пер,       Cena_Pr)
#end
#ifdef KS_3_GR
#ifdef KS_IN_NDE
  DoubleToStr(Итого_Пер_НДЕ,       Cena_PrR)
  DoubleToStr(Итого_НДС_Пер_НДЕ,   Cena_PrR)
  DoubleToStr(Итого_С_НДС_Пер_НДЕ, Cena_PrR)
#else
  DoubleToStr(Итого_Пер,       Cena_Pr)
  DoubleToStr(Итого_НДС_Пер,   Cena_Pr)
  DoubleToStr(Итого_С_НДС_Пер, Cena_Pr)
#end
#end
.endfields
