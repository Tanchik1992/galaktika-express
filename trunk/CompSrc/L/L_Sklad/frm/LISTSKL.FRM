/*
 ╔═══════════════════════════════════════════════════════════════════════════╗
 ║                     (c) 1994,97 корпорация ГАЛАКТИКА                      ║
 ║ Проект        : ГАЛАКТИКА                                                 ║
 ║ Система       : Основные средства                                         ║
 ║ Версия        : 5.00                                                      ║
 ║ Назначение    : Реестр ордеров                                            ║
 ║ Ответственный : Крахотко Александр Валерьевич (КРОХА)                     ║
 ║ Параметры     : есть                                                      ║
 ╚═══════════════════════════════════════════════════════════════════════════╝
*/

#INCLUDE listskl.pro // форма прототип

#doc
Краткий отчет с учетными единицами измерения
#end
.linkform 'listskl_101' prototype is 'listskl'
.nameInList 'Краткий отчет с учетными единицами измерения'
.group 'Краткий отчет'
.fields
  CommonFormHeader
.endfields
^
.fields
DateToStr(начальная_дата,'DD/MM/YYYY')
DateToStr(конечная_дата,'DD/MM/YYYY')
разрез_склад
разрез_мол
поле_1
поле_2
  ордер_дата
  ордер_номер
  ордер_склад
  ордер_мол
  ордер_накладная_организация
   // суммы по ордеру
   ордер_сум_нде substr(символ_нде,1,4)
//   ордер_сум_отч substr(символ_отч,1,4)
   ордер_сум_вал substr(символ_вал,1,4) 
.endfields

     БРЕЕСТР СКЛАДСКИХ ОРДЕРОВ Б С ^ ПО ^

    ^
    ^
 Р───────────────┬─────────┬──────────────────┬─────────────────┬────────────────────┬────────────────────┬─────────────────────
     Дата      │ Номер   │ Склад            │ Мол             │ Контрагент         │ Сумма              │ Сумма
               │         │                  │                 │                    │ в НДЕ              │ в валюте док-та
───────────────┴─────────┴──────────────────┴─────────────────┴────────────────────┴────────────────────┴───────────────────── Р
.{ ListSklCycleMain
 С^ С
.{ ListSklCycle1
   С^ С
.{ ListSklCycleOrder
.{ ListSklCycleMC
.}
 Р    @@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@ &&&&&&&&&&&&.&& @@@@ &&&&&&&&&&&&.&& @@@@ Р
.}
.{?Internal;length(trim(поле_2))>0
.fields
   у2_сум_нде    символ_нде
.endfields
 С  ИТОГО :                                                                           &&&&&&&&&&&&.&& @@@@ С
.} // ?Internal
.}
.{?Internal;length(trim(поле_1))>0
.fields
   у1_сум_нде    символ_нде
.endfields
 СИТОГО :                                                                             &&&&&&&&&&&&.&& @@@@ С
.} // ?Internal
.}

.fields
   у0_сум_нде    символ_нде
.endfields
 СИТОГО ПО ОТЧЕТУ :                                                                   &&&&&&&&&&&&.&& @@@@ С
.endform

#doc
Полный отчет с учетными единицами измерения со всеми ценами
#end
.linkform 'listskl_201' prototype is 'listskl'
.nameInList 'Полный отчет с учетными единицами измерения со всеми ценами'
.group 'Полный отчет'
.fields
  CommonFormHeader
.endfields
^
.fields
DateToStr(начальная_дата,'DD/MM/YYYY')
DateToStr(конечная_дата,'DD/MM/YYYY')
разрез_склад
разрез_мол
поле_1
поле_2
  ордер_номер
  ордер_дата
  ордер_склад
  ордер_мол
  ордер_накладная_организация
    мц_имя
    мц_баркод
    мц_партия
    ед_изм_имя
    мц_кол_уч
    символ_нде мц_цена_нде_уч мц_сум_нде
    символ_вал мц_цена_вал_уч
    символ_отч мц_цена_отч_уч
    символ_баз мц_цена_баз_уч
   // суммы по ордеру
   ордер_сум_нде substr(символ_нде,1,4)
   ордер_сум_отч substr(символ_отч,1,4)
.endfields

     БРЕЕСТР СКЛАДСКИХ ОРДЕРОВ Б С ^ ПО ^

    ^
    ^
.{ ListSklCycleMain
 Б^ Б
.{ ListSklCycle1
   Б^ Б
.{ ListSklCycleOrder
     Бордер N Б  Р^ Р  Бот Б  Р^ Р  Бна склад Б " Р^ Р",  Бмол Б " Р^ Р",  Бконтрагент Б " Ш^ Ш"
 Р     ────────────────────┬──────────────┬──────────────┬──────────┬─────────────┬───────┬─────────────────┬──────────────
      Наименование МЦ    │ Ном. номер   │ Партия       │ Уч.ЕдИзм │Количество   │Валюта │Цена             │ Сумма
     ────────────────────┴──────────────┴──────────────┴──────────┴─────────────┴───────┴─────────────────┴────────────── Р
.{ ListSklCycleMC
 Р     @@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@ @@@@@@@@@@@@@@ @@@@@@@@@@ &&&&&&&&&&&.& @@@@@@@ &&&&&&&&&.& (НДЕ) &&&&&&&&&&&&.&
                                                                                 @@@@@@@ &&&&&&&&&.& (валюта ордера)
                                                                                 @@@@@@@ &&&&&&&&&.& (валюта для отчетов)
                                                                                 @@@@@@@ &&&&&&&&&.& (базовая валюта) Р
.}
 Б    сумма по ордеру &&&&&&&&&&&&.&& @@@@
                    &&&&&&&&&&&&.&& @@@@ Б
.}
.{?Internal;length(trim(поле_2))>0
.fields
   trim(string(у2_сум_нде,15,2))    символ_нде
.endfields
 Б  Всего : ^ ^ Б
.} // ?Internal
.}
.{?Internal;length(trim(поле_1))>0
.fields
   trim(string(у1_сум_нде,15,2))    символ_нде
.endfields
 БВсего : ^ ^ Б
.} // ?Internal
.}

.fields
   trim(string(у0_сум_нде,15,2))    символ_нде
.endfields
 БИТОГО ПО ОТЧЕТУ : ^ ^ Б
.endform

#doc
Полный отчет с учетными единицами измерения в НДЕ
#end
.linkform 'listskl_211' prototype is 'listskl'
.nameInList 'Полный отчет с учетными единицами измерения в НДЕ'
.group 'Полный отчет'
.fields
  CommonFormHeader
.endfields
^
.fields
DateToStr(начальная_дата,'DD/MM/YYYY')
DateToStr(конечная_дата,'DD/MM/YYYY')
разрез_склад
разрез_мол
поле_1
поле_2
  ордер_номер
  ордер_дата
  ордер_склад
  ордер_мол
  ордер_накладная_организация
    мц_имя
    мц_баркод
    мц_партия
    ед_изм_имя
    мц_кол_уч
    символ_нде мц_цена_нде_уч  мц_сум_нде
   // суммы по ордеру
   ордер_сум_нде substr(символ_нде,1,4)
.endfields

     БРЕЕСТР СКЛАДСКИХ ОРДЕРОВ Б С ^ ПО ^

    ^
    ^
.{ ListSklCycleMain
^
.{ ListSklCycle1
  ^
.{ ListSklCycleOrder
     Бордер N Б  Р^ Р  Бот Б  Р^ Р  Бна склад Б " Р^ Р",  Бмол Б " Р^ Р",  Бконтрагент Б " Ш^ Ш"
 Р     ────────────────────┬──────────────┬──────────────┬──────────┬─────────────┬───────┬───────────┬──────────────
     Наименование МЦ     │ Ном. номер   │ Партия       │ Уч.ЕдИзм │Количество   │Валюта │Цена       │ Сумма
     ────────────────────┴──────────────┴──────────────┴──────────┴─────────────┴───────┴───────────┴────────────── Р
.{ ListSklCycleMC
 Р     @@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@ @@@@@@@@@@@@@@ @@@@@@@@@@ &&&&&&&&&&&.& @@@@@@@ &&&&&&&&.&& &&&&&&&&&&&.&& Р
.}
    сумма по ордеру &&&&&&&&&&&&.&& @@@@
.}
.{?Internal;length(trim(поле_2))>0
.fields
   trim(string(у2_сум_нде,15,2))    символ_нде
.endfields
  ИТОГО : ^ ^
.} // ?Internal
.}
.{?Internal;length(trim(поле_1))>0
.fields
   trim(string(у1_сум_нде,15,2))    символ_нде
.endfields
ИТОГО : ^ ^
.} // ?Internal
.}

.fields
   trim(string(у0_сум_нде,15,2))    символ_нде
.endfields
 БИТОГО ПО ОТЧЕТУ : ^ ^ Б
.endform

#doc
Полный отчет с учетными единицами измерения в валюте ордера
#end
.linkform 'listskl_221' prototype is 'listskl'
.nameInList 'Полный отчет с учетными единицами измерения в валюте ордера'
.group 'Полный отчет'
.fields
  CommonFormHeader
.endfields
^
.fields
DateToStr(начальная_дата,'DD/MM/YYYY')
DateToStr(конечная_дата,'DD/MM/YYYY')
разрез_склад
разрез_мол
поле_1
поле_2
  ордер_номер
  ордер_дата
  ордер_склад
  ордер_мол
  ордер_накладная_организация
    мц_имя
    мц_баркод
    мц_партия
    ед_изм_имя
    мц_кол_уч
    символ_вал мц_цена_вал_уч  мц_сум_вал
   // суммы по ордеру
   ордер_сум_отч substr(символ_отч,1,4)
.endfields

     БРЕЕСТР СКЛАДСКИХ ОРДЕРОВ Б С ^ ПО ^

    ^
    ^
.{ ListSklCycleMain
^
.{ ListSklCycle1
  ^
.{ ListSklCycleOrder
     Бордер N Б  Р^ Р  Бот Б  Р^ Р  Бна склад Б " Р^ Р",  Бмол Б " Р^ Р",  Бконтрагент Б " Р^ Р"
 Р     ────────────────────┬──────────────┬──────────────┬──────────┬─────────────┬───────┬───────────┬──────────────
     Наименование МЦ     │ Ном. номер   │ Партия       │ Уч.ЕдИзм │Количество   │Валюта │Цена       │ Сумма
     ────────────────────┴──────────────┴──────────────┴──────────┴─────────────┴───────┴───────────┴────────────── Р
.{ ListSklCycleMC
 Р     @@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@ @@@@@@@@@@@@@@ @@@@@@@@@@ &&&&&&&&&&&.& @@@@@@@ &&&&&&&&.&& &&&&&&&&&&&.&& Р
.}
    сумма по ордеру &&&&&&&&&&&&.&& @@@@
.}
.{?Internal;length(trim(поле_2))>0
.fields
   trim(string(у2_сум_нде,15,2))    символ_нде
.endfields
  ИТОГО : ^ ^
.} // ?Internal
.}
.{?Internal;length(trim(поле_1))>0
.fields
   trim(string(у1_сум_нде,15,2))    символ_нде
.endfields
ИТОГО : ^ ^
.} // ?Internal
.}

.fields
   trim(string(у0_сум_нде,15,2))    символ_нде
.endfields
 БИТОГО ПО ОТЧЕТУ : ^ ^ Б
.endform

#doc
Полный отчет с учетными единицами измерения в валюте для отчетов
#end
.linkform 'listskl_231' prototype is 'listskl'
.nameInList 'Полный отчет с учетными единицами измерения в валюте для отчетов'
.group 'Полный отчет'
.fields
  CommonFormHeader
.endfields
^
.fields
DateToStr(начальная_дата,'DD/MM/YYYY')
DateToStr(конечная_дата,'DD/MM/YYYY')
разрез_склад
разрез_мол
поле_1
поле_2
  ордер_номер
  ордер_дата
  ордер_склад
  ордер_мол
  ордер_накладная_организация
    мц_имя
    мц_баркод
    мц_партия
    ед_изм_имя
    мц_кол_уч
    символ_отч мц_цена_отч_уч мц_сум_отч
   // суммы по ордеру
   ордер_сум_отч substr(символ_отч,1,4)
.endfields

     БРЕЕСТР СКЛАДСКИХ ОРДЕРОВ  БС ^ ПО ^

    ^
    ^
.{ ListSklCycleMain
^
.{ ListSklCycle1
  ^
.{ ListSklCycleOrder
     Бордер N  С^ Р  Бот Б  Р^ Р  Бна склад Б " Р^ Р",  Бмол Б " Р^ Р",  Бконтрагент Б " Ш^ Ш"
 Р     ────────────────────┬──────────────┬──────────────┬──────────┬─────────────┬───────┬───────────┬──────────────
     Наименование МЦ     │ Ном. номер   │ Партия       │ Уч.ЕдИзм │Количество   │Валюта │Цена       │ Сумма
     ────────────────────┴──────────────┴──────────────┴──────────┴─────────────┴───────┴───────────┴────────────── Р
.{ ListSklCycleMC
 Р     @@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@ @@@@@@@@@@@@@@ @@@@@@@@@@ &&&&&&&&&&&.& @@@@@@@ &&&&&&&&.&& &&&&&&&&&&&.&& Р
.}
    сумма по ордеру &&&&&&&&&&&&.&& @@@@
.}
.{?Internal;length(trim(поле_2))>0
.fields
   trim(string(у2_сум_отч,15,2))    символ_отч
.endfields
  ИТОГО : ^ ^
.} // ?Internal
.}
.{?Internal;length(trim(поле_1))>0
.fields
   trim(string(у1_сум_отч,15,2))    символ_отч
.endfields
ИТОГО : ^ ^
.} // ?Internal
.}

.fields
   trim(string(у0_сум_отч,15,2))    символ_отч
.endfields
 БИТОГО ПО ОТЧЕТУ : ^ ^ Б
.endform

#doc
Полный отчет с учетными единицами измерения в базовой валюте
#end
.linkform 'listskl_241' prototype is 'listskl'
.nameInList 'Полный отчет с учетными единицами измерения в базовой валюте'
.group 'Полный отчет'
.fields
  CommonFormHeader
.endfields
^
.fields
DateToStr(начальная_дата,'DD/MM/YYYY')
DateToStr(конечная_дата,'DD/MM/YYYY')
разрез_склад
разрез_мол
поле_1
поле_2
  ордер_номер
  ордер_дата
  ордер_склад
  ордер_мол
  ордер_накладная_организация
    мц_имя
    мц_баркод
    мц_партия
    ед_изм_имя
    мц_кол_уч
    символ_баз мц_цена_баз_уч  мц_сум_баз
   // суммы по ордеру
   ордер_сум_баз substr(символ_баз,1,4)
.endfields

     БРЕЕСТР СКЛАДСКИХ ОРДЕРОВ  БС ^ ПО ^

    ^
    ^
.{ ListSklCycleMain
^
.{ ListSklCycle1
  ^
.{ ListSklCycleOrder
     Бордер N Б  Р^ Р  Бот Б  Р^ Р  Бна склад Б " Р^ Р",  Бмол Б " Р^ Р",  Бконтрагент Б " Р^ Р"
 Р     ────────────────────┬──────────────┬──────────────┬──────────┬─────────────┬───────┬───────────┬──────────────
     Наименование МЦ     │ Ном. номер   │ Партия       │ Уч.ЕдИзм │Количество   │Валюта │Цена       │ Сумма
     ────────────────────┴──────────────┴──────────────┴──────────┴─────────────┴───────┴───────────┴────────────── Р
.{ ListSklCycleMC
 Р     @@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@ @@@@@@@@@@@@@@ @@@@@@@@@@ &&&&&&&&&&&.& @@@@@@@ &&&&&&&&.&& &&&&&&&&&&&.&& Р
.}
    сумма по ордеру &&&&&&&&&&&&.&& @@@@
.}
.{?Internal;length(trim(поле_2))>0
.fields
   trim(string(у2_сум_баз,15,2))    символ_баз
.endfields
  ИТОГО : ^ ^
.} // ?Internal
.}
.{?Internal;length(trim(поле_1))>0
.fields
   trim(string(у1_сум_баз,15,2))    символ_баз
.endfields
ИТОГО : ^ ^
.} // ?Internal
.}

.fields
   trim(string(у0_сум_баз,15,2))    символ_баз
.endfields
 БИТОГО ПО ОТЧЕТУ : ^ ^ Б
.endform
