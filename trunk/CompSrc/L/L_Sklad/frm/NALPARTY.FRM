/*
 ╔════════════════════════════════════════════════════════════════════════════╗
 ║                     (c) Корпорация ГАЛАКТИКА, 1996,97                      ║
 ║ Проект        : ГАЛАКТИКА                                                  ║
 ║ Система       : Оперативный контур                                         ║
 ║ Версия        : 5.50                                                       ║
 ║ Назначение    : наличие в разрезе партий                                   ║
 ║ Ответственный : Бартош Евгений Анатольевич                                 ║
 ╚════════════════════════════════════════════════════════════════════════════╝
*/
#doc
Наличие в разрезе партий
#end
.set name='NalParty'
.hide
.var
 sum      : double;
 sumv     : double;
 parsum   : double;
 parsumv  : double;
 podrsum  : double;
 podrsumv : double;
 totsum   : double;
 totsumv  : double;
.endvar

.fields
  date1 : date
  tar
  bas

  cParty : comp
  nameparty
  kodparty
  dgodn
  nvaluch
  cValUch : comp

  namepodr
  kodpodr

  nRecMC : comp
  namemc
  nameed
  price   : double
  pricev  : double
  kol     : double
  SizeX   : double
  SizeY   : double
  SizeZ   : double
  Value   : double
  Massa   : double
.endfields
^
^
^
.begin
  TotSum  := 0;
  TotSumV := 0;
  InitGetCur;
 end.
.{
.begin
  ParSum  := 0;
  ParSumV := 0;
 end.
^
^
^
^
^
^
.{
.begin
  PodrSum  := 0;
  PodrSumV := 0;
 end.
.if npBySklad1
^
^
.end
.{
^
^
^
^
^
^
^
^
^
^
^
.begin
  Sum  := if(Abs(Kol) < GetPresision_forKol, price,price*kol);
  Sumv := if(Abs(Kol) < GetPresision_forKol, pricev,pricev*kol);
  PodrSum := PodrSum + Sum;
  PodrSumV := PodrSumV + Sumv;
 end.
.}
.if npBySklad2

.end
.begin
  ParSum := ParSum + PodrSum;
  ParSumV := ParSumV + PodrSumV;
 end.
.}
.begin
  TotSum := TotSum + PodrSum;
  TotSumV := TotSumV + PGetCurrency(cValUch,PodrSumV,date1);
 end.
.}
.begin
  DoneGetCur;
 end.
.endform
!
!
!
#doc
Ведомость наличия товаров в рaзрезе партий
#end
.linkform 'NalParty_01' prototype is 'NalParty'
.nameinlist 'Ведомость наличия товаров в рaзрезе партий'
.group '001'
.fields
  CommonFormHeader
  date1 tar bas tar bas
  nameparty kodparty dgodn nvaluch
  namepodr kodpodr
  namemc  nameed  price  pricev  kol  sum  sumv
  namepodr podrsum podrsumv
  nameparty parsum  parsumv
  totsum  totsumv
.endfields
^
 Й              Ведомость наличия товаров в разрезе партий товаров
                         сформирована на ^ Й
 Ш───────────────────────────────┬────────────┬───────────────────┬───────────────────┬──────────┬────────────────────┬────────────────────
   Наименование матценности    │Единица изм.│   Цена,@~@@@@     │Цена,@~@@@@@@@@@@@@│Количество│  Стоимость,@~@@@@  │Стоимость,@~@@@@@@@@
───────────────────────────────┴────────────┴───────────────────┴───────────────────┴──────────┴────────────────────┴──────────────────── Ш
 А.{
 Ш^ Ш, код:  Ш^ Ш, годность:  Ш^ Ш, валюта учета:  Ш^ Ш
.{
.if npBySklad1
склад  Ш^ Ш, код  Ш^ Ш
.end
.{
 Ш@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @~@@@@@@@@@@ &'&&&&&&&&&&&&&&.&& &'&&&&&&&&&&&&&&.&& &'&&&&&&&& &'&&&&&&&&&&&&&&&.&& &'&&&&&&&&&&&&&&&.&& Ш
.}
.if npBySklad2
 Ш        ИТОГО по складу @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                       &'&&&&&&&&&&&&&&&.&& &'&&&&&&&&&&&&&&&.&& Ш

.end
.}
 Ш        ИТОГО по партии @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                       &'&&&&&&&&&&&&&&&.&& &'&&&&&&&&&&&&&&&.&& Ш

.}
 Ш─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
        ИТОГО по ведомости:                                                                     &'&&&&&&&&&&&&&&&.&& &'&&&&&&&&&&&&&&&.&& Ш
.endform
!
!
!
#doc
Ведомость наличия по партиям в  национальной валюте
#end
.linkform 'NalParty_02' prototype is 'NalParty'
.nameinlist 'Ведомость наличия по партиям в  национальной валюте'
.group '000'
.fields
  CommonFormHeader
  date1 tar tar
  nameparty kodparty dgodn nvaluch
  namepodr kodpodr
  namemc nameed price kol sum
  namepodr podrsum
  nameparty parsum
  totsum
.endfields
^
 Й              Ведомость наличия товаров в разрезе партий товаров
                         сформирована на ^ Й
 Р───────────────────────────────┬────────────┬───────────────────┬──────────┬────────────────────
   Наименование матценности    │Единица изм.│    Цена,@~@@@@    │Количество│ Стоимость,@~@@@@
───────────────────────────────┴────────────┴───────────────────┴──────────┴──────────────────── Р
 А.{
 Р^, код: ^, годность: ^, валюта учета: ^ Р
.{
.if npBySklad1
 Рсклад ^, код ^ Р
.end
.{
 Р@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @~@@@@@@@@@@ &'&&&&&&&&&&&&&&.&& &'&&&&&&&& &'&&&&&&&&&&&&&&&.&& Р
.}
.if npBySklad2
 Р        ИТОГО по складу @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@     &'&&&&&&&&&&&&&&&&&.&& Р

.end
.}
 Р        ИТОГО по партии @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@     &'&&&&&&&&&&&&&&&&&.&& Р

.}
 Р────────────────────────────────────────────────────────────────────────────────────────────────
        ИТОГО по ведомости:                                               &'&&&&&&&&&&&&&&&&&.&& Р

.endform
!
!
!
#doc
Краткая ведомость наличия товаров в рaзрезе партий
#end
.linkform 'NalParty_03' prototype is 'NalParty'
.nameinlist 'Краткая ведомость наличия товаров в рaзрезе партий'
.group '011'
.fields
  CommonFormHeader
  date1 tar bas
  nameparty kodparty dgodn nvaluch parsum  parsumv
  totsum  totsumv
.endfields
^
 Й              Ведомость наличия товаров в разрезе партий товаров
                         сформирована на ^ Й
 Р────────────────────────────────────┬──────────┬──────────┬───────────┬────────────────────┬────────────────────
   Наименование партии              │   Код    │Дата годн.│ Валюта    │  Стоимость,@~@@@@  │ Стоимость,@~@@@@@@@
────────────────────────────────────┴──────────┴──────────┴───────────┴────────────────────┴────────────────────
.{
.{
.if npBySklad1
.end
.{
.}
.if npBySklad2
.end
.}
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@@ &#'&&&&&&&&&&&&&&.&& &#'&&&&&&&&&&&&&&.&&
.}
────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 Б        ИТОГО по ведомости:                                            &'&&&&&&&&&&&&&&&.&& &'&&&&&&&&&&&&&&&.&& С

.endform
!
!
!
#doc
Краткая ведомость наличия по партиям в валюте
#end
.linkform 'NalParty_04' prototype is 'NalParty'
.nameinlist 'Краткая ведомость наличия по партиям в валюте'
.group '010'
.fields
  CommonFormHeader
  date1 tar
  nameparty kodparty dgodn nvaluch parsum
  totsum
.endfields
^
 Б              Ведомость наличия товаров в разрезе партий товаров
                         сформирована на ^ Б
 И────────────────────────────────────┬──────────┬──────────┬───────────┬────────────────────
   Наименование партии              │   Код    │Дата годн.│ Валюта    │  Стоимость,@~@@@@
────────────────────────────────────┴──────────┴──────────┴───────────┴────────────────────
.{
.{
.if npBySklad1
.end
.{
.}
.if npBySklad2
.end
.}
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@@ &#'&&&&&&&&&&&&&&.&&
.}
───────────────────────────────────────────────────────────────────────────────────────────
 Б        ИТОГО по ведомости:                                            &'&&&&&&&&&&&&&&&.&& Й
.endform
