/*
 ╔═══════════════════════════════════════════════════════════════════════════╗
 ║                     (c) 1994,97 корпорация ГАЛАКТИКА                      ║
 ║ Проект        : ГАЛАКТИКА                                                 ║
 ║ Система       : Основные средства                                         ║
 ║ Версия        : 5.00                                                      ║
 ║ Назначение    : Движение в разрезах по контрагентам                       ║
 ║ Ответственный : Крахотко Александр Валерьевич (КРОХА)                     ║
 ║ Параметры     :                                                           ║
 ╚═══════════════════════════════════════════════════════════════════════════╝
*/
#doc
Движение по складу с корреспонденцией потоков МЦ с детализацией
#end
.linkform 'CutOrg_100' prototype is 'CutOrg'
.nameInList 'Движение по складу с корреспонденцией потоков МЦ с детализацией'
.group 'cut_pmp'
.fields
  CommonFormHeader
.endfields
^
.fields
 начальная_дата
 конечная_дата
 склад
.endfields
 Ш
  Ведомость движения МЦ по разрезам хранения и корреспондентам.

         с ^ по ^

───────────────────────┬───────────┬─────────┬───────────┬───────────┬───────────────────────┬───────────────────────┬───────────────────────────────────
                       │   Дата    │   Вид   │  Номер    │  Номер    │      П Р И Х О Д      │      Р А С Х О Д      │                О С Т А Т О К
                       │ операции  │ операции│   ордера  │ накладной ├───────────┬───────────┼───────────┬───────────┼──────────┬───────────┬────────────
                       │           │         │           │           │количество │  сумма    │количество │  сумма    │цена в НДЕ│количество │  сумма
───────────────────────┴───────────┴─────────┴───────────┴───────────┴───────────┴───────────┴───────────┴───────────┴──────────┴───────────┴────────────
.{CutOrgPodr
 БСклад : ^ Б
.{CutOrgMol
.{CutOrgParty
.{CutOrgMC
.begin
  Store_Calc(comp(мц_нрек),comp(склад_нрек),0,0,0) ;
  ост_к     := Store_Kol ;
  ост_ц     := Store_Summa / if (ост_к=0,1.0,ост_к) ;
  мц_и_кол := ост_к ;
  мц_и_стм := ост_ц * if(ост_к=0,1.0,ост_к) ;
 end.
.fields
  мц остаток_имя ост_ц ост_к ост_ц*if(ост_к=0,1.0,ост_к)
.endfields
 Б  МЦ  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &&&&&&&&&&&&&&& &&&&&&&&.& &&&&&&&&&&& &&&&&&&&&&& Б
.{CutOrgTip
.{CutOrgPodr2
.{CutOrgMol2
.{CutOrgData
.{CutOrgVid
.{CheckEnter CutOrgSample
.begin
  if (вид='приход')
    {
    мц_и_кол := мц_и_кол + количество      ;
    мц_и_стм := мц_и_стм + if(переоц_ордер,1.0,количество)*цена ;
    }
  else
    {
    мц_и_кол := мц_и_кол - количество      ;
    мц_и_стм := мц_и_стм - if(переоц_ордер,1.0,количество)*цена ;
    }
 end.
.{?Internal;вид='приход'
.fields
  склад2+' '+мол2 дата вид номер_ордера накладная_номер
  количество цена*if(переоц_ордер,1.0,количество) мц_и_стм/мц_и_кол мц_и_кол мц_и_стм
.endfields
@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@ @@@@@@@@@ @@@@@@@@@@@ @@@@@@@@@@@ &&&&&&&&&&& &&&&&&&&&&&                         &&&&&&&&.& &&&&&&&&&&& &&&&&&&&&&&
.} //?
.{?Internal;вид<>'приход'
.fields
  склад2+' '+мол2 дата вид номер_ордера накладная_номер
  количество цена*if(переоц_ордер,1.0,количество) мц_и_стм/мц_и_кол мц_и_кол мц_и_стм
.endfields
@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@ @@@@@@@@@ @@@@@@@@@@@ @@@@@@@@@@@                         &&&&&&&&&&& &&&&&&&&&&& &&&&&&&&.& &&&&&&&&&&& &&&&&&&&&&&
.} //?
.}
.}
.}
.}
.}
.}
.fields
  SubStr(мц,1,43)
  мц_итого_колп
  мц_итого_стмп
  мц_итого_колр
  мц_итого_стмр
  мц_и_стм/мц_и_кол
  мц_и_кол
  мц_и_стм
.endfields
  Итого по @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &&&&&&&&&.& &&&&&&&&&&& &&&&&&&&&&& &&&&&&&&&&& &&&&&&&&.& &&&&&&&&&&& &&&&&&&&&&&
.........................................................................................................................................................
.}
.}
.}
.begin
  Store_Calc(0,comp(склад_нрек),0,0,0) ;
 end.
.fields
  Склад
  разрез_итого_стмп
  разрез_итого_стмр
  Store_Summa + разрез_итого_стмп - разрез_итого_стмр
.endfields
ИТОГО по складу @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@             &&&&&&&&&&&             &&&&&&&&&&&                        &&&&&&&&&&&
.........................................................................................................................................................
.}
 Ш
.endform

#doc
Движение по складу с корреспонденцией потоков МЦ
#end
.linkform 'CutOrg_101' prototype is 'CutOrg'
.nameInList 'Движение по складу с корреспонденцией потоков МЦ'
.group 'cut_pmp'
.fields
  CommonFormHeader
.endfields
^
.fields
 начальная_дата
 конечная_дата
 склад
 мц
.endfields

 Ш  Ведомость движения МЦ по разрезам хранения и корреспондентам.

         с ^ по ^

───────────────────────────────────────────────┬───────────────────────┬───────────────────────┬───────────────────────┬────────────────────────
                                               │     О С Т А Т О К     │      П Р И Х О Д      │      Р А С Х О Д      │     О С Т А Т О К
                                               ├───────────┬───────────┼───────────┬───────────┼───────────┬───────────┼───────────┬────────────
                                               │количество │  сумма    │количество │  сумма    │количество │  сумма    │количество │  сумма
───────────────────────────────────────────────┴───────────┴───────────┴───────────┴───────────┴───────────┴───────────┴───────────┴────────────
.{CutOrgPodr
 БСКЛАД : ^ Б
.{CutOrgMol
.{CutOrgParty
.{CutOrgMC
.begin
  Store_Calc(comp(мц_нрек),comp(склад_нрек),0,0,0) ;
  ост_к     := Store_Kol ;
  ост_ц     := Store_Summa / if (ост_к=0,1.0,ост_к) ;
  мц_и_кол := ост_к ;
  мц_и_стм := ост_ц * if(ост_к=0,1.0,ост_к)
 end.
 Б  МЦ  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
.{CutOrgTip
.{CutOrgPodr2
.{CutOrgMol2
.{CutOrgData
.{CutOrgVid
.{CheckEnter CutOrgSample
.begin
  if (вид='приход')
    {
    мц_и_кол := мц_и_кол + количество      ;
    мц_и_стм := мц_и_стм + if(переоц_ордер,1.0,количество)*цена ;
    }
  else
    {
    мц_и_кол := мц_и_кол - количество      ;
    мц_и_стм := мц_и_стм - if(переоц_ордер,1.0,количество)*цена ;
    }
 end.
.}
.}
.}
.{?Internal;(length(склад2+мол2)>0)or((ссп<>0)and(сср<>0))
.fields
  склад2+' '+мол2
  скп ссп скр сср
.endfields
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                         &&&&&&&&&&& &&&&&&&&&&& &&&&&&&&&&& &&&&&&&&&&&
.} // ?
.} // mol2
.} // podr2
.}
.fields
  SubStr(мц,1,43)
  ост_к
  ост_ц * if(ост_к=0,1.0,ост_к)
  мц_итого_колп
  мц_итого_стмп
  мц_итого_колр
  мц_итого_стмр
  мц_и_кол
  мц_и_стм
.endfields
Итого по @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &&&&&&&&&&& &&&&&&&&&&& &&&&&&&&&&& &&&&&&&&&&& &&&&&&&&&&& &&&&&&&&&&& &&&&&&&&&&& &&&&&&&&&&&
................................................................................................................................................
.}
.}
.}
.begin
  Store_Calc(0,comp(склад_нрек),0,0,0) ;
  ссо := Store_Summa ;
 end.
.fields
  Склад
  ссо
  разрез_итого_стмп
  разрез_итого_стмр
  ссо + разрез_итого_стмп - разрез_итого_стмр // ?????
.endfields
ИТОГО ПО СКЛАДУ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@             &&&&&&&&&&&             &&&&&&&&&&&             &&&&&&&&&&&             &&&&&&&&&&&
................................................................................................................................................
.}
 Ш
.endform

#doc
Движение по складу
#end
.linkform 'CutOrg_200' prototype is 'CutOrg'
.nameInList 'Движение по складу'
.group 'cut_pp'
.fields
  CommonFormHeader
.endfields
^
.fields
 начальная_дата
 конечная_дата
 склад
.endfields

 Ш  Ведомость движения МЦ по разрезам хранения и корреспондентам.

         с ^ по ^

───────────────────────────────────────────────┬───────────────────┬───────────────────┬───────────────────┬────────────────────
                                               │   О С Т А Т О К   │    П Р И Х О Д    │    Р А С Х О Д    │   О С Т А Т О К
───────────────────────────────────────────────┴───────────────────┴───────────────────┴───────────────────┴────────────────────
.{CutOrgPodr
 БСКЛАД : ^ Б
.{CutOrgMol
.{CutOrgParty
.{CutOrgMC
.{CutOrgTip
.{CutOrgPodr2
.{CutOrgMol2
.{CutOrgData
.{CutOrgVid
.{CheckEnter CutOrgSample
.}
.}
.}
.{?Internal;(length(склад2+мол2)>0)or((ссп<>0)and(сср<>0))
.fields
  склад2+' '+мол2
  ссп сср
.endfields
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                     &&&&&&&&&&&&&&&&&.& &&&&&&&&&&&&&&&&&.&
.} // ?Internal
.} // mol2
.} // podr2
.}
.}
.}
.}
.begin
  Store_Calc(0,comp(склад_нрек),0,0,0) ;
  ссо := Store_Summa ;
 end.
.fields
  Склад
  ссо
  разрез_итого_стмп
  разрез_итого_стмр
  ссо + разрез_итого_стмп - разрез_итого_стмр // ?????
.endfields
ИТОГО ПО СКЛАДУ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &&&&&&&&&&&&&&&&&.& &&&&&&&&&&&&&&&&&.& &&&&&&&&&&&&&&&&&.& &&&&&&&&&&&&&&&&&.&
................................................................................................................................................
.}
 Ш
.endform
