/*
 ╔═══════════════════════════════════════════════════════════════════════════╗
 ║                     (c) 1994,97 корпорация ГАЛАКТИКА                      ║
 ║ Проект        : ГАЛАКТИКА                                                 ║
 ║ Система       : Основные средства                                         ║
 ║ Версия        : 5.00                                                      ║
 ║ Назначение    : Движение в разрезах по контрагентам                       ║
 ║ Ответственный : Крахотко Александр Валерьевич (КРОХА)                     ║
 ║ Параметры     :                                                           ║
 ╚═══════════════════════════════════════════════════════════════════════════╝
*/

#INCLUDE cut-org.pro

#doc
Только склады
#end
.linkform 'CutOrg_000' prototype is 'CutOrg'
.nameInList 'Только склады'
.hide
.fields
 склад
.endfields

.{CutOrgPodr
 склад ^
.{CutOrgMol
.{CutOrgParty
.{CutOrgMC
.{CutOrgTip
.{CutOrgPodr2
.{CutOrgMol2
.{CutOrgData
.{CutOrgVid
.{CheckEnter CutOrgSample
.}
.}
.}
.}
.}
.}
.}
.}
.}
.}

.endform
//---------------------------------------------------------------------------
//---------------------------------------------------------------------------
//---------------------------------------------------------------------------
#doc
Обычный отчет
#end
.linkform 'CutOrg_001' prototype is 'CutOrg'
.nameInList 'Обычный отчет'
.group 'cut_all'
.fields
  CommonFormHeader
.endfields
^
.fields
 начальная_дата
 конечная_дата
 склад
  мол
   партия
    мц остаток_имя остаток_кол_s остаток_цена
     тип
      склад2
       мол2
        дата
         вид
          номер_ордера цена количество_s:'p:r'
.endfields

 Б  ВЕДОМОСТЬ ДВИЖЕНИЯ МЦ ПО РАЗРЕЗАМ ХРАНЕНИЯ И КОРРЕСПОНДЕНТАМ Б

         с ^ по ^

 И           ────────────┬─────────┬───────────┬──────────────────────┬──────────────────────
             Дата опер.│Вид опер.│ N ордера  │      Цена в НДЕ      │      Количество
           ────────────┴─────────┴───────────┴──────────────────────┴────────────────────── И
.{CutOrgPodr
 И Склад ^ И
.{CutOrgMol
 И  Мол ^ И
.{CutOrgParty
 И   Партия ^ И
.{CutOrgMC
 И    МЦ ^ ,  ^ остаток : кол: ^ цена: ^ И
.{CutOrgTip
 И      ^ И
.{CutOrgPodr2
.{CutOrgMol2
 И        ^ ^ И
.{CutOrgData
.{CutOrgVid
.{CheckEnter CutOrgSample
 И            @@@@@@@@@@@ @@@@@@@@@ N @@@@@@@@@ цена &'&&&&&&&&&&&&&.& кол @@@@@@@@@@@@@@@@@ И
.}
.}
.}
.}
.}
.}
.}
.}
.}
.}
.endform




#doc
Полный отчет
#end
.linkform 'CutOrg_002' prototype is 'CutOrg'
.nameInList 'Полный отчет'
.group 'cut_all'
.defo landscape
.fields
  CommonFormHeader
.endfields
^
.fields
 начальная_дата
 конечная_дата
 склад
  мол
   партия
    мц остаток_имя остаток_цена остаток_кол_s:'p:r' if(остаток_кол_d=0,double(1),остаток_кол_d)*остаток_цена
!                                           if(abs(остаток_кол)<0.0001,1.0,остаток_кол)*остаток_цена
.endfields

 Б  Ведомость движения МЦ по разрезам хранения и корреспондентам Б

         с ^ по ^

 Р           ────────────┬─────────┬───────────┬───────────┬──────────────────────────────────────────┬──────────────────────────────────────────┬───────────────────────────────────────────
               Дата    │   Вид   │   Номер   │   Номер   │               П Р И Х О Д                │               Р А С Х О Д                │               О С Т А Т О К
             операции  │операции │  ордера   │ накладной ├────────────┬──────────────┬──────────────┼────────────┬──────────────┬──────────────┼────────────┬──────────────┬───────────────
                       │         │           │           │ Цена в НДЕ │  Количество  │    Сумма     │ Цена в НДЕ │  Количество  │    Сумма     │ Цена в НДЕ │  Количество  │    Сумма
           ────────────┴─────────┴───────────┴───────────┴────────────┴──────────────┴──────────────┴────────────┴──────────────┴──────────────┴────────────┴──────────────┴─────────────── Р
.{CutOrgPodr
.{CutOrgMol
.{CutOrgParty
 РСклад ^ Мол ^ Партия ^ Р
.{CutOrgMC
 Р    МЦ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                                &&&&&&&&&&&&&&&&& остаток: &'&&&&&&&.&& @@@@@@@@@@@@@@ &'&&&&&&&&&.&& Р
.{CutOrgTip
.{?Internal;length(тип)>0
.fields
 Р     тип Р
.endfields
 Р     ^ Р
.} // ?Internal
.{CutOrgPodr2
.{CutOrgMol2
.{?Internal;length(склад2+мол2)>0
.fields
  склад2
  мол2
.endfields
 Р        ^ ^ Р
.} // ?Internal
.{CutOrgData
.{CutOrgVid
.{CheckEnter CutOrgSample
.{?Internal;вид='приход'
.fields
   дата вид номер_ордера накладная_номер цена количество_s:'p:r' цена*if(переоц_ордер,1.0,количество_d)
.endfields
 Р            @@@@@@@@@@@ @@@@@@@@@ @@@@@@@@@@@ @@@@@@@@@@@ &'&&&&&&&.&& @@@@@@@@@@@@@@ &'&&&&&&&&&.&& Р
.} //?Internal
.{?Internal;вид<>'приход'
.fields
   дата вид номер_ордера накладная_номер цена количество_s:'p:r' цена*if(переоц_ордер,1.0,количество_d)
.endfields
 Р            @@@@@@@@@@@ @@@@@@@@@ @@@@@@@@@@@ @@@@@@@@@@@                                            &'&&&&&&&.&& @@@@@@@@@@@@@@ &'&&&&&&&&&.&& Р
.} //?Internal
.} // CutOrgSample
.} // CutOrgVid
.} // CutOrgData
.{?Internal;length(склад2+мол2)>0
.fields
  склад2 + ' ' + мол2
  DoubleToStr(конт_итого_колп,'[|-]3666`666`666`666.'+fractional_part8):'p:r'
  конт_итого_стмп
  DoubleToStr(конт_итого_колр,'[|-]3666`666`666`666.'+fractional_part8):'p:r'
  конт_итого_стмр
.endfields
 Р        Итого по @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@ &'&&&&&&&&&.&&              @@@@@@@@@@@@@@ &'&&&&&&&&&.&& Р
.} // ?Internal
.} // CutOrgMol2
.} // CutOrgPodr2
.} // CutOrgTip
.{?Internal;length(тип)>0
.fields
  SubStr(мц,1,43)
  DoubleToStr(мц_итого_колп,'[|-]3666`666`666`666.'+fractional_part8):'p:r'
  мц_итого_стмп
  DoubleToStr(мц_итого_колр,'[|-]3666`666`666`666.'+fractional_part8):'p:r'
  мц_итого_стмр
  DoubleToStr(мц_итого_кол ,'[|-]3666`666`666`666.'+fractional_part8):'p:r'
  мц_итого_стм
.endfields
 Р   Итого по @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@ &'&&&&&&&&&.&&              @@@@@@@@@@@@@@ &'&&&&&&&&&.&&              @@@@@@@@@@@@@@ &'&&&&&&&&&.&& Р
.} // ?Internal
.} // CutOrgMC
.fields
  Склад Мол Партия
  DoubleToStr(разрез_итого_колп,'[|-]3666`666`666`666.'+fractional_part8):'p:r'
  разрез_итого_стмп
  DoubleToStr(разрез_итого_колр,'[|-]3666`666`666`666.'+fractional_part8):'p:r'
  разрез_итого_стмр
.endfields
 Р  ИТОГО по складу ^, по МОЛу ^, по партии ^
 Б                                                                       @@@@@@@@@@@@@@ &'&&&&&&&&&.&&              @@@@@@@@@@@@@@ &'&&&&&&&&&.&& С
.} // party
.} // mol
.} // podr
.endform
!
!
!#INCLUDE cut-org.frn - если соберетесь раскомментаривать, то нужно
!                       внести кучу изменений как в cut-org.frv (Nazgul)
#INCLUDE cut-org.frv  // для русского продукта
