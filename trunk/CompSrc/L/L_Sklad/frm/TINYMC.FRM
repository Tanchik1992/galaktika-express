! ╔═════════════════════════════════════════════════════════════════════════╗
! ║  Разработал:  Александр Крахотко                                        ║
! ║  Назначение:  Оборотная ведомость по МЦ                                 ║
! ╚═════════════════════════════════════════════════════════════════════════╝

#INCLUDE tinymc.pro // форма прототип

#doc
Тестовая форма для вывода всех полей
#end
.linkform 'tinyMC_Test' prototype is 'TinyMC'
.hide
.nameInList 'Тестовая форма для вывода всех полей'
.Group 'Тестовые формы'
.fields
  CommonFormHeader
.endfields
^
.fields
sPodr sMOL sMC sParty
b_dat e_dat
valR valB
!.{
  mc_nom  mc_name ed_Y ed_O
!.{
!.if PosNoZero
      sklad
      // в учетных единицах измерения
      b_kolY  b_prRY  b_prBY  b_sumRY  b_sumBY
      a_kolY  a_prRY  a_prBY  a_sumRY  a_sumBY
      s_kolY  s_prRY  s_prBY  s_sumRY  s_sumBY
      e_kolY  e_prRY  e_prBY  e_sumRY  e_sumBY
      // в отпускных
      b_kolO  b_prRO  b_prBO  b_sumRO  b_sumBO
      a_kolO  a_prRO  a_prBO  a_sumRO  a_sumBO
      s_kolO  s_prRO  s_prBO  s_sumRO  s_sumBO
      e_kolO  e_prRO  e_prBO  e_sumRO  e_sumBO
      // в весовых характеристиках
      b_kolV  b_prRV  b_prBV  b_sumRV  b_sumBV
      a_kolV  a_prRV  a_prBV  a_sumRV  a_sumBV
      s_kolV  s_prRV  s_prBV  s_sumRV  s_sumBV
      e_kolV  e_prRV  e_prBV  e_sumRV  e_sumBV
!!.end
!.}
!!.if tinyskl1 // сумма по МЦ
    // в учетных единицах измерения
    sb_kolY  sb_prRY  sb_prBY  sb_sumRY  sb_sumBY
    sa_kolY  sa_prRY  sa_prBY  sa_sumRY  sa_sumBY
    ss_kolY  ss_prRY  ss_prBY  ss_sumRY  ss_sumBY
    se_kolY  se_prRY  se_prBY  se_sumRY  se_sumBY
    // в отпускных
    sb_kolO  sb_prRO  sb_prBO  sb_sumRO  sb_sumBO
    sa_kolO  sa_prRO  sa_prBO  sa_sumRO  sa_sumBO
    ss_kolO  ss_prRO  ss_prBO  ss_sumRO  ss_sumBO
    se_kolO  se_prRO  se_prBO  se_sumRO  se_sumBO
    // в весовых характеристиках
    sb_kolV  sb_prRV  sb_prBV  sb_sumRV  sb_sumBV
    sa_kolV  sa_prRV  sa_prBV  sa_sumRV  sa_sumBV
    ss_kolV  ss_prRV  ss_prBV  ss_sumRV  ss_sumBV
    se_kolV  se_prRV  se_prBV  se_sumRV  se_sumBV
!!.end
!.}
!!.if tinyskl2 // итого по предприятию
  // в учетных единицах измерения
  ib_kolY  ib_prRY  ib_prBY  ib_sumRY  ib_sumBY
  ia_kolY  ia_prRY  ia_prBY  ia_sumRY  ia_sumBY
  is_kolY  is_prRY  is_prBY  is_sumRY  is_sumBY
  ie_kolY  ie_prRY  ie_prBY  ie_sumRY  ie_sumBY
  // в отпускных
  ib_kolO  ib_prRO  ib_prBO  ib_sumRO  ib_sumBO
  ia_kolO  ia_prRO  ia_prBO  ia_sumRO  ia_sumBO
  is_kolO  is_prRO  is_prBO  is_sumRO  is_sumBO
  ie_kolO  ie_prRO  ie_prBO  ie_sumRO  ie_sumBO
  // в весовых характеристиках
  ib_kolV  ib_prRV  ib_prBV  ib_sumRV  ib_sumBV
  ia_kolV  ia_prRV  ia_prBV  ia_sumRV  ia_sumBV
  is_kolV  is_prRV  is_prBV  is_sumRV  is_sumBV
  ie_kolV  ie_prRV  ie_prBV  ie_sumRV  ie_sumBV
!!.end
.endfields

^ ^ ^ ^
н_дата к_дата ^ ^
валН валБ     ^ ^
.{
  номенкк_МЦ наименование_МЦ едУ едО  ^ ^ ^ ^
.{
.if PosNoZero
      склад  ^
      // в "У"четных единицах измерения
      н_колУ  н_ценаНУ  н_ценаБУ  н_сумНУ  н_сумБУ ^ ^ ^ ^ ^
      п_колУ  п_ценаНУ  п_ценаБУ  п_сумНУ  п_сумБУ ^ ^ ^ ^ ^
      р_колУ  р_ценаНУ  р_ценаБУ  р_сумНУ  р_сумБУ ^ ^ ^ ^ ^
      к_колУ  к_ценаНУ  к_ценаБУ  к_сумНУ  к_сумБУ ^ ^ ^ ^ ^
      // в "О"тпускных
      н_колО  н_ценаНО  н_ценаБО  н_сумНО  н_сумБО ^ ^ ^ ^ ^
      п_колО  п_ценаНО  п_ценаБО  п_сумНО  п_сумБО ^ ^ ^ ^ ^
      р_колО  р_ценаНО  р_ценаБО  р_сумНО  р_сумБО ^ ^ ^ ^ ^
      к_колО  к_ценаНО  к_ценаБО  к_сумНО  к_сумБО ^ ^ ^ ^ ^
      // в "В"есовых характеристиках
      н_колВ  н_ценаНВ  н_ценаБВ  н_сумНВ  н_сумБВ ^ ^ ^ ^ ^
      п_колВ  п_ценаНВ  п_ценаБВ  п_сумНВ  п_сумБВ ^ ^ ^ ^ ^
      р_колВ  р_ценаНВ  р_ценаБВ  р_сумНВ  р_сумБВ ^ ^ ^ ^ ^
      к_колВ  к_ценаНВ  к_ценаБВ  к_сумНВ  к_сумБВ ^ ^ ^ ^ ^
.end
.}
!.if Усли_сумма_не0
    // в "У"четных единицах измерения
    сн_колУ  сн_ценаНУ  сн_ценаБУ  сн_сумНУ  сн_сумБУ ^ ^ ^ ^ ^
    сп_колУ  сп_ценаНУ  сп_ценаБУ  сп_сумНУ  сп_сумБУ ^ ^ ^ ^ ^
    ср_колУ  ср_ценаНУ  ср_ценаБУ  ср_сумНУ  ср_сумБУ ^ ^ ^ ^ ^
    ск_колУ  ск_ценаНУ  ск_ценаБУ  ск_сумНУ  ск_сумБУ ^ ^ ^ ^ ^
    // в "О"тпускных
    сн_колО  сн_ценаНО  сн_ценаБО  сн_сумНО  сн_сумБО ^ ^ ^ ^ ^
    сп_колО  сп_ценаНО  сп_ценаБО  сп_сумНО  сп_сумБО ^ ^ ^ ^ ^
    ср_колО  ср_ценаНО  ср_ценаБО  ср_сумНО  ср_сумБО ^ ^ ^ ^ ^
    ск_колО  ск_ценаНО  ск_ценаБО  ск_сумНО  ск_сумБО ^ ^ ^ ^ ^
    // в "В"есовых характеристиках
    сн_колВ  сн_ценаНВ  сн_ценаБВ  сн_сумНВ  сн_сумБВ ^ ^ ^ ^ ^
    сп_колВ  сп_ценаНВ  сп_ценаБВ  сп_сумНВ  сп_сумБВ ^ ^ ^ ^ ^
    ср_колВ  ср_ценаНВ  ср_ценаБВ  ср_сумНВ  ср_сумБВ ^ ^ ^ ^ ^
    ск_колВ  ск_ценаНВ  ск_ценаБВ  ск_сумНВ  ск_сумБВ ^ ^ ^ ^ ^
!.end

.}
!.if Усли_итого_не0
  // итого по предприятию
  // в "У"четных единицах измерения
  ин_колУ  ин_ценаНУ  ин_ценаБУ  ин_сумНУ  ин_сумБУ ^ ^ ^ ^ ^
  ип_колУ  ип_ценаНУ  ип_ценаБУ  ип_сумНУ  ип_сумБУ ^ ^ ^ ^ ^
  ир_колУ  ир_ценаНУ  ир_ценаБУ  ир_сумНУ  ир_сумБУ ^ ^ ^ ^ ^
  ик_колУ  ик_ценаНУ  ик_ценаБУ  ик_сумНУ  ик_сумБУ ^ ^ ^ ^ ^
  // в "О"тпускных
  ин_колО  ин_ценаНО  ин_ценаБО  ин_сумНО  ин_сумБО ^ ^ ^ ^ ^
  ип_колО  ип_ценаНО  ип_ценаБО  ип_сумНО  ип_сумБО ^ ^ ^ ^ ^
  ир_колО  ир_ценаНО  ир_ценаБО  ир_сумНО  ир_сумБО ^ ^ ^ ^ ^
  ик_колО  ик_ценаНО  ик_ценаБО  ик_сумНО  ик_сумБО ^ ^ ^ ^ ^
  // в "В"есовых характеристиках
  ин_колВ  ин_ценаНВ  ин_ценаБВ  ин_сумНВ  ин_сумБВ ^ ^ ^ ^ ^
  ип_колВ  ип_ценаНВ  ип_ценаБВ  ип_сумНВ  ип_сумБВ ^ ^ ^ ^ ^
  ир_колВ  ир_ценаНВ  ир_ценаБВ  ир_сумНВ  ир_сумБВ ^ ^ ^ ^ ^
  ик_колВ  ик_ценаНВ  ик_ценаБВ  ик_сумНВ  ик_сумБВ ^ ^ ^ ^ ^
!.end

.endform

#doc
В разрезе учетных единиц измерения
#end
.linkform 'tinyMC_Y' prototype is 'TinyMC'
.nameInList 'В разрезе учетных единиц измерения'
.Group 'Обычные отчеты'
.PAPER PA4
.ORIENT LANDSCAPE
.DEFO LANDSCAPE
.LL 80
.P 60
.[H SKIP
 Ш  Лист@NP@
──────────────────┬──────────────────────────────────────────────────┬──────────────────────────────────────────────────┬──────────────────────────────────────────────────┬──────────────────────────────────────────────────
                  │             ОСТАТОК НА НАЧАЛО                    │                   ПРИХОД                         │                   РАСХОД                         │               ОСТАТОК НА КОНЕЦ
      СКЛАД       ├──────┬─────────────────────┬─────────────────────┼──────┬─────────────────────┬─────────────────────┼──────┬─────────────────────┬─────────────────────┼──────┬─────────────────────┬─────────────────────
                  │кол-во│         цена        │        сумма        │кол-во│         цена        │        сумма        │кол-во│         цена        │        сумма        │кол-во│         цена        │        сумма
──────────────────┴──────┴─────────────────────┴─────────────────────┴──────┴─────────────────────┴─────────────────────┴──────┴─────────────────────┴─────────────────────┴──────┴─────────────────────┴───────────────────── Ш
 И.]H
.fields
  CommonFormHeader
.endfields
^
.fields
b_dat e_dat
sPodr sMOL sMC sParty
valR valB valR valB
valR valB valR valB
valR valB valR valB
valR valB valR valB
!.{
  mc_name mc_nom  ed_Y
!.{
!.if PosNoZero
      sklad
      b_kolY  b_prRY  b_prBY  b_sumRY  b_sumBY
      a_kolY  a_prRY  a_prBY  a_sumRY  a_sumBY
      s_kolY  s_prRY  s_prBY  s_sumRY  s_sumBY
      e_kolY  e_prRY  e_prBY  e_sumRY  e_sumBY
!.end
!.}
    sb_kolY  sb_prRY  sb_prBY  sb_sumRY  sb_sumBY
    sa_kolY  sa_prRY  sa_prBY  sa_sumRY  sa_sumBY
    ss_kolY  ss_prRY  ss_prBY  ss_sumRY  ss_sumBY
    se_kolY  se_prRY  se_prBY  se_sumRY  se_sumBY
!.}
  ib_kolY  ib_prRY  ib_prBY  ib_sumRY  ib_sumBY
  ia_kolY  ia_prRY  ia_prBY  ia_sumRY  ia_sumBY
  is_kolY  is_prRY  is_prBY  is_sumRY  is_sumBY
  ie_kolY  ie_prRY  ie_prBY  ie_sumRY  ie_sumBY
.endfields
 Ш
 Щ     Оборотная ведомость движения МЦ
     (в разрезе учетных единиц измерения)
            с  Б^ Б по  Б^ А
 Ш
 Используемые фильтры :
 Склад  : ^
 МОЛ    : ^
 МЦ     : ^
 Партия : ^

 И  Лист@NP@
──────────────────┬──────────────────────────────────────────────────┬──────────────────────────────────────────────────┬──────────────────────────────────────────────────┬──────────────────────────────────────────────────
                  │             ОСТАТОК НА НАЧАЛО                    │                   ПРИХОД                         │                   РАСХОД                         │               ОСТАТОК НА КОНЕЦ
                  ├──────┬─────────────────────┬─────────────────────┼──────┬─────────────────────┬─────────────────────┼──────┬─────────────────────┬─────────────────────┼──────┬─────────────────────┬─────────────────────
      СКЛАД       │кол-во│         цена        │        сумма        │кол-во│         цена        │        сумма        │кол-во│         цена        │        сумма        │кол-во│         цена        │        сумма
                  │      ├──────────┬──────────┼──────────┬──────────┤      ├──────────┬──────────┼──────────┬──────────┤      ├──────────┬──────────┼──────────┬──────────┤      ├──────────┬──────────┼──────────┬──────────
                  │      │ @@@@@@@@ │ @@@@@@@@ │ @@@@@@@@ │ @@@@@@@@ │      │ @@@@@@@@ │ @@@@@@@@ │ @@@@@@@@ │ @@@@@@@@ │      │ @@@@@@@@ │ @@@@@@@@ │ @@@@@@@@ │ @@@@@@@@ │      │ @@@@@@@@ │ @@@@@@@@ │ @@@@@@@@ │ @@@@@@@
──────────────────┴──────┴──────────┴──────────┴──────────┴──────────┴──────┴──────────┴──────────┴──────────┴──────────┴──────┴──────────┴──────────┴──────────┴──────────┴──────┴──────────┴──────────┴──────────┴──────────
.{
 Б ^  ^     единица измерения : ^ Б
.{
.if PosNoZero
@@@@@@@@@@@@@@@@@@ &&&&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&&
.end
.}
    ИТОГО ПО МЦ    &&&&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&&
.}

ИТОГО ПО ВСЕМ МЦ   &&&&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& Ш
!.[f
!
!                                                                                                                                                                                                                     Лист @np@
!.]f
.endform

#doc
В разрезе отпускных единиц измерения
#end
.linkform 'tinyMC_O' prototype is 'TinyMC'
.nameInList 'В разрезе отпускных единиц измерения'
.Group 'Обычные отчеты'
.PAPER PA4
.ORIENT LANDSCAPE
.DEFO LANDSCAPE
.LL 80
.P 60
.[H SKIP
 Ш  Лист@NP@
───────────────────┬──────────────────────────────────────────────────┬──────────────────────────────────────────────────┬──────────────────────────────────────────────────┬──────────────────────────────────────────────────
                   │             ОСТАТОК НА НАЧАЛО                    │                   ПРИХОД                         │                   РАСХОД                         │               ОСТАТОК НА КОНЕЦ
      СКЛАД        ├──────┬─────────────────────┬─────────────────────┼──────┬─────────────────────┬─────────────────────┼──────┬─────────────────────┬─────────────────────┼──────┬─────────────────────┬─────────────────────
                   │кол-во│         цена        │        сумма        │кол-во│         цена        │        сумма        │кол-во│         цена        │        сумма        │кол-во│         цена        │        сумма
───────────────────┴──────┴─────────────────────┴─────────────────────┴──────┴─────────────────────┴─────────────────────┴──────┴─────────────────────┴─────────────────────┴──────┴─────────────────────┴─────────────────────
 Ш И.]H
.fields
  CommonFormHeader
.endfields
^
.fields
b_dat e_dat
sPodr sMOL sMC sParty
valR valB valR valB
valR valB valR valB
valR valB valR valB
valR valB valR valB
!.{
  mc_name mc_nom  ed_O
!.{
!.if PosNoZero
      sklad
      b_kolO  b_prRO  b_prBO  b_sumRO  b_sumBO
      a_kolO  a_prRO  a_prBO  a_sumRO  a_sumBO
      s_kolO  s_prRO  s_prBO  s_sumRO  s_sumBO
      e_kolO  e_prRO  e_prBO  e_sumRO  e_sumBO
!.end
!.}
    sb_kolO  sb_prRO  sb_prBO  sb_sumRO  sb_sumBO
    sa_kolO  sa_prRO  sa_prBO  sa_sumRO  sa_sumBO
    ss_kolO  ss_prRO  ss_prBO  ss_sumRO  ss_sumBO
    se_kolO  se_prRO  se_prBO  se_sumRO  se_sumBO
!.}
  ib_kolO  ib_prRO  ib_prBO  ib_sumRO  ib_sumBO
  ia_kolO  ia_prRO  ia_prBO  ia_sumRO  ia_sumBO
  is_kolO  is_prRO  is_prBO  is_sumRO  is_sumBO
  ie_kolO  ie_prRO  ie_prBO  ie_sumRO  ie_sumBO
.endfields

 Ш      Оборотная ведомость движения МЦ
     (в разрезе отпускных единиц измерения)
            с ^ по ^

 Используемые фильтры :
 Склад  : ^
 МОЛ    : ^
 МЦ     : ^
 Партия : ^

 И  Лист@NP@
───────────────────┬──────────────────────────────────────────────────┬──────────────────────────────────────────────────┬──────────────────────────────────────────────────┬──────────────────────────────────────────────────
                   │             ОСТАТОК НА НАЧАЛО                    │                   ПРИХОД                         │                   РАСХОД                         │               ОСТАТОК НА КОНЕЦ
                   ├──────┬─────────────────────┬─────────────────────┼──────┬─────────────────────┬─────────────────────┼──────┬─────────────────────┬─────────────────────┼──────┬─────────────────────┬─────────────────────
      СКЛАД        │кол-во│         цена        │        сумма        │кол-во│         цена        │        сумма        │кол-во│         цена        │        сумма        │кол-во│         цена        │        сумма
                   │      ├──────────┬──────────┼──────────┬──────────┤      ├──────────┬──────────┼──────────┬──────────┤      ├──────────┬──────────┼──────────┬──────────┤      ├──────────┬──────────┼──────────┬──────────
                   │      │ @@@@@@@@ │ @@@@@@@@ │ @@@@@@@@ │ @@@@@@@@ │      │ @@@@@@@@ │ @@@@@@@@ │ @@@@@@@@ │ @@@@@@@@ │      │ @@@@@@@@ │ @@@@@@@@ │ @@@@@@@@ │ @@@@@@@@ │      │ @@@@@@@@ │ @@@@@@@@ │ @@@@@@@@ │ @@@@@@@
───────────────────┴──────┴──────────┴──────────┴──────────┴──────────┴──────┴──────────┴──────────┴──────────┴──────────┴──────┴──────────┴──────────┴──────────┴──────────┴──────┴──────────┴──────────┴──────────┴──────────

.{
 Б ^  ^     единица измерения : ^ Б
.{
.if PosNoZero
@@@@@@@@@@@@@@@@@@@ &&&&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&&
.end
.}
    ИТОГО ПО МЦ     &&&&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&&
.}

ИТОГО ПО ВСЕМ МЦ    &&&&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& Ш


!.[f
!
!                                                                                                                                                                                                                     Лист @np@
!.]f
.endform



#doc
В разрезе Весовых характеристик
#end
.linkform 'tinyMC_V' prototype is 'TinyMC'
.nameInList 'В разрезе Весовых характеристик'
.Group 'Обычные отчеты'
.PAPER PA4
.ORIENT LANDSCAPE
.DEFO LANDSCAPE
.LL 80
.P 60
.[H SKIP
 Ш  Лист@NP@
─────────────────┬───────────────────────────────────────────────────┬───────────────────────────────────────────────────┬───────────────────────────────────────────────────┬───────────────────────────────────────────────────
                 │             ОСТАТОК НА НАЧАЛО                     │                    ПРИХОД                         │                    РАСХОД                         │               ОСТАТОК НА КОНЕЦ
      СКЛАД      ├───────┬─────────────────────┬─────────────────────┼───────┬─────────────────────┬─────────────────────┼───────┬─────────────────────┬─────────────────────┼───────┬─────────────────────┬─────────────────────
                 │  вес  │         цена        │        сумма        │  вес  │         цена        │        сумма        │  вес  │         цена        │        сумма        │  вес  │         цена        │        сумма
─────────────────┴───────┴─────────────────────┴─────────────────────┴───────┴─────────────────────┴─────────────────────┴───────┴─────────────────────┴─────────────────────┴───────┴─────────────────────┴─────────────────────
 Ш И.]H
.fields
  CommonFormHeader
.endfields
^
.fields
b_dat e_dat
sPodr sMOL sMC sParty
valR valB valR valB
valR valB valR valB
valR valB valR valB
valR valB valR valB
!.{
  mc_name mc_nom
!.{
!.if PosNoZero
      sklad
      b_kolV  b_prRV  b_prBV  b_sumRV  b_sumBV
      a_kolV  a_prRV  a_prBV  a_sumRV  a_sumBV
      s_kolV  s_prRV  s_prBV  s_sumRV  s_sumBV
      e_kolV  e_prRV  e_prBV  e_sumRV  e_sumBV
!.end
!.}
    sb_kolV  sb_prRV  sb_prBV  sb_sumRV  sb_sumBV
    sa_kolV  sa_prRV  sa_prBV  sa_sumRV  sa_sumBV
    ss_kolV  ss_prRV  ss_prBV  ss_sumRV  ss_sumBV
    se_kolV  se_prRV  se_prBV  se_sumRV  se_sumBV
!.}
  ib_kolV  ib_prRV  ib_prBV  ib_sumRV  ib_sumBV
  ia_kolV  ia_prRV  ia_prBV  ia_sumRV  ia_sumBV
  is_kolV  is_prRV  is_prBV  is_sumRV  is_sumBV
  ie_kolV  ie_prRV  ie_prBV  ie_sumRV  ie_sumBV
.endfields

 Ш      Оборотная ведомость движения МЦ
       (в разрезе Весовых характеристик)
            с ^ по ^

 Используемые фильтры :
 Склад  : ^
 МОЛ    : ^
 МЦ     : ^
 Партия : ^

 И  Лист@NP@
─────────────────┬───────────────────────────────────────────────────┬───────────────────────────────────────────────────┬───────────────────────────────────────────────────┬───────────────────────────────────────────────────
                 │              ОСТАТОК НА НАЧАЛО                    │                    ПРИХОД                         │                    РАСХОД                         │               ОСТАТОК НА КОНЕЦ
                 ├───────┬─────────────────────┬─────────────────────┼───────┬─────────────────────┬─────────────────────┼───────┬─────────────────────┬─────────────────────┼───────┬─────────────────────┬─────────────────────
      СКЛАД      │  вес  │         цена        │        сумма        │  вес  │         цена        │        сумма        │  вес  │         цена        │        сумма        │  вес  │         цена        │        сумма
                 │       ├──────────┬──────────┼──────────┬──────────┤       ├──────────┬──────────┼──────────┬──────────┤       ├──────────┬──────────┼──────────┬──────────┤       ├──────────┬──────────┼──────────┬──────────
                 │       │ @@@@@@@@ │ @@@@@@@@ │ @@@@@@@@ │ @@@@@@@@ │       │ @@@@@@@@ │ @@@@@@@@ │ @@@@@@@@ │ @@@@@@@@ │       │ @@@@@@@@ │ @@@@@@@@ │ @@@@@@@@ │ @@@@@@@@ │       │ @@@@@@@@ │ @@@@@@@@ │ @@@@@@@@ │ @@@@@@@
─────────────────┴───────┴──────────┴──────────┴──────────┴──────────┴───────┴──────────┴──────────┴──────────┴──────────┴───────┴──────────┴──────────┴──────────┴──────────┴───────┴──────────┴──────────┴──────────┴──────────

.{
 Б ^  ^ Б
.{
.if PosNoZero
@@@@@@@@@@@@@@@@  &&&.&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&.&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&.&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&.&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&&
.end
.}
    ИТОГО ПО МЦ   &&&.&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&.&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&.&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&.&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&&
.}

ИТОГО ПО ВСЕМ МЦ  &&&.&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&.&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&.&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&.&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& Ш
!.[f
!
!                                                                                                                                                                                                                     Лист @np@
!.]f
.endform

#doc
В  разрезе Весовых  характеристик (только вес)
#end
.linkform 'tinyMC_V1' prototype is 'TinyMC'
.nameInList  'В  разрезе Весовых  характеристик (только вес)'
.Group 'Обычные отчеты'
.PAPER PA4
.ORIENT PORTRAIT
.LL 80
.P 60
.[H SKIP
 Ш  Лист@NP@
────────────────────────────────┬──────────┬──────────┬──────────┬───────────
   Наименование МЦ              │ Входящий │  ПРИХОД  │  РАСХОД  │ Исходящий
                                │ остаток  │          │          │  остаток
────────────────────────────────┴──────────┴──────────┴──────────┴───────────
 Ш И.]H
.fields
  CommonFormHeader
.endfields
^
.fields
b_dat e_dat
sPodr sMOL sMC sParty
!.{
  mc_name mc_nom
!.{
!.if PosNoZero
      sklad
      b_kolV
      a_kolV
      s_kolV
      e_kolV
!.end
!.}
    sb_kolV
    sa_kolV
    ss_kolV
    se_kolV
!.}
  ib_kolV
  ia_kolV
  is_kolV
  ie_kolV
.endfields

 Ш            Оборотная ведомость движения МЦ
       (в разрезе Весовых характеристик, только вес)
            с ^ по ^

 Используемые фильтры :
 Склад  : ^
 МОЛ    : ^
 МЦ     : ^
 Партия : ^

 И  Лист@NP@
────────────────────────────────┬──────────┬──────────┬──────────┬───────────
   Наименование МЦ              │ Входящий │  ПРИХОД  │  РАСХОД  │ Исходящий
                                │ остаток  │          │          │  остаток
────────────────────────────────┴──────────┴──────────┴──────────┴───────────
.{
 Б ^  ^ Б
.{
.if PosNoZero
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&&.&&
.end
.}
       ИТОГО ПО МЦ               &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&&.&&
.}

ИТОГО ПО ВСЕМ МЦ                 &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&&.&& Ш
!.[f
!
!                                                                Лист @np@
!.]f
.endform


#doc
В разрезе учетных единиц измерения 
#end
.linkform 'tinyMC_Y_S' prototype is 'TinyMC'
.nameInList 'В разрезе учетных единиц измерения '
.Group 'Сводные отчеты'
.PAPER PA4
.ORIENT LANDSCAPE
.DEFO LANDSCAPE
.LL 80
.P 60
.[H SKIP
 Ш  Лист@NP@
─────────────────┬──────────────────────────────────────────────────┬──────────────────────────────────────────────────┬──────────────────────────────────────────────────┬──────────────────────────────────────────────────
                 │             ОСТАТОК НА НАЧАЛО                    │                   ПРИХОД                         │                   РАСХОД                         │               ОСТАТОК НА КОНЕЦ
 Наименование МЦ ├──────┬─────────────────────┬─────────────────────┼──────┬─────────────────────┬─────────────────────┼──────┬─────────────────────┬─────────────────────┼──────┬─────────────────────┬─────────────────────
                 │кол-во│         цена        │        сумма        │кол-во│         цена        │        сумма        │кол-во│         цена        │        сумма        │кол-во│         цена        │        сумма
─────────────────┴──────┴─────────────────────┴─────────────────────┴──────┴─────────────────────┴─────────────────────┴──────┴─────────────────────┴─────────────────────┴──────┴─────────────────────┴─────────────────────
 Ш И.]H
.fields
  CommonFormHeader
.endfields
^
.fields
b_dat e_dat
sPodr sMOL sMC sParty
valR valB valR valB
valR valB valR valB
valR valB valR valB
valR valB valR valB
!.{
!.{
!.if PosNoZero
!.end
!.}
  mc_name mc_nom  ed_Y
    sb_kolY  sb_prRY  sb_prBY  sb_sumRY  sb_sumBY
    sa_kolY  sa_prRY  sa_prBY  sa_sumRY  sa_sumBY
    ss_kolY  ss_prRY  ss_prBY  ss_sumRY  ss_sumBY
    se_kolY  se_prRY  se_prBY  se_sumRY  se_sumBY
!.}
  ib_kolY  ib_prRY  ib_prBY  ib_sumRY  ib_sumBY
  ia_kolY  ia_prRY  ia_prBY  ia_sumRY  ia_sumBY
  is_kolY  is_prRY  is_prBY  is_sumRY  is_sumBY
  ie_kolY  ie_prRY  ie_prBY  ie_sumRY  ie_sumBY
.endfields

 Ш      Оборотная ведомость движения МЦ
     (в разрезе учетных единиц измерения)
            с ^ по ^

 Используемые фильтры :
 Склад  : ^
 МОЛ    : ^
 МЦ     : ^
 Партия : ^

 И  Лист@NP@
─────────────────┬──────────────────────────────────────────────────┬──────────────────────────────────────────────────┬──────────────────────────────────────────────────┬──────────────────────────────────────────────────
                 │             ОСТАТОК НА НАЧАЛО                    │                   ПРИХОД                         │                   РАСХОД                         │               ОСТАТОК НА КОНЕЦ
                 ├──────┬─────────────────────┬─────────────────────┼──────┬─────────────────────┬─────────────────────┼──────┬─────────────────────┬─────────────────────┼──────┬─────────────────────┬─────────────────────
 Наименование МЦ │кол-во│         цена        │        сумма        │кол-во│         цена        │        сумма        │кол-во│         цена        │        сумма        │кол-во│         цена        │        сумма
                 │      ├──────────┬──────────┼──────────┬──────────┤      ├──────────┬──────────┼──────────┬──────────┤      ├──────────┬──────────┼──────────┬──────────┤      ├──────────┬──────────┼──────────┬──────────
                 │      │ @@@@@@@@ │ @@@@@@@@ │ @@@@@@@@ │ @@@@@@@@ │      │ @@@@@@@@ │ @@@@@@@@ │ @@@@@@@@ │ @@@@@@@@ │      │ @@@@@@@@ │ @@@@@@@@ │ @@@@@@@@ │ @@@@@@@@ │      │ @@@@@@@@ │ @@@@@@@@ │ @@@@@@@@ │ @@@@@@@
─────────────────┴──────┴──────────┴──────────┴──────────┴──────────┴──────┴──────────┴──────────┴──────────┴──────────┴──────┴──────────┴──────────┴──────────┴──────────┴──────┴──────────┴──────────┴──────────┴──────────

.{
.{
.if PosNoZero
.end
.}
 Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
 @@@@@@@@@@@@@@@@
 @@@@@@@@@@@@@@@@ &&&&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&&
.}

ИТОГО ПО ВСЕМ МЦ  &&&&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& Ш
!.[f
!
!                                                                                                                                                                                                                    Лист @np@
!.]f
.endform

#doc
В разрезе отпускных единиц измерения 
#end
.linkform 'tinyMC_O_S' prototype is 'TinyMC'
.nameInList 'В разрезе отпускных единиц измерения '
.Group 'Сводные отчеты'
.PAPER PA4
.ORIENT LANDSCAPE
.DEFO LANDSCAPE
.LL 80
.P 60
.[H SKIP
 Ш  Лист@NP@
──────────────────┬──────────────────────────────────────────────────┬──────────────────────────────────────────────────┬──────────────────────────────────────────────────┬──────────────────────────────────────────────────
                  │             ОСТАТОК НА НАЧАЛО                    │                   ПРИХОД                         │                   РАСХОД                         │               ОСТАТОК НА КОНЕЦ
 Наименование МЦ  ├──────┬─────────────────────┬─────────────────────┼──────┬─────────────────────┬─────────────────────┼──────┬─────────────────────┬─────────────────────┼──────┬─────────────────────┬─────────────────────
                  │кол-во│         цена        │        сумма        │кол-во│         цена        │        сумма        │кол-во│         цена        │        сумма        │кол-во│         цена        │        сумма
──────────────────┴──────┴─────────────────────┴─────────────────────┴──────┴─────────────────────┴─────────────────────┴──────┴─────────────────────┴─────────────────────┴──────┴─────────────────────┴─────────────────────
 Ш И.]H
.fields
  CommonFormHeader
.endfields
^
.fields
b_dat e_dat
sPodr sMOL sMC sParty
valR valB valR valB
valR valB valR valB
valR valB valR valB
valR valB valR valB
!.{
!.{
!.if PosNoZero
!.end
!.}
  mc_name mc_nom  ed_O
    sb_kolO  sb_prRO  sb_prBO  sb_sumRO  sb_sumBO
    sa_kolO  sa_prRO  sa_prBO  sa_sumRO  sa_sumBO
    ss_kolO  ss_prRO  ss_prBO  ss_sumRO  ss_sumBO
    se_kolO  se_prRO  se_prBO  se_sumRO  se_sumBO
!.}
  ib_kolO  ib_prRO  ib_prBO  ib_sumRO  ib_sumBO
  ia_kolO  ia_prRO  ia_prBO  ia_sumRO  ia_sumBO
  is_kolO  is_prRO  is_prBO  is_sumRO  is_sumBO
  ie_kolO  ie_prRO  ie_prBO  ie_sumRO  ie_sumBO
.endfields

 Ш      Оборотная ведомость движения МЦ
     (в разрезе отпускных единиц измерения)
            с ^ по ^

 Используемые фильтры :
 Склад  : ^
 МОЛ    : ^
 МЦ     : ^
 Партия : ^

 И  Лист@NP@
──────────────────┬──────────────────────────────────────────────────┬──────────────────────────────────────────────────┬──────────────────────────────────────────────────┬──────────────────────────────────────────────────
                  │             ОСТАТОК НА НАЧАЛО                    │                   ПРИХОД                         │                   РАСХОД                         │               ОСТАТОК НА КОНЕЦ
                  ├──────┬─────────────────────┬─────────────────────┼──────┬─────────────────────┬─────────────────────┼──────┬─────────────────────┬─────────────────────┼──────┬─────────────────────┬─────────────────────
  Наименование МЦ │кол-во│         цена        │        сумма        │кол-во│         цена        │        сумма        │кол-во│         цена        │        сумма        │кол-во│         цена        │        сумма
                  │      ├──────────┬──────────┼──────────┬──────────┤      ├──────────┬──────────┼──────────┬──────────┤      ├──────────┬──────────┼──────────┬──────────┤      ├──────────┬──────────┼──────────┬──────────
                  │      │ @@@@@@@@ │ @@@@@@@@ │ @@@@@@@@ │ @@@@@@@@ │      │ @@@@@@@@ │ @@@@@@@@ │ @@@@@@@@ │ @@@@@@@@ │      │ @@@@@@@@ │ @@@@@@@@ │ @@@@@@@@ │ @@@@@@@@ │      │ @@@@@@@@ │ @@@@@@@@ │ @@@@@@@@ │ @@@@@@@
──────────────────┴──────┴──────────┴──────────┴──────────┴──────────┴──────┴──────────┴──────────┴──────────┴──────────┴──────┴──────────┴──────────┴──────────┴──────────┴──────┴──────────┴──────────┴──────────┴──────────

.{
.{
.if PosNoZero
.end
.}
 Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
 @@@@@@@@@@@@@@@@@ 
 @@@@@@@@@@@@@@@@@ &&&&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&&
.}

ИТОГО ПО ВСЕМ МЦ   &&&&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& Ш
!.[f
!
!                                                                                                                                                                                                                    Лист @np@
!.]f
.endform




#doc
В разрезе Весовых характеристик 
#end
.linkform 'tinyMC_V_S' prototype is 'TinyMC'
.nameInList 'В разрезе Весовых характеристик '
.Group 'Сводные отчеты'
.PAPER PA4
.ORIENT LANDSCAPE
.DEFO LANDSCAPE
.LL 80
.P 60
.[H SKIP
 Ш  Лист@NP@
────────────────┬───────────────────────────────────────────────────┬───────────────────────────────────────────────────┬───────────────────────────────────────────────────┬───────────────────────────────────────────────────
                │              ОСТАТОК НА НАЧАЛО                    │                    ПРИХОД                         │                    РАСХОД                         │                ОСТАТОК НА КОНЕЦ
 Наименование МЦ├───────┬─────────────────────┬─────────────────────┼───────┬─────────────────────┬─────────────────────┼───────┬─────────────────────┬─────────────────────┼───────┬─────────────────────┬─────────────────────
                │  вес  │         цена        │        сумма        │  вес  │         цена        │        сумма        │  вес  │         цена        │        сумма        │  вес  │         цена        │        сумма
────────────────┴───────┴─────────────────────┴─────────────────────┴───────┴─────────────────────┴─────────────────────┴───────┴─────────────────────┴─────────────────────┴───────┴─────────────────────┴─────────────────────
 Ш И.]H
.fields
  CommonFormHeader
.endfields
^
.fields
b_dat e_dat
sPodr sMOL sMC sParty
valR valB valR valB
valR valB valR valB
valR valB valR valB
valR valB valR valB
!.{
!.{
!.if PosNoZero
!.end
!.}
  mc_name mc_nom
    sb_kolV  sb_prRV  sb_prBV  sb_sumRV  sb_sumBV
    sa_kolV  sa_prRV  sa_prBV  sa_sumRV  sa_sumBV
    ss_kolV  ss_prRV  ss_prBV  ss_sumRV  ss_sumBV
    se_kolV  se_prRV  se_prBV  se_sumRV  se_sumBV
!.}
  ib_kolV  ib_prRV  ib_prBV  ib_sumRV  ib_sumBV
  ia_kolV  ia_prRV  ia_prBV  ia_sumRV  ia_sumBV
  is_kolV  is_prRV  is_prBV  is_sumRV  is_sumBV
  ie_kolV  ie_prRV  ie_prBV  ie_sumRV  ie_sumBV
.endfields

 Ш      Оборотная ведомость движения МЦ
       (в разрезе Весовых характеристик)
            с ^ по ^

 Используемые фильтры :
 Склад  : ^
 МОЛ    : ^
 МЦ     : ^
 Партия : ^

 И  Лист@NP@
────────────────┬───────────────────────────────────────────────────┬───────────────────────────────────────────────────┬───────────────────────────────────────────────────┬───────────────────────────────────────────────────
                │              ОСТАТОК НА НАЧАЛО                    │                    ПРИХОД                         │                   РАСХОД                          │               ОСТАТОК НА КОНЕЦ
                ├───────┬─────────────────────┬─────────────────────┼───────┬─────────────────────┬─────────────────────┼───────┬─────────────────────┬─────────────────────┼───────┬─────────────────────┬─────────────────────
 Наименование МЦ│  вес  │         цена        │        сумма        │  вес  │         цена        │        сумма        │  вес  │         цена        │        сумма        │  вес  │         цена        │        сумма
                │       ├──────────┬──────────┼──────────┬──────────┤       ├──────────┬──────────┼──────────┬──────────┤       ├──────────┬──────────┼──────────┬──────────┤       ├──────────┬──────────┼──────────┬──────────
                │       │ @@@@@@@@ │ @@@@@@@@ │ @@@@@@@@ │ @@@@@@@@ │       │ @@@@@@@@ │ @@@@@@@@ │ @@@@@@@@ │ @@@@@@@@ │       │ @@@@@@@@ │ @@@@@@@@ │ @@@@@@@@ │ @@@@@@@@ │       │ @@@@@@@@ │ @@@@@@@@ │ @@@@@@@@ │ @@@@@@@
────────────────┴───────┴──────────┴──────────┴──────────┴──────────┴───────┴──────────┴──────────┴──────────┴──────────┴───────┴──────────┴──────────┴──────────┴──────────┴───────┴──────────┴──────────┴──────────┴──────────
.{
.{
.if PosNoZero
.end
.}
 Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
 @@@@@@@@@@@@@@@ &&&.&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&.&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&.&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&.&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&&
.}

ИТОГО ПО ВСЕМ МЦ &&&.&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&.&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&.&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&.&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& Ш
!.[f
!
!                                                                                                                                                                                                                                        Лист @np@
!.]f
.endform

#doc
В разрезе Весовых характеристик (только вес)
#end
.linkform 'tinyMC_V_S1' prototype is 'TinyMC'
.nameInList 'В разрезе Весовых характеристик (только вес)'
.Group 'Сводные отчеты'
.PAPER PA4
.ORIENT PORTRAIT
.LL 80
.P 60
.[H SKIP
 Ш  Лист@NP@
────────────────────────────────┬──────────┬──────────┬──────────┬───────────
   Наименование МЦ              │ Входящий │  ПРИХОД  │  РАСХОД  │ Исходящий
                                │ остаток  │          │          │  остаток
────────────────────────────────┴──────────┴──────────┴──────────┴───────────
 Ш И.]H
.fields
  CommonFormHeader
.endfields
^
.fields
b_dat e_dat
sPodr sMOL sMC sParty
!.{
!.{
!.if PosNoZero
!.end
!.}
  mc_name mc_nom
    sb_kolV
    sa_kolV
    ss_kolV
    se_kolV
!.}
  ib_kolV
  ia_kolV
  is_kolV
  ie_kolV
.endfields

 Ш            Оборотная ведомость движения МЦ
       (в разрезе Весовых характеристик, только вес)
            с ^ по ^

 Используемые фильтры :
 Склад  : ^
 МОЛ    : ^
 МЦ     : ^
 Партия : ^

 И  Лист@NP@
────────────────────────────────┬──────────┬──────────┬──────────┬───────────
   Наименование МЦ              │ Входящий │  ПРИХОД  │  РАСХОД  │ Исходящий
                                │ остаток  │          │          │  остаток
────────────────────────────────┴──────────┴──────────┴──────────┴───────────
.{
.{
.if PosNoZero
.end
.}
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  @@@@@@@@@@@@@@@@@@@@           &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&&.&&
.}

ИТОГО ПО ВСЕМ МЦ                 &&&&&&&.&& &&&&&&&.&& &&&&&&&.&& &&&&&&&&.&& Ш
!.[f
!
!                                                                  Лист @np@
!.]f
.endform

#doc
В разрезе учетных единиц измерения 
#end
.linkform 'tinyMC_Y_S' prototype is 'TinyMC'
.nameInList 'В разрезе учетных единиц измерения '
.Group 'Только в НДЕ и учетных единицах'
.PAPER PA4
.ORIENT LANDSCAPE
.DEFO LANDSCAPE
.LL 80
.P 60
.[H SKIP
 Ш  Лист@NP@
─────────────────────────────────┬────────────────────────────────┬────────────────────────────────┬────────────────────────────────┬────────────────────────────────
                                 │ ОСТАТОК НА НАЧАЛО              │ ПРИХОД                         │ РАСХОД                         │ ОСТАТОК НА КОНЕЦ
    Наименование МЦ              ├──────────┬──────────┬──────────┼──────────┬──────────┬──────────┼──────────┬──────────┬──────────┼──────────┬──────────┬──────────
                                 │кол-во    │ цена     │ сумма    │ кол-во   │ цена     │ сумма    │ кол-во   │ цена     │ сумма    │ кол-во   │ цена     │ сумма
─────────────────────────────────┴──────────┴──────────┴──────────┴──────────┴──────────┴──────────┴──────────┴──────────┴──────────┴──────────┴──────────┴──────────
 Ш И.]H
.fields
  CommonFormHeader
.endfields
^
.fields
b_dat e_dat
sPodr sMOL sMC sParty
valR valR
valR valR
valR valR
valR valR
!.{
!.{
!.if PosNoZero
!.end
!.}
  mc_name mc_nom  ed_Y
    sb_kolY  sb_prRY  sb_sumRY
    sa_kolY  sa_prRY  sa_sumRY
    ss_kolY  ss_prRY  ss_sumRY
    se_kolY  se_prRY  se_sumRY
!.}
  ib_kolY  ib_prRY  ib_sumRY
  ia_kolY  ia_prRY  ia_sumRY
  is_kolY  is_prRY  is_sumRY
  ie_kolY  ie_prRY  ie_sumRY
.endfields

 Ш     Оборотная ведомость движения МЦ
     (в разрезе учетных единиц измерения)
            с ^ по ^

 Используемые фильтры :
 Склад  : ^
 МОЛ    : ^
 МЦ     : ^
 Партия : ^

 И  Лист@NP@
─────────────────────────────────┬────────────────────────────────┬────────────────────────────────┬────────────────────────────────┬────────────────────────────────
                                 │ ОСТАТОК НА НАЧАЛО              │ ПРИХОД                         │ РАСХОД                         │ ОСТАТОК НА КОНЕЦ
                                 ├──────────┬──────────┬──────────┼──────────┬──────────┬──────────┼──────────┬──────────┬──────────┼──────────┬──────────┬──────────
    Наименование МЦ              │кол-во    │ цена     │ сумма    │ кол-во   │ цена     │ сумма    │ кол-во   │ цена     │ сумма    │ кол-во   │ цена     │ сумма
                                 │          │ @@@@@@@@ │ @@@@@@@@ │          │ @@@@@@@@ │ @@@@@@@@ │          │ @@@@@@@@ │ @@@@@@@@ │          │ @@@@@@@@ │ @@@@@@@@
─────────────────────────────────┴──────────┴──────────┴──────────┴──────────┴──────────┴──────────┴──────────┴──────────┴──────────┴──────────┴──────────┴──────────

.{
.{
.if PosNoZero
.end
.}
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@ &&&&&&&&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&&&& &&&&&&&.&& &&&&&&&.&&
.}

 БИТОГО ПО ВСЕМ МЦ                &&&&&&&&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&&&& &&&&&&&.&& &&&&&&&.&& &&&&&&&&&& &&&&&&&.&& &&&&&&&.&& Щ
!.[f
!
!                                                                                                                                                        Лист @np@
!.]f
.endform

#doc
С содержанием драгметаллов
#end
.linkform 'tinyMC_Drag' prototype is 'TinyMC'
.nameinlist 'С содержанием драгметаллов'
.Group 'Сводные отчеты'
.PAPER PA4
.ORIENT LANDSCAPE
.DEFO LANDSCAPE
.LL 80
.P 60
.[H SKIP
 Ш   Лист@NP@
──────────────────────────┬────────────────────┬────────┬────────────────────┬──────────────────────┬──────────────────────┬──────────────────────┬──────────────────────┬──────────────────
 Наименование МЦ/драгмет. │   Номенк. номер    │Ед.учета│ Содержание драгмет.│   ВХОДЯЩИЙ ОСТАТОК   │        ПРИХОД        │        РАСХОД        │  ИСХОДЯЩИЙ ОСТАТОК   │СПОСОБ ОПРЕДЕЛЕНИЯ
──────────────────────────┼────────────────────┼────────┼────────────────────┼──────────────────────┼──────────────────────┼──────────────────────┼──────────────────────┼──────────────────
          (1)             │        (2)         │   (3)  │        (4)         │         (5)          │          (6)         │          (7)         │          (8)         │        (9)
──────────────────────────┴────────────────────┴────────┴────────────────────┴──────────────────────┴──────────────────────┴──────────────────────┴──────────────────────┴────────────────── Ш
 И.]H
.create view VDrag
from  KatDrag(readonly), NalDrag(readonly), KatEd(readonly), TmpSaldo2
where
(( word(3)          == NalDrag.TiDk   and
   mc_nRec          == NalDrag.cKatOS and
   NalDrag.cKatDrag == KatDrag.nRec   and
   KatDrag.cKatEd   == KatEd.nRec
))
;
.create view AllDrag
from  TmpSaldo2(readonly),  KatDrag(readonly),  KatEd(readonly)
where
(( TmpSaldo2.cMC    == KatDrag.nRec   and
   KatDrag.cKatEd   == KatEd.nRec
))
;
.fields
 CommonFormHeader
 b_dat e_dat
 sPodr sMOL sMC sParty
!.{
!.{
!.if PosNoZero
!.end
!.}
  mc_name mc_nom  ed_Y   sb_kolY  sa_kolY  ss_kolY  se_kolY
!.}
.endfields
^

  Журнал учета драгоценных металлов (камней) в МЦ
  (оборотная ведомость с ^ по ^)
 Р
 Используемые фильтры :
 Склад  : ^
 МОЛ    : ^
 МЦ     : ^
 Партия : ^ Ш
 И.begin
VDrag.delete all TmpSaldo2;
end.
 Р   Лист@NP@
──────────────────────────┬────────────────────┬────────┬────────────────────┬──────────────────────┬──────────────────────┬──────────────────────┬──────────────────────┬──────────────────
 Наименование МЦ/драгмет. │   Номенк. номер    │Ед.учета│ Содержание драгмет.│   ВХОДЯЩИЙ ОСТАТОК   │        ПРИХОД        │        РАСХОД        │  ИСХОДЯЩИЙ ОСТАТОК   │СПОСОБ ОПРЕДЕЛЕНИЯ
──────────────────────────┼────────────────────┼────────┼────────────────────┼──────────────────────┼──────────────────────┼──────────────────────┼──────────────────────┼──────────────────
          (1)             │        (2)         │   (3)  │        (4)         │         (5)          │          (6)         │          (7)         │          (8)         │        (9)
──────────────────────────┴────────────────────┴────────┴────────────────────┴──────────────────────┴──────────────────────┴──────────────────────┴──────────────────────┴────────────────── Ш
 И.{
.{
.if PosNoZero
.end
.}
.begin
if VDrag.getFirst NalDrag <>tsOk  tinyMC_Drag.fbreak; 
end.    
 С@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@ @@@@@@@@@                     &&&&&&&&&&&&&&&&&&&&& &&&&&&&&&&&&&&&&&&&&&& &&&&&&&&&&&&&&&&&&&&&& &&&&&&&&&&&&&&&&&&&&&& С
.{ table 'VDrag.NalDrag'                                                      
.fields
   VDrag.KatDrag.Name
   VDrag.KatDrag.Kod
   VDrag.KatEd.Name
   DoubleToStr(VDrag.NalDrag.Kol, '[|-]3666`666`666`666.8889999999')
   DoubleToStr(sb_kolY * VDrag.NalDrag.Kol, '[|-]3666`666`666`666.8889999999')
   DoubleToStr(sa_kolY * VDrag.NalDrag.Kol, '[|-]3666`666`666`666.8889999999')
   DoubleToStr(ss_kolY * VDrag.NalDrag.Kol, '[|-]3666`666`666`666.8889999999')
   DoubleToStr(se_kolY * VDrag.NalDrag.Kol, '[|-]3666`666`666`666.8889999999')
   if(VDrag.NalDrag.VidDrag=0, 'паспорт', 
      if(VDrag.NalDrag.VidDrag=1, 'комиссионно',
         if(VDrag.NalDrag.VidDrag=2, 'справочник', '')))
.endfields
.begin
if VDrag.GetFirst TmpSaldo2 where ((VDrag.KatDrag.nRec == TmpSaldo2.cMC))<>tsOk
  { VDrag.TmpSaldo2.cMC := VDrag.KatDrag.nRec;
    VDrag.TmpSaldo2.kol := sb_kolY * VDrag.NalDrag.Kol;
    VDrag.TmpSaldo2.kolP:= sa_kolY * VDrag.NalDrag.Kol;
    VDrag.TmpSaldo2.kolR:= ss_kolY * VDrag.NalDrag.Kol;
    VDrag.TmpSaldo2.sumP:= se_kolY * VDrag.NalDrag.Kol;
    VDrag.insert current TmpSaldo2;
  }
else
  { VDrag.TmpSaldo2.kol := VDrag.TmpSaldo2.kol  + sb_kolY * VDrag.NalDrag.Kol;
    VDrag.TmpSaldo2.kolP:= VDrag.TmpSaldo2.kolP + sa_kolY * VDrag.NalDrag.Kol;
    VDrag.TmpSaldo2.kolR:= VDrag.TmpSaldo2.kolR + ss_kolY * VDrag.NalDrag.Kol;
    VDrag.TmpSaldo2.sumP:= VDrag.TmpSaldo2.sumP + se_kolY * VDrag.NalDrag.Kol;
    VDrag.update current TmpSaldo2;
  }     
end.
 Р  @@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@ @@@@@@@@@ &&&&&&&&&&&&&&&&&&& &&&&&&&&&&&&&&&&&&&&& &&&&&&&&&&&&&&&&&&&&&& &&&&&&&&&&&&&&&&&&&&&& &&&&&&&&&&&&&&&&&&&&&&   @@@@@@@@@@@@@@@@@@ Р
.}
.}

 С  ИТОГО Щ
 И.{ table 'AllDrag.TmpSaldo2'
.fields
   AllDrag.KatDrag.Name
   AllDrag.KatDrag.Kod
   AllDrag.KatEd.Name
   DoubleToStr(AllDrag.TmpSaldo2.kol , '[|-]3666`666`666`666.8889999999')
   DoubleToStr(AllDrag.TmpSaldo2.kolP, '[|-]3666`666`666`666.8889999999')
   DoubleToStr(AllDrag.TmpSaldo2.kolR, '[|-]3666`666`666`666.8889999999')
   DoubleToStr(AllDrag.TmpSaldo2.sumP, '[|-]3666`666`666`666.8889999999')
.endfields
 С  @@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@ @@@@@@@@@                     &&&&&&&&&&&&&&&&&&&&& &&&&&&&&&&&&&&&&&&&&&& &&&&&&&&&&&&&&&&&&&&&& &&&&&&&&&&&&&&&&&&&&&& С
.}                                                                              

   Руководитель предприятия

   Главный бухгалтер

   М.П.                             
.endform

