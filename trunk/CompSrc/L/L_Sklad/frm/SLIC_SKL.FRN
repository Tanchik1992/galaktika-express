! ╔═════════════════════════════════════════════════════════════════════════╗
! ║  Разработал:  Александр Крахотко                                        ║
! ║  Назначение:  Сличительная ведомость по итогам инвентаризации           ║
! ╚═════════════════════════════════════════════════════════════════════════╝
!
#include slic_skl.pro
#include slic_n19.frn

#doc
Сличительная ведомость по итогам инвентаризации
#end
.linkform 'SLIC_SKL_1' prototype is 'InvVed'
.nameInList 'Сличительная ведомость по итогам инвентаризации'
.group 'Сличительные ведомости (Беларусь)'
.group 'Сличительные ведомости'
#CommissionLinkVar
#CommissionLinkInit(PrintPereo)
.fields
  CommonFormHeader
.endfields
^
.fields
    склад
    if(мол='','не задан',мол)
    дата_инвентаризации : 'm:DD/MM/YYYY'
!.{
      мц_код
      мц_название
      партия
      ед_измерения
      дата_выявления : 'm:DD/MM/YYYY'
      кол_инвентаризации
      кол_программно
      цена_новая
!      DoubleToStr((кол_инвентаризации-кол_программно),'[+|-]36`666.99999999') : 'T:R'
!      DoubleToStr((кол_инвентаризации-кол_программно),'3666666666666666.999999999') : 'R'
      DoubleToStr(кол_инвентаризации-кол_программно,'[|-]3666`666`666`666`666'+sKolZnak)
      (кол_инвентаризации-кол_программно)*цена_новая
!.}
.endfields
.p 60
.defo Landscape

 Й    В Е Д О М О С Т Ь   П О   И Т О Г А М   И Н В Е Н Т А Р И З А Ц И И Й

 И  Склад : ^
  МОЛ   : ^
  Дата инвентаризации : ^ И

.{
.[h OverWrite
 Р────────────────┬─────────────────────────────────────┬──────────────────────────┬─────────┬──────────┬────────────┬────────────┬───────────────┬─────────────┬───────────────────
 Номенклатурный │  Наименование товара                │  Партия товара           │ Единица │   Дата   │Фактический │ Расчетный  │  Цена в НДЕ   │ Расхождение │ Сумма расхождения
  номер товара  │                                     │                          │измерения│ остатков │  остаток   │  остаток   │               │             │      в НДЕ
────────────────┴─────────────────────────────────────┴──────────────────────────┴─────────┴──────────┴────────────┴────────────┴───────────────┴─────────────┴─────────────────── Р
.]h
.if flagParty
.{
 Р@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@ @@@@@@@@@@ &&&&&&&&&&&& &&&&&&&&&&&& &&&&&&&&&&&&.&& &&&&&&&&&&&&& &&&&&&&&&&&&&&&&.&& Р
.}
.end
.}
 Р────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── Р
.{While (Номер_члена_комиссии < Количество_членов_комиссии)
.begin
  Номер_члена_комиссии := Номер_члена_комиссии + 1;
end.
.}
.endform


