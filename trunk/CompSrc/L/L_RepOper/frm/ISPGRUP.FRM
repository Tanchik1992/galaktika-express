/*
 ╔════════════════════════════════════════════════════════════════════════════╗
 ║                     (c) Корпорация ГАЛАКТИКА, 1996,97                      ║
 ║ Проект        : ГАЛАКТИКА                                                  ║
 ║ Система       : Оперативный контур                                         ║
 ║ Версия        : 5.00                                                       ║
 ║ Назначение    : Исполняемые договора в разрезе групп документов-оснований  ║
 ║ Ответственный : Володько Вадим Геннадьевич (VVG)                           ║
 ╚════════════════════════════════════════════════════════════════════════════╝
*/
#doc
Исполняемые договора в разрезе групп документов-оснований
#end
.set name='ispgrup'
.hide
.fields  // IspGrup. Поля: Заголовок
 valtar valbas header header2 header3
.endfields
национальная валюта ^
валюта для отчетов  ^
заголовок1 ^
заголовок2 ^
заголовок3 ^
------------------------------------------------------------------------------
.{//1
.fields  // IspGrup. Поля: Справочная информация о контрагенте
 namekongrp adrkongrp telkongrp
.endfields
группы, привязанные к контрагенту ^
                адрес   ^
                телефон ^
.{//2
=========================================================
.fields // IspGrup. Поля: Справочная информация о группе
 namgrp dfinish gstar gsbas gsval gssimval
.endfields
.{//3
группа ^
.}//3
дата ^
сумма ^ ^ ^ ^
.{//4
---------------------------------------------------------
.fields  // IspGrup. Поля: Информация по ДО
 namkontr adrkontr telkontr
 cBaseDoc: comp //BaseDoc.nRec
 namdog numbdog datdog dogprim datepost
 sumdog
 sumdogv
 dogsumo           // сумма по договору
 dogsimval         // валюта договора
 v1                // сумма договора для нерублевых ДО (в скобках)
 v2                // процент наценки
 dogNDS
 dogNDSv
 dogNDSo
.endfields
контрагент ^ ^ ^
BaseDoc.nRec ^
договор ^ N ^ от ^
примечание^
дата поставки ^
сумма ^
в валюте для отчетов ^
сумма по договору ^ в ^
в скобках: ^ ^
НДС ^
в валюте для отчетов ^
НДС по договору ^
.{//5
.fields // IspGrup. Поля: Суммы по дебету и кредиту
 debdate debdoc debsum debsumv debsumval debsimval debsumo debNDS debNDSv debNDSval debNDSo
 krddate krddoc krdsum krdsumv krdsumval krdsimval krdsumo krdNDS krdNDSv krdNDSval krdNDSo
.endfields
^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^
^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^
.}//5
------------------------------------
.fields // IspGrup. Поля: Общие суммы и задолженности по дебету и кредиту
 debtot debtotv debtoto krdtot krdtotv krdtoto
 debNDStot debNDStotv debNDStoto krdNDStot krdNDStotv krdNDStoto
 debdol debdolv debdolo krddol krddolv krddolo
 debNDSdol debNDSdolv debNDSdolo krdNDSdol krdNDSdolv krdNDSdolo
 debpros debprosv debproso krdpros krdprosv krdproso
 debNDSpros debNDSprosv debNDSproso krdNDSpros krdNDSprosv krdNDSproso
.endfields
^ ^ ^ ^ ^ ^
^ ^ ^ ^ ^ ^
^ ^ ^ ^ ^ ^
^ ^ ^ ^ ^ ^
^ ^ ^ ^ ^ ^
^ ^ ^ ^ ^ ^
.fields  // IspGrup. Поля: Примечание
  remark
.endfields
примечание ^
.}//4
=====================================
.fields  // IspGrup. Поля: Общие суммы по группе ДО
 kondol ourdol
 kondolv ourdolv
 konpros ourpros
 konprosv ourprosv
 GrpOsnSum GrpOsnSumV
 konNDSdol ourNDSdol
 konNDSdolv ourNDSdolv
 konNDSpros ourNDSpros
 konNDSprosv ourNDSprosv
 GrpOsnNDS GrpOsnNDSV
 remgrp
.endfields
итого по контрагенту:
^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^
.}//2
.fields   // IspGrup. Поля: Общие суммы по задолженности
 kon1dol our1dol kon1dolv our1dolv
 kon1pros our1pros kon1prosv our1prosv
 kon1NDSdol our1NDSdol kon1NDSdolv our1NDSdolv
 kon1NDSpros our1NDSpros kon1NDSprosv our1NDSprosv
.endfields
^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^
.}//1
.fields   // IspGrup. Поля: Общие суммы по отчету
 nadat
 tkondol tourdol tkondolv tourdolv
 tkonpros tourpros tkonprosv tourprosv
 tkonNDSdol tourNDSdol tkonNDSdolv tourNDSdolv
 tkonNDSpros tourNDSpros tkonNDSprosv tourNDSprosv
.endfields
всего на ^
^ ^ ^ ^
^ ^ ^ ^
^ ^ ^ ^
^ ^ ^ ^
.endform
!
!
!
!
!
#doc
Реестр исполняемых договоров по группам договоров
#end
.linkform 'ispgrup01' prototype is 'ispgrup'
.nameinlist 'Реестр исполняемых договоров по группам договоров'
.group 'Подробные реестры исполнения договоров из групп ДО'
.group 'В национальной валюте и валюте для отчетов'
.group 'В валюте для отчетов'
.fields
 CommonFormHeader
 header
.endfields
^
       БРеестр исполняемых договоров, принадлежащих к определенным группам
  @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
 Ш
.{
.fields
 namekongrp
.endfields
══════════════════════════════════════════════════════════════════════════════════════════════════════════════════
 Группа по контрагенту: ^
.{
══════════════════════════════════════════════════════════════════════════════════════════════════════════════════
 Наименование группы:
.{
.fields
 namgrp
.endfields
 ^
.}
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.{
.fields
 namkontr
 namdog numbdog datdog sumdog valtar sumdogv valbas v1 v2
 dogprim
 valtar valbas valtar valbas
.endfields
 Контрагент: ^
 ^ N ^ от ^ на сумму ^' в ^, ^' в ^ ^ ^
 ^
┌─────────────────────────────────────────────────────────────────────────────────┐┌──────────────────────────────────────────────────────────────────────────────────┐
│                       ДЕБЕТ (поступления товаров/денег)                         ││                     КРЕДИТ (наши платежи/поставки товаров)                       │
├──────────┬─────────────────────────────────┬─────────────────┬──────────────────┤├──────────┬─────────────────────────────────┬──────────────────┬──────────────────┤
│   Дата   │             Документ            │  Сумма в @@@@@@ │  Сумма в @@@@@@  ││   Дата   │             Документ            │  Сумма в @@@@@@  │  Сумма в @@@@@@  │
├──────────┴─────────────────────────────────┴─────────────────┴──────────────────┤├──────────┴─────────────────────────────────┴──────────────────┴──────────────────┤
.{
.fields
 debdate debdoc debsum debsumv krddate krddoc krdsum krdsumv
.endfields
│@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&││@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&│
.}
.fields
 debtot debtotv krdtot krdtotv
 debdol debdolv krddol krddolv
 remark
.endfields
└────────────────────────┬────────────────────────────────────────────────────────┤└───────────────────────┬──────────────────────────────────────────────────────────┤
                         │ Итого получено:    &'&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&│                        │ Итого отправлено:   &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&│
                         │ Долг контрагента:  &'&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&│                        │ Наш долг:           &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&│
                         └────────────────────────────────────────────────────────┘                        └──────────────────────────────────────────────────────────┘
 ^
───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.}
.fields
 kondol valtar ourdol valtar
 kondolv valbas ourdolv valbas
 remgrp
 kon1dol valtar our1dol valtar
 kon1dolv valbas our1dolv valbas
 nadat
 tkondol valtar tourdol valtar
 tkondolv valbas tourdolv valbas
.endfields

 Б ВСЕГО по группе договоров
  долг контрагентов:&'&&&&&&&&&&&&&&&&& в @@@@@@   наш долг:&'&&&&&&&&&&&&&&&&& в @@@@@@
                    &'&&&&&&&&&&&&&&&&& в @@@@@@            &'&&&&&&&&&&&&&&&&& в @@@@@@ Щ
 Ш───────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  ^
.}
═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════

 Б ВСЕГО по контрагенту группы договоров
  долг контрагентов:&'&&&&&&&&&&&&&&&&& в @@@@@@   наш долг:&'&&&&&&&&&&&&&&&&& в @@@@@@
                    &'&&&&&&&&&&&&&&&&& в @@@@@@            &'&&&&&&&&&&&&&&&&& в @@@@@@ Щ
 Ш───────────────────────────────────────────────────────────────────────────────────────────────────────────────────

.}
═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════

 Б ИТОГО по группам договоров на ^:
  долг контрагентов:&'&&&&&&&&&&&&&&&&& в @@@@@@   наш долг:&'&&&&&&&&&&&&&&&&& в @@@@@@
                    &'&&&&&&&&&&&&&&&&& в @@@@@@            &'&&&&&&&&&&&&&&&&& в @@@@@@ Щ
 А.endform
!
!
!
#doc
Реестр исполняемых договоров по группам договоров (только в рублях)
#end
.linkform 'ispgrup02' prototype is 'ispgrup'
.nameinlist 'Реестр исполняемых договоров по группам договоров (только в рублях)'
.group 'Подробные реестры исполнения договоров из групп ДО'
.group 'В национальной валюте'
.fields
 CommonFormHeader
 header2
 namekongrp
 namgrp
 namkontr namdog numbdog datdog sumdog valtar
 dogprim
 valtar valtar
 debdate debdoc debsum krddate krddoc krdsum
 debtot krdtot
 debdol krddol
 remark
 kondol ourdol
 GrpOsnSum
 gstar
 remgrp
 kon1dol our1dol
 nadat
 tkondol tourdol
.endfields
^
     БРеестр исполняемых договоров, принадлежащих к определенным группам
 @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
.{
══════════════════════════════════════════════════════════════════════════
 Группа по контрагенту:  Б^ Б
.{
══════════════════════════════════════════════════════════════════════════
 Наименование группы:
.{
  Б^ Б
.}
──────────────────────────────────────────────────────────────────────────
.{
 Контрагент:  Б^ Б
  С^ N ^ от ^ на сумму ^' в ^
 ^ С
 Р
┌──────────────────────────────────────────────────────────────┐┌───────────────────────────────────────────────────────────────┐
│             ДЕБЕТ (поступления товаров/денег)                ││           КРЕДИТ (наши платежи/поставки товаров)              │
├──────────┬─────────────────────────────────┬─────────────────┤├──────────┬─────────────────────────────────┬──────────────────┤
│   Дата   │             Документ            │  Сумма в @@@@@@ ││   Дата   │             Документ            │  Сумма в @@@@@@  │
├──────────┴─────────────────────────────────┴─────────────────┤├──────────┴─────────────────────────────────┴──────────────────┤
.{
│@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&&&&&││@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&&&&&&│
.}
└────────────────────────┬─────────────────────────────────────┤└───────────────────────┬───────────────────────────────────────┤
                         │ Итого получено:    &'&&&&&&&&&&&&&&&│                        │ Итого отправлено:   &'&&&&&&&&&&&&&&&&│
                         │ Долг контрагента:  &'&&&&&&&&&&&&&&&│                        │ Наш долг:           &'&&&&&&&&&&&&&&&&│
                         └─────────────────────────────────────┘                        └───────────────────────────────────────┘
 ^
───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── Р
.}

 СВСЕГО по группе договоров Б
  долг контрагентов: &'&&&&&&&&&&&&&&&&&     наш долг: &'&&&&&&&&&&&&&&&&&
────────────────────────────────────────────────────────────────────────────────────────────────────────────
  Сумма по всем основаниям группы: &'&&&&&&&&&&&&&&&&&
  Регламентная сумма:              &'&&&&&&&&&&&&&&&&&
  ^ Р
.}
 Р════════════════════════════════════════════════════════════════════════════════════════════════════════════
 БВСЕГО по контрагенту группы договоров Б
  долг контрагентов: &'&&&&&&&&&&&&&&&&&     наш долг: &'&&&&&&&&&&&&&&&&& Р
.}
 Р───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 БИТОГО по группам договоров на ^: Б
  долг контрагентов: &'&&&&&&&&&&&&&&&&&     наш долг: &'&&&&&&&&&&&&&&&&& Р
.endform
!
!
!
#doc
Ведомость исполнения групп договоров
#end
.linkform 'ispgrup03' prototype is 'ispgrup'
.nameinlist 'Ведомость исполнения групп договоров'
.group 'В национальной валюте и валюте для отчетов'
.fields
  CommonFormHeader
  header
  valbas valbas
  namekongrp
  trim(NamGrp) kondol ourdol kondolv ourdolv
  kon1dol our1dol kon1dolv our1dolv
  tkondol tourdol tkondolv tourdolv
.endfields
^
               БВедомость исполнения групп договоров
 Б           Р@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
═══════════════════════════════════╤════════════════════╤════════════════════╤════════════════════╤════════════════════
    Наименование группы договоров  │ Долг контрагентов  │      Наш долг      │ Долг конт.в @~@@@@ │  Наш долг в @@@@@@
═══════════════════════════════════╧════════════════════╧════════════════════╧════════════════════╧════════════════════
.{
^
.{
.{
.}
.{
.{
.}
.}
  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&&
.}
 ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
            БВСЕГО по группировке : Б   &'&&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&&
═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
.}

              БИТОГО по ведомости : Б   &'&&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&& Р
.endform
!
!
!
#doc
Ведомость исполнения групп договоров по контрагентам
#end
.linkform 'ispgrup03_1' prototype is 'ispgrup'
.nameinlist 'Ведомость исполнения групп договоров по контрагентам'
.group 'В национальной валюте и валюте для отчетов'
.create view loKont
from
 TmpGrn
where
((
   Longint(23021971) == tmpGrn.wList
))
;
.fields
  CommonFormHeader
  header
.endfields
^
               БВедомость исполнения групп договоров по контрагентам
 Б           Р@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.{//1
.fields
  namekongrp
.endfields
 Б^ Б
.{//2
.begin
 loKont.delete safe TmpGrn;
end.
 ═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
.fields
  trim(NamGrp)
  valtar valbas valtar valbas valtar valbas valtar valbas
.endfields
 Б Группа: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
  ╒════════════════════════════════╤═════════════════════════════════════════╤═════════════════════════════════════════╤═════════════════════════════════════════╤═════════════════════════════════════════╕
  │                                │               Долг контрагента          │               в т.ч.просроченный        │              Н а ш  д о л г             │           в т.ч.просроченный            │
  │   Наименование контрагента     ├────────────────────┬────────────────────┼────────────────────┬────────────────────┼────────────────────┬────────────────────┼────────────────────┬────────────────────┤
  │                                │      в @~@@@@      │      в @~@@@@      │       в @~@@@@     │      в @~@@@@      │       в @~@@@@     │      в @~@@@@      │       в @~@@@@     │       в @~@@@@     │
  ├────────────────────────────────┼────────────────────┼────────────────────┼────────────────────┼────────────────────┼────────────────────┼────────────────────┼────────────────────┼────────────────────┤
.{//3
.}//3
.{//4
.{//5
.}//5
.begin
  if (loKont.GetFirst tmpGrn where ((longint(23021971) == wList and
                                     namkontr == tmpGrn.ss[1](NoIndex) )) <> 0)
   {
     loKont.ClearBuffer(tnTmpGrn);
     loKont.tmpGrn.wList:=longint(23021971);
     loKont.tmpGrn.ss[1]:=namkontr;
     loKont.insert current TmpGrn;
   }
  loKont.tmpGrn.Sums[1] := loKont.tmpGrn.Sums[1]+double(debdol);
  loKont.tmpGrn.Sums[2] := loKont.tmpGrn.Sums[2]+double(debdolv);
  loKont.tmpGrn.Sums[3] := loKont.tmpGrn.Sums[3]+double(debpros);
  loKont.tmpGrn.Sums[4] := loKont.tmpGrn.Sums[4]+double(debprosv);
  loKont.tmpGrn.Sums[5] := loKont.tmpGrn.Sums[5]+double(krddol);
  loKont.tmpGrn.Sums[6] := loKont.tmpGrn.Sums[6]+double(krddolv);
  loKont.tmpGrn.Sums[7] := loKont.tmpGrn.Sums[7]+double(krdpros);
  loKont.tmpGrn.Sums[8] := loKont.tmpGrn.Sums[8]+double(krdprosv);
  loKont.Update current TmpGrn;
end.
.}//4
.{table 'loKont'
.fields
 loKont.tmpGrn.ss[1]
 loKont.tmpGrn.Sums[1]
 loKont.tmpGrn.Sums[2]
 loKont.tmpGrn.Sums[3]
 loKont.tmpGrn.Sums[4]
 loKont.tmpGrn.Sums[5]
 loKont.tmpGrn.Sums[6]
 loKont.tmpGrn.Sums[7]
 loKont.tmpGrn.Sums[8]
.endfields
  │@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│&'&&&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&&&│
.}
  ╘════════════════════════════════╧════════════════════╧════════════════════╧════════════════════╧════════════════════╧════════════════════╧════════════════════╧════════════════════╧════════════════════╛
.fields
  trim(NamGrp) kondol kondolv konpros konprosv ourdol ourdolv ourpros ourprosv
.endfields
 Б ИТОГО по @@@@@@@@@@@@@@@@@@@@@@@@@ Б &'&&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&&
.}//2
.fields
  kon1dol kon1dolv kon1pros kon1prosv our1dol our1dolv our1pros our1prosv
.endfields
 ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
            БВСЕГО по группировке : Б   &'&&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&&
═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
.}//1
.fields
  tkondol tkondolv tkonpros tkonprosv tourdol tourdolv tourpros tourprosv
.endfields

              БИТОГО по ведомости : Б   &'&&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&& Р
.endform

#doc
Ведомость исполнения групп договоров по контрагентам
#end
.linkform 'ispgrup03_2' prototype is 'ispgrup'
.nameinlist 'Ведомость исполнения групп договоров по контрагентам'
.group 'В национальной валюте'
.create view loKont
from
 TmpGrn
where
((
   Longint(23021971) == tmpGrn.wList
))
;
.fields
  CommonFormHeader
  header2
.endfields
^
         БВедомость исполнения групп договоров по контрагентам
 Б           Р@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.{//1
.fields
  namekongrp
.endfields
 Б^ Б
.{//2
.begin
 loKont.delete safe TmpGrn;
end.
 ═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
.fields
  trim(NamGrp)
.endfields
 Б Группа: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
  ╒════════════════════════════════╤════════════════════╤════════════════════╤════════════════════╤════════════════════╕
  │   Наименование контрагента     │  Долг контрагента  │ в т.ч.просроченный │   Н а ш  д о л г   │ в т.ч.просроченный │
  ├────────────────────────────────┼────────────────────┼────────────────────┼────────────────────┼────────────────────┤
.{//3
.}//3
.{//4
.{//5
.}//5
.begin
  if (loKont.GetFirst tmpGrn where ((longint(23021971) == wList and
                                     namkontr == tmpGrn.ss[1](NoIndex) )) <> 0)
   {
     loKont.ClearBuffer(tnTmpGrn);
     loKont.tmpGrn.wList:=longint(23021971);
     loKont.tmpGrn.ss[1]:=namkontr;
     loKont.insert current TmpGrn;
   }
  loKont.tmpGrn.Sums[1] := loKont.tmpGrn.Sums[1]+double(debdol);
  loKont.tmpGrn.Sums[3] := loKont.tmpGrn.Sums[3]+double(debpros);
  loKont.tmpGrn.Sums[5] := loKont.tmpGrn.Sums[5]+double(krddol);
  loKont.tmpGrn.Sums[7] := loKont.tmpGrn.Sums[7]+double(krdpros);
  loKont.Update current TmpGrn;
end.
.}//4
.{table 'loKont'
.fields
 loKont.tmpGrn.ss[1]
 loKont.tmpGrn.Sums[1]
 loKont.tmpGrn.Sums[3]
 loKont.tmpGrn.Sums[5]
 loKont.tmpGrn.Sums[7]
.endfields
  │@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│&'&&&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&&&│
.}
  ╘════════════════════════════════╧════════════════════╧════════════════════╧════════════════════╧════════════════════╛
.fields
  trim(NamGrp) kondol konpros ourdol ourpros
.endfields
 Б ИТОГО по @@@@@@@@@@@@@@@@@@@@@@@@@ Б &'&&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&&
.}//2
.fields
  kon1dol kon1pros our1dol our1pros
.endfields
 ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
            БВСЕГО по группировке : Б   &'&&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&&
═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
.}//1
.fields
  tkondol tkonpros tourdol tourpros
.endfields

              БИТОГО по ведомости : Б   &'&&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&& Р
.endform

#doc
Ведомость исполнения групп договоров по контрагентам
#end
.linkform 'ispgrup03_3' prototype is 'ispgrup'
.nameinlist 'Ведомость исполнения групп договоров по контрагентам'
.group 'В валюте для отчетов'
.create view loKont
from
 TmpGrn
where
((
   Longint(23021971) == tmpGrn.wList
))
;
.fields
  CommonFormHeader
  header3
.endfields
^
         БВедомость исполнения групп договоров по контрагентам
 Б           Р@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.{//1
.fields
  namekongrp
.endfields
 Б^ Б
.{//2
.begin
 loKont.delete safe TmpGrn;
end.
 ═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
.fields
  trim(NamGrp)
.endfields
 Б Группа: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
  ╒════════════════════════════════╤════════════════════╤════════════════════╤════════════════════╤════════════════════╕
  │   Наименование контрагента     │  Долг контрагента  │ в т.ч.просроченный │   Н а ш  д о л г   │ в т.ч.просроченный │
  ├────────────────────────────────┼────────────────────┼────────────────────┼────────────────────┼────────────────────┤
.{//3
.}//3
.{//4
.{//5
.}//5
.begin
  if (loKont.GetFirst tmpGrn where ((longint(23021971) == wList and
                                     namkontr == tmpGrn.ss[1](NoIndex) )) <> 0)
   {
     loKont.ClearBuffer(tnTmpGrn);
     loKont.tmpGrn.wList:=longint(23021971);
     loKont.tmpGrn.ss[1]:=namkontr;
     loKont.insert current TmpGrn;
   }
  loKont.tmpGrn.Sums[2] := loKont.tmpGrn.Sums[2]+double(debdolv);
  loKont.tmpGrn.Sums[4] := loKont.tmpGrn.Sums[4]+double(debprosv);
  loKont.tmpGrn.Sums[6] := loKont.tmpGrn.Sums[6]+double(krddolv);
  loKont.tmpGrn.Sums[8] := loKont.tmpGrn.Sums[8]+double(krdprosv);
  loKont.Update current TmpGrn;
end.
.}//4
.{table 'loKont'
.fields
 loKont.tmpGrn.ss[1]
 loKont.tmpGrn.Sums[2]
 loKont.tmpGrn.Sums[4]
 loKont.tmpGrn.Sums[6]
 loKont.tmpGrn.Sums[8]
.endfields
  │@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│&'&&&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&&&│
.}
  ╘════════════════════════════════╧════════════════════╧════════════════════╧════════════════════╧════════════════════╛
.fields
  trim(NamGrp) kondolv konprosv ourdolv ourprosv
.endfields
 Б ИТОГО по @@@@@@@@@@@@@@@@@@@@@@@@@ Б &'&&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&&
.}//2
.fields
  kon1dolv kon1prosv our1dolv our1prosv
.endfields
 ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
            БВСЕГО по группировке : Б   &'&&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&&
═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
.}//1
.fields
  tkondolv tkonprosv tourdolv tourprosv
.endfields

              БИТОГО по ведомости : Б   &'&&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&& Р
.endform

!
!
!
!
#doc
Ведомость исполнения договоров из групп договоров
#end
.linkform 'ispgrup04' prototype is 'ispgrup'
.nameinlist 'Ведомость исполнения договоров из групп договоров'
.group 'В национальной валюте'
.fields
 CommonFormHeader
 header2
 namgrp
 namkontr namdog numbdog datdog sumdog debtot debdol krdtot krddol remark
 kondol ourdol
 tkondol tourdol
.endfields
^
                БВедомость исполнения договоров из групп договоров
@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
 Ш ═════════════════════════════════════╤════════════════════════════════════════╤═════════════╤════════╤══════════════════╤══════════════════╤═════════════════╤═══════════════════╤═════════════════╤═══════════════════════════════════════════════
       Наименование контрагента       │              Вид договора              │    Номер    │  Дата  │ Сумма по договору│Оплатил контрагент│ Долг контрагента│   Оплачено нами   │    Наш долг     │                  Примечания
 ═════════════════════════════════════╧════════════════════════════════════════╧═════════════╧════════╧══════════════════╧══════════════════╧═════════════════╧═══════════════════╧═════════════════╧═══════════════════════════════════════════════ Ш
 Р.{
.{
 И Группа: И
.{
 ^
.}
 И ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── И
.{
.{
.}
 И @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@ @@@@@@@@ &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&& ^ И
.}

 Й ВСЕГО по группе: долг контрагентов:&'&&&&&&&&&&&&&&&&& наш долг:&'&&&&&&&&&&&&&&&&&
 ═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════ Щ
 Р.}
.}

 И    ИТОГО :       долг контрагентов:&'&&&&&&&&&&&&&&&&& наш долг:&'&&&&&&&&&&&&&&&&& Ш
.endform
!
!
!
!
!
#doc
Ведомость исполнения договоров из групп договоров в валюте
#end
.linkform 'ispgrup05' prototype is 'ispgrup'
.nameinlist 'Ведомость исполнения договоров из групп договоров в валюте'
.group 'В валюте для отчетов'
.fields
  CommonFormHeader
 header3
 namgrp
 namkontr namdog numbdog datdog sumdogv debtotv debdolv krdtotv krddolv remark
 kondolv ourdolv
 tkondolv tourdolv
.endfields
^
                БВедомость исполнения договоров из групп договоров
@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
 Ш ═════════════════════════════════════╤══════════════════════════════════════╤═════════════╤════════╤══════════════════╤══════════════════╤═════════════════╤═══════════════════╤═════════════════╤═══════════════════════════════════════════════
       Наименование контрагента       │             Вид договора             │    Номер    │  Дата  │ Сумма по договору│Оплатил контрагент│Долг контрагента │   Оплачено нами   │    Наш долг     │                  Примечания
 ═════════════════════════════════════╧══════════════════════════════════════╧═════════════╧════════╧══════════════════╧══════════════════╧═════════════════╧═══════════════════╧═════════════════╧═══════════════════════════════════════════════
.{
.{
 Б Группа: Б
.{
 Б ^ Б
.}
 ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.{
.{
.}
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@ @@@@@@@@ &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&& ^
.}

 ВСЕГО по группе: долг контрагентов:&'&&&&&&&&&&&&&&&&& наш долг:&'&&&&&&&&&&&&&&&&&
 ════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
.}
.}

 Б       ИТОГО :    долг контрагентов:&'&&&&&&&&&&&&&&&&& наш долг:&'&&&&&&&&&&&&&&&&& Щ
 А.endform
!
#include ispgrup.frn