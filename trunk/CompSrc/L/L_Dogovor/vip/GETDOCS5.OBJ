
#include gdocs0.vpp  // Table STRUCT SGetDocs
#include gdocs01.vpp // Table STRUCT SSpDocs3

#ifdef ComponentVersion
#component "L_DOGOVOR"
#end

#doc
Содержит описание методов пакетного формирования документов по договорам/соглашениям/ПКП
#end
ObjInterface Dog2AnyDocsObj;
//******************************************************************************
  #doc
  установка параметров пакетного формирования
  #end
  procedure SetBrowseOptions ( var sTitle         : string; // '' - стандартный заголовок
                               // иначе установит указанный
                               var sColumnSelect  : string; // название колонки
                               // с сформированными/помеченными документами
                               var Show_brSp      : word; // browse со спецификацией
                               // 0 - скрыть (Show_brSpItogo скрывает автоматом)
                               // 1 - показать для просмотра
                               // 2 - показать для пометки
                               var Show_brSpItogo : word; // browse с итоговой спецификацией
                               // 0 - скрыть
                               // 1 - показать для просмотра
                               var whc_User       : word; // Хелп для интерфейса выбора
                               var sHelpLine      : string; // Строка подсказки для интерфейса выбора
                               var CheckOnMark    : word; // Пометка только с одинаковыми:
                               // Бит 1 ( 1) : Пометка только из одного договора
                               //     2 ( 2) : Контрагент
                               //     3 ( 4) : Валюта
                               //     4 ( 8) : Входимость налогов
                               //     5 (16) : Направление договора
                               //     6 (32) : Плательщик
                               //     7 (64) : Получатель платежа
                               //     8 (128) : Не с нулевым остатком (SpDocs.Ostatok)
                               var Number_Screen  : word; // настройка предфильтра
                               // по умолчанию установлено Number_Screen := FunctionID;
                               // Number_Screen = 0 - не вызывать никаких фильтров
                               var DskParams      : longint; // можно самому настроить
                               // фильтры, не вызывая 'BegFil' (Number_Screen = 0)
                               var wOtherParams   : word // Побитные параметры:
                               // Бит 1 ( 1) : =1 - интерфейс закрывается по Enter
                              );
//******************************************************************************
  #doc
  модификация структуры в памяти (SGetDocs) по сформированным документам
  #end
  function FillExistDocs (var MMadeSpDog : longint;
                              FunctionID : word // номер функции
                          ) : word;
//******************************************************************************
  #doc
  формирование документов
  #end
  function MakeDocBySelection ( var MDog       : longint; // SGetDocs.NRec
                                // если SGetDocs.wDocType=1..2, то  SGetDocs.NRec = Dogovor.NRec
                                // если SGetDocs.wDocType=4, то SGetDocs.cCalPlan = CalPlan.NRec
                                var MSpDog     : longint; // SpDocs.NRec
                                var MMadeSpDog : longint; // функция должна дополнить
                                // этот маркер SpDocs.NRec, по которым были
                                // сформированы документы и апдейтнуть
                                // шапку договора SGetDocs.scurDirect
                                    FunctionID : word; // номер функции
                                    wParams    : word // параметры для формирования
                               ) : word; //  (0 - сформировали успешно)
//******************************************************************************
end;
