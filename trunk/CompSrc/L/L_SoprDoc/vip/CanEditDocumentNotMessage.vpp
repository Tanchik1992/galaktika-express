#ifndef _CanEditDocumentNotMessage_VPP
#define _CanEditDocumentNotMessage_VPP

Function CanEditDocumentNotMessage: boolean;
{
  if ( not boGetTune('Doc.ModSopr') or (isProtectedKatSopr))
    {
      CanEditDocumentNotMessage := FALSE;
      exit;
    }

  CanEditDocumentNotMessage := TRUE;

  Case DscVisible of
  //----------------
    cgDocVisible_All:    // 'все права'
        {}
  //----------------
    cgDocVisible_MySelf,           // 'только со своим дескриптором'
    cgDocVisible_OwnModifAllRead: // 'свои-изменение, все - чтение'
      If KatSopr.Descr<>DscName
        CanEditDocumentNotMessage := FALSE;
  //----------------
     cgDocVisible_GrRead: // 'свои-изменение, по группе - чтение'
       If (KatSopr.Descr<>DscName) or (KatSopr.DesGr<>DesGroup)
         CanEditDocumentNotMessage := FALSE;
  //----------------
     cgDocVisible_GrAll,             // 'все права в рамках группы'
     cgDocVisible_GrpModifAllRead:  // 'все права в рамках группы, все - чтение'
       If  KatSopr.DesGr<>DesGroup
         CanEditDocumentNotMessage := FALSE;
  //----------------
  end;

#ifdef __SOPRDOC102__
  if ( CanEditDocumentNotMessage )
    if KatSopr.VidSopr = word(102)
      if IsValid(#StepDoc)
        {
          var LL: SkyModificatorObj;
          GetVipRef(LL, 'SkyModificator');
          CanEditDocumentNotMessage := LL.CanEditKatSopr102(StepDoc.nRec);
        }
#end //__SOPRDOC102__

  if ( CanEditDocumentNotMessage )
    CanEditDocumentNotMessage := CanEditDocument__Status_DO__(word(0));
}

#end