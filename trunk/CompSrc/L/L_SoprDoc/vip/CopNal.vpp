//ษอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
//บ          ซชโจช (แ) 1995, TOP SOFT Ltd., ฎข๋ฉ             บ
//บ  ฅเแจ๏    :  5.50                                                  บ
//บ  งเกฎโซ:  ฎซฅๆ .. (dig)                                      บ
//บ  งญ็ฅญจฅ:  ฅเฅแฎเโจเฎขช ญชซคญฎฉ ฏฎ                         บ
//บ  งฌฅญฅญจ๏ :                                                        บ
//ศอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
Procedure CopySpDocNal(oldSpSopr:comp);
{
    StartNewVisual(vtIndicatorVisual, vfTimer+vfBreak+vfConfirm,
           ''#3'ฎฏจเใฅฌ ญซฎฃจ...'#13#3, RecordsInTable(#SpDocNal));
// ฏเฎขฅเ๏ฅฌ ฅแซจ ญซฎฃจ ข ฎฏฅเ ชฎญโใเฅ, โฎ ชฎฏจเใฅฌ จๅ คซ๏ ญฎขฎฉ
    ResetBounds(#SpDocNal);
    if (GetFirst SpDocNal where ((oldSpSopr       == SpDocNal.cSpDoc and
                                  KatSopr.VidSopr == SpDocNal.TipDoc )) = tsOk) do {
      PushPos(#SpDocNal);
      if (not NextVisual) BREAK;
      SpDocNal.cSpDoc := spSopr.Nrec;
      if (update current SpDocNal <> tsOk)
        message(''#3'่จกช ชฎฏจเฎขญจ๏ ญซฎฃฎข',CancelButton);
      PopPos(#SpDocNal);
!    } while (GetNext SpDocNal where ((oldSpSopr       == SpDocNal.cSpDoc and
!                                      KatSopr.VidSopr == SpDocNal.TipDoc )) = tsOk);
    } while (GetFirst SpDocNal where ((oldSpSopr       == SpDocNal.cSpDoc and
                                      KatSopr.VidSopr == SpDocNal.TipDoc )) = tsOk);
    SetBounds(#SpDocNal);
    StopVisual('',0);   // แชฎฏจเฎขซจ ญซฎฃจ
}
