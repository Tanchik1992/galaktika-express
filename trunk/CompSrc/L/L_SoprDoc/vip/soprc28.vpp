//********************************************************************************
//                                                        (c) ชฎเฏฎเๆจ๏ ซชโจช
// ซชโจช 7.12 - _
// _
//********************************************************************************

!ษอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
!บ งญ็ฅญจฅ    : ญกฎเ ญชซคญ๋ๅ, แข๏งญญ๋ๅ แ                            บ
!ศอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ

Create view CheckNakl
Var
  pNrec: comp;    //แแ๋ซช ญ 
  TypeSopr: word;
From
  KatSopr
 , StepDoc
 , BaseDoc
where
((
  pNrec        == StepDoc.cBaseDoc AND
  StepDoc.NRec == KatSopr.cStepDoc AND
  TypeSopr     == KatSopr.VidSopr
))
;

Function IsNaklInDo (NrecDO, NRecNakl: comp; TypeSopr: word; var KolNakl: word): comp;
{
  CheckNakl.pNrec := NRecDO;
  CheckNakl.TypeSopr := TypeSopr;
  IsNaklInDo := 0;
  KolNakl := 0;

  if CheckNakl.GetFirst StepDoc = tsOk
    CheckNakl._LOOP KatSopr
      {
        IsNaklInDO := CheckNakl.KatSopr.NRec;
        KolNakl    := KolNakl + 1;
        if CheckNakl.KatSopr.NRec = NRecNakl
          {
            IsNaklInDo := NRecNakl;
            Exit;
          }
      }
}

