!╔═══════════════════════════════════════════════════════════════════════════╗
!║ Назначение    : информация по Услуге в приходной накладной                ║
!╚═══════════════════════════════════════════════════════════════════════════╝

!!! этот файл устарел и больше поддерживаться не будет - оставлен только для поддержки
!!! клиентских отчетов, разработанных на базе этой формы
!!! в дальнейшем печать отчетов в приходных накладных будет поддерживаться интерфейсом PRINTSOPR

  FPrihNkl.PutEventById(feDoLoop,fcPrihNkl_SopUsl);
  FPrihNkl.Write(SpSopr.NRec);
  if (GetFirst KatUsl where ((SpSopr.cMCUsl == KatUsl.NRec)) = tsOk)
    {
      FPrihNkl.Write(KatUSL.Kod);
      FPrihNkl.Write(KatUSL.Name);
    }
  else
    FPrihNkl.SkipFormat(2);
  if (SpSopr.PrMC = 3)
    FPrihNkl.Write(DoubleToStr(SpSopr.Kol,'666666.88')+'%');
  else
    FPrihNkl.SkipFormat(1);

  if (KatSopr.VhodNal = 1) // да
    {
      FPrihNkl.Write(SpSopr.Price -  SpSopr.sumNDS,  Cena_PrR); //без нал
      FPrihNkl.Write(SpSopr.VPrice - SpSopr.sumvNDS,  Cena_PrV);
      sUslBN :=  sUslBN  + SpSopr.Price  - SpSopr.sumNDS; //без нал
      svUslBN := svUslBN + SpSopr.VPrice - SpSopr.sumvNDS;
      FPrihNkl.Write((SpSopr.Price), Cena_PrR);
      FPrihNkl.Write((SpSopr.VPrice), Cena_PrV);
      sUsl :=  sUsl  + SpSopr.Price;
      svUsl := svUsl + SpSopr.VPrice;
    }
  else                     // нет
    {
      FPrihNkl.Write((SpSopr.Price),  Cena_PrR);     //без нал
      FPrihNkl.Write((SpSopr.VPrice),  Cena_PrV);
      sUslBN :=  sUslBN  + SpSopr.Price;   //без нал
      svUslBN := svUslBN + SpSopr.VPrice;

      FPrihNkl.Write(SpSopr.Price +  SpSopr.sumNDS,  Cena_PrR);
      FPrihNkl.Write(SpSopr.VPrice + SpSopr.sumvNDS,  Cena_PrV);
      sUsl :=  sUsl  + SpSopr.Price  + SpSopr.sumNDS;
      svUsl := svUsl + SpSopr.VPrice + SpSopr.sumvNDS;
    }

  FPrihNkl.Write(KlVal.SimvolV);
  FPrihNkl.Write(KlVal.ISO);

  erfl := true;
!----------- ывод внешинх атрибутов по услугам ----------
  KolAttr := 5;
  pNRec   := coKatUSL;
  _LOOP AttrVal where ((pNRec       == AttrVal.wTable and
                        KatUSL.Nrec == AttrVal.cRec)) 
    {
      AttrTyp := 0;
      if (GetFirst FastFirstRow attrnam 
                        where ((AttrVal.cAttrNam == attrnam.nrec)) = tsOk)
        AttrTyp := AttrNam.AttrType;
      Case AttrTyp of
        0 : FPrihnkl.Write(AttrVal.vString);
        1 : FPrihnkl.Write(AttrVal.vDouble,2);
        2 : FPrihnkl.Write(AttrVal.vDate);
        3 : FPrihnkl.Write(AttrVal.vTime);
      else
        FPrihnkl.Write(AttrVal.vString);
      End;
      KolAttr := KolAttr - 1;
      if KolAttr = 0
        break;
    }
  FPrihnkl.SkipFormat(KolAttr);

!----- Конец вывода внешних атрибутов по услугам --------
