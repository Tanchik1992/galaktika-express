//********************************************************************************
//                                                        (c) ชฎเฏฎเๆจ๏ ซชโจช
// ซชโจช 7.12 - _
// _
//********************************************************************************

!ษอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
!บ งญ็ฅญจฅ    : ฏเฎๆฅคใเ๋/ไใญชๆจจ คซ๏ เกฎโ๋ ข แฎฏเฎขฎคจโฅซ์ญ๋ๅ คฎชใฌฅญโๅบ
!ศอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ

#ifNdef _soprc06_VPP
#define _soprc06_VPP

Procedure MakeSumPrice;
{
  if wGetTune('Doc.IzmCenaKol') = 0
    {
      Message('แโญฎขซฅญ งฏเฅโ ญ จงฌฅญฅญจฅ แโฎจฌฎแโจ ข แฎฏเฎขฎคจโฅซ์ญ๋ๅ คฎชใฌฅญโๅ');
      Exit;
    }

  if wGetTune('Doc.IzmCenaKol') = 1
    if (KatSopr.cVal = 0)
      {
        if (SpSopr.Price <> 0)
          set SpSopr.KolFact := double(ExprFieldValue) / SpSopr.Price;
      }
    else
      {
        if (SpSopr.VPrice <> 0)
          set SpSopr.KolFact := double(ExprFieldValue) / SpSopr.VPrice;
      }
  else//จงฌฅญจโ์ ๆฅญใ
    if (SpSopr.KolFact <> 0)
      {
        if (KatSopr.cVal = 0)
          set SpSopr.rPrice := double(ExprFieldValue) / SpSopr.KolFact;
        else
          set SpSopr.rVPrice := double(ExprFieldValue) / SpSopr.KolFact;

        if (KatSopr.cVal = 0)
          set SpSopr.Price := double(ExprFieldValue) / SpSopr.KolFact;
        else
          set SpSopr.VPrice := double(ExprFieldValue) / SpSopr.KolFact;
      }
};

#end //_06_vpp
