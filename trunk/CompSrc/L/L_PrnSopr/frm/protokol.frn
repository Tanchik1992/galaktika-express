#define TTN_Protokol_Cen
#doc
Протокол (текущая цена)
#end
.LinkForm 'TOVN_PROT_CEN_1' Prototype is 'tovn'
.Group 'Накладные на продажу'
.NameInList 'Протокол (текущая цена)'
.DEFP PA4
.DEFO PORTRAIT
.LL 80
.var
  npp:Word
  FirstPrice:Double
  ProcNacFirst:Double
  ProcNacMy:Double
  SumNacFirst:Double
  SumNacMy:Double
.endvar
#include format.frn
.fields
  CommonFormHeader
  Номер
  Поставщик
  Получатель
  npp
  Название
  КодМЦ
  DoubleToStr(КолУч,Kol_Pr)
  DoubleToStr(ЦНацБНУч, Cena_PrR)
  Дата
  Дата
  СпецСимвол
.endfields
.{
 ^
 Р
  Щ  Приложение 2
   к Положению о порядке
   формирования и применения
   цен и тарифов 22.04.1999 № 43 Щ

                           Ш ПРОТОКОЛ №  Д@@@@@@@@@@@@@@@@@@@@@@@ Д
 Ш         Шсогласования отпускных цен на товары (продукцию) Ш
         Шмежду  Ш Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
         Ши  Ь@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ на поставку Д
        __________________________________________________________________________________________________________________
                                 Ш(наименование групп товаров) Ш
        __________________________________________________________________________________________________________________

.begin
 npp := 0;
end.
.if TOVN01
.else
.end
.if TOVN02
.else
.end
 Ш ┌───┬────────────────────────────────┬───────────┬────────┬────────────────────────────┐
 │ № │     Наименование               │Артикул,   │ Объем  │Отпускная цена              │
 │п/п│     и краткая                  │марка,     │ партии │предприятия-изготовителя или│
 │   │     характеристика             │тип,       │        │первого покупателя,         │
 │   │                                │сорт       │        │завезшего товар из-за       │
 │   │                                │           │        │пределов республики         │
 ├───┼────────────────────────────────┼───────────┼────────┼────────────────────────────┤
 │ 1 │               2                │    3      │    4   │              5             │
 ├───┼────────────────────────────────┼───────────┼────────┼────────────────────────────┤
.{
.begin
 npp:=npp + 1;
 if (Цена_изготовителяНац = 0) FirstPrice := Цена_ордера_нац
 else FirstPrice := Цена_изготовителяНац;
 SumNacFirst := Цена_ордера_нац - FirstPrice;
 ProcNacFirst := if (FirstPrice <> 0, SumNacFirst / FirstPrice * 100, 0);
 SumNacMy := ЦНацБНУч - Цена_ордера_нац;
 ProcNacMy := if (FirstPrice <> 0, (SumNacMy / FirstPrice) * 100, if (ЦНацБНУч > 0, 100, 0));

end.
 │@@@│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@│&&&&&&&&│        &&&&&&&&&&&&        │
.}
 └───┴────────────────────────────────┴───────────┴────────┴────────────────────────────┘ И
 Р
.{CheckEnter TOVNUSL
.}
.{
.}

  ШИзготовитель (поставщик)__________________                  Покупатель__________________
                              (подпись)                                     (подпись)
                       М.П.                                          М.П.
  Дата  @@@@@@@@@@                                            Дата   @@@@@@@@@@

   ^ И
.}
.endform


#doc
Протокол (заводская цена)
#end
.LinkForm 'TOVN_PROT_CEN_2' Prototype is 'tovn'
.Group 'Накладные на продажу'
.NameInList 'Протокол (заводская цена)'
.DEFP PA4
.DEFO PORTRAIT
.LL 80
.var
  npp:Word
  FirstPrice:Double
  ProcNacFirst:Double
  ProcNacMy:Double
  SumNacFirst:Double
  SumNacMy:Double
.endvar
#include format.frn
.fields
  CommonFormHeader
  Номер
  Поставщик
  Получатель
  npp
  Название
  КодМЦ
  DoubleToStr(КолУч,Kol_Pr)
  Завод_Цена
  Дата
  Дата
  СпецСимвол
.endfields
.{
 ^
 Р
  Щ  Приложение 2
   к Положению о порядке
   формирования и применения
   цен и тарифов 22.04.1999 № 43 Щ

                           Ш ПРОТОКОЛ №  Д@@@@@@@@@@@@@@@@@@@@@@@ Д
 Ш         Шсогласования отпускных цен на товары (продукцию) Ш
         Шмежду  Ш Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
         Ши  Ь@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ на поставку Д
        __________________________________________________________________________________________________________________
                                 Ш(наименование групп товаров) Ш
        __________________________________________________________________________________________________________________

.begin
 npp := 0;
end.
.if TOVN01
.else
.end
.if TOVN02
.else
.end
 Ш ┌───┬────────────────────────────────┬───────────┬────────┬────────────────────────────┐
 │ № │     Наименование               │Артикул,   │ Объем  │Отпускная цена              │
 │п/п│     и краткая                  │марка,     │ партии │предприятия-изготовителя или│
 │   │     характеристика             │тип,       │        │первого покупателя,         │
 │   │                                │сорт       │        │завезшего товар из-за       │
 │   │                                │           │        │пределов республики         │
 ├───┼────────────────────────────────┼───────────┼────────┼────────────────────────────┤
 │ 1 │               2                │    3      │    4   │              5             │
 ├───┼────────────────────────────────┼───────────┼────────┼────────────────────────────┤
.{
.begin
 npp:=npp + 1;
 if (Цена_изготовителяНац = 0) FirstPrice := Цена_ордера_нац
 else FirstPrice := Цена_изготовителяНац;
 SumNacFirst := Цена_ордера_нац - FirstPrice;
 ProcNacFirst := if (FirstPrice <> 0, SumNacFirst / FirstPrice * 100, 0);
 SumNacMy := ЦНацБНУч - Цена_ордера_нац;
 ProcNacMy := if (FirstPrice <> 0, (SumNacMy / FirstPrice) * 100, if (ЦНацБНУч > 0, 100, 0));

end.
 │@@@│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@│&&&&&&&&│        &&&&&&&&&&&&        │
.}
 └───┴────────────────────────────────┴───────────┴────────┴────────────────────────────┘ И
 Р
.{CheckEnter TOVNUSL
.}
.{
.}

  ШИзготовитель (поставщик)__________________                  Покупатель__________________
                              (подпись)                                     (подпись)
                       М.П.                                          М.П.
  Дата  @@@@@@@@@@                                            Дата   @@@@@@@@@@

   ^ И
.}
.endform

#doc
Протокол согласования цен (руб., полный)
#end
.LinkForm 'TOVN_PROT_CEN_3' Prototype is 'tovn'
.Group 'Накладные на продажу'
.NameInList 'Протокол согласования цен (руб., полный)'
.DEFP PA4
.DEFO LANDSCAPE
.LL 51
.var
  npp:Word
  FirstPrice  : Double
  ProcNacFirst: Double
  SumNacFirst : Double
  ProcNacMy   : Double
  SumNacMy    : Double
  ChrBreakPage: String;
.endvar
#include protokol.frv
#include format.frn
#include ttn_fun.frn
.fields
!Шапка
  CommonFormHeader
  Номер
  Поставщик
  Поставщик_БАНК_Имя
  Поставщик_БАНК_Счет
  Поставщик_БАНК_Счет_Ркц
  Поставщик_БАНК_Счет_Плат
  Поставщик_Адрес
  Поставщик_ТЕЛ
  Получатель
  Получатель_БАНК_Имя
  Получатель_БАНК_Счет
  Получатель_БАНК_Счет_Ркц
  Получатель_БАНК_Счет_Плат
  Получатель_Адрес
  Получатель_ТЕЛ
!новая страница
  Номер StrNN
!итого по странице
  DoubleToStr(SumItog1, Cena_PrR)
  DoubleToStr(SumItog2, Cena_PrR)
  ChrBreakPage
!новая страница
  Номер StrNN
!спецификация
     npp
     Название
     КодМЦ
     DoubleToStr(FirstPrice, Cena_PrR)
     ProcNacFirst
     DoubleToStr(SumNacFirst, Cena_PrR)
     DoubleToStr((SumNacFirst * КолФ), Cena_PrR)
     ProcNacMy
     DoubleToStr(SumNacMy, Cena_PrR)
     DoubleToStr((SumNacMy * КолФ), Cena_PrR)
     ЦНацСН
!итого по странице
  DoubleToStr(SumItog1, Cena_PrR)
  DoubleToStr(SumItog2, Cena_PrR)
  ChrBreakPage
!итого по странице
  DoubleToStr(SumItog1, Cena_PrR)
  DoubleToStr(SumItog2, Cena_PrR)
!Итоговые суммы
  DoubleToStr(SumItogFull1, Cena_PrR)
  DoubleToStr(SumItogFull2, Cena_PrR)
!подписи
  Year(cur_date)
  Year(cur_date)
  ChrBreakPage
.endfields
#include ttn_008.frn
.{
.begin
  npp          := 0;
  KolAdd       := 0;
  KolPage      := 0;
  NextPage     := false;
  StrNN        := 1;
  SumItog1     := 0;
  SumItogFull1 := 0;
  SumItog2     := 0;
  SumItogFull2 := 0;

  readmydsk(breakPage, 'OptionsProt_Cen', false);
  readmydsk(MainKol  , 'MainKolProt_Cen', false);
  readmydsk(FixKol   , 'FixKolProt_Cen' , false);
  FixKolPage := MainKol;
  ChrBreakPage := if (breakPage = 1, '', '');
end.
 ^
 Р
                                   ЩПРОТОКОЛ N Щ ^
                       Щсогласования цен на товары (продукцию) Щ

         ПОСТАВЩИК :  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
         Банк      :  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
         Счет №  Б^ ^ ^ Б
         Адрес     :  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
         тел./факс :  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б

         ПОЛУЧАТЕЛЬ:  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
         Банк      :  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
         Счет №  Б^ ^ ^ Б
         Адрес     :  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
         тел./факс :  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б

.if tovn01
.end
.if tovn02
.end
   ───┬──────────────────────────────┬────────────────┬─────────────────┬─────────────────────────────────────────────┬─────────────────────────────────────────────┬─────────────────
    № │         Наименование         │ Номенклатурный │   Цена изгото-  │          Оплаченная оптовая надбавка        │          Взимаемая оптовая надбавка         │   Отпускная
   п/п│                              │    номер       │     вителя      ├─────────┬─────────────────┬─────────────────┤─────────┬─────────────────┬─────────────────┤      цена
      │                              │                │   (импортера)   │ Процент │ Сумма за единицу│ Сумма по позиции│ Процент │ Сумма за единицу│ Сумма по позиции│
   ───┴──────────────────────────────┴────────────────┴─────────────────┴─────────┴─────────────────┴─────────────────┴─────────┴─────────────────┴─────────────────┴─────────────────
!цикл по спецификации
.{
.{?Internal;(KolPage = FixKolPage)
.begin
  KolAdd       := 0;
  KolPage      := 0;
  SumItog1     := 0;
  SumItog2     := 0;
  FixKolPage   := FixKol;
  inc(StrNN);
end.
 В   протокол № ^ согласования цен на товары (продукцию)                                                                                                             страница N В ^
   ───┬──────────────────────────────┬────────────────┬─────────────────┬─────────────────────────────────────────────┬─────────────────────────────────────────────┬─────────────────
    № │         Наименование         │ Номенклатурный │   Цена изгото-  │          Оплаченная оптовая надбавка        │          Взимаемая оптовая надбавка         │   Отпускная
   п/п│                              │    номер       │     вителя      ├─────────┬─────────────────┬─────────────────┤─────────┬─────────────────┬─────────────────┤      цена
      │                              │                │   (импортера)   │ Процент │ Сумма за единицу│ Сумма по позиции│ Процент │ Сумма за единицу│ Сумма по позиции│
   ───┴──────────────────────────────┴────────────────┴─────────────────┴─────────┴─────────────────┴─────────────────┴─────────┴─────────────────┴─────────────────┴─────────────────
.}
.begin
   var KolLine, KolLine2:word;
   inc(KolPage);
   inc(KolSpSopr);
   KolLine  := KolAddInStr(Название, 30, true);
   KolLine2 := KolAddInStr(КодМц,    16, true);
   If (KolLine2 > KolLine) KolLine := KolLine2;
   IF KolLine   > 0
   {
     KolPage := KolPage + KolLine;
     IF KolPage>FixKolPage
     {
       NextPage   := true;
       KolAdd     := KolLine + 1;
       FixKolPage := FixKol;
     }
   }
end.
.{?Internal; NextPage
   ───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                             Итого:   Б&'&&&&&&&&&&&&&&& Б                              Б&'&&&&&&&&&&&&&&& Б

.{?Internal; breakPage=1
^
.}
.begin
  KolPage  := KolAdd;
  NextPage := false;
  SumItog1 := 0;
  SumItog2 := 0;
end.
 В   протокол № ^ согласования цен на товары (продукцию)                                                                                                             страница N В ^
   ───┬──────────────────────────────┬────────────────┬─────────────────┬─────────────────────────────────────────────┬─────────────────────────────────────────────┬─────────────────
    № │         Наименование         │ Номенклатурный │   Цена изгото-  │          Оплаченная оптовая надбавка        │          Взимаемая оптовая надбавка         │   Отпускная
   п/п│                              │    номер       │     вителя      ├─────────┬─────────────────┬─────────────────┤─────────┬─────────────────┬─────────────────┤      цена
      │                              │                │   (импортера)   │ Процент │ Сумма за единицу│ Сумма по позиции│ Процент │ Сумма за единицу│ Сумма по позиции│
   ───┴──────────────────────────────┴────────────────┴─────────────────┴─────────┴─────────────────┴─────────────────┴─────────┴─────────────────┴─────────────────┴─────────────────
.}
.begin
 npp:=npp + 1;
 if (Цена_изготовителяНац = 0) FirstPrice := Цена_ордера_нац
 else FirstPrice := Цена_изготовителяНац;
 SumNacFirst := Цена_ордера_нац - FirstPrice;
 ProcNacFirst := if (FirstPrice <> 0, SumNacFirst / FirstPrice * 100, 0);
 SumNacMy := ЦНацБНУч - Цена_ордера_нац;
 ProcNacMy := if (FirstPrice <> 0, (SumNacMy / FirstPrice) * 100, if (ЦНацБНУч > 0, 100, 0));
 SumItog1 := SumItog1 + (SumNacFirst * КолФ);
 SumItog2 := SumItog2 + (SumNacMy    * КолФ);
 SumItogFull1 := SumItogFull1 + (SumNacFirst * КолФ);
 SumItogFull2 := SumItogFull2 + (SumNacMy    * КолФ);
end.
  @@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@ &'&&&&&&&&&&&&&&& &&&&&&.&& &'&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&& &&&&&&.&& &'&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&
.{?Internal; (KolPage=FixKolPage) AND (KolSpSopr<количество_SpSopr)
   ───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                             Итого:   Б&'&&&&&&&&&&&&&&& Б                              Б&'&&&&&&&&&&&&&&& Б
.{?Internal; breakPage=1
^
.}
.}
.}
.{?Internal; (FixKol = FixKolPage) and (KolPage<FixKol)
   ───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                             Итого:   Б&'&&&&&&&&&&&&&&& Б                              Б&'&&&&&&&&&&&&&&& Б
.}
.{?Internal; KolSpSopr=количество_SpSopr
   ───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                Всего по протоколу:   Б&'&&&&&&&&&&&&&&& Б                              Б&'&&&&&&&&&&&&&&& Б
.}
.{ CHECKENTER TOVNUSL
.}

.{
.}
#ifdef __SKYSHOP__
#include sky.inc
#end



      Поставщик                                                                                                                Получатель
      ___________________________________________                                                                              _____________________________________

      "____"____________ @@@@ г.                                                                                               "____"____________ @@@@ г.
 Р
   ^
.}
.endform

#doc
Протокол согласования цен (руб., краткий)
#end
.LinkForm 'TOVN_PROT_CEN_4' Prototype is 'tovn'
.Group 'Накладные на продажу'
.NameInList 'Протокол согласования цен (руб., краткий)'
.DEFP PA4
.DEFO PORTRAIT
.LL 80
.var
  npp:Word
  FirstPrice:Double
  ProcNacFirst:Double
  ProcNacMy:Double
  SumNacFirst:Double
  SumNacMy:Double
.endvar
#include format.frn
.fields
  CommonFormHeader
  Номер
  Поставщик
  Поставщик_БАНК_Имя
  Поставщик_БАНК_Счет
  Поставщик_БАНК_Счет_Ркц
  Поставщик_БАНК_Счет_Плат
  Поставщик_Адрес
  Поставщик_ТЕЛ
  Получатель
  Получатель_БАНК_Имя
  Получатель_БАНК_Счет
  Получатель_БАНК_Счет_Ркц
  Получатель_БАНК_Счет_Плат
  Получатель_Адрес
  Получатель_ТЕЛ
  npp
  Название
  КодМЦ
  DoubleToStr(FirstPrice, Cena_PrR)
  ProcNacFirst
  ProcNacMy
  ЦНацСН
  Year(cur_date)
  Year(cur_date)
  СпецСимвол
.endfields
.{
 ^

 Р                                   ЩПРОТОКОЛ N Щ ^
                       Щсогласования цен на товары (продукцию) Щ

         ПОСТАВЩИК :  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
         Банк      :  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
         Счет №  Б^ Б ^  Б^ Б
         Адрес     :  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
         тел./факс :  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б

         ПОЛУЧАТЕЛЬ:  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
         Банк      :  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
         Счет №  Б^ Б ^  Б^ Б
         Адрес     :  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
         тел./факс :  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б

.begin
 npp := 0;
end.
.if tovn01
.end
.if tovn02
.end
  ────┬──────────────────────────────┬────────────────┬─────────────────┬────────────┬──────────┬─────────────────
    № │         Наименование         │ Номенклатурный │   Цена изгото-  │Оплаченный %│Взимаемый │   Отпускная
   п/п│                              │    номер       │     вителя      │оптовой над-│% оптовой │      цена
      │                              │                │   (импортера)   │  бавки     │надбавки  │
  ────┴──────────────────────────────┴────────────────┴─────────────────┴────────────┴──────────┴─────────────────
.{
.begin
 npp:=npp + 1;
 if (Цена_изготовителяНац = 0) FirstPrice := Цена_ордера_нац
 else FirstPrice := Цена_изготовителяНац;
 SumNacFirst := Цена_ордера_нац - FirstPrice;
 ProcNacFirst := if (FirstPrice <> 0, SumNacFirst / FirstPrice * 100, 0);
 SumNacMy := ЦНацБНУч - Цена_ордера_нац;
 ProcNacMy := if (FirstPrice <> 0, (SumNacMy / FirstPrice) * 100, if (ЦНацБНУч > 0, 100, 0));

end.
  &&&& @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@ &'&&&&&&&&&&&&&&& &&&&&&&&&.&& &&&&&&&.&& &'&&&&&&&&&&&&&&&
.}
  ────────────────────────────────────────────────────────────────────────────────────────────────────────────────

.{ CHECKENTER TOVNUSL
.}
.{
.}
#ifdef __SKYSHOP__
#include sky.inc
#end

      Поставщик                                                            Получатель
      ________________________________________                             _______________________________________

      "____"____________ @@@@ г.                                           "____"____________ @@@@ г.
 Р
   ^
.}
.endform
#undef TTN_Protokol_Cen