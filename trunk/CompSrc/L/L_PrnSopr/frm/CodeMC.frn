!Код учетной и отпускной единицы матценности
!ОКЕИ в российский формах
.begin
  var piExAttr  : iExtAttr;
  CodeOtpEd := '';
  CodeEd    := '';

  FROMKATMC.pNrec := comp(спецификацияМЦ_нрек);

  if (FROMKATMC.GetFirst SpSopr = tsOk)
  {
    if (FROMKATMC.GetFirst KatOtpEd = tsOk)
    {
      if (FROMKATMC.GetFirst KatEd where ((FROMKATMC.KatOtpEd.cKatEd == KatEd.NRec )) = tsOk)
        CodeOtpEd := piExAttr.sGetAttr(coKatEd, FROMKATMC.KatEd.NRec, 'Код');
    }

    if (FROMKATMC.GetFirst KatMC = tsOk)
      if (FROMKATMC.GetFirst KatEd where ((FROMKATMC.KatMC.cEd == KatEd.NRec )) = tsOk)
        CodeEd := piExAttr.sGetAttr(coKatEd, FROMKATMC.KatEd.NRec, 'Код');
  }
end.
