!╔═════════════════════════════════════════════════════════════════════╗
!║      Проект ГАЛАКТИКА (c) 1994,95 TOP SOFT Ltd., АО НОВЫЙ АТЛАНТ    ║
!║  Версия :     3.30                                                  ║
!║  Разработал:  Сидоров В.Г.                                          ║
!║  Назначение: НАКЛАДНАЯ НА ОТПУСК МЦ НА СТОРОНУ Форма М-15           ║
!║  Изменения:                                                         ║
!╚═════════════════════════════════════════════════════════════════════╝
!#include tovn.pro

#doc
Накладная на отпуск материалов на сторону. Форма М-15
#end
.linkform 'TOVN_M15' prototype is 'tovn'
.NameInList 'Накладная на отпуск материалов на сторону. Форма М-15'
.group 'Накладные на продажу'
.group 'Рекламационные накладные'
.group 'Акты на строительство'
#include format.frn
#include summa.frn
#include ttn_fun.frn
#include m-15_var.frn
#include ttnf_var.frn
#include mfo.frn
#include org_decl.frn
.DEFP PA4
.DEFO LANDSCAPE
.PAPER PA4
.ORIENT PORTRAIT
.LL 80
.ORIENT LANDSCAPE
.LL 51
!.P 50
.fields
Номер
Поставщик
Поставщик_ОКПО
Дата
Склад
Основание
Грузополучатель
ДовЛицоДолжность + ' ' + ФИОДовер



DoubleToStr(KolDOItog, Kol_Pr)
DoubleToStr(KolFItog,  Kol_Pr)
DoubleToStr(Sum1Itog,  Cena_PrR)
DoubleToStr(Sum2Itog,  Cena_PrR)
DoubleToStr(Sum3Itog,  Cena_PrR)
СпСимвол
Название КодМЦ CodeOtpEd ОтпЕд КолДО КолФ
DoubleToStr(ЦнацБН  , Cena_PrR)
DoubleToStr(СтНацБН , Cena_PrR)
DoubleToStr(СтНДСНац, Cena_PrR)
DoubleToStr(СтНацСН , Cena_PrR)

DoubleToStr(KolDOItog, Kol_Pr)
DoubleToStr(KolFItog , Kol_Pr)
DoubleToStr(Sum1Itog , Cena_PrR)
DoubleToStr(Sum2Itog , Cena_PrR)
DoubleToStr(Sum3Itog , Cena_PrR)
СпСимвол
DoubleToStr(KolDOItog, Kol_Pr)
DoubleToStr(KolFItog , Kol_Pr)
DoubleToStr(Sum1Itog , Cena_PrR)
DoubleToStr(Sum2Itog , Cena_PrR)
DoubleToStr(Sum3Itog , Cena_PrR)

DoubleToStr(KolDOItogFull, Kol_Pr)
DoubleToStr(KolFItogFull , Kol_Pr)
DoubleToStr(Sum1ItogFull , Cena_PrR)
DoubleToStr(Sum2ItogFull , Cena_PrR)
DoubleToStr(Sum3ItogFull , Cena_PrR)

стр_АНаименований
strokaR
doubleToString(0, Round(Sum2ItogFull,GetPrecisionGroup('brForSopr_Price')))
if(отпуск_разрешил_должность <> '', отпуск_разрешил_должность, '_________________')
if(отпуск_разрешил <> '', отпуск_разрешил, '__________________________________')
if(Главный_Бухгалтер <> '', Главный_Бухгалтер,'__________________________________')
if(сдал_отправитель_должность <> '', сдал_отправитель_должность, '_________________')
if(сдал_отправитель <> '', сдал_отправитель, '__________________________________')
СпецСимвол
.endfields
#include m-15_dsk.frn
.{
#include sum_calc.frn
 Ш
.begin
  KolDOItog  :=0;
  KolFItog   :=0;
  Sum1Itog   :=0;
  Sum2Itog   :=0;
  Sum3Itog   :=0;

  KolAdd       := 0;
  KolPage      := 0;
  NextPage     := false;
  StrNN        := 1;

  readmydsk(breakPage, 'Optionsm15', false);
  readmydsk(MainKol  , 'MainKolm15', false);
  readmydsk(FixKol   , 'FixKolm15' , false);
  FixKolPage := MainKol;
  ChrBreakPage := if (breakPage = 1, '', '');

  СпСимвол :='';
 end.
                                                                                                                                      Типовая межотраслевая форма N М-15
                                                                                                                                      Утверждена постановлением Госкомстата России
                                                                                                                                      от 30.10.97 N 71а
                                                      НАКЛАДНАЯ   N Д @@@@@@@@ Д
                                               на отпуск материалов на сторону                                                                                          ┌─────────┐
                                                                                                                                                                        │ Коды    │
                                                                                                                                                                        ├─────────┤
                                                                                                                                                          Форма по ОКУД │ 0315007 │
                                                                                                                                                                        ├─────────┤
Организация : Д @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д        по ОКПО │@@@@@@@@@│
                                                                                                                                                                        └─────────┘
                                                       ╔══════════╦═══════╦═══════════════════════════╦═════════════════════════════════╦═════════════════════════════════════════╗
                                                       ║   Дата   ║Код ви-║      Отправитель          ║        Получатель               ║   Ответственный за поставку             ║
                                                       ║  состав- ║да опе-╟──────────────┬────────────╫────────────────────┬────────────╫─────────────┬──────────────┬────────────╢
                                                       ║   ления  ║рации  ║ Структурное  │    вид     ║     Структурное    │    Вид     ║Структурное  │     Вид      │    код     ║
                                                       ║          ║       ║подразделение │деятельности║    подразделение   │деятельности║подразделение│ деятельности │исполнителя ║
                                                       ║          ║       ║              │            ║                    │            ║             │              │            ║
                                                       ╠══════════╬═══════╬══════════════╪════════════╬════════════════════╪════════════╬═════════════╪══════════════╪════════════╣
                                                       ║@@@@@@@@@@║       ║@@@@@@@@@@@@@@│            ║                    │            ║             │              │            ║
                                                       ╚══════════╩═══════╩══════════════╧════════════╩════════════════════╧════════════╩═════════════╧══════════════╧════════════╝
.if tovn01
Основание №  Д^ Д
.else
Основание №
.end
.if tovn02
.end

Кому : Д @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  Через кого : Д @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
╔══════════════════════╦═════════════════════════════╦═════════════════╦═══════════════════════╦═════════════╦═══════════════╦═════════════╦═══════════════╦════════════╦═════════╗
║Корреспондирующий счет║    Материальные ценности    ║Единица измерения║      Количество       ║   Цена,     ║    Сумма      ║   Сумма     ║    Всего      ║    Номер   ║Порядко- ║
╟──────────┬───────────╫──────────────────┬──────────╫─────┬───────────╫───────────┬───────────╢  руб.коп.   ║  без учета    ║    НДС,     ║   с учетом    ╟──────┬─────╢вый номер║
║   счет,  │ код ана-  ║  наименование    │  номенк- ║ код │ наименова-║ надлежит  │ отпущено  ║             ║     НДС       ║  руб.коп.   ║     НДС,      ║инвен-│пас- ║записи по║
║  субсчет │литического║сорт,размер,марка │ латурный ║     │    ние    ║ отпустить │           ║             ║   руб.коп.    ║             ║   руб.коп.    ║ тар- │порта║складской║
║          │   учета   ║                  │  номер   ║     │           ║           │           ║             ║               ║             ║               ║ ный  │     ║картотеке║
╟──────────┼───────────╫──────────────────┼──────────╫─────┼───────────╫───────────┼───────────╫─────────────╫───────────────╫─────────────╫───────────────╫──────┼─────╫─────────╢
║    1     │     2     ║        3         │    4     ║  5  │     6     ║    7      │    8      ║     9       ║      10       ║     11      ║     12        ║  13  │ 14  ║    15   ║
╠══════════╪═══════════╬══════════════════╪══════════╬═════╪═══════════╬═══════════╪═══════════╬═════════════╬═══════════════╬═════════════╬═══════════════╬══════╪═════╬═════════╣
.{
.{?Internal;(KolPage = FixKolPage)
.begin
  inc(StrNN);
  KolAdd     :=0;
  KolPage    :=0;
  KolDOItog  :=0;
  KolFItog   :=0;
  Sum1Itog   :=0;
  Sum2Itog   :=0;
  Sum3Itog   :=0;
  FixKolPage := FixKol;
end.
                                                                                                                                                  Оборотная  сторона формы  № М-15
╔══════════════════════╦═════════════════════════════╦═════════════════╦═══════════════════════╦═════════════╦═══════════════╦═════════════╦═══════════════╦════════════╦═════════╗
║Корреспондирующий счет║    Материальные ценности    ║Единица измерения║      Количество       ║   Цена,     ║    Сумма      ║   Сумма     ║    Всего      ║    Номер   ║Порядко- ║
╟──────────┬───────────╫──────────────────┬──────────╫─────┬───────────╫───────────┬───────────╢  руб.коп.   ║  без учета    ║    НДС,     ║   с учетом    ╟──────┬─────╢вый номер║
║   счет,  │ код ана-  ║  наименование    │  номенк- ║ код │ наименова-║ надлежит  │ отпущено  ║             ║     НДС       ║  руб.коп.   ║     НДС,      ║инвен-│пас- ║записи по║
║  субсчет │литического║сорт,размер,марка │ латурный ║     │    ние    ║ отпустить │           ║             ║   руб.коп.    ║             ║   руб.коп.    ║ тар- │порта║складской║
║          │   учета   ║                  │  номер   ║     │           ║           │           ║             ║               ║             ║               ║ ный  │     ║картотеке║
╟──────────┼───────────╫──────────────────┼──────────╫─────┼───────────╫───────────┼───────────╫─────────────╫───────────────╫─────────────╫───────────────╫──────┼─────╫─────────╢
║    1     │     2     ║        3         │    4     ║  5  │     6     ║    7      │    8      ║     9       ║      10       ║     11      ║     12        ║  13  │ 14  ║    15   ║
╠══════════╪═══════════╬══════════════════╪══════════╬═════╪═══════════╬═══════════╪═══════════╬═════════════╬═══════════════╬═════════════╬═══════════════╬══════╪═════╬═════════╣
.}
#include m-15_02.frn
.{?Internal; NextPage
╚══════════╧═══════════╩══════════════════╧══════════╩═════╧═══════════╬═══════════╪═══════════╬═════════════╬═══════════════╬═════════════╬═══════════════╬══════╧═════╩═════════╝
                                                                 Итого:║@@@@@@@@@@@│@@@@@@@@@@@║             ║@@@@@@@@@@@@@@@║@@@@@@@@@@@@@║@@@@@@@@@@@@@@@║
                                                                       ╚═══════════╧═══════════╩═════════════╩═══════════════╩═════════════╩═══════════════╝
.{?Internal; breakPage=1
^
.}
.begin
  inc(StrNN);
  KolPage   := KolAdd;
  KolDOItog := 0;
  KolFItog  := 0;
  Sum1Itog  := 0;
  Sum2Itog  := 0;
  Sum3Itog  := 0;
  NextPage  := false;
end.
                                                                                                                                                   Оборотная  сторона формы  № М-15
╔══════════════════════╦═════════════════════════════╦═════════════════╦═══════════════════════╦═════════════╦═══════════════╦═════════════╦═══════════════╦════════════╦═════════╗
║Корреспондирующий счет║    Материальные ценности    ║Единица измерения║      Количество       ║   Цена,     ║    Сумма      ║   Сумма     ║    Всего      ║    Номер   ║Порядко- ║
╟──────────┬───────────╫──────────────────┬──────────╫─────┬───────────╫───────────┬───────────╢  руб.коп.   ║  без учета    ║    НДС,     ║   с учетом    ╟──────┬─────╢вый номер║
║   счет,  │ код ана-  ║  наименование    │  номенк- ║ код │ наименова-║ надлежит  │ отпущено  ║             ║     НДС       ║  руб.коп.   ║     НДС,      ║инвен-│пас- ║записи по║
║  субсчет │литического║сорт,размер,марка │ латурный ║     │    ние    ║ отпустить │           ║             ║   руб.коп.    ║             ║   руб.коп.    ║ тар- │порта║складской║
║          │   учета   ║                  │  номер   ║     │           ║           │           ║             ║               ║             ║               ║ ный  │     ║картотеке║
╟──────────┼───────────╫──────────────────┼──────────╫─────┼───────────╫───────────┼───────────╫─────────────╫───────────────╫─────────────╫───────────────╫──────┼─────╫─────────╢
║    1     │     2     ║        3         │    4     ║  5  │     6     ║    7      │    8      ║     9       ║      10       ║     11      ║     12        ║  13  │ 14  ║    15   ║
╠══════════╪═══════════╬══════════════════╪══════════╬═════╪═══════════╬═══════════╪═══════════╬═════════════╬═══════════════╬═════════════╬═══════════════╬══════╪═════╬═════════╣
.}
#include m-15_03.frn
#include CodeMC.frn
║          │           ║@@@@@@@@@@@@@@@@@@│@@@@@@@@@@║@@@@@│@@@@@@@@@@@║&&&&&&&&&&&│&&&&&&&&&&&║&&&&&&&&&&&&&║&&&&&&&&&&&&&&&║&&&&&&&&&&&&&║&&&&&&&&&&&&&&&║      │     ║         ║
.{?Internal; (KolPage = FixKolPage)  AND (KolSpSopr < количество_SpSopr)
╚══════════╧═══════════╩══════════════════╧══════════╩═════╧═══════════╬═══════════╪═══════════╬═════════════╬═══════════════╬═════════════╬═══════════════╬══════╧═════╩═════════╝
                                                                 Итого:║@@@@@@@@@@@│@@@@@@@@@@@║             ║@@@@@@@@@@@@@@@║@@@@@@@@@@@@@║@@@@@@@@@@@@@@@║
                                                                       ╚═══════════╧═══════════╩═════════════╩═══════════════╩═════════════╩═══════════════╝
.{?Internal; breakPage=1
^
.}
.}
.}
.{?Internal; (FixKol = FixKolPage) and (KolPage < FixKol)
╠══════════╪═══════════╬══════════════════╪══════════╬═════╪═══════════╬═══════════╪═══════════╬═════════════╬═══════════════╬═════════════╬═══════════════╬══════╪═════╬═════════╣
║          │           ║                  │          ║     │     Итого:║@@@@@@@@@@@│@@@@@@@@@@@║             ║@@@@@@@@@@@@@@@║@@@@@@@@@@@@@║@@@@@@@@@@@@@@@║      │     ║         ║
.}
╚══════════╧═══════════╩══════════════════╧══════════╩═════╧═══════════╬═══════════╪═══════════╬═════════════╬═══════════════╬═════════════╬═══════════════╬══════╧═════╩═════════╝
                                                    Всего по накладной:║@@@@@@@@@@@│@@@@@@@@@@@║             ║@@@@@@@@@@@@@@@║@@@@@@@@@@@@@║@@@@@@@@@@@@@@@║
                                                                       ╚═══════════╧═══════════╩═════════════╩═══════════════╩═════════════╩═══════════════╝
.{ CHECKENTER TOVNUSL
.}
  Всего отпущено Д ^  Днаименований
  На сумму Д ^    Дв том числе сумма НДС Д ^ Д

  Отпуск разрешил  З@~@@@@@@@@@@@@@@@ З __________  З@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ З       Главный бухгалтер      __________   З@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ З
                       должность      подпись       расшифровка подписи                                          подпись       расшифровка подписи

  Отпустил         З@~@@@@@@@@@@@@@@@ З __________  З@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ З       Получил _____________  __________  __________________________________
                       должность      подпись       расшифровка подписи                           должность      подпись       расшифровка подписи Ш
.{
.}
#ifdef __SKYSHOP__
#include sky.inc
#end
   ^
.}
.endform
