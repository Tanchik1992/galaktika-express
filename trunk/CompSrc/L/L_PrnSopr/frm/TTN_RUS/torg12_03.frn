!подсчет сумм по странице и итоговых сумм
.begin
#ifdef _IN_VAL_DOC_
  СтНДСНац := СтНДСНак;
  СтНацБН  := СтНакБН;
  СтНацСН  := СтНакСН;
#else
  СтНДСНац := СтНДСНац0;
  СтНацБН  := СтНацБН0;
  СтНацСН  := СтНацСН0;
#end

  inc(Nom);
  var tKolItog, tMassaBrItog, tMassaNetItog: double;// временные

  if (bAutoGrM)
    tKolItog := if (ЕД_ИЗМЕРЕНИЯ_ГРУЗОВЫХ_МЕСТ = 'н/у', 0, КОЛ_ГРУЗОВЫХ_МЕСТ)
  else
    tKolItog := if (КОЛ_ГРУЗОВЫХ_МЕСТ <> 0, КОЛ_ГРУЗОВЫХ_МЕСТ,
                    if (ЕД_ИЗМЕРЕНИЯ_ГРУЗОВЫХ_МЕСТ = 'н/у', 0, КолФ));

  tMassaBrItog  := if (wRoundMass2 > 3, Round((МассаМЦ + МассаТарыМЦ) * КолУч / 1000, wRoundMass2) * 1000,
                                        Round((МассаМЦ + МассаТарыМЦ) * КолУч));

  tMassaNetItog := if (wRoundMass2 > 3, Round(МассаМЦ * КолУч / 1000, wRoundMass2) * 1000,
                                        Round(МассаМЦ * КолУч));

  KolItog      := KolItog      + tKolItog;
  MassaBrItog  := MassaBrItog  + tMassaBrItog;
  MassaNetItog := MassaNetItog + tMassaNetItog;

  Sum1Itog := Sum1Itog + СтНацБН;
  Sum2Itog := Sum2Itog + СтНДСНац;
  Sum3Itog := Sum3Itog + СтНацСН;

  inc(NomFull);

  KolItogFull      := KolItogFull      + tKolItog;
  MassaBrItogFull  := MassaBrItogFull  + tMassaBrItog;
  MassaNetItogFull := MassaNetItogFull + tMassaNetItog;

  Sum1ItogFull := Sum1ItogFull + СтНацБН;
  Sum2ItogFull := Sum2ItogFull + СтНДСНац;
  Sum3ItogFull := Sum3ItogFull + СтНацСН;
end.
