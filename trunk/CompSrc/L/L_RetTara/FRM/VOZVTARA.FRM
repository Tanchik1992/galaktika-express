#INCLUDE VOZVTARA.PRO
#INCLUDE BAL_MCp.frn
#INCLUDE BAL_MCdo.frn
#doc
Отпуск-Возврат МЦ (цены из сопроводительных документов)
Полный отчет
#end
.linkform 'VozvTara 01p' prototype is 'VozvTara'
.group 'Отпуск-Возврат МЦ (цены из сопроводительных документов)'
.NameInList 'Полный отчет'
.fields
  CommonFormHeader
.endfields
^
.fields
  // фильтр по датам
  begdate:'m:DD/MM/YYYY'
  enddate:'m:DD/MM/YYYY'
  ValNatName
  ValTarName
  ValNatName
  ValTarName

  контрагент_имя
  контрагент_унн

  мц_имя
  мц_ном

  до_дата + ' ' + до_номер

  сокр_единица_изм

  кол_отпущено
  сумма_отп_НДЕ
  сумма_отп_вал

  кол_возвращено
  сумма_возвр_НДЕ
  сумма_возвр_вал
.endfields
.p 50
.defo Portrait
 Р
 Б                      ОТПУСК - ВОЗВРАТ МЦ (цены из сопроводительных документов, полный отчет) С
 Р
     Отчет сформирован за период :  от ^
                                    до ^
 Р
.{ CHECKENTER VozvKontrAg
.[h OverWrite
 Р───────────────────────────────────────────────────┬─────┬──────────────────────────────────────────────────────────┬───────────────────────────────────────────────────────────
                                                   │     │                          Отпуск                          │                         Возврат
                Наименование                       │     ├────────────────┬─────────────────────────────────────────┼────────────────┬──────────────────────────────────────────
                                                   │ Ед. │                │                  Сумма                  │                │                  Сумма
                                                   │ изм.│   Количество   ├────────────────────┬────────────────────┤   Количество   ├────────────────────┬─────────────────────
                                                   │     │                │  в @@@@@@@@@@@@@@@ │  в @@@@@@@@@@@@@@@ │                │  в @@@@@@@@@@@@@@@ │  в @@@@@@@@@@@@@@@@
───────────────────────────────────────────────────┴─────┴────────────────┴────────────────────┴────────────────────┴────────────────┴────────────────────┴───────────────────── Р
!                                                   @@@@@ &#&&&&&&&&&&&.&& &#&&&&&&&&&&&&&&&.&& &#&&&&&&&&&&&&&&&.&& &#&&&&&&&&&&&.&& &#&&&&&&&&&&&&&&&.&& &#&&&&&&&&&&&&&&&.&&
.]h
 Р ^ ^ Р
.{ CHECKENTER VozvMC
 Р     ^ ^ Р
.{ CHECKENTER VozvDocOsn
 Р        @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@ &#&&&&&&&&&&&.&& &#&&&&&&&&&&&&&&&.&& &#&&&&&&&&&&&&&&&.&& &#&&&&&&&&&&&.&& &#&&&&&&&&&&&&&&&.&& &#&&&&&&&&&&&&&&&.&& Р
.} // VozvDocOsn
.fields
  итого_цикл_2
  сокр_единица_изм
  MC1
  MC2
  MC3
  MC4
  MC5
  MC6
.endfields
 Р     Итого по @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@ &#&&&&&&&&&&&.&& &#&&&&&&&&&&&&&&&.&& &#&&&&&&&&&&&&&&&.&& &#&&&&&&&&&&&.&& &#&&&&&&&&&&&&&&&.&& &#&&&&&&&&&&&&&&&.&& Р
.} // VozvMC
.fields
  итого_цикл_1
  KontrAg1
  KontrAg2
  KontrAg3
  KontrAg4
  KontrAg5
  KontrAg6
.endfields
 Р Итого по @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@       &#&&&&&&&&&&&.&& &#&&&&&&&&&&&&&&&.&& &#&&&&&&&&&&&&&&&.&& &#&&&&&&&&&&&.&& &#&&&&&&&&&&&&&&&.&& &#&&&&&&&&&&&&&&&.&&
 Р
.} // VozvKontrAg
.fields
  Otch1
  Otch2
  Otch3
  Otch4
  Otch5
  Otch6
.endfields
 С Всего по отчету :                                        &#&&&&&&&&&&&.&& &#&&&&&&&&&&&&&&&.&& &#&&&&&&&&&&&&&&&.&& &#&&&&&&&&&&&.&& &#&&&&&&&&&&&&&&&.&& &#&&&&&&&&&&&&&&&.&& С
.endform


!


#doc
Отпуск-Возврат МЦ (цены из сопроводительных документов)
Сокращенный отчет
#end
.linkform 'VozvTara 01s' prototype is 'VozvTara'
.group 'Отпуск-Возврат МЦ (цены из сопроводительных документов)'
.NameInList 'Сокращенный отчет'
.fields
  CommonFormHeader
.endfields
^
.fields
  // фильтр по датам
  begdate:'m:DD/MM/YYYY'
  enddate:'m:DD/MM/YYYY'
  ValNatName
  ValTarName
  ValNatName
  ValTarName

  контрагент_имя
  контрагент_унн
.endfields
.p 50
.defo Portrait
 Р
 Б                   ОТПУСК - ВОЗВРАТ МЦ (цены из сопроводительных документов, сокращенный отчет) С
 Р
     Отчет сформирован за период :  от ^
                                    до ^
 Р
.{ CHECKENTER VozvKontrAg
.[h OverWrite
 Р───────────────────────────────────────────────────┬──────────────────────────────────────────────────────────┬───────────────────────────────────────────────────────────
                                                   │                          Отпуск                          │                         Возврат
                Наименование                       ├────────────────┬─────────────────────────────────────────┼────────────────┬──────────────────────────────────────────
                                                   │                │                  Сумма                  │                │                  Сумма
                                                   │   Количество   ├────────────────────┬────────────────────┤   Количество   ├────────────────────┬─────────────────────
                                                   │                │  в @@@@@@@@@@@@@@@ │  в @@@@@@@@@@@@@@@ │                │  в @@@@@@@@@@@@@@@ │  в @@@@@@@@@@@@@@@@
───────────────────────────────────────────────────┴────────────────┴────────────────────┴────────────────────┴────────────────┴────────────────────┴───────────────────── Р
!                                                   &#&&&&&&&&&&&.&& &#&&&&&&&&&&&&&&&.&& &#&&&&&&&&&&&&&&&.&& &#&&&&&&&&&&&.&& &#&&&&&&&&&&&&&&&.&& &#&&&&&&&&&&&&&&&.&&
.]h
 Р ^ ^ Р
.{ CHECKENTER VozvMC
.{ CHECKENTER VozvDocOsn
.} // VozvDocOsn
.fields
  мц_имя + ' ' + мц_ном
  MC1
  MC2
  MC3
  MC4
  MC5
  MC6
.endfields
 Р     @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &#&&&&&&&&&&&.&& &#&&&&&&&&&&&&&&&.&& &#&&&&&&&&&&&&&&&.&& &#&&&&&&&&&&&.&& &#&&&&&&&&&&&&&&&.&& &#&&&&&&&&&&&&&&&.&& Р
.} // VozvMC
.fields
  итого_цикл_1
  KontrAg1
  KontrAg2
  KontrAg3
  KontrAg4
  KontrAg5
  KontrAg6
.endfields
 Р Итого по @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &#&&&&&&&&&&&.&& &#&&&&&&&&&&&&&&&.&& &#&&&&&&&&&&&&&&&.&& &#&&&&&&&&&&&.&& &#&&&&&&&&&&&&&&&.&& &#&&&&&&&&&&&&&&&.&&
 Р
.} // VozvKontrAg
.fields
  Otch1
  Otch2
  Otch3
  Otch4
  Otch5
  Otch6
.endfields
 С Всего по отчету :                                  &#&&&&&&&&&&&.&& &#&&&&&&&&&&&&&&&.&& &#&&&&&&&&&&&&&&&.&& &#&&&&&&&&&&&.&& &#&&&&&&&&&&&&&&&.&& &#&&&&&&&&&&&&&&&.&& С
.endform


!


#doc
Отпуск-Возврат МЦ (цены из сопроводительных документов)
Краткий отчет
#end
.linkform 'VozvTara 01k' prototype is 'VozvTara'
.group 'Отпуск-Возврат МЦ (цены из сопроводительных документов)'
.NameInList 'Краткий отчет'
.fields
  CommonFormHeader
.endfields
^
.fields
  // фильтр по датам
  begdate:'m:DD/MM/YYYY'
  enddate:'m:DD/MM/YYYY'
  ValNatName
  ValTarName
  ValNatName
  ValTarName
.endfields
.p 50
.defo Portrait
 Р
 Б                   ОТПУСК - ВОЗВРАТ МЦ (цены из сопроводительных документов, краткий отчет) С
 Р
     Отчет сформирован за период :  от ^
                                    до ^
 Р
.{ CHECKENTER VozvKontrAg
.[h OverWrite
 Р───────────────────────────────────────────────────┬──────────────────────────────────────────────────────────┬───────────────────────────────────────────────────────────
                                                   │                          Отпуск                          │                         Возврат
                Наименование                       ├────────────────┬─────────────────────────────────────────┼────────────────┬──────────────────────────────────────────
                                                   │                │                  Сумма                  │                │                  Сумма
                                                   │   Количество   ├────────────────────┬────────────────────┤   Количество   ├────────────────────┬─────────────────────
                                                   │                │  в @@@@@@@@@@@@@@@ │  в @@@@@@@@@@@@@@@ │                │  в @@@@@@@@@@@@@@@ │  в @@@@@@@@@@@@@@@@
───────────────────────────────────────────────────┴────────────────┴────────────────────┴────────────────────┴────────────────┴────────────────────┴───────────────────── Р
!                                                   &#&&&&&&&&&&&.&& &#&&&&&&&&&&&&&&&.&& &#&&&&&&&&&&&&&&&.&& &#&&&&&&&&&&&.&& &#&&&&&&&&&&&&&&&.&& &#&&&&&&&&&&&&&&&.&&
.]h
.{ CHECKENTER VozvMC
.{ CHECKENTER VozvDocOsn
.} // VozvDocOsn
.} // VozvMC
.fields
  контрагент_имя + ' ' + контрагент_унн
  KontrAg1
  KontrAg2
  KontrAg3
  KontrAg4
  KontrAg5
  KontrAg6
.endfields
 Р @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &#&&&&&&&&&&&.&& &#&&&&&&&&&&&&&&&.&& &#&&&&&&&&&&&&&&&.&& &#&&&&&&&&&&&.&& &#&&&&&&&&&&&&&&&.&& &#&&&&&&&&&&&&&&&.&& Р
.} // VozvKontrAg
.fields
  Otch1
  Otch2
  Otch3
  Otch4
  Otch5
  Otch6
.endfields
 С
 Всего по отчету :                                  &#&&&&&&&&&&&.&& &#&&&&&&&&&&&&&&&.&& &#&&&&&&&&&&&&&&&.&& &#&&&&&&&&&&&.&& &#&&&&&&&&&&&&&&&.&& &#&&&&&&&&&&&&&&&.&& С
.endform