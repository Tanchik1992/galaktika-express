#doc
Баланс поставок МЦ (цены из прайс-листа)
Полный отчет
#end
.linkform 'VozvTara 03p' prototype is 'VozvTara'
.group 'Баланс поставок МЦ (цены из прайс-листа)'
.NameInList 'Полный отчет'
.var
   curDO,MC0,KontrAg0,Otch0 : double ;
.endvar
.Create view PrTab
  var
    curMC    : comp ;
  from
    Prices   , // Прайс-листы (спецификация)
    KatOtpEd   // Отпускные единицы измерения
  where
    ((
          nRecPrice     == Prices.cKlPrice  // Nrec прайс-листа
      and curMC         == Prices.cThing    // Nrec товара/услуги
      and Prices.cOtpEd == KatOtpEd.nRec    // Nrec отпускной единицы
    )) ;
.fields
  CommonFormHeader
.endfields
^
.fields
  // фильтр по датам
  begdate:'m:DD/MM/YYYY'
  enddate:'m:DD/MM/YYYY'
  ValNatName

  контрагент_имя
  контрагент_унн

  мц_имя
  мц_ном

  до_дата + ' ' + до_номер

  сокр_единица_изм

  кол_отпущено
  кол_возвращено
  кол_отпущено - кол_возвращено
  curDO
.endfields
.p 50
.defo Portrait
.begin
  Otch0 := 0 ;
 end.
 И
 Б                     БАЛАНС ПОСТАВОК МЦ (цены из прайс-листа, полный отчет) Й
 И
     Отчет сформирован за период :  от ^
                                    до ^
 И
.{ CHECKENTER VozvKontrAg
.[h OverWrite
 И───────────────────────────────────────────────────┬─────┬─────────────────────────────────┬──────────────────────────────────────
                                                   │     │                                 │      Задолженность контрагентов
                Наименование                       │     │           Количество            ├────────────────┬─────────────────────
                                                   │ Ед. │                                 │                │
                                                   │ изм.├────────────────┬────────────────┤   Количество   │ Сумма в @@@@@@@@@@@
                                                   │     │    Отпущено    │   Возвращено   │                │
───────────────────────────────────────────────────┴─────┴────────────────┴────────────────┴────────────────┴───────────────────── И
!                                                   @@@@@ &#&&&&&&&&&&&.&& &#&&&&&&&&&&&.&& &#&&&&&&&&&&&.&& &&&&&&&&&&&&&&&&&.&&
.]h
 И ^ ^ И
.begin
  KontrAg0 := 0 ;
end.
.{ CHECKENTER VozvMC
 И     ^ ^ И
.begin
  MC0 := 0 ;
end.
.{ CHECKENTER VozvDocOsn
.begin
  case порядок_сорт of
    1: PrTab.curMC := мц_нрек ;
    2: PrTab.curMC := до_нрек ;
    3: PrTab.curMC := контрагент_нрек ;
  end ;
  curDO := if ( PrTab.GetFirst Prices = 0, PrTab.Prices.Price, double(0) )
           / if ( PrTab.GetFirst KatOtpEd = 0,
                  PrTab.KatOtpEd.Koef,
                  double(1) )
           * долг_кол_в_уч_ед ;
  MC0 := MC0 + curDO ;
end.
 И        @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@ &#&&&&&&&&&&&.&& &#&&&&&&&&&&&.&& &#&&&&&&&&&&&.&& &&&&&&&&&&&&&&&&&.&& И
.} // VozvDocOsn
.begin
  KontrAg0 := KontrAg0 + MC0 ;
end.
.fields
  итого_цикл_2
  сокр_единица_изм
  MC1
  MC4
  MC1 - MC4
  MC0
.endfields
 И     Итого по @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@ &#&&&&&&&&&&&.&& &#&&&&&&&&&&&.&& &#&&&&&&&&&&&.&& &&&&&&&&&&&&&&&&&.&& И
.} // VozvMC
.begin
  Otch0 := Otch0 + KontrAg0 ;
end.
.fields
  итого_цикл_1
  KontrAg1
  KontrAg4
  KontrAg1 - KontrAg4
  KontrAg0
.endfields
 И Итого по @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@       &#&&&&&&&&&&&.&& &#&&&&&&&&&&&.&& &#&&&&&&&&&&&.&& &&&&&&&&&&&&&&&&&.&&
 И
.} // VozvKontrAg
.fields
  Otch1
  Otch4
  Otch1 - Otch4
  Otch0
.endfields
 Й Всего по отчету :                                        &#&&&&&&&&&&&.&& &#&&&&&&&&&&&.&& &#&&&&&&&&&&&.&& &&&&&&&&&&&&&&&&&.&& Й
.endform



!


#doc
Баланс поставок МЦ (цены из прайс-листа)
Сокращенный отчет
#end
.linkform 'VozvTara 03s' prototype is 'VozvTara'
.group 'Баланс поставок МЦ (цены из прайс-листа)'
.NameInList 'Сокращенный отчет'
.var
   curDO,MC0,KontrAg0,Otch0 : double ;
.endvar
.Create view PrTab
  var
    curPrice,
    curMC    : comp ;
  from
    Prices   ,
    KatOtpEd
  where
    ((
          nRecPrice     == Prices.cKlPrice  // Nrec прайс-листа
      and curMC         == Prices.cThing    // Nrec товара/услуги
      and Prices.cOtpEd == KatOtpEd.nRec    // Nrec отпускной единицы
    )) ;
.fields
  CommonFormHeader
.endfields
^
.fields
  // фильтр по датам
  begdate:'m:DD/MM/YYYY'
  enddate:'m:DD/MM/YYYY'
  ValNatName

  контрагент_имя
  контрагент_унн
.endfields
.p 50
.defo Portrait
.begin
  Otch0 := 0 ;
 end.
 И
 Б                     БАЛАНС ПОСТАВОК МЦ (цены из прайс-листа, сокращенный отчет) Й
 И
     Отчет сформирован за период :  от ^
                                    до ^
 И
.{ CHECKENTER VozvKontrAg
.[h OverWrite
 И───────────────────────────────────────────────────┬─────────────────────────────────┬──────────────────────────────────────
                                                   │                                 │      Задолженность контрагентов
                Наименование                       │           Количество            ├────────────────┬─────────────────────
                                                   │                                 │                │
                                                   ├────────────────┬────────────────┤   Количество   │ Сумма в @@@@@@@@@@@
                                                   │    Отпущено    │   Возвращено   │                │
───────────────────────────────────────────────────┴────────────────┴────────────────┴────────────────┴───────────────────── И
!                                                   &#&&&&&&&&&&&.&& &#&&&&&&&&&&&.&& &#&&&&&&&&&&&.&& &&&&&&&&&&&&&&&&&.&&
.]h
 И ^ ^ И
.begin
  KontrAg0 := 0 ;
end.
.{ CHECKENTER VozvMC
.begin
  MC0 := 0 ;
end.
.{ CHECKENTER VozvDocOsn
.begin
  case порядок_сорт of
    1: PrTab.curMC := мц_нрек ;
    2: PrTab.curMC := до_нрек ;
    3: PrTab.curMC := контрагент_нрек ;
  end ;
  curDO := if ( PrTab.GetFirst Prices = 0, PrTab.Price, double(0) )
           / if ( PrTab.GetFirst KatOtpEd = 0,
                  PrTab.KatOtpEd.Koef,
                  double(1) )
           * долг_кол_в_уч_ед ;
  MC0 := MC0 + curDO ;
end.
.} // VozvDocOsn
.begin
  KontrAg0 := KontrAg0 + MC0 ;
end.
.fields
  мц_имя + ' ' + мц_ном
  MC1
  MC4
  MC1 - MC4
  MC0
.endfields
 И     @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &#&&&&&&&&&&&.&& &#&&&&&&&&&&&.&& &#&&&&&&&&&&&.&& &&&&&&&&&&&&&&&&&.&& И
.} // VozvMC
.begin
  Otch0 := Otch0 + KontrAg0 ;
end.
.fields
  итого_цикл_1
  KontrAg1
  KontrAg4
  KontrAg1 - KontrAg4
  KontrAg0
.endfields
 И Итого по @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &#&&&&&&&&&&&.&& &#&&&&&&&&&&&.&& &#&&&&&&&&&&&.&& &&&&&&&&&&&&&&&&&.&&
 И
.} // VozvKontrAg
.fields
  Otch1
  Otch4
  Otch1 - Otch4
  Otch0
.endfields
 Й Всего по отчету :                                  &#&&&&&&&&&&&.&& &#&&&&&&&&&&&.&& &#&&&&&&&&&&&.&& &&&&&&&&&&&&&&&&&.&& Й
.endform



!


#doc
Баланс поставок МЦ (цены из прайс-листа)
Краткий отчет
#end
.linkform 'VozvTara 03k' prototype is 'VozvTara'
.group 'Баланс поставок МЦ (цены из прайс-листа)'
.NameInList 'Краткий отчет'
.var
   curDO,MC0,KontrAg0,Otch0 : double ;
.endvar
.Create view PrTab
  var
    curPrice,
    curMC    : comp ;
  from
    Prices   ,
    KatOtpEd
  where
    ((
          nRecPrice     == Prices.cKlPrice  // Nrec прайс-листа
      and curMC         == Prices.cThing    // Nrec товара/услуги
      and Prices.cOtpEd == KatOtpEd.nRec    // Nrec отпускной единицы
    )) ;
.fields
  CommonFormHeader
.endfields
^
.fields
  // фильтр по датам
  begdate:'m:DD/MM/YYYY'
  enddate:'m:DD/MM/YYYY'
  ValNatName
.endfields
.p 50
.defo Portrait
.begin
  Otch0 := 0 ;
 end.
 И
 Б                     БАЛАНС ПОСТАВОК МЦ (цены из прайс-листа, краткий отчет) Й
 И
     Отчет сформирован за период :  от ^
                                    до ^
 И
.{ CHECKENTER VozvKontrAg
.[h OverWrite
 И───────────────────────────────────────────────────┬─────────────────────────────────┬──────────────────────────────────────
                                                   │                                 │      Задолженность контрагентов
                Наименование                       │           Количество            ├────────────────┬─────────────────────
                                                   │                                 │                │
                                                   ├────────────────┬────────────────┤   Количество   │ Сумма в @@@@@@@@@@@
                                                   │    Отпущено    │   Возвращено   │                │
───────────────────────────────────────────────────┴────────────────┴────────────────┴────────────────┴───────────────────── И
!                                                   &#&&&&&&&&&&&.&& &#&&&&&&&&&&&.&& &#&&&&&&&&&&&.&& &&&&&&&&&&&&&&&&&.&&
.]h
.begin
  KontrAg0 := 0 ;
end.
.{ CHECKENTER VozvMC
.begin
  MC0 := 0 ;
end.
.{ CHECKENTER VozvDocOsn
.begin
  case порядок_сорт of
    1: PrTab.curMC := мц_нрек ;
    2: PrTab.curMC := до_нрек ;
    3: PrTab.curMC := контрагент_нрек ;
  end ;
  curDO := if ( PrTab.GetFirst Prices = 0, PrTab.Price, double(0) )
           / if ( PrTab.GetFirst KatOtpEd = 0,
                  PrTab.KatOtpEd.Koef,
                  double(1) )
           * долг_кол_в_уч_ед ;
  MC0 := MC0 + curDO ;
end.
.} // VozvDocOsn
.begin
  KontrAg0 := KontrAg0 + MC0 ;
end.
.} // VozvMC
.begin
  Otch0 := Otch0 + KontrAg0 ;
end.
.fields
  контрагент_имя + ' ' + контрагент_унн
  KontrAg1
  KontrAg4
  KontrAg1 - KontrAg4
  KontrAg0
.endfields
 И @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &#&&&&&&&&&&&.&& &#&&&&&&&&&&&.&& &#&&&&&&&&&&&.&& &&&&&&&&&&&&&&&&&.&& И
.} // VozvKontrAg
.fields
  Otch1
  Otch4
  Otch1 - Otch4
  Otch0
.endfields
 Й
 Всего по отчету :                                  &#&&&&&&&&&&&.&& &#&&&&&&&&&&&.&& &#&&&&&&&&&&&.&& &&&&&&&&&&&&&&&&&.&& Й
.endform
