/*
 ╔═════════════════════════════════════════════════════════════════════════╗
 ║                     (c) Корпорация ГАЛАКТИКА, 1994,99                   ║
 ║ Проект        : ГАЛАКТИКА                                               ║
 ║ Система       : Оперативный контур                                      ║
 ║ Версия        : 5.80 (SKLAD)                                            ║
 ║ Разработал    : Сорока В.В.                                             ║
 ║ Назначение    : Форма иерарх. отчета по нераспред.скл.специф.-й         ║
 ╚═════════════════════════════════════════════════════════════════════════╝
*/
#doc
Форма иерархического отчета по нераспред.скл.специф.-й
#end
.set name='HRepBox'
.hide
.fields
  strRepName : string //01
  wTipEdIzm  : word //02
.endfields
12
^^
.{
.{ CheckEnter GrpHeaderBox
.fields
   GroupHeaderName:string //03
.endfields
3
^
.}
.fields
 cSaldoBox     :comp          //04
 sMZName       :string        //05
 sPartyName    :string        //06
 dblMZKol      :double        //07
 sEdIzmName    :string        //08
 sKatBoxName   :string        //09
.endfields
456789
^^^^^^
.{ CheckEnter GrpFooterBox
.Fields
  strGrpTotalName:string //10
  dblGrpKol      :double //11
.EndFields
1
01
^^
.}
.}
.endform

!-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
!!\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\
!-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

#doc
ОТЧЕТ ПО НАЛИЧИЮ В ЯЧЕЙКАХ ХРАНЕНИЯ
#end
.linkform 'HRepBox01' prototype is 'HRepBox'
.p 55
.defo landscape
.NameInList 'ОТЧЕТ ПО НАЛИЧИЮ В ЯЧЕЙКАХ ХРАНЕНИЯ'
.var
     dblTotKol    : double;
     strTipEdIzm  : string;
.endvar
.begin
!!----- инициализация ---
 dblTotKol      := 0;
 case wTipEdIzm of
  0: strTipEdIzm := '(учетн.)';
  1: strTipEdIzm := '(масса)';
  2: strTipEdIzm := '(объем)';
  else strTipEdIzm := '????????';
 end;//case
end.
.fields
 CommonFormHeader
.endfields
 Ш^
.fields
 strRepName //01
 strTipEdIzm
.endfields
 Б@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
 ─────────────────────────────┬──────────────────┬───────────────────┬───────────┬───────────────────────
         Наименование         │       Партия     │     Количество    │  Единица  │        Ячейка
             МЦ               │                  │                   │ измерения │       хранения
                              │                  │                   │@~@@@@@@@@@│
 ─────────────────────────────┼──────────────────┼───────────────────┼───────────┼───────────────────────
             (1)              │        (2)       │        (3)        │    (4)    │          (5)
 ─────────────────────────────┴──────────────────┴───────────────────┴───────────┴───────────────────────
.{ //MAIN CYCLE ON Box's
.[h SKIP

.fields
CommonFormHeader
strRepName
.endfields
 ^
 @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Лист N @Np@
 ─────────────────────────────┬──────────────────┬───────────────────┬───────────┬───────────────────────
             (1)              │        (2)       │        (3)        │    (4)    │          (5)
 ─────────────────────────────┴──────────────────┴───────────────────┴───────────┴───────────────────────
.]h //HEADER end
!!------------------------------------------------------------------------
.{ CheckEnter GrpHeaderBox
.Fields GroupHeaderName:'T:-' .EndFields //02
 Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
.}//CheckEnter GroupHeader;
.fields
 sMZName     //04
 sPartyName  //05
 dblMZKol    //06
 sEdIzmName  //07
 sKatBoxName //08
.endfields
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&&&.&&& @~@@@@@@@@@ @@@@@@@@@@@@
!!----------------- суммирование ---------------------------
.begin
  dblTotKol := dblTotKol + dblMZKol;
end.
.{ CheckEnter GrpFooterBox
.fields
  strGrpTotalName:'T:-'  //09
  dblGrpKol              //10
.endfields
 Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&&&.&&& Б
.} //CheckEnter GrpFooterBox;
!!------------------------------------------------------------------------
.} //MAIN CYCLE ON Box
 ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.fields
 dblTotKol
.endfields
 Б  Итого по отчету:                                &'&&&&&&&&&&&&&.&&& Б
 Ш
.endform
!-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
!!\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\
!-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
