! ╔═════════════════════════════════════════════════════════════════════════╗
! ║  Разработал:  Володько А.В. (Anatoly)                                   ║
! ║  Назначение:  Печать планов поставок / реализации                       ║
! ╚═════════════════════════════════════════════════════════════════════════╝
#doc
Печать планов поставок / реализации
#end
.Set Name = 'DebList'
.hide
! Циклы заголовка (верхняя линия)                     j000
! Циклы заголовка (наименования периодов)             j001-j003
! Циклы заголовка (нижняя линия)                      j009
! Циклы шапки контрагента (верхняя линия)             j300
! Циклы шапки контрагента (наименования периодов)     j301-j303
! Циклы шапки контрагента (нижняя линия)              j309
! Циклы шапки договора (верхняя линия)                j500
! Циклы шапки договора (наименования периодов)        j501-j513
! Циклы шапки договора (нижняя линия)                 j509
! Циклы договора (значения dpxx51x и dpdxxd51x)       j510-j511
! Циклы шапки договора (нижняя линия)                 j599
! Циклы итого контрагента (верхняя линия)             j700
! Циклы итого контрагента (наименования периодов)     j701-j703
! Циклы итого контрагента (нижняя линия)              j709
! Циклы итого контрагента (значения kpxx71x)          j710-j711
! Циклы итого контрагента (нижняя линия)              j719
! Циклы итого контрагента (значения kpxx72x)          j720-j721
! Циклы итого контрагента (нижняя линия)              j799
! Циклы итого все контрагенты (верхняя линия)         j900
! Циклы итого все контрагенты (наименования периодов) j901-j903
! Циклы итого все контрагенты (нижняя линия)          j909
! Циклы итого все контрагенты (значения apxx91x)      j910-j911
! Циклы итого все контрагенты (нижняя линия)          j919
! Циклы итого все контрагенты сальдированно(apxx92x)  j920-j922
! Циклы итого все контрагенты (нижняя линия)          j999
!11. Отгружено  товара   = сумма расходной накладной в продажах для дог.продажи
!12. Возвращено товара   = сумма возвратной накл. в продажах для дог.продажи
!    (отгруженного)
!13. Принято товара      = сумма приходной накладной в закупках для дог.закупки
!14. Возвращено товара   = сумма возвратной накл. в закупках для дог.закупки
!      (принятого)
!15. Оплачено нам денег  = сумма платежного документа от контрагента
!                          для договора продажи
!16. Возвращено денег    = сумма платежного документа от нас
!контрагенту(по продаже)   для договора продажи
!17. Оплачено нами денег = сумма платежного документа от нас
!                          для договора закупки
!18. Возвращено денег    = сумма платежного документа от контрагента
!нам (по закупке)          для договора закупки
!19. Оплачено нам товаром= сумма приходной накладной для дог.продажи
!1a. Возврат e19.        = сумма возвратной накл. в закупках для дог.продажи
!1b. Оплачено нами товаром = сумма расходной накладной для дог.закупки
!1c. Возврат e1b.        = сумма возвратной накл. в продажах для дог.закупки
!1z. Суммарное движение после последнего периода
!d21. Фактически отгружено (нами)     = {d11.}-{d12.}
!d22. Фактически принято   (от контр) = {d13.}-{d14.}
!d23. Фактически оплачено нам         = {d15.}+{d19.}-{d16.}-{d1a.}
!d24. Фактически оплачено нами        = {d17.}+{d1b.}-{d18.}-{d1c.}
!d25. Задолженность по продаже(контр) = {d21.}-{d23.}
!d26. Задолженность по закупке(контр) = {d24.}-{d22.}
!..   Другие вычисляемые выражения
!d2z. Фактическая задолженность       = {d25.}-{d26.}
!  контрагента(>0) или наша (<0)
!
!Итоговая задолженность по договору
!d31. По товару (Продажа) (наша)            = If(Продажа,{d01.} - {d21.},0)
!d32. По товару (Закупка) (контр)           = If(Закупка,{d01.} - {d22.},0)
!d33. По оплате (Продажа) (контр)           = If(Продажа,{d01.} - {d23.},0)
!d34. По оплате (Закупка) (наша)            = If(Закупка,{d01.} - {d24.},0)
!d35. Задолженность по продаже(контрагента) = {d33.} - {d31.}
!d36. Задолженность по закупке(контрагента) = {d32.} - {d34.}
!..
!d3z. Фактическая задолженность             = {d35.} + {d36.}
!     контрагента(>0) или наша (<0)
!
!Итоговая просроченная задолженность по договору
!d41. По товару (Продажа)             = If({наступил срок отгрузки}, {d31.} ,0)
!d42. По товару (Закупка)             = If({наступил срок отгрузки}, {d32.} ,0)
!d43. По оплате (Продажа)             = If({наступил срок оплаты}  , {d33.} ,0)
!d44. По оплате (Закупка)             = If({наступил срок оплаты}  , {d34.} ,0)
!d45. Задолженность по продаже(контрагента) = If({d25.}>0 и {наступил срок оплаты}
!                                            или {d25.}<0 и {наступил срок отгрузки},
!                                                {d25.},0 )
!d46. Задолженность по закупке(контрагента) = If({d26.}>0 и {наступил срок отгрузки}
!                                            или {d26.}<0 и {наступил срок оплаты},
!                                                {d26.},0 )
!d4z. Фактическая просроченная сальдированная задолженность
!     контрагента (>0) или наша (<0)        = {d45.} + {d46.}
.fields
  TblPeriods:LongInt    // 01
  fdPer1  :word         // 02
  fdPer2  :word         // 03
  fdp31d  :word         // 041
  fdp32d  :word         // 042
  fdp33d  :word         // 043
  fdp34d  :word         // 044
  fdp3zd  :word         // 045
  fdp31   :word         // 046
  fdp32   :word         // 047
  fdp33   :word         // 048
  fdp34   :word         // 049
  fdp3z   :word         // 040
  fdp41d  :word         // 051
  fdp42d  :word         // 052
  fdp43d  :word         // 053
  fdp44d  :word         // 054
  fdp4zd  :word         // 055
  fdp41   :word         // 056
  fdp42   :word         // 057
  fdp43   :word         // 058
  fdp44   :word         // 059
  fdp4z   :word         // 050
  fkp31   :word         // 06
  fkp32   :word         // 07
  fkp33   :word         // 08
  fkp34   :word         // 09
  fkp3z   :word         // 10
  fkp3zs  :word         // 11
  fkp41   :word         // 12
  fkp42   :word         // 13
  fkp43   :word         // 14
  fkp44   :word         // 15
  fkp4z   :word         // 16
  fkp4zs  :word         // 17
  fap31   :word         // 18
  fap32   :word         // 19
  fap33   :word         // 20
  fap34   :word         // 21
  fap3z   :word         // 22
  fap3zk  :word         // 23
  fap3zs  :word         // 24
  fap41   :word         // 25
  fap42   :word         // 26
  fap43   :word         // 27
  fap44   :word         // 28
  fap4z   :word         // 29
  fap4zk  :word         // 30
  fap4zs  :word         // 31
  fName1  :word         // 32
  fName2  :word         // 33

 ВалОтчета:string           //01
 ВалютаОтчета:string        //02
 ВВалютеОтчета:string       //03
 ДатаОтчета:date            //04
 НачДатаОтчета:date         //05
 КонДатаОтчета:date         //06
 НачДатаПериодов:date       //07
 КонДатаПериодов:date       //08
 Per0:word                  //09
 Per1:word                  //10
 Per2:word                  //11
 Align:word                 //12
 AlignDay:word              //13
 LenPer:word                //14
 TipLen:word                //15
 KolPers:word               //16
 Prod:word                  //17
 Zakup:word                 //18
 UchVozvr:boolean           //19
 AllKontr:word              //20
 NaklOnlyWas:boolean        //21
 UserTune_cVal:string       //22

! KatOrg_Nrec:string     //01 Код
 KatOrg_Name:string     //02 наим.организации или ФИО физ.лица
 KatOrg_TipOrg:string   //03 ООО, ЗАО, НТО, МП, СП, ЧП и т.п.
 KatOrg_Addr:string     //04 адрес контрагента
 KatOrg_OKPO:string     //05 код по ОКПО
 KatOrg_OKONH:string    //06 код по ОКОНХ
 KatOrg_TEL:string      //07 телефоны + факсы контрагента
! KatOrg_cState:string   //08 номер страны (NRec из KatState)
! KatOrg_cCity:string    //09 номер города (NRec из KatCity)
 KatOrg_TipKnt:string   //10 классификация контрагентов
 KatOrg_CorpoIn:word    //11 1-входит в состав корпорации,else-0
 KatOrg_UNN:string      //12 условный номер налогоплательщика

 NдокДескрДО:string      //00
 Dogovor_NoDoc:string
 Dogovor_dDoc: date
! BaseDoc_NRec:string     //01 Код
 BaseDoc_Name:string     //02 наименование докумета-основания
 BaseDoc_VIDDOC:word     //03 вид док-та: договор, счет, счет-фактура
 BaseDoc_NoDoc:string    //04 номер документа
 BaseDoc_DscDoc:string   //05 дескриптор к номеру документа
 BaseDoc_dForm:date      //06 дата формирования
 BaseDoc_dDoc:date       //07 дата вступления в силу
! BaseDoc_YearDoc:word    //08 отдельно: год от dDoc
! BaseDoc_KolDn:word      //09 количество дней действия счета
! BaseDoc_dEnd:date       //10 дата окончания договора
! BaseDoc_cORG:string     //11 код контрагента
! BaseDoc_cBANK:string    //12 банк контрагента
! BaseDoc_cDogAgr:string  //13 указатель на группу договоров
! BaseDoc_cMyBANK:string  //14 код собственного банка
! BaseDoc_Summa:double    //15 сумма по договору
 BaseDoc_Shtraf:word     //16 1 - предусмотрены или 0-нет штрафы
 BaseDoc_Skidka:double   //17 скидка от суммы счета
 BaseDoc_NDS:double      //18 сумма НДС
 BaseDoc_DopProc:double  //19 доп_процент к курсу для вал-руб док-осн
 BaseDoc_TOTAL:double    //20 итого
! BaseDoc_cGrPol:string   //21 код грузополучателя
! BaseDoc_cGrOtpr:string  //22 код грузоотправителя
! BaseDoc_STATUS:word     //23 системное состояние документа
! BaseDoc_cStatDoc:string //24 состояние документа
 BaseDoc_Direct:word     //25 0-внут операция,1 - продажа,2 - закупка
! BaseDoc_cVAL:string     //26 код валюты
! BaseDoc_SUMVAL:double   //27 сумма в валюте
 BaseDoc_TipMoney:word   //28 тип документа по отношению к валюте
 BaseDoc_Prior:string    //29 приоритет оплаты
! BaseDoc_cNalog:string   //30 код налога
 BaseDoc_VhodNal:word    //31 вход в цену налогов: 1-входит
! BaseDoc_cParty:string   //32 партия для учета консигнации
 BaseDoc_KolKompl:double //33 кол-во комплектов
! BaseDoc_cCompl:string   //34 комплект ссылка
! BaseDoc_cPodrTo:string  //35 в подразделение ссылка
! BaseDoc_cNazna:string   //36 назначение ссылка
 BaseDoc_dOtsroch:date   //37 дата отсрочки оплаты по закупке
 BaseDoc_VhSkid:word     //38 вариант скидки:1-%,2-сумма
 BaseDoc_dPrice:date     //39 дата цен
 BaseDoc_ValCurse:double //40 курс валюты для вал-руб ДО

 ВалДог:string            //01
 ВалютаДог:string         //02
 ВВалютеДог:string        //03
! StepDoc_Nrec:string      //04 Код
 StepDoc_Name:string      //05 наименование
 StepDoc_NStep:string     //06 номер этапа
 StepDoc_dStart:date      //07 дата начала этапа
 StepDoc_dEnd:date        //08 дата завершения этапа
! StepDoc_Summa:double     //09 сумма по этапу
! StepDoc_cVal:string      //10 код валюты
! StepDoc_SUMVAL:double    //11 сумма в валюте
! StepDoc_cStatDoc:string  //12 состояние этапа (код STATDOC)
! StepDoc_Status:word      //13 системный статус документа
 StepDoc_dIzvMax:date     //14 дата,до кот необх известить об оплате
 StepDoc_dIzvFact:date    //15 дата фактич извещ о переч денег
 StepDoc_dOplMax:date     //16 дата, до кот должны поступ деньги
 StepDoc_dOplFact:date    //17 дата выписки из банка(факт)
 StepDoc_dOtgr:date       //18 дата отгр(макс)- в случае несамовывоза
 StepDoc_dZabor:date      //19 дата самов(забора товара) макс
! StepDoc_cShtrafP:string  //20 штрафы за просрочку оплаты
! StepDoc_cShtrafG:string  //21 штрафы за просрочку отгрузки
 ОтгрузитьДо:Date         //22
 ОплатитьДо:Date          //23

 d01d:double
 d11d:double d12d:double d13d:double d14d:double d15d:double d16d:double
 d17d:double d18d:double d19d:double d1ad:double d1bd:double d1cd:double d1zd:double
 d21d:double d22d:double d23d:double d24d:double d25d:double d26d:double d2zd:double
 d31d:double d32d:double d33d:double d34d:double d35d:double d36d:double d3zd:double
 d41d:double d42d:double d43d:double d44d:double d45d:double d46d:double d4zd:double

 d01:double
 d11:double d12:double d13:double d14:double d15:double d16:double
 d17:double d18:double d19:double d1a:double d1b:double d1c:double d1z:double
 d21:double d22:double d23:double d24:double d25:double d26:double d2z:double
 d31:double d32:double d33:double d34:double d35:double d36:double d3z:double
 d41:double d42:double d43:double d44:double d45:double d46:double d4z:double
 k01:double k02:double
 k11:double k12:double k13:double k14:double k15:double k16:double
 k17:double k18:double k19:double k1a:double k1b:double k1c:double k1zP:double k1zZ:double
 k21:double k22:double k23:double k24:double k25:double k26:double k2z:double
 k31:double k32:double k33:double k34:double k35:double k36:double k3z:double
 k41:double k42:double k43:double k44:double k45:double k46:double k4z:double

 a01:double a02:double
 a11:double a12:double a13:double a14:double a15:double a16:double
 a17:double a18:double a19:double a1a:double a1b:double a1c:double a1zP:double a1zZ:double
 a21:double a22:double a23:double a24:double a25:double a26:double a2z:double
 a31:double a32:double a33:double a34:double a35:double a36:double a3z:double
 a41:double a42:double a43:double a44:double a45:double a46:double a4z:double

.endfields
123412345678951234567896789012345678901234567890123
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1234567890123456789012
^^^^^^^^^^^^^^^^^^^^^^
 Циклы заголовка (верхняя линия)                     j000
 Циклы заголовка (наименования периодов)             j001-j003
 Циклы заголовка (нижняя линия)                      j009
 .{.?j000;.}
 .{.?j001;.}
 .{.?j002;.}
 .{.?j003;.}
 .{.?j009;.}
Конец заголовка
.{fKatOrg CHECKENTER
KatOrg
123456789012
*^^^^^^**^^^
 Циклы шапки контрагента (верхняя линия)             j300
 Циклы шапки контрагента (наименования периодов)     j301-j303
 Циклы шапки контрагента (нижняя линия)              j309
 .{.?j300;.}
 .{.?j301;.}
 .{.?j302;.}
 .{.?j303;.}
 .{.?j309;.}
Конец шапки Katorg
.{fBaseDoc CHECKENTER
BaseDoc
01234567890123456789012345678901234567890
^*^^^^^^********^^^^^****^**^^*^*^***^^^^^^
!конец шапки BaseDoc
.{fStepDoc CHECKENTER
StepDoc
12345678901234567890123
^^^*^^^^*****^^^^^^**^^
1
^
123456789abcz
^^^^^^^^^^^^^
123456z
^^^^^^^
123456z
^^^^^^^
123456z
^^^^^^^
1
^
123456789abcz
^^^^^^^^^^^^^
123456z
^^^^^^^
123456z
^^^^^^^
123456z
^^^^^^^
  Циклы договора (значения dpxx51x и dpxxd51x)        j510-j519
       1               2               3               4               5               6               7               8               9             10
          12345678901234567890
 Циклы шапки договора (верхняя линия)                j500
 Циклы шапки договора (наименования периодов)        j501-j513
 Циклы шапки договора (нижняя линия)                 j509
 Циклы договора (значения dpxx51x и dpdxxd51x)       j510-j511
 Циклы шапки договора (нижняя линия)                 j599
 .{.?j500;.}
 .{.?j501;.}
 .{.?j502;.}
 .{.?j503;.}
 .{.?j509;.}
 .{.?j510;.}
 .{.?j519;.}
 .{.?j511;.}
 .{.?j599;.}
Конец StepDoc
.}
Конец BaseDoc
.}
12
^^
123456789abcPZ
^^^^^^^^^^^^^^
123456z
^^^^^^^
123456z
^^^^^^^
123456z
^^^^^^^
 Циклы итого контрагента (верхняя линия)             j700
 Циклы итого контрагента (наименования периодов)     j701-j703
 Циклы итого контрагента (нижняя линия)              j709
 Циклы итого контрагента (значения kpxx71x)          j710-j711
 Циклы итого контрагента (нижняя линия)              j719
 Циклы итого контрагента (значения kpxx72x)          j720-j721
 Циклы итого контрагента (нижняя линия)              j799
 .{.?j700;.}
 .{.?j701;.}
 .{.?j702;.}
 .{.?j703;.}
 .{.?j709;.}

 .{.?j710;.}
 .{.?j711;.}
 .{.?j719;.}
 .{.?j720;.}
 .{.?j721;.}
 .{.?j799;.}
Конец итого по Katorg
.}
Начало итого по всем
12
^^
123456789abcPZ
^^^^^^^^^^^^^^
123456z
^^^^^^^
123456z
^^^^^^^
123456z
^^^^^^^
 Циклы итого все контрагенты (верхняя линия)         j900
 Циклы итого все контрагенты (наименования периодов) j901-j903
 Циклы итого все контрагенты (нижняя линия)          j909
 Циклы итого все контрагенты (значения apxx91x)      j910-j911
 Циклы итого все контрагенты (нижняя линия)          j919
 Циклы итого все контрагенты сальдированно(apxx92x)  j920-j922
 Циклы итого все контрагенты (нижняя линия)          j999
 .{.?j900;.}
 .{.?j901;.}
 .{.?j902;.}
 .{.?j903;.}
 .{.?j909;.}

 .{.?j910;.}
 .{.?j911;.}
 .{.?j919;.}
 .{.?j920;.}
 .{.?j921;.}
 .{.?j922;.}
 .{.?j999;.}

Конец итого по всем

.endform

!******************************************************************************************************************************************************************************************************************

#doc
Фактические задолженности по периодам (развернутый)
#end
.linkform 'DebList01' prototype is DebList
.group '1.Фактические задолженности (по реальным оборотам)'
.nameinlist '01.Фактические задолженности по периодам (развернутый)'
.var Ind:Longint
.endvar
.fields
  CommonFormHeader
 DateToStr(ДатаОтчета,'DD/MM/YYYY')
 ВВалютеОтчета
 DateToStr(НачДатаОтчета,'DD/MM/YYYY')
 DateToStr(КонДатаОтчета,'DD/MM/YYYY')
.endfields
 ^

 С           ОТЧЕТ ПО ИСПОЛНЯЕМЫМ ДОКУМЕНТАМ-ОСНОВАНИЯМ ПО КОНТРАГЕНТАМ В РАЗРЕЗЕ
            ДОКУМЕНТОВ-ОСНОВАНИЙ С РАЗБИВКОЙ ПО ВРЕМЕНИ ФАКТИЧЕСКОЙ ЗАДОЛЖЕННОСТИ С

.begin Ind:=IterInitNew(KolPers); end.
 Й  Сформирован на ^ в ^.
  Взяты документы-основания ( ДО )с ^ по ^. Й

 .{.?j000;;false;.}
 .{.?j001;;false;.}
 .{.?j002;;false;.}
 .{.?j003;;false;.}
 .{.?j009;;false;.}
 Ш Положительные задолженности соответствуют долгу контрагента,отрицательные - нашему долгу. Ш

.{fKatOrg CHECKENTER
.fields
 KatOrg_Name
 TblGfiString(TblPeriods,IterNext(Ind),fName1)
 TblGfiString(TblPeriods,IterNext(Ind),fName2)
.endfields

 Й Контрагент: ^ Й
 Ш──────────────┬──────────┬───────────┬──────────┬──────────┬──────────────┬.{.?j300;──────────────┬.}────────────────── Ш
 Ш     Тип ДО   │   Дата   │N документа│ Оплатить │ Отгрузить│ Сумма по ДО  │.{.?j301;@~@@@@@@@@@@@@│.} Итого фактическая Ш
 Ш              │    ДО    │с дескрипт.│    до    │    до    │              │.{.?j302;@~@@@@@@@@@@@@│.}   задолженность Ш
 Ш──────────────┼──────────┼───────────┼──────────┼──────────┼──────────────┼.{.?j303;──────────────┼.}────────────────── Ш
 .{.?j309;;false;.}
.{fBaseDoc CHECKENTER
.{fStepDoc CHECKENTER
.fields
 IF (BaseDoc_TipMoney=1,'Руб.',
   IF (BaseDoc_TipMoney=2,'В-р.',
   IF (BaseDoc_TipMoney=3,'Вал.','')))+
  IF (BaseDoc_VidDoc=101, 'сч.закупки',
   IF (BaseDoc_VidDoc=102,'прием.конс',
   IF (BaseDoc_VidDoc=201,'сч.продажи',
   IF (BaseDoc_VidDoc=202,'отп.консиг',''))))
 DateToStr(StepDoc_dStart,'DD/MM/YYYY')
 NдокДескрДО
 DateToStr(ОплатитьДо,'DD/MM/YYYY')
 DateToStr(ОтгрузитьДо,'DD/MM/YYYY')
 d01
 TblGfiDouble(TblPeriods,IterNext(Ind),fdp3z)
 d3z
.endfields
 .{.?j500;;false;.}
 .{.?j501;;false;.}
 .{.?j502;;false;.}
 .{.?j503;;false;.}
 .{.?j509;;false;.}
 Ш@@@@@@@@@@@@@@│@@@@@@@@@@│@@@@@@@@@@@│@@@@@@@@@@│@@@@@@@@@@│&&&&&&&&&&&.&&│.{.?j510;&&&&&&&&&&&.&&│.}&'&&&&&&&&&&&&&.&& Ш
 .{.?j519;;false;.}
 .{.?j511;;false;.}
 .{.?j599;;false;.}
.}
.}
.fields
 TblGfiDouble(TblPeriods,IterNext(Ind),fkp3z)
 KatOrg_Name
 TblGfiDouble(TblPeriods,IterNext(Ind),fkp3zs)
 k3z
.endfields
 Ш──────────────┴──────────┴───────────┴──────────┴──────────┴──────────────┼.{.?j700;──────────────┼.}────────────────── Ш
 .{.?j701;;false;.}
 .{.?j702;;false;.}
 .{.?j703;;false;.}
 .{.?j709;;false;.}
 Ш Итого по контрагенту                           По документам-основаниям: │.{.?j710;&&&&&&&&&&&.&&│.} Ш
 .{.?j711;;false;.}
 .{.?j719;;false;.}
 Ш @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Сальдировано: │.{.?j720;&&&&&&&&&&&.&&│.}&'&&&&&&&&&&&&&.&& Ш
 .{.?j721;;false;.}
 Ш──────────────────────────────────────────────────────────────────────────┴.{.?j799;──────────────┴.}────────────────── Ш
.}

.fields
 a01
 TblGfiString(TblPeriods,IterNext(Ind),fName1)
 a02
 TblGfiString(TblPeriods,IterNext(Ind),fName2)
 If(AllKontr=0,'выбранным контрагентам:','контрагентам:')
 TblGfiDouble(TblPeriods,IterNext(Ind),fap3z)
 TblGfiDouble(TblPeriods,IterNext(Ind),fap3zk)
 TblGfiDouble(TblPeriods,IterNext(Ind),fap3zs)
 a3z
.endfields

 Ш───────────────────────────────────────────────────────────┬──────────────┬.{.?j900;──────────────┬.}────────────────── Ш
 Ш                                      ДО продаж  на сумму: │&&&&&&&&&&&.&&│.{.?j901;@~@@@@@@@@@@@@│.} Итого фактическая Ш
 Ш                                      ДО закупок на сумму: │&&&&&&&&&&&.&&│.{.?j902;@~@@@@@@@@@@@@│.}   задолженность Ш
 .{.?j903;;false;.}
 Ш                                                           └──────────────┼.{.?j909;──────────────┼.}────────────────── Ш
 Ш Итого по всем @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                 По ДО:    │.{.?j910;&&&&&&&&&&&.&&│.} Ш
 .{.?j911;;false;.}
 .{.?j919;;false;.}
 Ш                                                         По контрагентам: │.{.?j920;&&&&&&&&&&&.&&│.} Ш
 Ш                                                         Сальдировано:    │.{.?j921;&&&&&&&&&&&.&&│.}&'&&&&&&&&&&&&&.&& Ш
 .{.?j922;;false;.}
 Ш──────────────────────────────────────────────────────────────────────────┴.{.?j999;──────────────┴.}────────────────── Ш
.begin IterDone(Ind); end.

*
.endform

!******************************************************************************************************************************************************************************************************************

#doc
Фактические задолженности по периодам (развернутый) c последующим движением
#end
.linkform 'DebList01P' prototype is DebList
.group '1+.Фактические задолженности (по реальным оборотам) с послед. движением'
.nameinlist '01+.Фактические задолженности по периодам (развернутый) c последующим движением'
.var Ind:LongInt
.endvar
.fields
  CommonFormHeader
 DateToStr(ДатаОтчета,'DD/MM/YYYY')
 ВВалютеОтчета
 DateToStr(НачДатаОтчета,'DD/MM/YYYY')
 DateToStr(КонДатаОтчета,'DD/MM/YYYY')
.endfields
 ^

 Ш  Й      ОТЧЕТ ПО ИСПОЛНЯЕМЫМ ДОКУМЕНТАМ-ОСНОВАНИЯМ ПО КОНТРАГЕНТАМ В РАЗРЕЗЕ
         ДОКУМЕНТОВ-ОСНОВАНИЙ С РАЗБИВКОЙ ПО ВРЕМЕНИ ФАКТИЧЕСКОЙ ЗАДОЛЖЕННОСТИ С

.begin Ind:=IterInitNew(KolPers); end.
 Й  Сформирован на ^ в ^.
  Взяты документы-основания ( ДО ) с ^ по ^. Й

 .{.?j000;;false;.}
 .{.?j001;;false;.}
 .{.?j002;;false;.}
 .{.?j003;;false;.}
 .{.?j009;;false;.}
 Р Положительные задолженности соответствуют долгу контрагента,отрицательные - нашему долгу.  Р

.{fKatOrg CHECKENTER
.fields
 KatOrg_Name
 TblGfiString(TblPeriods,IterNext(Ind),fName1)
 TblGfiString(TblPeriods,IterNext(Ind),fName2)
.endfields

 Й Контрагент: ^ Й
 Ш──────────────┬──────────┬───────────┬──────────┬──────────┬──────────────┬.{.?j300;──────────────┬.}──────────────────┬──────────────────
     Тип ДО   │   Дата   │N документа│ Оплатить │ Отгрузить│ Сумма по ДО  │.{.?j301;@~@@@@@@@@@@@@│.} Итого фактическая│  Движение после
              │    ДО    │с дескрипт.│    до    │    до    │              │.{.?j302;@~@@@@@@@@@@@@│.}   задолженность  │последнего периода
──────────────┼──────────┼───────────┼──────────┼──────────┼──────────────┼.{.?j303;──────────────┼.}──────────────────┼────────────────── Ш
 .{.?j309;;false;.}
.{fBaseDoc CHECKENTER
.{fStepDoc CHECKENTER
.fields
 IF (BaseDoc_TipMoney=1,'Руб.',
   IF (BaseDoc_TipMoney=2,'В-р.',
   IF (BaseDoc_TipMoney=3,'Вал.','')))+
  IF (BaseDoc_VidDoc=101, 'сч.закупки',
   IF (BaseDoc_VidDoc=102,'прием.конс',
   IF (BaseDoc_VidDoc=201,'сч.продажи',
   IF (BaseDoc_VidDoc=202,'отп.консиг',''))))
 DateToStr(StepDoc_dStart,'DD/MM/YYYY')
 NдокДескрДО
 DateToStr(ОплатитьДо,'DD/MM/YYYY')
 DateToStr(ОтгрузитьДо,'DD/MM/YYYY')
 d01
 TblGfiDouble(TblPeriods,IterNext(Ind),fdp3z)
 d3z
 d1z
.endfields
 .{.?j500;;false;.}
 .{.?j501;;false;.}
 .{.?j502;;false;.}
 .{.?j503;;false;.}
 .{.?j509;;false;.}
 Ш@@@@@@@@@@@@@@│@@@@@@@@@@│@@@@@@@@@@@│@@@@@@@@@@│@@@@@@@@@@│&&&&&&&&&&&.&&│.{.?j510;&&&&&&&&&&&.&&│.}&'&&&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&& Ш
 .{.?j519;;false;.}
 .{.?j511;;false;.}
 .{.?j599;;false;.}
.}
.}
.fields
 TblGfiDouble(TblPeriods,IterNext(Ind),fkp3z)
 KatOrg_Name
 TblGfiDouble(TblPeriods,IterNext(Ind),fkp3zs)
 k3z
 k1zP+k1zZ
.endfields
 Ш──────────────┴──────────┴───────────┴──────────┴──────────┴──────────────┼.{.?j700;──────────────┼.}──────────────────┼────────────────── Ш
 .{.?j701;;false;.}
 .{.?j702;;false;.}
 .{.?j703;;false;.}
 .{.?j709;;false;.}
 Ш Итого по контрагенту                                              По ДО: │.{.?j710;&&&&&&&&&&&.&&│.}                  │ Ш
 .{.?j711;;false;.}
 .{.?j719;;false;.}
 Ш @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Сальдировано: │.{.?j720;&&&&&&&&&&&.&&│.}&'&&&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&& Ш
 .{.?j721;;false;.}
 Ш──────────────────────────────────────────────────────────────────────────┴.{.?j799;──────────────┴.}──────────────────┴────────────────── Ш
.}

.fields
 a01
 TblGfiString(TblPeriods,IterNext(Ind),fName1)
 a02
 TblGfiString(TblPeriods,IterNext(Ind),fName2)
 If(AllKontr=0,'выбранным контрагентам:','контрагентам:')
 TblGfiDouble(TblPeriods,IterNext(Ind),fap3z)
 TblGfiDouble(TblPeriods,IterNext(Ind),fap3zk)
 TblGfiDouble(TblPeriods,IterNext(Ind),fap3zs)
 a3z
 a1zP+a1zZ
.endfields

 Ш───────────────────────────────────────────────────────────┬──────────────┬.{.?j900;──────────────┬.}──────────────────┬──────────────────
                                      ДО продаж  на сумму: │&&&&&&&&&&&.&&│.{.?j901;@~@@@@@@@@@@@@│.} Итого фактическая│  Движение после
                                      ДО закупок на сумму: │&&&&&&&&&&&.&&│.{.?j902;@~@@@@@@@@@@@@│.}   задолженность  │последнего периода Ш
 .{.?j903;;false;.}
 Ш                                                           └──────────────┼.{.?j909;──────────────┼.}──────────────────┼──────────────────
 Итого по всем @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                 По ДО:    │.{.?j910;&&&&&&&&&&&.&&│.}                  │ Ш
 .{.?j911;;false;.}
 .{.?j919;;false;.}
 Ш                                                         По контрагентам: │.{.?j920;&&&&&&&&&&&.&&│.}                  │
                                                         Сальдировано:    │.{.?j921;&&&&&&&&&&&.&&│.}&'&&&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&& Ш
 .{.?j922;;false;.}
 Ш──────────────────────────────────────────────────────────────────────────┴.{.?j999;──────────────┴.}──────────────────┴────────────────── Ш

.begin IterDone(Ind); end.

*
.endform

! Ш****************************************************************************************************************************************************************************************************************** Ш

#doc
Фактические задолженности по периодам (свернутый)
#end
.linkform 'DebList01a' prototype is DebList
.group '1.Фактические задолженности (по реальным оборотам)'
.nameinlist '01a.Фактические задолженности по периодам (свернутый)'
.var Ind:LongInt
.endvar
.fields
  CommonFormHeader
 DateToStr(ДатаОтчета,'DD/MM/YYYY')
 ВВалютеОтчета
 DateToStr(НачДатаОтчета,'DD/MM/YYYY')
 DateToStr(КонДатаОтчета,'DD/MM/YYYY')
 TblGfiString(TblPeriods,IterNext(Ind),fName1)
 TblGfiString(TblPeriods,IterNext(Ind),fName2)
.endfields
 ^

 С ОТЧЕТ ПО ИСПОЛНЯЕМЫМ ДОКУМЕНТАМ-ОСНОВАНИЯМ ПО КОНТРАГЕНТАМ
 С РАЗБИВКОЙ ПО ВРЕМЕНИ ФАКТИЧЕСКОЙ ЗАДОЛЖЕННОСТИ С

.begin Ind:=IterInitNew(KolPers); end.
 Й  Сформирован на ^ в ^.
  Взяты документы-основания ( ДО ) с ^ по ^. Й

 Р Положительные задолженности соответствуют долгу контрагента, отрицательные - нашему долгу. Р

 Р────────────────────────────────────────┬.{.?j000;──────────────┬.}──────────────────
 Наименование контрагента               │.{.?j001;@~@@@@@@@@@@@@│.} Итого фактическая
                                        │.{.?j002;@~@@@@@@@@@@@@│.}   задолженность
 .{.?j003;;false;.}
────────────────────────────────────────┼.{.?j009;──────────────┼.}────────────────── Р
.{CHECKENTER fKatOrg
 .{.?j300;;false;.}
 .{.?j301;;false;.}
 .{.?j302;;false;.}
 .{.?j303;;false;.}
 .{.?j309;;false;.}
.{CHECKENTER fBaseDoc
.{CHECKENTER fStepDoc
 .{.?j500;;false;.}
 .{.?j501;;false;.}
 .{.?j502;;false;.}
 .{.?j503;;false;.}
 .{.?j509;;false;.}
 .{.?j510;;false;.}
 .{.?j519;;false;.}
 .{.?j511;;false;.}
 .{.?j599;;false;.}
.}
.}
.fields
 KatOrg_Name
 TblGfiDouble(TblPeriods,IterNext(Ind),fkp3z)
 TblGfiDouble(TblPeriods,IterNext(Ind),fkp3zs)
 k3z
.endfields
 .{.?j700;;false;.}
 .{.?j701;;false;.}
 .{.?j702;;false;.}
 .{.?j703;;false;.}
 .{.?j709;;false;.}
 Р@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│.{.?j710;&&&&&&&&&&&.&&│.}
                          Сальдировано: │.{.?j711;&&&&&&&&&&&.&&│.}&'&&&&&&&&&&&&&.&&
────────────────────────────────────────┼.{.?j719;──────────────┼.}────────────────── Р
 .{.?j720;;false;.}
 .{.?j721;;false;.}
 .{.?j799;;false;.}
.}
.fields
 TblGfiDouble(TblPeriods,IterNext(Ind),fap3z)
 TblGfiDouble(TblPeriods,IterNext(Ind),fap3zk)
 If(AllKontr=0,'выбранным контрагентам','контрагентам')
 TblGfiDouble(TblPeriods,IterNext(Ind),fap3zs)
 a3z
.endfields
 Р────────────────────────────────────────┼.{.?j900;──────────────┼.}────────────────── Р
 .{.?j901;;false;.}
 .{.?j902;;false;.}
 .{.?j903;;false;.}
 .{.?j909;;false;.}
 Р                                 По ДО: │.{.?j910;&&&&&&&&&&&.&&│.} Р
 .{.?j911;;false;.}
 .{.?j919;;false;.}
 РИтого по всем          По контрагентам: │.{.?j920;&&&&&&&&&&&.&&│.}
@@@@@@@@@@@@@@@@@@@@@@@   Сальдировано: │.{.?j921;&&&&&&&&&&&.&&│.}&'&&&&&&&&&&&&&.&& Р
 .{.?j922;;false;.}
 Р────────────────────────────────────────┴.{.?j999;──────────────┴.}────────────────── Р

.begin IterDone(Ind); end.

*
.endform

! Ш****************************************************************************************************************************************************************************************************************** Ш

#doc
Фактические задолженности по периодам (свернутый) c последующим движением
#end
.linkform 'DebList01Pa' prototype is DebList
.group '1+.Фактические задолженности (по реальным оборотам) с послед. движением'
.nameinlist '01+a.Фактические задолженности по периодам (свернутый) c последующим движением'
.var Ind:LongInt
.endvar
.fields
  CommonFormHeader
 DateToStr(ДатаОтчета,'DD/MM/YYYY')
 ВВалютеОтчета
 DateToStr(НачДатаОтчета,'DD/MM/YYYY')
 DateToStr(КонДатаОтчета,'DD/MM/YYYY')
 TblGfiString(TblPeriods,IterNext(Ind),fName1)
 TblGfiString(TblPeriods,IterNext(Ind),fName2)
.endfields
 ^

 С  ОТЧЕТ ПО ИСПОЛНЯЕМЫМ ДОКУМЕНТАМ-ОСНОВАНИЯМ ПО КОНТРАГЕНТАМ
  С РАЗБИВКОЙ ПО ВРЕМЕНИ ФАКТИЧЕСКОЙ ЗАДОЛЖЕННОСТИ С

.begin Ind:=IterInitNew(KolPers); end.
 Й  Сформирован на ^ в ^.
  Взяты документы-основания ( ДО ) с ^ по ^. Й

 Р Положительные задолженности соответствуют долгу контрагента,отрицательные - нашему долгу. Р

 Р────────────────────────────────────────┬.{.?j000;──────────────┬.}──────────────────┬──────────────────
 Наименование контрагента               │.{.?j001;@~@@@@@@@@@@@@│.} Итого фактическая│  Движение после
                                        │.{.?j002;@~@@@@@@@@@@@@│.}   задолженность  │последнего периода
 .{.?j003;;false;.}
────────────────────────────────────────┼.{.?j009;──────────────┼.}──────────────────┼────────────────── Р
.{CHECKENTER fKatOrg
 .{.?j300;;false;.}
 .{.?j301;;false;.}
 .{.?j302;;false;.}
 .{.?j303;;false;.}
 .{.?j309;;false;.}
.{CHECKENTER fBaseDoc
.{CHECKENTER fStepDoc
 .{.?j500;;false;.}
 .{.?j501;;false;.}
 .{.?j502;;false;.}
 .{.?j503;;false;.}
 .{.?j509;;false;.}
 .{.?j510;;false;.}
 .{.?j519;;false;.}
 .{.?j511;;false;.}
 .{.?j599;;false;.}
.}
.}
.fields
 KatOrg_Name
 TblGfiDouble(TblPeriods,IterNext(Ind),fkp3z)
 TblGfiDouble(TblPeriods,IterNext(Ind),fkp3zs)
 k3z
 k1zP+k1zZ
.endfields
 .{.?j700;;false;.}
 .{.?j701;;false;.}
 .{.?j702;;false;.}
 .{.?j703;;false;.}
 .{.?j709;;false;.}
 Р@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│.{.?j710;&&&&&&&&&&&.&&│.}                  │
                          Сальдировано: │.{.?j711;&&&&&&&&&&&.&&│.}&'&&&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&&
────────────────────────────────────────┼.{.?j719;──────────────┼.}──────────────────┼────────────────── Р
 .{.?j720;;false;.}
 .{.?j721;;false;.}
 .{.?j799;;false;.}
.}
.fields
 TblGfiDouble(TblPeriods,IterNext(Ind),fap3z)
 TblGfiDouble(TblPeriods,IterNext(Ind),fap3zk)
 If(AllKontr=0,'выбранным контрагентам','контрагентам')
 TblGfiDouble(TblPeriods,IterNext(Ind),fap3zs)
 a3z
 a1zP+a1zZ
.endfields
 Р────────────────────────────────────────┼.{.?j900;──────────────┼.}──────────────────┼────────────────── Р
 .{.?j901;;false;.}
 .{.?j902;;false;.}
 .{.?j903;;false;.}
 .{.?j909;;false;.}
 Р                                 По ДО: │.{.?j910;&&&&&&&&&&&.&&│.}                  │ Р
 .{.?j911;;false;.}
 .{.?j919;;false;.}
 РИтого по всем          По контрагентам: │.{.?j920;&&&&&&&&&&&.&&│.}                  │
@@@@@@@@@@@@@@@@@@@@@@@   Сальдировано: │.{.?j921;&&&&&&&&&&&.&&│.}&'&&&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&&
 .{.?j922;;false;.}
────────────────────────────────────────┴.{.?j999;──────────────┴.}──────────────────┴────────────────── Р

.begin IterDone(Ind); end.

*
.endform

! Ш****************************************************************************************************************************************************************************************************************** Ш

#doc
Просроченные фактические задолженности по периодам (развернутый)
#end
.linkform 'DebList02' prototype is DebList
.group '1.Фактические задолженности (по реальным оборотам)'
.nameinlist '02.Просроченные фактические задолженности по периодам (развернутый)'
.var Ind:LongInt
.endvar
.fields
  CommonFormHeader
 DateToStr(ДатаОтчета,'DD/MM/YYYY')
 ВВалютеОтчета
 DateToStr(НачДатаОтчета,'DD/MM/YYYY')
 DateToStr(КонДатаОтчета,'DD/MM/YYYY')
.endfields
 ^

 Б       ОТЧЕТ ПО ИСПОЛНЯЕМЫМ ДОКУМЕНТАМ-ОСНОВАНИЯМ ПО КОНТРАГЕНТАМ В РАЗРЕЗЕ
ДОКУМЕНТОВ-ОСНОВАНИЙ С РАЗБИВКОЙ ПО ВРЕМЕНИ ПРОСРОЧЕННОЙ ФАКТИЧЕСКОЙ ЗАДОЛЖЕННОСТИ Б

.begin Ind:=IterInitNew(KolPers); end.
 Й  Сформирован на ^ в ^.
  Взяты документам-основаниям ( ДО ) с ^ по ^. Й
 .{.?j000;;false;.}
 .{.?j001;;false;.}
 .{.?j002;;false;.}
 .{.?j003;;false;.}
 .{.?j009;;false;.}
 Р Положительные задолженности соответствуют долгу контрагента, отрицательные - нашему долгу. Р

.{fKatOrg CHECKENTER
.fields
 KatOrg_Name
 TblGfiString(TblPeriods,IterNext(Ind),fName1)
 TblGfiString(TblPeriods,IterNext(Ind),fName2)
.endfields

 Й Контрагент: ^ Й
 Ш──────────────┬──────────┬───────────┬──────────┬──────────┬──────────────┬.{.?j300;──────────────┬.}──────────────────
     Тип ДО   │ Дата ДО  │N документа│ Оплатить │ Отгрузить│ Сумма по ДО  │.{.?j301;@~@@@@@@@@@@@@│.}Итого просроченная
              │          │с дескрипт.│    до    │    до    │              │.{.?j302;@~@@@@@@@@@@@@│.}задолженность
──────────────┼──────────┼───────────┼──────────┼──────────┼──────────────┼.{.?j303;──────────────┼.}────────────────── Ш
 .{.?j309;;false;.}
.{fBaseDoc CHECKENTER
.{fStepDoc CHECKENTER
.fields
 IF (BaseDoc_TipMoney=1,'Руб.',
   IF (BaseDoc_TipMoney=2,'В-р.',
   IF (BaseDoc_TipMoney=3,'Вал.','')))+
  IF (BaseDoc_VidDoc=101, 'сч.закупки',
   IF (BaseDoc_VidDoc=102,'прием.конс',
   IF (BaseDoc_VidDoc=201,'сч.продажи',
   IF (BaseDoc_VidDoc=202,'отп.консиг',''))))
 DateToStr(StepDoc_dStart,'DD/MM/YYYY')
 NдокДескрДО
 DateToStr(ОплатитьДо,'DD/MM/YYYY')
 DateToStr(ОтгрузитьДо,'DD/MM/YYYY')
 d01
 TblGfiDouble(TblPeriods,IterNext(Ind),fdp4z)
 d4z
.endfields
 .{.?j500;;false;.}
 .{.?j501;;false;.}
 .{.?j502;;false;.}
 .{.?j503;;false;.}
 .{.?j509;;false;.}
 Ш@@@@@@@@@@@@@@│@@@@@@@@@@│@@@@@@@@@@@│@@@@@@@@@@│@@@@@@@@@@│&&&&&&&&&&&.&&│.{.?j510;&&&&&&&&&&&.&&│.}&'&&&&&&&&&&&&&.&& Ш
 .{.?j519;;false;.}
 .{.?j511;;false;.}
 .{.?j599;;false;.}
.}
.}
.fields
 TblGfiDouble(TblPeriods,IterNext(Ind),fkp4z)
 KatOrg_Name
 TblGfiDouble(TblPeriods,IterNext(Ind),fkp4zs)
 k4z
.endfields
 Ш──────────────┴──────────┴───────────┴──────────┴──────────┴──────────────┼.{.?j700;──────────────┼.}────────────────── Ш
 .{.?j701;;false;.}
 .{.?j702;;false;.}
 .{.?j703;;false;.}
 .{.?j709;;false;.}
 Ш Итого по контрагенту                                              По ДО: │.{.?j710;&&&&&&&&&&&.&&│.} Ш
 .{.?j711;;false;.}
 .{.?j719;;false;.}
 Ш @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Сальдировано: │.{.?j720;&&&&&&&&&&&.&&│.}&'&&&&&&&&&&&&&.&& Ш
 .{.?j721;;false;.}
 Ш──────────────────────────────────────────────────────────────────────────┴.{.?j799;──────────────┴.}────────────────── Ш
.}

.fields
 a01
 TblGfiString(TblPeriods,IterNext(Ind),fName1)
 a02
 TblGfiString(TblPeriods,IterNext(Ind),fName2)
 If(AllKontr=0,'выбранным контрагентам:','контрагентам:')
 TblGfiDouble(TblPeriods,IterNext(Ind),fap4z)
 TblGfiDouble(TblPeriods,IterNext(Ind),fap4zk)
 TblGfiDouble(TblPeriods,IterNext(Ind),fap4zs)
 a4z
.endfields

 Ш───────────────────────────────────────────────────────────┬──────────────┬.{.?j900;──────────────┬.}──────────────────
                                      ДО продаж  на сумму: │&&&&&&&&&&&.&&│.{.?j901;@~@@@@@@@@@@@@│.}Итого просроченная
                                      ДО закупок на сумму: │&&&&&&&&&&&.&&│.{.?j902;@~@@@@@@@@@@@@│.}   задолженность Ш
 .{.?j903;;false;.}
 Ш                                                           └──────────────┼.{.?j909;──────────────┼.}────────────────── Ш
 Ш Итого по всем @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                 По ДО:    │.{.?j910;&&&&&&&&&&&.&&│.} Ш
 .{.?j911;;false;.}
 .{.?j919;;false;.}
 Ш                                                         По контрагентам: │.{.?j920;&&&&&&&&&&&.&&│.}
                                                         Сальдировано:    │.{.?j921;&&&&&&&&&&&.&&│.}&'&&&&&&&&&&&&&.&& Ш
 .{.?j922;;false;.}
 Ш──────────────────────────────────────────────────────────────────────────┴.{.?j999;──────────────┴.}────────────────── Ш

.begin IterDone(Ind); end.

*
.endform

! Ш****************************************************************************************************************************************************************************************************************** Ш

#doc
Просроченные факт. задолженности по периодам (разв.) с посл.движением
#end
.linkform 'DebList02P' prototype is DebList
.group '1+.Фактические задолженности (по реальным оборотам) с послед. движением'
.nameinlist '02+.Просроченные факт. задолженности по периодам (разв.) с посл.движением'
.var Ind:LongInt
.endvar
.fields
  CommonFormHeader
 DateToStr(ДатаОтчета,'DD/MM/YYYY')
 ВВалютеОтчета
 DateToStr(НачДатаОтчета,'DD/MM/YYYY')
 DateToStr(КонДатаОтчета,'DD/MM/YYYY')
.endfields
 ^

 Б           ОТЧЕТ ПО ИСПОЛНЯЕМЫМ ДОКУМЕНТАМ-ОСНОВАНИЯМ ПО КОНТРАГЕНТАМ В РАЗРЕЗЕ
   ДОКУМЕНТОВ-ОСНОВАНИЙ С РАЗБИВКОЙ ПО ВРЕМЕНИ ПРОСРОЧЕННОЙ ФАКТИЧЕСКОЙ ЗАДОЛЖЕННОСТИ Б

.begin Ind:=IterInitNew(KolPers); end.
 Б  Сформирован на ^ в ^.
  Взяты документы-основания ( ДО ) с ^ по ^. Б
 .{.?j000;;false;.}
 .{.?j001;;false;.}
 .{.?j002;;false;.}
 .{.?j003;;false;.}
 .{.?j009;;false;.}
 Р Положительные задолженности соответствуют долгу контрагента, отрицательные - нашему долгу. Р

.{fKatOrg CHECKENTER
.fields
 KatOrg_Name
 TblGfiString(TblPeriods,IterNext(Ind),fName1)
 TblGfiString(TblPeriods,IterNext(Ind),fName2)
.endfields

 Б Контрагент: ^ Б
 Ш──────────────┬──────────┬───────────┬──────────┬──────────┬──────────────┬.{.?j300;──────────────┬.}──────────────────┬──────────────────
    Тип ДО    │ Дата ДО  │N документа│ Оплатить │ Отгрузить│ Сумма по ДО  │.{.?j301;@~@@@@@@@@@@@@│.}Итого просроченная│  Движение после
              │          │с дескрипт.│    до    │    до    │              │.{.?j302;@~@@@@@@@@@@@@│.}задолженность     │последнего периода
──────────────┼──────────┼───────────┼──────────┼──────────┼──────────────┼.{.?j303;──────────────┼.}──────────────────┼────────────────── Ш
 .{.?j309;;false;.}
.{fBaseDoc CHECKENTER
.{fStepDoc CHECKENTER
.fields
 IF (BaseDoc_TipMoney=1,'Руб.',
   IF (BaseDoc_TipMoney=2,'В-р.',
   IF (BaseDoc_TipMoney=3,'Вал.','')))+
  IF (BaseDoc_VidDoc=101, 'сч.закупки',
   IF (BaseDoc_VidDoc=102,'прием.конс',
   IF (BaseDoc_VidDoc=201,'сч.продажи',
   IF (BaseDoc_VidDoc=202,'отп.консиг',''))))
 DateToStr(StepDoc_dStart,'DD/MM/YYYY')
 NдокДескрДО
 DateToStr(ОплатитьДо,'DD/MM/YYYY')
 DateToStr(ОтгрузитьДо,'DD/MM/YYYY')
 d01
 TblGfiDouble(TblPeriods,IterNext(Ind),fdp4z)
 d4z
 d1z
.endfields
 .{.?j500;;false;.}
 .{.?j501;;false;.}
 .{.?j502;;false;.}
 .{.?j503;;false;.}
 .{.?j509;;false;.}
 Ш@@@@@@@@@@@@@@│@@@@@@@@@@│@@@@@@@@@@@│@@@@@@@@@@│@@@@@@@@@@│&&&&&&&&&&&.&&│.{.?j510;&&&&&&&&&&&.&&│.}&'&&&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&& Ш
 .{.?j519;;false;.}
 .{.?j511;;false;.}
 .{.?j599;;false;.}
.}
.}
.fields
 TblGfiDouble(TblPeriods,IterNext(Ind),fkp4z)
 KatOrg_Name
 TblGfiDouble(TblPeriods,IterNext(Ind),fkp4zs)
 k4z
 k1zP+k1zZ
.endfields
 Ш──────────────┴──────────┴───────────┴──────────┴──────────┴──────────────┼.{.?j700;──────────────┼.}──────────────────┼────────────────── Ш
 .{.?j701;;false;.}
 .{.?j702;;false;.}
 .{.?j703;;false;.}
 .{.?j709;;false;.}
 Ш Итого по контрагенту                                              По ДО: │.{.?j710;&&&&&&&&&&&.&&│.}                  │ Ш
 .{.?j711;;false;.}
 .{.?j719;;false;.}
 Ш @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Сальдировано: │.{.?j720;&&&&&&&&&&&.&&│.}&'&&&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&& Ш
 .{.?j721;;false;.}
 Ш──────────────────────────────────────────────────────────────────────────┴.{.?j799;──────────────┴.}──────────────────┴────────────────── Ш
.}

.fields
 a01
 TblGfiString(TblPeriods,IterNext(Ind),fName1)
 a02
 TblGfiString(TblPeriods,IterNext(Ind),fName2)
 If(AllKontr=0,'выбранным контрагентам:','контрагентам:')
 TblGfiDouble(TblPeriods,IterNext(Ind),fap4z)
 TblGfiDouble(TblPeriods,IterNext(Ind),fap4zk)
 TblGfiDouble(TblPeriods,IterNext(Ind),fap4zs)
 a4z
 a1zP+a1zZ
.endfields

 Ш───────────────────────────────────────────────────────────┬──────────────┬.{.?j900;──────────────┬.}──────────────────┬──────────────────
                                      ДО продаж  на сумму: │&&&&&&&&&&&.&&│.{.?j901;@~@@@@@@@@@@@@│.}Итого просроченная│  Движение после
                                      ДО закупок на сумму: │&&&&&&&&&&&.&&│.{.?j902;@~@@@@@@@@@@@@│.}   задолженность  │последнего периода Ш
 .{.?j903;;false;.}
 Ш                                                           └──────────────┼.{.?j909;──────────────┼.}──────────────────┼──────────────────
 Итого по всем @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                   По ДО:  │.{.?j910;&&&&&&&&&&&.&&│.} Ш
 .{.?j911;;false;.}
 .{.?j919;;false;.}
 Ш                                                         По контрагентам: │.{.?j920;&&&&&&&&&&&.&&│.}                  │
                                                         Сальдировано:    │.{.?j921;&&&&&&&&&&&.&&│.}&'&&&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&& Ш
 .{.?j922;;false;.}
 Ш──────────────────────────────────────────────────────────────────────────┴.{.?j999;──────────────┴.}──────────────────┴────────────────── Ш

.begin IterDone(Ind); end.

*
.endform

! Ш****************************************************************************************************************************************************************************************************************** Ш

#doc
Просроченные фактические задолженности по периодам (свернутый)
#end
.linkform 'DebList02a' prototype is DebList
.group '1.Фактические задолженности (по реальным оборотам)'
.nameinlist '02a.Просроченные фактические задолженности по периодам (свернутый)'
.var Ind:LongInt
.endvar
.fields
  CommonFormHeader
 DateToStr(ДатаОтчета,'DD/MM/YYYY')
 ВВалютеОтчета
 DateToStr(НачДатаОтчета,'DD/MM/YYYY')
 DateToStr(КонДатаОтчета,'DD/MM/YYYY')
 TblGfiString(TblPeriods,IterNext(Ind),fName1)
 TblGfiString(TblPeriods,IterNext(Ind),fName2)
.endfields
 ^

 Й                 ОТЧЕТ ПО ИСПОЛНЯЕМЫМ ДОКУМЕНТАМ-ОСНОВАНИЯМ ПО КОНТРАГЕНТАМ
                 С РАЗБИВКОЙ ПО ВРЕМЕНИ ПРОСРОЧЕННОЙ ФАКТИЧЕСКОЙ ЗАДОЛЖЕННОСТИ Й

.begin Ind:=IterInitNew(KolPers); end.
 Й  Сформирован на ^ в ^.
  Взяты документы-основания ( ДО ) с ^ по ^. Й

 Р Положительные задолженности соответствуют долгу контрагента, отрицательные - нашему долгу. Р

 Р────────────────────────────────────────┬.{.?j000;──────────────┬.}──────────────────
 Наименование контрагента               │.{.?j001;@~@@@@@@@@@@@@│.}Итого просроченная
                                        │.{.?j002;@~@@@@@@@@@@@@│.}   задолженность
 .{.?j003;;false;.}
────────────────────────────────────────┼.{.?j009;──────────────┼.}────────────────── Р
.{CHECKENTER fKatOrg
 .{.?j300;;false;.}
 .{.?j301;;false;.}
 .{.?j302;;false;.}
 .{.?j303;;false;.}
 .{.?j309;;false;.}
.{CHECKENTER fBaseDoc
.{CHECKENTER fStepDoc
 .{.?j500;;false;.}
 .{.?j501;;false;.}
 .{.?j502;;false;.}
 .{.?j503;;false;.}
 .{.?j509;;false;.}
 .{.?j510;;false;.}
 .{.?j519;;false;.}
 .{.?j511;;false;.}
 .{.?j599;;false;.}
.}
.}
.fields
 KatOrg_Name
 TblGfiDouble(TblPeriods,IterNext(Ind),fkp4z)
 TblGfiDouble(TblPeriods,IterNext(Ind),fkp4zs)
 k4z
.endfields
 .{.?j700;;false;.}
 .{.?j701;;false;.}
 .{.?j702;;false;.}
 .{.?j703;;false;.}
 .{.?j709;;false;.}
 Р@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│.{.?j710;&&&&&&&&&&&.&&│.}
                          Сальдировано: │.{.?j711;&&&&&&&&&&&.&&│.}&'&&&&&&&&&&&&&.&&
────────────────────────────────────────┼.{.?j719;──────────────┼.}────────────────── Р
 .{.?j720;;false;.}
 .{.?j721;;false;.}
 .{.?j799;;false;.}
.}
.fields
 TblGfiDouble(TblPeriods,IterNext(Ind),fap4z)
 TblGfiDouble(TblPeriods,IterNext(Ind),fap4zk)
 If(AllKontr=0,'выбранным контрагентам','контрагентам')
 TblGfiDouble(TblPeriods,IterNext(Ind),fap4zs)
 a4z
.endfields
 Р────────────────────────────────────────┼.{.?j900;──────────────┼.}────────────────── Р
 .{.?j901;;false;.}
 .{.?j902;;false;.}
 .{.?j903;;false;.}
 .{.?j909;;false;.}
 Р                                 По ДО: │.{.?j910;&&&&&&&&&&&.&&│.} Р
 .{.?j911;;false;.}
 .{.?j919;;false;.}
 РИтого по всем          По контрагентам: │.{.?j920;&&&&&&&&&&&.&&│.}
@@@@@@@@@@@@@@@@@@@@@@@   Сальдировано: │.{.?j921;&&&&&&&&&&&.&&│.}&'&&&&&&&&&&&&&.&& Р
 .{.?j922;;false;.}
 Р────────────────────────────────────────┴.{.?j999;──────────────┴.}────────────────── Р

.begin IterDone(Ind); end.

*
.endform

!******************************************************************************************************************************************************************************************************************

#doc
Просроченные факт. задолженности по периодам (свер.) с послед. движением
#end
.linkform 'DebList02Pa' prototype is DebList
.group '1+.Фактические задолженности (по реальным оборотам) с послед. движением'
.nameinlist '02+a.Просроченные факт. задолженности по периодам (свер.) с послед. движением'
.var Ind:LongInt
.endvar
.fields
  CommonFormHeader
 DateToStr(ДатаОтчета,'DD/MM/YYYY')
 ВВалютеОтчета
 DateToStr(НачДатаОтчета,'DD/MM/YYYY')
 DateToStr(КонДатаОтчета,'DD/MM/YYYY')
 TblGfiString(TblPeriods,IterNext(Ind),fName1)
 TblGfiString(TblPeriods,IterNext(Ind),fName2)
.endfields
 ^
 Б
 И                 ОТЧЕТ ПО ИСПОЛНЯЕМЫМ ДОКУМЕНТАМ-ОСНОВАНИЯМ ПО КОНТРАГЕНТАМ
                 С РАЗБИВКОЙ ПО ВРЕМЕНИ ПРОСРОЧЕННОЙ ФАКТИЧЕСКОЙ ЗАДОЛЖЕННОСТИ Й

.begin Ind:=IterInitNew(KolPers); end.
 Й  Сформирован на ^ в ^.
  Взяты документы-основания ( ДО ) с ^ по ^. Й

 Р Положительные задолженности соответствуют долгу контрагента, отрицательные - нашему долгу. Р

 Р────────────────────────────────────────┬.{.?j000;──────────────┬.}──────────────────┬──────────────────
 Наименование контрагента               │.{.?j001;@~@@@@@@@@@@@@│.}Итого просроченная│  Движение после
                                        │.{.?j002;@~@@@@@@@@@@@@│.}   задолженность  │последнего периода
 .{.?j003;;false;.}
────────────────────────────────────────┼.{.?j009;──────────────┼.}──────────────────┼────────────────── Р
.{CHECKENTER fKatOrg
 .{.?j300;;false;.}
 .{.?j301;;false;.}
 .{.?j302;;false;.}
 .{.?j303;;false;.}
 .{.?j309;;false;.}
.{CHECKENTER fBaseDoc
.{CHECKENTER fStepDoc
 .{.?j500;;false;.}
 .{.?j501;;false;.}
 .{.?j502;;false;.}
 .{.?j503;;false;.}
 .{.?j509;;false;.}
 .{.?j510;;false;.}
 .{.?j519;;false;.}
 .{.?j511;;false;.}
 .{.?j599;;false;.}
.}
.}
.fields
 KatOrg_Name
 TblGfiDouble(TblPeriods,IterNext(Ind),fkp4z)
 TblGfiDouble(TblPeriods,IterNext(Ind),fkp4zs)
 k4z
 k1zP+k1zZ
.endfields
 .{.?j700;;false;.}
 .{.?j701;;false;.}
 .{.?j702;;false;.}
 .{.?j703;;false;.}
 .{.?j709;;false;.}
 Р@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│.{.?j710;&&&&&&&&&&&.&&│.}                  │
                          Сальдировано: │.{.?j711;&&&&&&&&&&&.&&│.}&'&&&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&&
────────────────────────────────────────┼.{.?j719;──────────────┼.}──────────────────┼────────────────── Р
 .{.?j720;;false;.}
 .{.?j721;;false;.}
 .{.?j799;;false;.}
.}
.fields
 TblGfiDouble(TblPeriods,IterNext(Ind),fap4z)
 TblGfiDouble(TblPeriods,IterNext(Ind),fap4zk)
 If(AllKontr=0,'выбранным контрагентам','контрагентам')
 TblGfiDouble(TblPeriods,IterNext(Ind),fap4zs)
 a4z
 a1zP+a1zZ
.endfields
 Р────────────────────────────────────────┼.{.?j900;──────────────┼.}──────────────────┼────────────────── Р
 .{.?j901;;false;.}
 .{.?j902;;false;.}
 .{.?j903;;false;.}
 .{.?j909;;false;.}
 Р                                 По ДО: │.{.?j910;&&&&&&&&&&&.&&│.}                  │ Р
 .{.?j911;;false;.}
 .{.?j919;;false;.}
 РИтого по всем          По контрагентам: │.{.?j920;&&&&&&&&&&&.&&│.}                  │
@@@@@@@@@@@@@@@@@@@@@@@   Сальдировано: │.{.?j921;&&&&&&&&&&&.&&│.}&'&&&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&& Р
 .{.?j922;;false;.}
 Р────────────────────────────────────────┴.{.?j999;──────────────┴.}──────────────────┴────────────────── Р

.begin IterDone(Ind); end.

*
.endform

!******************************************************************************************************************************************************************************************************************

#doc
Задолженности по оплате по периодам (развернутый)
#end
.linkform 'DebList03' prototype is DebList
.group '2.Задолженности по оплате (относительно документа основания)'
.nameinlist '03.Задолженности по оплате по периодам (развернутый)'
.var Ind:LongInt
.endvar
.fields
  CommonFormHeader
 DateToStr(ДатаОтчета,'DD/MM/YYYY')
 ВВалютеОтчета
 If(Prod=1, If(Zakup=1,'закупки и продажи','продажи'), If(Zakup=1,'закупки',''))
 DateToStr(НачДатаОтчета,'DD/MM/YYYY')
 DateToStr(КонДатаОтчета,'DD/MM/YYYY')
.endfields
 ^

 Й           ОТЧЕТ ПО ИСПОЛНЯЕМЫМ ДОКУМЕНТАМ-ОСНОВАНИЯМ ПО КОНТРАГЕНТАМ В РАЗРЕЗЕ
           ДОКУМЕНТОВ-ОСНОВАНИЙ С РАЗБИВКОЙ ПО ВРЕМЕНИ ЗАДОЛЖЕННОСТИ ПО ОПЛАТЕ Й

.begin Ind:=IterInitNew(KolPers); end.
 Й  Сформирован на ^ в ^.
  Взяты документы-основания ( ДО ) ^ с ^ по ^. Й

 .{.?j000;;false;.}
 .{.?j001;;false;.}
 .{.?j002;;false;.}
 .{.?j003;;false;.}
 .{.?j009;;false;.}
 И Положительные задолженности соответствуют долгу контрагента,
 отрицательные - нашему долгу. И

.{fKatOrg CHECKENTER
.fields
 KatOrg_Name
 TblGfiString(TblPeriods,IterNext(Ind),fName1)
 TblGfiString(TblPeriods,IterNext(Ind),fName2)
.endfields

 Б Контрагент: ^ Б
 Ш──────────────┬──────────┬───────────┬──────────┬──────────┬──────────────┬.{.?j300;──────────────┬.}───────────────────
    Тип ДО    │ Дата ДО  │N документа│ Оплатить │ Отгрузить│ Сумма по ДО  │.{.?j301;@~@@@@@@@@@@@@│.}Итого задолженность
              │          │с дескрипт.│    до    │    до    │              │.{.?j302;@~@@@@@@@@@@@@│.}     по оплате
──────────────┼──────────┼───────────┼──────────┼──────────┼──────────────┼.{.?j303;──────────────┼.}─────────────────── Ш
 .{.?j309;;false;.}
.{fBaseDoc CHECKENTER
.{fStepDoc CHECKENTER
.fields
 IF (BaseDoc_TipMoney=1,'Руб.',
   IF (BaseDoc_TipMoney=2,'В-р.',
   IF (BaseDoc_TipMoney=3,'Вал.','')))+
  IF (BaseDoc_VidDoc=101, 'сч.закупки',
   IF (BaseDoc_VidDoc=102,'прием.конс',
   IF (BaseDoc_VidDoc=201,'сч.продажи',
   IF (BaseDoc_VidDoc=202,'отп.консиг',''))))
 DateToStr(StepDoc_dStart,'DD/MM/YYYY')
 NдокДескрДО
 DateToStr(ОплатитьДо,'DD/MM/YYYY')
 DateToStr(ОтгрузитьДо,'DD/MM/YYYY')
 d01
!d33. По оплате (Продажа) (контр)           = If(Продажа,{d01.} - {d23.},0)
!d34. По оплате (Закупка) (наша)            = If(Закупка,{d01.} - {d24.},0)
 TblGfiDouble(TblPeriods,IterNow(Ind),fdp33)-TblGfiDouble(TblPeriods,IterNext(Ind),fdp34)
 d33-d34
.endfields
 .{.?j500;;false;.}
 .{.?j501;;false;.}
 .{.?j502;;false;.}
 .{.?j503;;false;.}
 .{.?j509;;false;.}
 Ш@@@@@@@@@@@@@@│@@@@@@@@@@│@@@@@@@@@@@│@@@@@@@@@@│@@@@@@@@@@│&&&&&&&&&&&.&&│.{.?j510;&&&&&&&&&&&.&&│.}&'&&&&&&&&&&&&&&.&& Ш
 .{.?j519;;false;.}
 .{.?j511;;false;.}
 .{.?j599;;false;.}
.}
.}
.fields
 KatOrg_Name
 k01-k02
 TblGfiDouble(TblPeriods,IterNow(Ind),fkp33)-TblGfiDouble(TblPeriods,IterNext(Ind),fkp34)
 k33-k34
.endfields
 Ш──────────────┴──────────┴───────────┴──────────┴──────────┼──────────────┼.{.?j700;──────────────┼.}─────────────────── Ш
 .{.?j701;;false;.}
 .{.?j702;;false;.}
 .{.?j703;;false;.}
 .{.?j709;;false;.}
 Ш Итого по @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│&&&&&&&&&&&.&&│.{.?j710;&&&&&&&&&&&.&&│.}&'&&&&&&&&&&&&&&.&& Ш
 .{.?j711;;false;.}
 .{.?j719;;false;.}
 .{.?j720;;false;.}
 .{.?j721;;false;.}
 Ш───────────────────────────────────────────────────────────┴──────────────┴.{.?j799;──────────────┴.}─────────────────── Ш
.}
.fields
 a01
 TblGfiString(TblPeriods,IterNext(Ind),fName1)
 a02
 TblGfiString(TblPeriods,IterNext(Ind),fName2)
 If(AllKontr=0,'выбранным контрагентам:','контрагентам:')
 TblGfiDouble(TblPeriods,IterNow(Ind),fap33)-TblGfiDouble(TblPeriods,IterNext(Ind),fap34)
 a33-a34
.endfields

 Ш───────────────────────────────────────────────────────────┬──────────────┬.{.?j900;──────────────┬.}───────────────────
                                      ДО продаж  на сумму: │&&&&&&&&&&&.&&│.{.?j901;@~@@@@@@@@@@@@│.}Итого задолженность
                                      ДО закупок на сумму: │&&&&&&&&&&&.&&│.{.?j902;@~@@@@@@@@@@@@│.}    по оплате Ш
 .{.?j903;;false;.}
 Ш                                                           └──────────────┼.{.?j909;──────────────┼.}───────────────────
 Итого по всем @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@  │.{.?j910;&&&&&&&&&&&.&&│.}&'&&&&&&&&&&&&&&.&& Ш
 .{.?j911;;false;.}
 .{.?j919;;false;.}
 .{.?j920;;false;.}
 .{.?j921;;false;.}
 .{.?j922;;false;.}
 Ш──────────────────────────────────────────────────────────────────────────┴.{.?j999;──────────────┴.}─────────────────── Ш

.begin IterDone(Ind); end.

*
.endform

!******************************************************************************************************************************************************************************************************************

#doc
Задолженности по оплате по периодам (развер.) с последующим движением
#end
.linkform 'DebList03P' prototype is DebList
.group '2+.Задолж. по оплате (относительно документа основания) с послед. движением'
.nameinlist '03+.Задолженности по оплате по периодам (развер.) с последующим движением'
.var Ind:LongInt
.endvar
.fields
  CommonFormHeader
 DateToStr(ДатаОтчета,'DD/MM/YYYY')
 ВВалютеОтчета
 If(Prod=1, If(Zakup=1,'закупки и продажи','продажи'), If(Zakup=1,'закупки',''))
 DateToStr(НачДатаОтчета,'DD/MM/YYYY')
 DateToStr(КонДатаОтчета,'DD/MM/YYYY')
.endfields
 ^

 Й           ОТЧЕТ ПО ИСПОЛНЯЕМЫМ ДОКУМЕНТАМ-ОСНОВАНИЯМ ПО КОНТРАГЕНТАМ В РАЗРЕЗЕ
           ДОКУМЕНТОВ-ОСНОВАНИЙ С РАЗБИВКОЙ ПО ВРЕМЕНИ ЗАДОЛЖЕННОСТИ ПО ОПЛАТЕ Й

.begin Ind:=IterInitNew(KolPers); end.
 Й  Сформирован на ^ в ^.
  Взяты документы-основания ( ДО ) ^ с ^ по ^. Й

 .{.?j000;;false;.}
 .{.?j001;;false;.}
 .{.?j002;;false;.}
 .{.?j003;;false;.}
 .{.?j009;;false;.}
 И Положительные задолженности соответствуют долгу контрагента,
 отрицательные - нашему долгу. И

.{fKatOrg CHECKENTER
.fields
 KatOrg_Name
 TblGfiString(TblPeriods,IterNext(Ind),fName1)
 TblGfiString(TblPeriods,IterNext(Ind),fName2)
.endfields

 Й Контрагент: ^ Й
 Ш──────────────┬──────────┬───────────┬──────────┬──────────┬──────────────┬.{.?j300;──────────────┬.}───────────────────┬──────────────────
     Тип ДО   │ Дата ДО  │N документа│ Оплатить │ Отгрузить│ Сумма по ДО  │.{.?j301;@~@@@@@@@@@@@@│.}Итого задолженность│  Движение после
              │          │с дескрипт.│    до    │    до    │              │.{.?j302;@~@@@@@@@@@@@@│.}     по оплате     │последнего периода
──────────────┼──────────┼───────────┼──────────┼──────────┼──────────────┼.{.?j303;──────────────┼.}───────────────────┼────────────────── Ш
 .{.?j309;;false;.}
.{fBaseDoc CHECKENTER
.{fStepDoc CHECKENTER
.fields
 IF (BaseDoc_TipMoney=1,'Руб.',
   IF (BaseDoc_TipMoney=2,'В-р.',
   IF (BaseDoc_TipMoney=3,'Вал.','')))+
  IF (BaseDoc_VidDoc=101, 'сч.закупки',
   IF (BaseDoc_VidDoc=102,'прием.конс',
   IF (BaseDoc_VidDoc=201,'сч.продажи',
   IF (BaseDoc_VidDoc=202,'отп.консиг',''))))
 DateToStr(StepDoc_dStart,'DD/MM/YYYY')
 NдокДескрДО
 DateToStr(ОплатитьДо,'DD/MM/YYYY')
 DateToStr(ОтгрузитьДо,'DD/MM/YYYY')
 d01
!d33. По оплате (Продажа) (контр)           = If(Продажа,{d01.} - {d23.},0)
!d34. По оплате (Закупка) (наша)            = If(Закупка,{d01.} - {d24.},0)
 TblGfiDouble(TblPeriods,IterNow(Ind),fdp33)-TblGfiDouble(TblPeriods,IterNext(Ind),fdp34)
 d33-d34
 d1z
.endfields
 .{.?j500;;false;.}
 .{.?j501;;false;.}
 .{.?j502;;false;.}
 .{.?j503;;false;.}
 .{.?j509;;false;.}
 Ш@@@@@@@@@@@@@@│@@@@@@@@@@│@@@@@@@@@@@│@@@@@@@@@@│@@@@@@@@@@│&&&&&&&&&&&.&&│.{.?j510;&&&&&&&&&&&.&&│.}&'&&&&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&& Ш
 .{.?j519;;false;.}
 .{.?j511;;false;.}
 .{.?j599;;false;.}
.}
.}
.fields
 KatOrg_Name
 k01-k02
 TblGfiDouble(TblPeriods,IterNow(Ind),fkp33)-TblGfiDouble(TblPeriods,IterNext(Ind),fkp34)
 k33-k34
 k1zP+k1zZ
.endfields
 Ш──────────────┴──────────┴───────────┴──────────┴──────────┼──────────────┼.{.?j700;──────────────┼.}───────────────────┼────────────────── Ш
 .{.?j701;;false;.}
 .{.?j702;;false;.}
 .{.?j703;;false;.}
 .{.?j709;;false;.}
 Ш Итого по @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│&&&&&&&&&&&.&&│.{.?j710;&&&&&&&&&&&.&&│.}&'&&&&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&& Ш
 .{.?j711;;false;.}
 .{.?j719;;false;.}
 .{.?j720;;false;.}
 .{.?j721;;false;.}
 Ш───────────────────────────────────────────────────────────┴──────────────┴.{.?j799;──────────────┴.}───────────────────┴────────────────── Ш
.}
.fields
 a01
 TblGfiString(TblPeriods,IterNext(Ind),fName1)
 a02
 TblGfiString(TblPeriods,IterNext(Ind),fName2)
 If(AllKontr=0,'выбранным контрагентам:','контрагентам:')
 TblGfiDouble(TblPeriods,IterNow(Ind),fap33)-TblGfiDouble(TblPeriods,IterNext(Ind),fap34)
 a33-a34
 a1zP+a1zZ
.endfields

 Ш───────────────────────────────────────────────────────────┬──────────────┬.{.?j900;──────────────┬.}───────────────────┬──────────────────
                                      ДО продаж  на сумму: │&&&&&&&&&&&.&&│.{.?j901;@~@@@@@@@@@@@@│.}Итого задолженность│  Движение после
                                      ДО закупок на сумму: │&&&&&&&&&&&.&&│.{.?j902;@~@@@@@@@@@@@@│.}     по оплате     │последнего периода Ш
 .{.?j903;;false;.}
 Ш                                                           └──────────────┼.{.?j909;──────────────┼.}───────────────────┼──────────────────
 Итого по всем @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@  │.{.?j910;&&&&&&&&&&&.&&│.}&'&&&&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&& Ш
 .{.?j911;;false;.}
 .{.?j919;;false;.}
 .{.?j920;;false;.}
 .{.?j921;;false;.}
 .{.?j922;;false;.}
 Ш──────────────────────────────────────────────────────────────────────────┴.{.?j999;──────────────┴.}───────────────────┴────────────────── Ш

.begin IterDone(Ind); end.

*
.endform

!******************************************************************************************************************************************************************************************************************

#doc
Задолженности по оплате по периодам (свернутый)
#end
.linkform 'DebList03a' prototype is DebList
.group '2.Задолженности по оплате (относительно документа основания)'
.nameinlist '03a.Задолженности по оплате по периодам (свернутый)'
.var Ind:LongInt
.endvar
.fields
  CommonFormHeader
 DateToStr(ДатаОтчета,'DD/MM/YYYY')
 ВВалютеОтчета
 If(Prod=1, If(Zakup=1,'закупки и продажи','продажи'), If(Zakup=1,'закупки',''))
 DateToStr(НачДатаОтчета,'DD/MM/YYYY')
 DateToStr(КонДатаОтчета,'DD/MM/YYYY')
 TblGfiString(TblPeriods,IterNext(Ind),fName1)
 TblGfiString(TblPeriods,IterNext(Ind),fName2)
.endfields
 ^

 Й               ОТЧЕТ ПО ИСПОЛНЯЕМЫМ ДОКУМЕНТАМ-ОСНОВАНИЯМ ПО КОНТРАГЕНТАМ
               С РАЗБИВКОЙ ПО ВРЕМЕНИ ЗАДОЛЖЕННОСТИ ПО ОПЛАТЕ Й

.begin Ind:=IterInitNew(KolPers); end.
 Й  Сформирован на ^ в ^.
  Взяты документы-основания ( ДО ) ^ с ^ по ^. Й

 И Положительные задолженности соответствуют долгу контрагента,
 отрицательные - нашему долгу. И

 Ш────────────────────────────────────────┬.{.?j000;──────────────┬.}───────────────────
 Наименование контрагента               │.{.?j001;@~@@@@@@@@@@@@│.}Итого задолженность
                                        │.{.?j002;@~@@@@@@@@@@@@│.}     по оплате
 .{.?j003;;false;.}
────────────────────────────────────────┼.{.?j009;──────────────┼.}─────────────────── Ш
.{CHECKENTER fKatOrg
 .{.?j300;;false;.}
 .{.?j301;;false;.}
 .{.?j302;;false;.}
 .{.?j303;;false;.}
 .{.?j309;;false;.}
.{CHECKENTER fBaseDoc
.{CHECKENTER fStepDoc
 .{.?j500;;false;.}
 .{.?j501;;false;.}
 .{.?j502;;false;.}
 .{.?j503;;false;.}
 .{.?j509;;false;.}
 .{.?j510;;false;.}
 .{.?j519;;false;.}
 .{.?j511;;false;.}
 .{.?j599;;false;.}
.}
.}
.fields
 KatOrg_Name
 TblGfiDouble(TblPeriods,IterNow(Ind),fkp33)-TblGfiDouble(TblPeriods,IterNext(Ind),fkp34)
 k33-k34
.endfields
 .{.?j700;;false;.}
 .{.?j701;;false;.}
 .{.?j702;;false;.}
 .{.?j703;;false;.}
 .{.?j709;;false;.}
 Ш@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│.{.?j710;&&&&&&&&&&&.&&│.}&'&&&&&&&&&&&&&&.&& Ш
 .{.?j711;;false;.}
 .{.?j719;;false;.}
 .{.?j720;;false;.}
 .{.?j721;;false;.}
 .{.?j799;;false;.}
.}
.fields
 If(AllKontr=0,'выбранным контрагентам','контрагентам')
 TblGfiDouble(TblPeriods,IterNow(Ind),fap33)-TblGfiDouble(TblPeriods,IterNext(Ind),fap34)
 a33-a34
.endfields
 Ш────────────────────────────────────────┼.{.?j900;──────────────┼.}─────────────────── Ш
 .{.?j901;;false;.}
 .{.?j902;;false;.}
 .{.?j903;;false;.}
 .{.?j909;;false;.}
 ШИтого по всем @@@@@@@@@@@@@@@@@@@@@@@@  │.{.?j910;&&&&&&&&&&&.&&│.}&'&&&&&&&&&&&&&&.&& Ш
 .{.?j911;;false;.}
 .{.?j919;;false;.}
 .{.?j920;;false;.}
 .{.?j921;;false;.}
 .{.?j922;;false;.}
 Ш────────────────────────────────────────┴.{.?j999;──────────────┴.}─────────────────── Ш

.begin IterDone(Ind); end.

*
.endform

!******************************************************************************************************************************************************************************************************************

#doc
Задолженности по оплате по периодам (свер.) с послед. движением
#end
.linkform 'DebList03Pa' prototype is DebList
.group '2+.Задолж. по оплате (относительно документа основания) с послед. движением'
.nameinlist '03+a.Задолженности по оплате по периодам (свер.) с послед. движением'
.var Ind:LongInt
.endvar
.fields
  CommonFormHeader
 DateToStr(ДатаОтчета,'DD/MM/YYYY')
 ВВалютеОтчета
 If(Prod=1, If(Zakup=1,'закупки и продажи','продажи'), If(Zakup=1,'закупки',''))
 DateToStr(НачДатаОтчета,'DD/MM/YYYY')
 DateToStr(КонДатаОтчета,'DD/MM/YYYY')
 TblGfiString(TblPeriods,IterNext(Ind),fName1)
 TblGfiString(TblPeriods,IterNext(Ind),fName2)
.endfields
 ^

 Й               ОТЧЕТ ПО ИСПОЛНЯЕМЫМ ДОКУМЕНТАМ-ОСНОВАНИЯМ ПО КОНТРАГЕНТАМ
               С РАЗБИВКОЙ ПО ВРЕМЕНИ ЗАДОЛЖЕННОСТИ ПО ОПЛАТЕ Й

.begin Ind:=IterInitNew(KolPers); end.
 Й  Сформирован на ^ в ^.
  Взяты документы-основания ( ДО ) ^ с ^ по ^. Й

 И Положительные задолженности соответствуют долгу контрагента,
 отрицательные - нашему долгу. И

 Ш────────────────────────────────────────┬.{.?j000;──────────────┬.}───────────────────┬──────────────────
 Наименование контрагента               │.{.?j001;@~@@@@@@@@@@@@│.}Итого задолженность│  Движение после
                                        │.{.?j002;@~@@@@@@@@@@@@│.}     по оплате     │последнего периода Ш
 .{.?j003;;false;.}
 Ш────────────────────────────────────────┼.{.?j009;──────────────┼.}───────────────────┼────────────────── Ш
.{CHECKENTER fKatOrg
 .{.?j300;;false;.}
 .{.?j301;;false;.}
 .{.?j302;;false;.}
 .{.?j303;;false;.}
 .{.?j309;;false;.}
.{CHECKENTER fBaseDoc
.{CHECKENTER fStepDoc
 .{.?j500;;false;.}
 .{.?j501;;false;.}
 .{.?j502;;false;.}
 .{.?j503;;false;.}
 .{.?j509;;false;.}
 .{.?j510;;false;.}
 .{.?j519;;false;.}
 .{.?j511;;false;.}
 .{.?j599;;false;.}
.}
.}
.fields
 KatOrg_Name
 TblGfiDouble(TblPeriods,IterNow(Ind),fkp33)-TblGfiDouble(TblPeriods,IterNext(Ind),fkp34)
 k33-k34
 k1zP+k1zZ
.endfields
 .{.?j700;;false;.}
 .{.?j701;;false;.}
 .{.?j702;;false;.}
 .{.?j703;;false;.}
 .{.?j709;;false;.}
 Ш@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│.{.?j710;&&&&&&&&&&&.&&│.}&'&&&&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&& Ш
 .{.?j711;;false;.}
 .{.?j719;;false;.}
 .{.?j720;;false;.}
 .{.?j721;;false;.}
 .{.?j799;;false;.}
.}
.fields
 If(AllKontr=0,'выбранным контрагентам','контрагентам')
 TblGfiDouble(TblPeriods,IterNow(Ind),fap33)-TblGfiDouble(TblPeriods,IterNext(Ind),fap34)
 a33-a34
 a1zP+a1zZ
.endfields
 Ш────────────────────────────────────────┼.{.?j900;──────────────┼.}───────────────────┼────────────────── Ш
 .{.?j901;;false;.}
 .{.?j902;;false;.}
 .{.?j903;;false;.}
 .{.?j909;;false;.}
 ШИтого по всем @@@@@@@@@@@@@@@@@@@@@@@@  │.{.?j910;&&&&&&&&&&&.&&│.}&'&&&&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&& Ш
 .{.?j911;;false;.}
 .{.?j919;;false;.}
 .{.?j920;;false;.}
 .{.?j921;;false;.}
 .{.?j922;;false;.}
 Ш────────────────────────────────────────┴.{.?j999;──────────────┴.}───────────────────┴────────────────── Ш

.begin IterDone(Ind); end.

*
.endform

!******************************************************************************************************************************************************************************************************************

#doc
Просроченные задолженности по оплате по периодам (развернутый)
#end
.linkform 'DebList04' prototype is DebList
.group '2.Задолженности по оплате (относительно документа основания)'
.nameinlist '04.Просроченные задолженности по оплате по периодам (развернутый)'
.var Ind:LongInt
.endvar
.fields
  CommonFormHeader
 DateToStr(ДатаОтчета,'DD/MM/YYYY')
 ВВалютеОтчета
 If(Prod=1, If(Zakup=1,'закупки и продажи','продажи'), If(Zakup=1,'закупки',''))
 DateToStr(НачДатаОтчета,'DD/MM/YYYY')
 DateToStr(КонДатаОтчета,'DD/MM/YYYY')
.endfields
 ^

 Й            ОТЧЕТ ПО ИСПОЛНЯЕМЫМ ДОКУМЕНТАМ-ОСНОВАНИЯМ ПО КОНТРАГЕНТАМ В РАЗРЕЗЕ
      ДОКУМЕНТОВ-ОСНОВАНИЙ С РАЗБИВКОЙ ПО ВРЕМЕНИ ПРОСРОЧЕННОЙ ЗАДОЛЖЕННОСТИ ПО ОПЛАТЕ Й

.begin Ind:=IterInitNew(KolPers); end.
 Й  Сформирован на ^ в ^.
  Взяты документы-основания ( ДО ) ^ с ^ по ^. Й
 .{.?j000;.}.{.?j001;.} .{.?j002;.} .{.?j003;.} .{.?j009;.}
 И Положительные задолженности соответствуют долгу контрагента,
 отрицательные - нашему долгу. И

.{fKatOrg CHECKENTER
.fields
 KatOrg_Name
 TblGfiString(TblPeriods,IterNext(Ind),fName1)
 TblGfiString(TblPeriods,IterNext(Ind),fName2)
.endfields

 Й Контрагент: ^ Й
 Ш──────────────┬──────────┬───────────┬──────────┬──────────┬──────────────┬.{.?j300;──────────────┬.}──────────────────
    Тип ДО    │ Дата ДО  │N документа│ Оплатить │ Отгрузить│ Сумма по ДО  │.{.?j301;@~@@@@@@@@@@@@│.} Итого просрочено
              │          │с дескрипт.│    до    │    до    │              │.{.?j302;@~@@@@@@@@@@@@│.}     по оплате
──────────────┼──────────┼───────────┼──────────┼──────────┼──────────────┼.{.?j303;──────────────┼.}────────────────── Ш
 .{.?j309;;false;.}
.{fBaseDoc CHECKENTER
.{fStepDoc CHECKENTER
.fields
 IF (BaseDoc_TipMoney=1,'Руб.',
   IF (BaseDoc_TipMoney=2,'В-р.',
   IF (BaseDoc_TipMoney=3,'Вал.','')))+
  IF (BaseDoc_VidDoc=101, 'сч.закупки',
   IF (BaseDoc_VidDoc=102,'прием.конс',
   IF (BaseDoc_VidDoc=201,'сч.продажи',
   IF (BaseDoc_VidDoc=202,'отп.консиг',''))))
 DateToStr(StepDoc_dStart,'DD/MM/YYYY')
 NдокДескрДО
 DateToStr(ОплатитьДо,'DD/MM/YYYY')
 DateToStr(ОтгрузитьДо,'DD/MM/YYYY')
 d01
 TblGfiDouble(TblPeriods,IterNow(Ind),fdp43)-TblGfiDouble(TblPeriods,IterNext(Ind),fdp44)
 d43-d44
.endfields
 .{.?j500;;false;.}
 .{.?j501;;false;.}
 .{.?j502;;false;.}
 .{.?j503;;false;.}
 .{.?j509;;false;.}
 Ш@@@@@@@@@@@@@@│@@@@@@@@@@│@@@@@@@@@@@│@@@@@@@@@@│@@@@@@@@@@│&&&&&&&&&&&.&&│.{.?j510;&&&&&&&&&&&.&&│.}&'&&&&&&&&&&&&&.&& Ш
 .{.?j519;;false;.}
 .{.?j511;;false;.}
 .{.?j599;;false;.}
.}
.}
.fields
 KatOrg_Name
 k01-k02
 TblGfiDouble(TblPeriods,IterNow(Ind),fkp43)-TblGfiDouble(TblPeriods,IterNext(Ind),fkp44)
 k43-k44
.endfields
 Ш──────────────┴──────────┴───────────┴──────────┴──────────┼──────────────┼.{.?j700;──────────────┼.}────────────────── Ш
 .{.?j701;;false;.}
 .{.?j702;;false;.}
 .{.?j703;;false;.}
 .{.?j709;;false;.}
 ШИтого по @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│&&&&&&&&&&&.&&│.{.?j710;&&&&&&&&&&&.&&│.}&'&&&&&&&&&&&&&.&& Ш
 .{.?j711;;false;.}
 .{.?j719;;false;.}
 .{.?j720;;false;.}
 .{.?j721;;false;.}
 Ш───────────────────────────────────────────────────────────┴──────────────┴.{.?j799;──────────────┴.}────────────────── Ш
.}

.fields
 a01
 TblGfiString(TblPeriods,IterNext(Ind),fName1)
 a02
 TblGfiString(TblPeriods,IterNext(Ind),fName2)
 If(AllKontr=0,'выбранным контрагентам:','контрагентам:')
 TblGfiDouble(TblPeriods,IterNow(Ind),fap43)-TblGfiDouble(TblPeriods,IterNext(Ind),fap44)
 a43-a44
.endfields
 Ш───────────────────────────────────────────────────────────┬──────────────┬.{.?j900;──────────────┬.}──────────────────
                                      ДО продаж  на сумму: │&&&&&&&&&&&.&&│.{.?j901;@~@@@@@@@@@@@@│.} Итого просрочено
                                      ДО закупок на сумму: │&&&&&&&&&&&.&&│.{.?j902;@~@@@@@@@@@@@@│.}    по оплате Ш
 .{.?j903;;false;.}
 Ш                                                           └──────────────┼.{.?j909;──────────────┼.}──────────────────
 Итого по всем @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ │.{.?j910;&&&&&&&&&&&.&&│.}&'&&&&&&&&&&&&&.&& Ш
 .{.?j911;;false;.}
 .{.?j919;;false;.}
 .{.?j920;;false;.}
 .{.?j921;;false;.}
 .{.?j922;;false;.}
 Ш──────────────────────────────────────────────────────────────────────────┴.{.?j999;──────────────┴.}────────────────── Ш

.begin IterDone(Ind); end.

*
.endform

!******************************************************************************************************************************************************************************************************************

#doc
Просроченные задолж. по оплате по периодам (разв.) с посл. движением
#end
.linkform 'DebList04P' prototype is DebList
.group '2+.Задолж. по оплате (относительно документа основания) с послед. движением'
.nameinlist '04+.Просроченные задолж. по оплате по периодам (разв.) с посл. движением'
.var Ind:LongInt
.endvar
.fields
  CommonFormHeader
 DateToStr(ДатаОтчета,'DD/MM/YYYY')
 ВВалютеОтчета
 If(Prod=1, If(Zakup=1,'закупки и продажи','продажи'), If(Zakup=1,'закупки',''))
 DateToStr(НачДатаОтчета,'DD/MM/YYYY')
 DateToStr(КонДатаОтчета,'DD/MM/YYYY')
.endfields
 ^

 Й            ОТЧЕТ ПО ИСПОЛНЯЕМЫМ ДОКУМЕНТАМ-ОСНОВАНИЯМ ПО КОНТРАГЕНТАМ В РАЗРЕЗЕ
      ДОКУМЕНТОВ-ОСНОВАНИЙ С РАЗБИВКОЙ ПО ВРЕМЕНИ ПРОСРОЧЕННОЙ ЗАДОЛЖЕННОСТИ ПО ОПЛАТЕ Й

.begin Ind:=IterInitNew(KolPers); end.
 Й  Сформирован на ^ в ^.
  Взяты документы-основания ( ДО ) ^ с ^ по ^. Й
 .{.?j000;.}.{.?j001;.} .{.?j002;.} .{.?j003;.} .{.?j009;.}
 И Положительные задолженности соответствуют долгу контрагента,
 отрицательные - нашему долгу. И

.{fKatOrg CHECKENTER
.fields
 KatOrg_Name
 TblGfiString(TblPeriods,IterNext(Ind),fName1)
 TblGfiString(TblPeriods,IterNext(Ind),fName2)
.endfields

 Й Контрагент: ^ Й
 Ш──────────────┬──────────┬───────────┬──────────┬──────────┬──────────────┬.{.?j300;──────────────┬.}──────────────────┬──────────────────
    Тип ДО    │ Дата ДО  │N документа│ Оплатить │ Отгрузить│ Сумма по ДО  │.{.?j301;@~@@@@@@@@@@@@│.} Итого просрочено │  Движение после
              │          │с дескрипт.│    до    │    до    │              │.{.?j302;@~@@@@@@@@@@@@│.}     по оплате    │последнего периода
──────────────┼──────────┼───────────┼──────────┼──────────┼──────────────┼.{.?j303;──────────────┼.}──────────────────┼────────────────── Ш
 .{.?j309;;false;.}
.{fBaseDoc CHECKENTER
.{fStepDoc CHECKENTER
.fields
 IF (BaseDoc_TipMoney=1,'Руб.',
   IF (BaseDoc_TipMoney=2,'В-р.',
   IF (BaseDoc_TipMoney=3,'Вал.','')))+
  IF (BaseDoc_VidDoc=101, 'сч.закупки',
   IF (BaseDoc_VidDoc=102,'прием.конс',
   IF (BaseDoc_VidDoc=201,'сч.продажи',
   IF (BaseDoc_VidDoc=202,'отп.консиг',''))))
 DateToStr(StepDoc_dStart,'DD/MM/YYYY')
 NдокДескрДО
 DateToStr(ОплатитьДо,'DD/MM/YYYY')
 DateToStr(ОтгрузитьДо,'DD/MM/YYYY')
 d01
 TblGfiDouble(TblPeriods,IterNow(Ind),fdp43)-TblGfiDouble(TblPeriods,IterNext(Ind),fdp44)
 d43-d44
 d1z
.endfields
 .{.?j500;;false;.}
 .{.?j501;;false;.}
 .{.?j502;;false;.}
 .{.?j503;;false;.}
 .{.?j509;;false;.}
 Ш@@@@@@@@@@@@@@│@@@@@@@@@@│@@@@@@@@@@@│@@@@@@@@@@│@@@@@@@@@@│&&&&&&&&&&&.&&│.{.?j510;&&&&&&&&&&&.&&│.}&'&&&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&& Ш
 .{.?j519;;false;.}
 .{.?j511;;false;.}
 .{.?j599;;false;.}
.}
.}
.fields
 KatOrg_Name
 k01-k02
 TblGfiDouble(TblPeriods,IterNow(Ind),fkp43)-TblGfiDouble(TblPeriods,IterNext(Ind),fkp44)
 k43-k44
 k1zP+k1zZ
.endfields
 Ш──────────────┴──────────┴───────────┴──────────┴──────────┼──────────────┼.{.?j700;──────────────┼.}──────────────────┼────────────────── Ш
 .{.?j701;;false;.}
 .{.?j702;;false;.}
 .{.?j703;;false;.}
 .{.?j709;;false;.}
 ШИтого по @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│&&&&&&&&&&&.&&│.{.?j710;&&&&&&&&&&&.&&│.}&'&&&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&& Ш
 .{.?j711;;false;.}
 .{.?j719;;false;.}
 .{.?j720;;false;.}
 .{.?j721;;false;.}
 Ш───────────────────────────────────────────────────────────┴──────────────┴.{.?j799;──────────────┴.}──────────────────┴────────────────── Ш
.}

.fields
 a01
 TblGfiString(TblPeriods,IterNext(Ind),fName1)
 a02
 TblGfiString(TblPeriods,IterNext(Ind),fName2)
 If(AllKontr=0,'выбранным контрагентам:','контрагентам:')
 TblGfiDouble(TblPeriods,IterNow(Ind),fap43)-TblGfiDouble(TblPeriods,IterNext(Ind),fap44)
 a43-a44
 a1zP+a1zZ
.endfields
 Ш───────────────────────────────────────────────────────────┬──────────────┬.{.?j900;──────────────┬.}──────────────────┬──────────────────
                                      ДО продаж  на сумму: │&&&&&&&&&&&.&&│.{.?j901;@~@@@@@@@@@@@@│.} Итого просрочено │  Движение после
                                      ДО закупок на сумму: │&&&&&&&&&&&.&&│.{.?j902;@~@@@@@@@@@@@@│.}    по оплате     │последнего периода Ш
 .{.?j903;;false;.}
 Ш                                                           └──────────────┼.{.?j909;──────────────┼.}──────────────────┼──────────────────
 Итого по всем @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ │.{.?j910;&&&&&&&&&&&.&&│.}&'&&&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&& Ш
 .{.?j911;;false;.}
 .{.?j919;;false;.}
 .{.?j920;;false;.}
 .{.?j921;;false;.}
 .{.?j922;;false;.}
 Ш──────────────────────────────────────────────────────────────────────────┴.{.?j999;──────────────┴.}──────────────────┴────────────────── Ш

.begin IterDone(Ind); end.

*
.endform

!******************************************************************************************************************************************************************************************************************

#doc
Просроченные задолженности по оплате по периодам (свернутый)
#end
.linkform 'DebList04a' prototype is DebList
.group '2.Задолженности по оплате (относительно документа основания)'
.nameinlist '04a.Просроченные задолженности по оплате по периодам (свернутый)'
.var Ind:LongInt
.endvar
.fields
  CommonFormHeader
 DateToStr(ДатаОтчета,'DD/MM/YYYY')
 ВВалютеОтчета
 If(Prod=1, If(Zakup=1,'закупки и продажи','продажи'), If(Zakup=1,'закупки',''))
 DateToStr(НачДатаОтчета,'DD/MM/YYYY')
 DateToStr(КонДатаОтчета,'DD/MM/YYYY')
 TblGfiString(TblPeriods,IterNext(Ind),fName1)
 TblGfiString(TblPeriods,IterNext(Ind),fName2)
.endfields
 ^

 Й               ОТЧЕТ ПО ИСПОЛНЯЕМЫМ ДОКУМЕНТАМ-ОСНОВАНИЯМ ПО КОНТРАГЕНТАМ
               С РАЗБИВКОЙ ПО ВРЕМЕНИ ПРОСРОЧЕННОЙ ЗАДОЛЖЕННОСТИ ПО ОПЛАТЕ Й

.begin Ind:=IterInitNew(KolPers); end.
 Й  Сформирован на ^ в ^.
  Взяты документы-основания ( ДО ) ^ с ^ по ^. Й

 И Положительные задолженности соответствуют долгу контрагента,
 отрицательные - нашему долгу. И

 Ш────────────────────────────────────────┬.{.?j000;──────────────┬.}──────────────────
 Наименование контрагента               │.{.?j001;@~@@@@@@@@@@@@│.} Итого просрочено
                                        │.{.?j002;@~@@@@@@@@@@@@│.}   по оплате Ш
 .{.?j003;;false;.}
 Ш────────────────────────────────────────┼.{.?j009;──────────────┼.}────────────────── Ш
.{CHECKENTER fKatOrg
 .{.?j300;;false;.}
 .{.?j301;;false;.}
 .{.?j302;;false;.}
 .{.?j303;;false;.}
 .{.?j309;;false;.}
.{CHECKENTER fBaseDoc
.{CHECKENTER fStepDoc
 .{.?j500;;false;.}
 .{.?j501;;false;.}
 .{.?j502;;false;.}
 .{.?j503;;false;.}
 .{.?j509;;false;.}
 .{.?j510;;false;.}
 .{.?j519;;false;.}
 .{.?j511;;false;.}
 .{.?j599;;false;.}
.}
.}
.fields
 KatOrg_Name
 TblGfiDouble(TblPeriods,IterNow(Ind),fkp43)-TblGfiDouble(TblPeriods,IterNext(Ind),fkp44)
 k43-k44
.endfields
 .{.?j700;;false;.}
 .{.?j701;;false;.}
 .{.?j702;;false;.}
 .{.?j703;;false;.}
 .{.?j709;;false;.}
 Ш@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│.{.?j710;&&&&&&&&&&&.&&│.}&'&&&&&&&&&&&&&.&& Ш
 .{.?j711;;false;.}
 .{.?j719;;false;.}
 .{.?j720;;false;.}
 .{.?j721;;false;.}
 .{.?j799;;false;.}
.}
.fields
 If(AllKontr=0,'выбранным контрагентам','контрагентам')
 TblGfiDouble(TblPeriods,IterNow(Ind),fap43)-TblGfiDouble(TblPeriods,IterNext(Ind),fap44)
 a43-a44
.endfields
 Ш────────────────────────────────────────┼.{.?j900;──────────────┼.}────────────────── Ш
 .{.?j901;;false;.}
 .{.?j902;;false;.}
 .{.?j903;;false;.}
 .{.?j909;;false;.}
 ШИтого по всем @@@@@@@@@@@@@@@@@@@@@@@@  │.{.?j910;&&&&&&&&&&&.&&│.}&'&&&&&&&&&&&&&.&& Ш
 .{.?j911;;false;.}
 .{.?j919;;false;.}
 .{.?j920;;false;.}
 .{.?j921;;false;.}
 .{.?j922;;false;.}
 Ш────────────────────────────────────────┴.{.?j999;──────────────┴.}────────────────── Ш

.begin IterDone(Ind); end.

*
.endform

!******************************************************************************************************************************************************************************************************************

#doc
Просроченные задолженности по оплате по периодам (свер.) с посл. движением
#end
.linkform 'DebList04Pa' prototype is DebList
.group '2+.Задолж. по оплате (относительно документа основания) с послед. движением'
.nameinlist '04+a.Просроч. задолженности по оплате по периодам (свер.) с посл. движением'
.var Ind:LongInt
.endvar
.fields
  CommonFormHeader
 DateToStr(ДатаОтчета,'DD/MM/YYYY')
 ВВалютеОтчета
 If(Prod=1, If(Zakup=1,'закупки и продажи','продажи'), If(Zakup=1,'закупки',''))
 DateToStr(НачДатаОтчета,'DD/MM/YYYY')
 DateToStr(КонДатаОтчета,'DD/MM/YYYY')
 TblGfiString(TblPeriods,IterNext(Ind),fName1)
 TblGfiString(TblPeriods,IterNext(Ind),fName2)
.endfields
 ^

 Й           ОТЧЕТ ПО ИСПОЛНЯЕМЫМ ДОКУМЕНТАМ-ОСНОВАНИЯМ ПО КОНТРАГЕНТАМ
          С РАЗБИВКОЙ ПО ВРЕМЕНИ ПРОСРОЧЕННОЙ ЗАДОЛЖЕННОСТИ ПО ОПЛАТЕ Й

.begin Ind:=IterInitNew(KolPers); end.
 Й  Сформирован на ^ в ^.
  Взяты документы-основания ( ДО ) ^ с ^ по ^. Й

 И Положительные задолженности соответствуют долгу контрагента,
 отрицательные - нашему долгу. И

 Ш────────────────────────────────────────┬.{.?j000;──────────────┬.}──────────────────┬──────────────────
 Наименование контрагента               │.{.?j001;@~@@@@@@@@@@@@│.} Итого просрочено │  Движение после
                                        │.{.?j002;@~@@@@@@@@@@@@│.}   по оплате      │последнего периода Ш
 .{.?j003;;false;.}
 Ш────────────────────────────────────────┼.{.?j009;──────────────┼.}──────────────────┼────────────────── Ш
.{CHECKENTER fKatOrg
 .{.?j300;;false;.}
 .{.?j301;;false;.}
 .{.?j302;;false;.}
 .{.?j303;;false;.}
 .{.?j309;;false;.}
.{CHECKENTER fBaseDoc
.{CHECKENTER fStepDoc
 .{.?j500;;false;.}
 .{.?j501;;false;.}
 .{.?j502;;false;.}
 .{.?j503;;false;.}
 .{.?j509;;false;.}
 .{.?j510;;false;.}
 .{.?j519;;false;.}
 .{.?j511;;false;.}
 .{.?j599;;false;.}
.}
.}
.fields
 KatOrg_Name
 TblGfiDouble(TblPeriods,IterNow(Ind),fkp43)-TblGfiDouble(TblPeriods,IterNext(Ind),fkp44)
 k43-k44
 k1zP+k1zZ
.endfields
 .{.?j700;;false;.}
 .{.?j701;;false;.}
 .{.?j702;;false;.}
 .{.?j703;;false;.}
 .{.?j709;;false;.}
 Ш@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│.{.?j710;&&&&&&&&&&&.&&│.}&'&&&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&& Ш
 .{.?j711;;false;.}
 .{.?j719;;false;.}
 .{.?j720;;false;.}
 .{.?j721;;false;.}
 .{.?j799;;false;.}
.}
.fields
 If(AllKontr=0,'выбранным контрагентам','контрагентам')
 TblGfiDouble(TblPeriods,IterNow(Ind),fap43)-TblGfiDouble(TblPeriods,IterNext(Ind),fap44)
 a43-a44
 a1zP+a1zZ
.endfields
 Ш────────────────────────────────────────┼.{.?j900;──────────────┼.}──────────────────┼────────────────── Ш
 .{.?j901;;false;.}
 .{.?j902;;false;.}
 .{.?j903;;false;.}
 .{.?j909;;false;.}
 ШИтого по всем @@@@@@@@@@@@@@@@@@@@@@@@  │.{.?j910;&&&&&&&&&&&.&&│.}&'&&&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&& Ш
 .{.?j911;;false;.}
 .{.?j919;;false;.}
 .{.?j920;;false;.}
 .{.?j921;;false;.}
 .{.?j922;;false;.}
 Ш────────────────────────────────────────┴.{.?j999;──────────────┴.}──────────────────┴────────────────── Ш

.begin IterDone(Ind); end.

*
.endform

!******************************************************************************************************************************************************************************************************************

#doc
Задолженности по товару по периодам (развернутый)
#end
.linkform 'DebList05' prototype is DebList
.group '3.Задолженности по товару (относительно документа основания)'
.nameinlist '05.Задолженности по товару по периодам (развернутый)'
.var Ind:LongInt
.endvar
.fields
  CommonFormHeader
 DateToStr(ДатаОтчета,'DD/MM/YYYY')
 ВВалютеОтчета
 DateToStr(НачДатаОтчета,'DD/MM/YYYY')
 DateToStr(КонДатаОтчета,'DD/MM/YYYY')
.endfields
 ^

 Й           ОТЧЕТ ПО ИСПОЛНЯЕМЫМ ДОКУМЕНТАМ-ОСНОВАНИЯМ ПО КОНТРАГЕНТАМ В РАЗРЕЗЕ
           ДОКУМЕНТОВ-ОСНОВАНИЙ С РАЗБИВКОЙ ПО ВРЕМЕНИ ЗАДОЛЖЕННОСТИ ПО ТОВАРУ Й

.begin Ind:=IterInitNew(KolPers); end.
 Й  Сформирован на ^ в ^.
  Взяты документы-основания ( ДО ) с ^ по ^. Й
 .{.?j000;.}.{.?j001;.} .{.?j002;.} .{.?j003;.} .{.?j009;.}
 И Положительные задолженности соответствуют долгу контрагента,
 отрицательные - нашему долгу. И

.{fKatOrg CHECKENTER
.fields
 KatOrg_Name
 TblGfiString(TblPeriods,IterNext(Ind),fName1)
 TblGfiString(TblPeriods,IterNext(Ind),fName2)
.endfields

 Й Контрагент: ^ Й
 Ш──────────────┬──────────┬───────────┬──────────┬──────────┬──────────────┬.{.?j300;──────────────┬.}───────────────────
    Тип ДО    │ Дата ДО  │N документа│ Оплатить │ Отгрузить│ Сумма по ДО  │.{.?j301;@~@@@@@@@@@@@@│.}Итого задолженность
              │          │с дескрипт.│    до    │    до    │              │.{.?j302;@~@@@@@@@@@@@@│.}      по товару
──────────────┼──────────┼───────────┼──────────┼──────────┼──────────────┼.{.?j303;──────────────┼.}─────────────────── Ш
 .{.?j309;;false;.}
.{fBaseDoc CHECKENTER
.{fStepDoc CHECKENTER
.fields
 IF (BaseDoc_TipMoney=1,'Руб.',
   IF (BaseDoc_TipMoney=2,'В-р.',
   IF (BaseDoc_TipMoney=3,'Вал.','')))+
  IF (BaseDoc_VidDoc=101, 'сч.закупки',
   IF (BaseDoc_VidDoc=102,'прием.конс',
   IF (BaseDoc_VidDoc=201,'сч.продажи',
   IF (BaseDoc_VidDoc=202,'отп.консиг',''))))
 DateToStr(StepDoc_dStart,'DD/MM/YYYY')
 NдокДескрДО
 DateToStr(ОплатитьДо,'DD/MM/YYYY')
 DateToStr(ОтгрузитьДо,'DD/MM/YYYY')
 d01
!d31. По товару (Продажа) (наша)            = If(Продажа,{d01.} - {d21.},0)
!d32. По товару (Закупка) (контр)           = If(Закупка,{d01.} - {d22.},0)
 TblGfiDouble(TblPeriods,IterNow(Ind),fdp32)-TblGfiDouble(TblPeriods,IterNext(Ind),fdp31)
 d32-d31
.endfields
 .{.?j500;;false;.}
 .{.?j501;;false;.}
 .{.?j502;;false;.}
 .{.?j503;;false;.}
 .{.?j509;;false;.}
 Ш@@@@@@@@@@@@@@│@@@@@@@@@@│@@@@@@@@@@@│@@@@@@@@@@│@@@@@@@@@@│&&&&&&&&&&&.&&│.{.?j510;&&&&&&&&&&&.&&│.}&'&&&&&&&&&&&&&&.&& Ш
 .{.?j519;;false;.}
 .{.?j511;;false;.}
 .{.?j599;;false;.}
.}
.}
.fields
 KatOrg_Name
 k01-k02
 TblGfiDouble(TblPeriods,IterNow(Ind),fkp32)-TblGfiDouble(TblPeriods,IterNext(Ind),fkp31)
 k32-k31
.endfields
 Ш──────────────┴──────────┴───────────┴──────────┴──────────┼──────────────┼.{.?j700;──────────────┼.}─────────────────── Ш
 .{.?j701;;false;.}
 .{.?j702;;false;.}
 .{.?j703;;false;.}
 .{.?j709;;false;.}
 Ш Итого по @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│&&&&&&&&&&&.&&│.{.?j710;&&&&&&&&&&&.&&│.}&'&&&&&&&&&&&&&&.&& Ш
 .{.?j711;;false;.}
 .{.?j719;;false;.}
 .{.?j720;;false;.}
 .{.?j721;;false;.}
 Ш───────────────────────────────────────────────────────────┴──────────────┴.{.?j799;──────────────┴.}─────────────────── Ш
.}
.fields
 a01
 TblGfiString(TblPeriods,IterNext(Ind),fName1)
 a02
 TblGfiString(TblPeriods,IterNext(Ind),fName2)
 If(AllKontr=0,'выбранным контрагентам:','контрагентам:')
 TblGfiDouble(TblPeriods,IterNow(Ind),fap32)-TblGfiDouble(TblPeriods,IterNext(Ind),fap31)
 a32-a31
.endfields
 Ш───────────────────────────────────────────────────────────┬──────────────┬.{.?j900;──────────────┬.}───────────────────
                                      ДО продаж  на сумму: │&&&&&&&&&&&.&&│.{.?j901;@~@@@@@@@@@@@@│.}Итого задолженность
                                      ДО закупок на сумму: │&&&&&&&&&&&.&&│.{.?j902;@~@@@@@@@@@@@@│.}     по товару Ш
 .{.?j903;;false;.}
 Ш                                                           └──────────────┼.{.?j909;──────────────┼.}───────────────────
 Итого по всем @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ │.{.?j910;&&&&&&&&&&&.&&│.}&'&&&&&&&&&&&&&.&& Ш
 .{.?j911;;false;.}
 .{.?j919;;false;.}
 .{.?j920;;false;.}
 .{.?j921;;false;.}
 .{.?j922;;false;.}
──────────────────────────────────────────────────────────────────────────┴.{.?j999;──────────────┴.}───────────────────

.begin IterDone(Ind); end.

*
.endform

!******************************************************************************************************************************************************************************************************************

#doc
Задолженности по товару по периодам (свернутый)
#end
.linkform 'DebList05a' prototype is DebList
.group '3.Задолженности по товару (относительно документа основания)'
.nameinlist '05a.Задолженности по товару по периодам (свернутый)'
.var Ind:LongInt
.endvar
.fields
  CommonFormHeader
 DateToStr(ДатаОтчета,'DD/MM/YYYY')
 ВВалютеОтчета
 DateToStr(НачДатаОтчета,'DD/MM/YYYY')
 DateToStr(КонДатаОтчета,'DD/MM/YYYY')
 TblGfiString(TblPeriods,IterNext(Ind),fName1)
 TblGfiString(TblPeriods,IterNext(Ind),fName2)
.endfields
 ^

 Й           ОТЧЕТ ПО ИСПОЛНЯЕМЫМ ДОКУМЕНТАМ-ОСНОВАНИЯМ ПО КОНТРАГЕНТАМ
                С РАЗБИВКОЙ ПО ВРЕМЕНИ ЗАДОЛЖЕННОСТИ ПО ТОВАРУ Й

.begin Ind:=IterInitNew(KolPers); end.
 Й  Сформирован на ^ в ^.
  Взяты документы-основания ( ДО ) с ^ по ^. Й

 И Положительные задолженности соответствуют долгу контрагента,
 отрицательные - нашему долгу. И

 Ш────────────────────────────────────────┬.{.?j000;──────────────┬.}───────────────────
 Наименование контрагента               │.{.?j001;@~@@@@@@@@@@@@│.}Итого задолженность
                                        │.{.?j002;@~@@@@@@@@@@@@│.}      по товару Ш
 .{.?j003;;false;.}
 Ш────────────────────────────────────────┼.{.?j009;──────────────┼.}─────────────────── Ш
.{CHECKENTER fKatOrg
 .{.?j300;;false;.}
 .{.?j301;;false;.}
 .{.?j302;;false;.}
 .{.?j303;;false;.}
 .{.?j309;;false;.}
.{CHECKENTER fBaseDoc
.{CHECKENTER fStepDoc
 .{.?j500;;false;.}
 .{.?j501;;false;.}
 .{.?j502;;false;.}
 .{.?j503;;false;.}
 .{.?j509;;false;.}
 .{.?j510;;false;.}
 .{.?j519;;false;.}
 .{.?j511;;false;.}
 .{.?j599;;false;.}
.}
.}
.fields
 KatOrg_Name
 TblGfiDouble(TblPeriods,IterNow(Ind),fkp32)-TblGfiDouble(TblPeriods,IterNext(Ind),fkp31)
 k32-k31
.endfields
 .{.?j700;;false;.}
 .{.?j701;;false;.}
 .{.?j702;;false;.}
 .{.?j703;;false;.}
 .{.?j709;;false;.}
 Ш@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│.{.?j710;&&&&&&&&&&&.&&│.}&'&&&&&&&&&&&&&&.&& Ш
 .{.?j711;;false;.}
 .{.?j719;;false;.}
 .{.?j720;;false;.}
 .{.?j721;;false;.}
 .{.?j799;;false;.}
.}
.fields
 If(AllKontr=0,'выбранным контрагентам','контрагентам')
 TblGfiDouble(TblPeriods,IterNow(Ind),fap32)-TblGfiDouble(TblPeriods,IterNext(Ind),fap31)
 a32-a31
.endfields
 Ш────────────────────────────────────────┼.{.?j900;──────────────┼.}─────────────────── Ш
 .{.?j901;;false;.}
 .{.?j902;;false;.}
 .{.?j903;;false;.}
 .{.?j909;;false;.}
 ШИтого по всем @@@@@@@@@@@@@@@@@@@@@@@@  │.{.?j910;&&&&&&&&&&&.&&│.}&'&&&&&&&&&&&&&&.&& Ш
 .{.?j911;;false;.}
 .{.?j919;;false;.}
 .{.?j920;;false;.}
 .{.?j921;;false;.}
 .{.?j922;;false;.}
 Ш────────────────────────────────────────┴.{.?j999;──────────────┴.}─────────────────── Ш

.begin IterDone(Ind); end.

*
.endform

!******************************************************************************************************************************************************************************************************************

#doc
Просроченные задолженности по товару по периодам (развернутый)
#end
.linkform 'DebList06' prototype is DebList
.group '3.Задолженности по товару (относительно документа основания)'
.nameinlist '06.Просроченные задолженности по товару по периодам (развернутый)'
.var Ind:LongInt
.endvar
.fields
  CommonFormHeader
 DateToStr(ДатаОтчета,'DD/MM/YYYY')
 ВВалютеОтчета
 DateToStr(НачДатаОтчета,'DD/MM/YYYY')
 DateToStr(КонДатаОтчета,'DD/MM/YYYY')
.endfields
 ^

 Й           ОТЧЕТ ПО ИСПОЛНЯЕМЫМ ДОКУМЕНТАМ-ОСНОВАНИЯМ ПО КОНТРАГЕНТАМ В РАЗРЕЗЕ
      ДОКУМЕНТОВ-ОСНОВАНИЙ С РАЗБИВКОЙ ПО ВРЕМЕНИ ПРОСРОЧЕННОЙ ЗАДОЛЖЕННОСТИ ПО ТОВАРУ Й

.begin Ind:=IterInitNew(KolPers); end.
 Й  Сформирован на ^ в ^.
  Взяты документы-основания ( ДО ) с ^ по ^. Й
 .{.?j000;;false;.}
 .{.?j001;;false;.}
 .{.?j002;;false;.}
 .{.?j003;;false;.}
 .{.?j009;;false;.}

 И Положительные задолженности соответствуют долгу контрагента,
 отрицательные - нашему долгу. И

.{fKatOrg CHECKENTER
.fields
 KatOrg_Name
 TblGfiString(TblPeriods,IterNext(Ind),fName1)
 TblGfiString(TblPeriods,IterNext(Ind),fName2)
.endfields

 Й Контрагент: ^ Й
 Ш──────────────┬──────────┬───────────┬──────────┬──────────┬──────────────┬.{.?j300;──────────────┬.}──────────────────
    Тип ДО    │ Дата ДО  │N документа│ Оплатить │ Отгрузить│ Сумма по ДО  │.{.?j301;@~@@@@@@@@@@@@│.} Итого просрочено
              │          │с дескрипт.│    до    │    до    │              │.{.?j302;@~@@@@@@@@@@@@│.}    по товару
──────────────┼──────────┼───────────┼──────────┼──────────┼──────────────┼.{.?j303;──────────────┼.}────────────────── Ш
 .{.?j309;;false;.}
.{fBaseDoc CHECKENTER
.{fStepDoc CHECKENTER
.fields
 IF (BaseDoc_TipMoney=1,'Руб.',
   IF (BaseDoc_TipMoney=2,'В-р.',
   IF (BaseDoc_TipMoney=3,'Вал.','')))+
  IF (BaseDoc_VidDoc=101, 'сч.закупки',
   IF (BaseDoc_VidDoc=102,'прием.конс',
   IF (BaseDoc_VidDoc=201,'сч.продажи',
   IF (BaseDoc_VidDoc=202,'отп.консиг',''))))
 DateToStr(StepDoc_dStart,'DD/MM/YYYY')
 NдокДескрДО
 DateToStr(ОплатитьДо,'DD/MM/YYYY')
 DateToStr(ОтгрузитьДо,'DD/MM/YYYY')
 d01
!d31. По товару (Продажа) (наша)            = If(Продажа,{d01.} - {d21.},0)
!d32. По товару (Закупка) (контр)           = If(Закупка,{d01.} - {d22.},0)
 TblGfiDouble(TblPeriods,IterNow(Ind),fdp42)-TblGfiDouble(TblPeriods,IterNext(Ind),fdp41)
 d42-d41
.endfields
 .{.?j500;;false;.}
 .{.?j501;;false;.}
 .{.?j502;;false;.}
 .{.?j503;;false;.}
 .{.?j509;;false;.}
 Ш@@@@@@@@@@@@@@│@@@@@@@@@@│@@@@@@@@@@@│@@@@@@@@@@│@@@@@@@@@@│&&&&&&&&&&&.&&│.{.?j510;&&&&&&&&&&&.&&│.}&'&&&&&&&&&&&&&.&& Ш
 .{.?j519;;false;.}
 .{.?j511;;false;.}
 .{.?j599;;false;.}
.}
.}
.fields
 KatOrg_Name
 k01-k02
 TblGfiDouble(TblPeriods,IterNow(Ind),fkp42)-TblGfiDouble(TblPeriods,IterNext(Ind),fkp41)
 k42-k41
.endfields
 Ш──────────────┴──────────┴───────────┴──────────┴──────────┼──────────────┼.{.?j700;──────────────┼.}────────────────── Ш
 .{.?j701;;false;.}
 .{.?j702;;false;.}
 .{.?j703;;false;.}
 .{.?j709;;false;.}
 Ш Итого по @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│&&&&&&&&&&&.&&│.{.?j710;&&&&&&&&&&&.&&│.}&'&&&&&&&&&&&&&.&& Ш
 .{.?j711;;false;.}
 .{.?j719;;false;.}
 .{.?j720;;false;.}
 .{.?j721;;false;.}
 Ш───────────────────────────────────────────────────────────┴──────────────┴.{.?j799;──────────────┴.}────────────────── Ш
.}

.fields
 a01
 TblGfiString(TblPeriods,IterNext(Ind),fName1)
 a02
 TblGfiString(TblPeriods,IterNext(Ind),fName2)
 If(AllKontr=0,'выбранным контрагентам:','контрагентам:')
 TblGfiDouble(TblPeriods,IterNow(Ind),fap42)-TblGfiDouble(TblPeriods,IterNext(Ind),fap41)
 a42-a41
.endfields
 Ш───────────────────────────────────────────────────────────┬──────────────┬.{.?j900;──────────────┬.}──────────────────
                                     ДО продаж  на сумму:  │&&&&&&&&&&&.&&│.{.?j901;@~@@@@@@@@@@@@│.} Итого просрочено
                                     ДО закупок на сумму:  │&&&&&&&&&&&.&&│.{.?j902;@~@@@@@@@@@@@@│.}    по товару Ш
 .{.?j903;;false;.}
 Ш                                                           └──────────────┼.{.?j909;──────────────┼.}──────────────────
 Итого по всем @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ │.{.?j910;&&&&&&&&&&&.&&│.}&'&&&&&&&&&&&&&.&& Ш
 .{.?j911;;false;.}
 .{.?j919;;false;.}
 .{.?j920;;false;.}
 .{.?j921;;false;.}
 .{.?j922;;false;.}
 Ш──────────────────────────────────────────────────────────────────────────┴.{.?j999;──────────────┴.}────────────────── Ш

.begin IterDone(Ind); end.

*
.endform

!******************************************************************************************************************************************************************************************************************

#doc
Просроченные задолженности по товару по периодам (свернутый)
#end
.linkform 'DebList06a' prototype is DebList
.group '3.Задолженности по товару (относительно документа основания)'
.nameinlist '06a.Просроченные задолженности по товару по периодам (свернутый)'
.var Ind:LongInt
.endvar
.fields
  CommonFormHeader
 DateToStr(ДатаОтчета,'DD/MM/YYYY')
 ВВалютеОтчета
 DateToStr(НачДатаОтчета,'DD/MM/YYYY')
 DateToStr(КонДатаОтчета,'DD/MM/YYYY')
 TblGfiString(TblPeriods,IterNext(Ind),fName1)
 TblGfiString(TblPeriods,IterNext(Ind),fName2)
.endfields
 ^

 Й               ОТЧЕТ ПО ИСПОЛНЯЕМЫМ ДОКУМЕНТАМ-ОСНОВАНИЯМ ПО КОНТРАГЕНТАМ
           С РАЗБИВКОЙ ПО ВРЕМЕНИ ПРОСРОЧЕННОЙ ЗАДОЛЖЕННОСТИ ПО ТОВАРУ Й

.begin Ind:=IterInitNew(KolPers); end.
 Й  Сформирован на ^ в ^.
  Взяты документы-основания ( ДО ) с ^ по ^. Й

 И Положительные задолженности соответствуют долгу контрагента,
 отрицательные - нашему долгу. И

 Ш────────────────────────────────────────┬.{.?j000;──────────────┬.}───────────────────
 Наименование контрагента               │.{.?j001;@~@@@@@@@@@@@@│.} Итого просроченная
                                        │.{.?j002;@~@@@@@@@@@@@@│.} задолж. по товару Ш
 .{.?j003;;false;.}
 Ш────────────────────────────────────────┼.{.?j009;──────────────┼.}─────────────────── Ш
.{CHECKENTER fKatOrg
 .{.?j300;;false;.}
 .{.?j301;;false;.}
 .{.?j302;;false;.}
 .{.?j303;;false;.}
 .{.?j309;;false;.}
.{CHECKENTER fBaseDoc
.{CHECKENTER fStepDoc
 .{.?j500;;false;.}
 .{.?j501;;false;.}
 .{.?j502;;false;.}
 .{.?j503;;false;.}
 .{.?j509;;false;.}
 .{.?j510;;false;.}
 .{.?j519;;false;.}
 .{.?j511;;false;.}
 .{.?j599;;false;.}
.}
.}
.fields
 KatOrg_Name
 TblGfiDouble(TblPeriods,IterNow(Ind),fkp42)-TblGfiDouble(TblPeriods,IterNext(Ind),fkp41)
 k42-k41
.endfields
 .{.?j700;;false;.}
 .{.?j701;;false;.}
 .{.?j702;;false;.}
 .{.?j703;;false;.}
 .{.?j709;;false;.}
 Ш@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│.{.?j710;&&&&&&&&&&&.&&│.}&'&&&&&&&&&&&&&&.&& Ш
 .{.?j711;;false;.}
 .{.?j719;;false;.}
 .{.?j720;;false;.}
 .{.?j721;;false;.}
 .{.?j799;;false;.}
.}
.fields
 If(AllKontr=0,'выбранным контрагентам','контрагентам')
 TblGfiDouble(TblPeriods,IterNow(Ind),fap42)-TblGfiDouble(TblPeriods,IterNext(Ind),fap41)
 a42-a41
.endfields
 Ш────────────────────────────────────────┼.{.?j900;──────────────┼.}─────────────────── Ш
 .{.?j901;;false;.}
 .{.?j902;;false;.}
 .{.?j903;;false;.}
 .{.?j909;;false;.}
 ШИтого по всем @@@@@@@@@@@@@@@@@@@@@@@@  │.{.?j910;&&&&&&&&&&&.&&│.}&'&&&&&&&&&&&&&&.&& Ш
 .{.?j911;;false;.}
 .{.?j919;;false;.}
 .{.?j920;;false;.}
 .{.?j921;;false;.}
 .{.?j922;;false;.}
 Ш────────────────────────────────────────┴.{.?j999;──────────────┴.}─────────────────── Ш

.begin IterDone(Ind); end.

*
.endform

!******************************************************************************************************************************************************************************************************************

#doc
Самый полный отчет по задолженностям
#end
.linkform 'DebList98' prototype is DebList
.group '4.Полные отчеты по документам-основаниям'
.nameinlist '98.Самый полный отчет по задолженностям.'
.var Ind:LongInt
.endvar
.fields
  CommonFormHeader
 DateToStr(ДатаОтчета,'DD/MM/YYYY')
 ВВалютеОтчета
 DateToStr(НачДатаОтчета,'DD/MM/YYYY')
 DateToStr(КонДатаОтчета,'DD/MM/YYYY')
.endfields
 ^

 Й            ОТЧЕТ ПО ИСПОЛНЯЕМЫМ ДОКУМЕНТАМ-ОСНОВАНИЯМ ПО КОНТРАГЕНТАМ В РАЗРЕЗЕ
                 ДОКУМЕНТОВ-ОСНОВАНИЙ С РАЗБИВКОЙ ПО ВРЕМЕНИ ЗАДОЛЖЕННОСТИ Й

.begin Ind:=IterInitNew(KolPers); end.
 Й  Сформирован на ^ в ^.
  Взяты документы-основания ( ДО ) с ^ по ^. Й

 .{.?j000;;false;.}
 .{.?j001;;false;.}
 .{.?j002;;false;.}
 .{.?j003;;false;.}
 .{.?j009;;false;.}
 И  Положительные фактические задолженности соответствуют долгу контрагента, отрицательные - нашему долгу. И

.{fKatOrg CHECKENTER
.fields
 KatOrg_Name
.endfields

 Й Контрагент: ^ Й

 .{.?j300;;false;.}
 .{.?j301;;false;.}
 .{.?j302;;false;.}
 .{.?j303;;false;.}
 .{.?j309;;false;.}
.{fBaseDoc CHECKENTER
.{fStepDoc CHECKENTER
.fields
 DateToStr(StepDoc_dStart,'DD/MM/YYYY')
 NдокДескрДО
 IF (BaseDoc_TipMoney=1,'Рублевый',
   IF (BaseDoc_TipMoney=2,'Валютно-рублевый',
   IF (BaseDoc_TipMoney=3,'Валютный','')))
 IF (BaseDoc_VidDoc=101,'счет на закупку.',
   IF (BaseDoc_VidDoc=102,'ДО приема на консигнацию.',
   IF (BaseDoc_VidDoc=201,'счет на продажу.',
   IF (BaseDoc_VidDoc=202,'ДО отпуска на консигнацию.',''))))
 StepDoc_Name
 d01d
 ВалДог
 d01
 ВалОтчета
 If(BaseDoc_TipMoney=2
   ,  If(BaseDoc_ValCurse>0.00001,'Курс='+String(BaseDoc_ValCurse,0,2)+'+',
        If(BaseDoc_DopProc<>0,'Надбавка к курсу: ','') )+
      If(BaseDoc_DopProc<>0,String(BaseDoc_DopProc,0,2)+'%','')
   , ''
   )
 DateToStr(ОплатитьДо,'DD/MM/YYYY')
 DateToStr(ОтгрузитьДо,'DD/MM/YYYY')
.endfields

 Й Дата ДО: @@@@@@@@@@              Номер документа с дескриптором: ^
 Тип ДО: ^ ^ ^
 Сумма ДО: &'&&&&&&&&&&&&&.&& ^ (в валюте отчета: &'&&&&&&&&&&&&&.&& ^)  ^
 Максимальная дата оплаты: @@@@@@@@@@   Максимальная дата отгрузки: @@@@@@@@@@ Й
.fields
 d11d+d13d d12d+d14d d21d+d22d d31d+d32d d15d+d17d d16d+d18d
  d19d+d1bd d1ad+d1cd d23d+d24d d33d+d34d d3zd d4zd d1zd
 d11+d13 d12+d14 d21+d22 d31+d32 d15+d17 d16+d18
  d19+d1b d1a+d1c d23+d24 d33+d34 d3z d4z d1z
.endfields          //    1              2              3              4              5              6              7              8              9             10             11

 Ш──────────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────────┬──────────────────┬──────────────────
                  │   Отгружено  │  Возвращено  │     Итого    │ Задолженность│   Оплачено   │    Возврат   │   Оплачено   │    Возврат   │      Итого   │ Задолженность│   Задолженность  │ Зад. фактическая │  Движение после
                  │     товара   │    товара    │   отгружено  │   по товару  │   деньгами   │    оплаты    │    товаром   │     товара   │     оплаты   │   по оплате  │    фактическая   │   просроченная   │последнего периода
──────────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────────┼──────────────────┼──────────────────
 в валюте ДО      │&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&&
 в валюте отчета  │&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&&
──────────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────────┴──────────────────┴────────────────── Ш

.fields
 TblGfiString(TblPeriods,IterNow(Ind),fName1)+' '+TblGfiString(TblPeriods,IterNext(Ind),fName2)
 ВВалютеДог
 TblGfiDouble(TblPeriods,IterNow(Ind),fdp31d)+TblGfiDouble(TblPeriods,IterNow(Ind),fdp32d) TblGfiDouble(TblPeriods,IterNow(Ind),fdp33d)+TblGfiDouble(TblPeriods,IterNext(Ind),fdp34d)
 TblGfiDouble(TblPeriods,IterNext(Ind),fdp3zd)
.endfields

 Ш──────────────────.{.?j500;┬─────────────────────────────.}
      По периодам .{.?j501;│@~@@@@@@@@@@@@@@@@@@@@@@@@@@@.}
 задолженность    .{.?j502;┼──────────────┬──────────────.}
 в @@@@@@@@@@@@@@@.{.?j503;│  по товару   │  по оплате   .}
──────────────────.{.?j509;┼──────────────┼──────────────.}
 По ДО            .{.?j510;│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&.}
──────────────────.{.?j519;┼──────────────┴──────────────.}
 Фактическая      .{.?j511;│   &'&&&&&&&&&&&&&.&&        .}
──────────────────.{.?j599;┴─────────────────────────────.} Ш

.}
.}
.fields
 KatOrg_Name
 k01
 ВалОтчета
 k02
 ВалОтчета
 ВВалютеОтчета
.endfields

 Й Итого по контрагенту: ^
 Всего ДО продаж  на сумму: &&&&&&&&&&&.&& ^
 Всего ДО закупок на сумму: &&&&&&&&&&&.&& ^ Й
.fields
 k11 k12 k21 k31 k15 k16 k19 k1a k23 k33 k35 k45 k1zP
 k13 k14 k22 k32 k17 k18 k1b k1c k24 k34 k36 k46 k1zZ
 k11-k13 k12-k14 k21-k22 k31-k32 k15-k17 k16-k18
  k19-k1b k1a-k1c k23-k24 k33-k34 k3z k4z k1zP+k1zZ
.endfields          //    1              2              3              4              5              6              7              8              9             10             11            12

 Ш──────────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────────┬──────────────────┬──────────────────
                  │   Отгружено  │  Возвращено  │     Итого    │ Задолженность│   Оплачено   │    Возврат   │   Оплачено   │    Возврат   │      Итого   │ Задолженность│   Задолженность  │ Зад. фактическая │  Движение после
 в @@@@@@@@@@@@@@@│     товара   │    товара    │   отгружено  │   по товару  │   деньгами   │    оплаты    │    товаром   │     товара   │     оплаты   │   по оплате  │    фактическая   │    просроченная  │последнего периода
──────────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────────┼──────────────────┼──────────────────
 По продажам      │&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&&
 По закупкам      │&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&&
──────────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────────┼──────────────────┼──────────────────
 Баланс           │&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&&
──────────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────────┴──────────────────┴────────────────── Ш
.fields
 TblGfiString(TblPeriods,IterNow(Ind),fName1)+' '+TblGfiString(TblPeriods,IterNext(Ind),fName2)
 ВВалютеОтчета
 TblGfiDouble(TblPeriods,IterNow(Ind),fkp31) TblGfiDouble(TblPeriods,IterNext(Ind),fkp33)
 TblGfiDouble(TblPeriods,IterNow(Ind),fkp32) TblGfiDouble(TblPeriods,IterNext(Ind),fkp34)
 TblGfiDouble(TblPeriods,IterNext(Ind),fkp3z)
 TblGfiDouble(TblPeriods,IterNext(Ind),fkp3zs)
.endfields

 Ш──────────────────.{.?j700;┬─────────────────────────────.}
      По периодам .{.?j701;│@~@@@@@@@@@@@@@@@@@@@@@@@@@@@.}
 Задолженность    .{.?j702;┼──────────────┬──────────────.}
 в @@@@@@@@@@@@@@@.{.?j703;│  по товару   │  по оплате   .}
──────────────────.{.?j709;┼──────────────┼──────────────.}
 По продажам      .{.?j710;│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&.}
 По закупкам      .{.?j711;│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&.}
──────────────────.{.?j719;┼──────────────┴──────────────.}
 Фактическая      .{.?j720;│   &'&&&&&&&&&&&&&.&&        .}
 Сальдированно    .{.?j721;│   &'&&&&&&&&&&&&&.&&        .}
──────────────────.{.?j799;┴─────────────────────────────.} Ш

.}
.fields
 If(AllKontr=0,'выбранным контрагентам.','контрагентам.')
 a01
 ВалОтчета
 a02
 ВалОтчета
 ВВалютеОтчета
.endfields

 Й Итого по всем ^
 Всего ДО продаж  на сумму: &&&&&&&&&&&.&& ^
 Всего ДО закупок на сумму: &&&&&&&&&&&.&& ^ Й
.fields
 a11 a12 a21 a31 a15 a16 a19 a1a a23 a33 a35 a45 a1zP
 a13 a14 a22 a32 a17 a18 a1b a1c a24 a34 a36 a46 a1zZ
 a11-a13 a12-a14 a21-a22 a31-a32 a15-a17 a16-a18
  a19-a1b a1a-a1c a23-a24 a33-a34 a3z a4z a1zP+a1zZ
.endfields          //    1              2              3              4              5              6              7              8              9             10             11           12

 Ш──────────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────────┬──────────────────┬──────────────────
                  │   Отгружено  │  Возвращено  │     Итого    │ Задолженность│   Оплачено   │    Возврат   │   Оплачено   │    Возврат   │      Итого   │ Задолженность│   Задолженность  │ Зад. фактическая │  Движение после
 в @@@@@@@@@@@@@@@│     товара   │    товара    │   отгружено  │   по товару  │   деньгами   │    оплаты    │    товаром   │     товара   │     оплаты   │   по оплате  │    фактическая   │    просроченная  │последнего периода
──────────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────────┼──────────────────┼──────────────────
 По продажам      │&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&&
 По закупкам      │&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&&
──────────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────────┼──────────────────┼──────────────────
 Баланс           │&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&&
──────────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────────┴──────────────────┴────────────────── Ш

.fields
 TblGfiString(TblPeriods,IterNow(Ind),fName1)+' '+TblGfiString(TblPeriods,IterNext(Ind),fName2)
 ВВалютеОтчета
 TblGfiDouble(TblPeriods,IterNow(Ind),fap31) TblGfiDouble(TblPeriods,IterNext(Ind),fap33)
 TblGfiDouble(TblPeriods,IterNow(Ind),fap32) TblGfiDouble(TblPeriods,IterNext(Ind),fap34)
 TblGfiDouble(TblPeriods,IterNext(Ind),fap3z)
 TblGfiDouble(TblPeriods,IterNext(Ind),fap3zk)
 TblGfiDouble(TblPeriods,IterNext(Ind),fap3zs)
.endfields

 Ш──────────────────.{.?j900;┬─────────────────────────────.}
      По периодам .{.?j901;│@~@@@@@@@@@@@@@@@@@@@@@@@@@@@.}
 Задолженность    .{.?j902;┼──────────────┬──────────────.}
 в @@@@@@@@@@@@@@@.{.?j903;│  по товару   │  по оплате   .}
──────────────────.{.?j909;┼──────────────┼──────────────.}
 По продажам      .{.?j910;│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&.}
 По закупкам      .{.?j911;│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&.}
──────────────────.{.?j919;┼──────────────┴──────────────.}
 Фактическая      .{.?j920;│   &'&&&&&&&&&&&&&.&&        .}
 По контрагентам  .{.?j921;│   &'&&&&&&&&&&&&&.&&        .}
 Сальдированно    .{.?j922;│   &'&&&&&&&&&&&&&.&&        .}
──────────────────.{.?j999;┴─────────────────────────────.} Ш

.begin IterDone(Ind); end.

*
.endform

!******************************************************************************************************************************************************************************************************************

#doc
Самый полный отчет по просроченным задолженностям
#end
.linkform 'DebList99' prototype is DebList
.group '4.Полные отчеты по документам-основаниям'
.nameinlist '99.Самый полный отчет по просроченным задолженностям.'
.var Ind:LongInt
.endvar
.fields
  CommonFormHeader
 DateToStr(ДатаОтчета,'DD/MM/YYYY')
 ВВалютеОтчета
 DateToStr(НачДатаОтчета,'DD/MM/YYYY')
 DateToStr(КонДатаОтчета,'DD/MM/YYYY')
.endfields
 ^

 Й            ОТЧЕТ ПО ИСПОЛНЯЕМЫМ ДОКУМЕНТАМ-ОСНОВАНИЯМ ПО КОНТРАГЕНТАМ В РАЗРЕЗЕ
           ДОКУМЕНТОВ-ОСНОВАНИЙ С РАЗБИВКОЙ ПО ВРЕМЕНИ ПРОСРОЧЕННОЙ ЗАДОЛЖЕННОСТИ Й

.begin Ind:=IterInitNew(KolPers); end.
 Й  Сформирован на ^ в ^.
  Взяты документы-основания ( ДО ) с ^ по ^. Й
 .{.?j000;;false;.}
 .{.?j001;;false;.}
 .{.?j002;;false;.}
 .{.?j003;;false;.}
 .{.?j009;;false;.}

 И  Положительные фактические задолженности соответствуют долгу контрагента, отрицательные - нашему долгу. И

.{fKatOrg CHECKENTER
.fields
 KatOrg_Name
.endfields

 Й Контрагент: ^ Й
 .{.?j300;;false;.}
 .{.?j301;;false;.}
 .{.?j302;;false;.}
 .{.?j303;;false;.}
 .{.?j309;;false;.}
.{fBaseDoc CHECKENTER
.{fStepDoc CHECKENTER
.fields
 DateToStr(StepDoc_dStart,'DD/MM/YYYY')
 NдокДескрДО
 IF (BaseDoc_TipMoney=1,'Рублевый',
   IF (BaseDoc_TipMoney=2,'Валютно-рублевый',
   IF (BaseDoc_TipMoney=3,'Валютный','')))
 IF (BaseDoc_VidDoc=101,'счет на закупку.',
   IF (BaseDoc_VidDoc=102,'ДО приема на консигнацию.',
   IF (BaseDoc_VidDoc=201,'счет на продажу.',
   IF (BaseDoc_VidDoc=202,'ДО отпуска на консигнацию.',''))))
 StepDoc_Name
 d01d
 ВалДог
 d01
 ВалОтчета
 If(BaseDoc_TipMoney=2
   ,  If(BaseDoc_ValCurse>0.00001,'Курс='+String(BaseDoc_ValCurse,0,2)+'+',
        If(BaseDoc_DopProc<>0,'Надбавка к курсу: ','') )+
      If(BaseDoc_DopProc<>0,String(BaseDoc_DopProc,0,2)+'%','')
   , ''
   )
 DateToStr(ОплатитьДо,'DD/MM/YYYY')
 DateToStr(ОтгрузитьДо,'DD/MM/YYYY')
.endfields

 Й Дата ДО: @@@@@@@@@@              Номер документа с дескриптором: ^
 Тип ДО: ^ ^ ^
 Сумма ДО: &'&&&&&&&&&&&&&.&& ^ (в валюте отчета: &'&&&&&&&&&&&&&.&& ^)  ^
 Максимальная дата оплаты: @@@@@@@@@@   Максимальная дата отгрузки: @@@@@@@@@@ Й
.fields
 d11d+d13d d12d+d14d d21d+d22d d41d+d42d d15d+d17d d16d+d18d
  d19d+d1bd d1ad+d1cd d23d+d24d d43d+d44d d3zd d4zd d1zd
 d11+d13 d12+d14 d21+d22 d41+d42 d15+d17 d16+d18
  d19+d1b d1a+d1c d23+d24 d43+d44 d3z d4z d1z
.endfields          //    1              2              3              4              5              6              7              8              9             10             11

 Ш──────────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────────┬──────────────────┬──────────────────
                  │   Отгружено  │  Возвращено  │     Итого    │  Просрочено  │   Оплачено   │    Возврат   │   Оплачено   │    Возврат   │      Итого   │  Просрочено  │   Задолженность  │ Зад. фактическая │  Движение после
                  │     товара   │    товара    │   отгружено  │   по товару  │   деньгами   │    оплаты    │    товаром   │     товара   │     оплаты   │   по оплате  │    фактическая   │   просроченная   │последнего периода
──────────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────────┼──────────────────┼──────────────────
 в валюте ДО      │&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&&
 в валюте отчета  │&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&&
──────────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────────┴──────────────────┴────────────────── Ш
.fields
 TblGfiString(TblPeriods,IterNow(Ind),fName1)+' '+TblGfiString(TblPeriods,IterNext(Ind),fName2)
 ВВалютеДог
 TblGfiDouble(TblPeriods,IterNow(Ind),fdp41d)+TblGfiDouble(TblPeriods,IterNow(Ind),fdp42d) TblGfiDouble(TblPeriods,IterNow(Ind),fdp43d)+TblGfiDouble(TblPeriods,IterNext(Ind),fdp44d)
 TblGfiDouble(TblPeriods,IterNext(Ind),fdp4zd)
.endfields

 Ш──────────────────.{.?j500;┬─────────────────────────────.}
      По периодам .{.?j501;│@~@@@@@@@@@@@@@@@@@@@@@@@@@@@.}
 Просрочено       .{.?j502;┼──────────────┬──────────────.}
 в @@@@@@@@@@@@@@@.{.?j503;│  по товару   │  по оплате   .}
──────────────────.{.?j509;┼──────────────┼──────────────.}
 По ДО            .{.?j510;│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&.}
──────────────────.{.?j519;┼──────────────┴──────────────.}
 Фактическая      .{.?j511;│   &'&&&&&&&&&&&&&.&&        .}
──────────────────.{.?j599;┴─────────────────────────────.} Ш

.}
.}
.fields
 KatOrg_Name
 k01
 ВалОтчета
 k02
 ВалОтчета
 ВВалютеОтчета
.endfields

 Й Итого по контрагенту: ^
 Всего ДО продаж  на сумму: &&&&&&&&&&&.&& ^
 Всего ДО закупок на сумму: &&&&&&&&&&&.&& ^ Й
.fields
 k11 k12 k21 k41 k15 k16 k19 k1a k23 k43 k35 k45 k1zP
 k13 k14 k22 k42 k17 k18 k1b k1c k24 k44 k36 k46 k1zZ
 k11-k13 k12-k14 k21-k22 k41-k42 k15-k17 k16-k18
  k19-k1b k1a-k1c k23-k24 k43-k44 k3z k4z k1zP+k1zZ
.endfields          //    1              2              3              4              5              6              7              8              9             10             11            12

 Ш──────────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────────┬──────────────────┬──────────────────
                  │   Отгружено  │  Возвращено  │     Итого    │  Просрочено  │   Оплачено   │    Возврат   │   Оплачено   │    Возврат   │      Итого   │  Просрочено  │   Задолженность  │ Зад. фактическая │  Движение после
 в @@@@@@@@@@@@@@@│     товара   │    товара    │   отгружено  │   по товару  │   деньгами   │    оплаты    │    товаром   │     товара   │     оплаты   │   по оплате  │    фактическая   │    просроченная  │последнего периода
──────────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────────┼──────────────────┼──────────────────
 По продажам      │&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&&
 По закупкам      │&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&&
──────────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────────┼──────────────────┼──────────────────
 Баланс           │&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&&
──────────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────────┴──────────────────┴────────────────── Ш

.fields
 TblGfiString(TblPeriods,IterNow(Ind),fName1)+' '+TblGfiString(TblPeriods,IterNext(Ind),fName2)
 ВВалютеОтчета
 TblGfiDouble(TblPeriods,IterNow(Ind),fkp41) TblGfiDouble(TblPeriods,IterNext(Ind),fkp43)
 TblGfiDouble(TblPeriods,IterNow(Ind),fkp42) TblGfiDouble(TblPeriods,IterNext(Ind),fkp44)
 TblGfiDouble(TblPeriods,IterNext(Ind),fkp4z)
 TblGfiDouble(TblPeriods,IterNext(Ind),fkp4zs)
.endfields

 Ш──────────────────.{.?j700;┬─────────────────────────────.}
      По периодам .{.?j701;│@~@@@@@@@@@@@@@@@@@@@@@@@@@@@.}
 Просрочено       .{.?j702;┼──────────────┬──────────────.}
 в @@@@@@@@@@@@@@@.{.?j703;│  по товару   │  по оплате   .}
──────────────────.{.?j709;┼──────────────┼──────────────.}
 По продажам      .{.?j710;│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&.}
 По закупкам      .{.?j711;│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&.}
──────────────────.{.?j719;┼──────────────┴──────────────.}
 Фактическая      .{.?j720;│   &'&&&&&&&&&&&&&.&&        .}
 Сальдированно    .{.?j721;│   &'&&&&&&&&&&&&&.&&        .}
──────────────────.{.?j799;┴─────────────────────────────.} Ш

.}
.fields
 If(AllKontr=0,'выбранным контрагентам.','контрагентам.')
 a01
 ВалОтчета
 a02
 ВалОтчета
 ВВалютеОтчета
.endfields

 Й Итого по всем ^
 Всего ДО продаж  на сумму: &&&&&&&&&&&.&& ^
 Всего ДО закупок на сумму: &&&&&&&&&&&.&& ^ Й
.fields
 a11 a12 a21 a41 a15 a16 a19 a1a a23 a43 a35 a45 a1zP
 a13 a14 a22 a42 a17 a18 a1b a1c a24 a44 a36 a46 a1zZ
 a11-a13 a12-a14 a21-a22 a41-a42 a15-a17 a16-a18
  a19-a1b a1a-a1c a23-a24 a43-a44 a3z a4z a1zP+a1zZ
.endfields          //    1              2              3              4              5              6              7              8              9             10             11           12

 Ш──────────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────────┬──────────────────┬──────────────────
                  │   Отгружено  │  Возвращено  │     Итого    │  Просрочено  │   Оплачено   │    Возврат   │   Оплачено   │    Возврат   │      Итого   │  Просрочено  │   Задолженность  │ Зад. фактическая │  Движение после
 в @@@@@@@@@@@@@@@│     товара   │    товара    │   отгружено  │   по товару  │   деньгами   │    оплаты    │    товаром   │     товара   │     оплаты   │   по оплате  │    фактическая   │    просроченная  │последнего периода
──────────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────────┼──────────────────┼──────────────────
 По продажам      │&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&&
 По закупкам      │&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&&
──────────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────────┼──────────────────┼──────────────────
 Баланс           │&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&&│&'&&&&&&&&&&&&&.&&
──────────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────────┴──────────────────┴────────────────── Ш
.fields
 TblGfiString(TblPeriods,IterNow(Ind),fName1)+' '+TblGfiString(TblPeriods,IterNext(Ind),fName2)
 ВВалютеОтчета
 TblGfiDouble(TblPeriods,IterNow(Ind),fap41) TblGfiDouble(TblPeriods,IterNext(Ind),fap43)
 TblGfiDouble(TblPeriods,IterNow(Ind),fap42) TblGfiDouble(TblPeriods,IterNext(Ind),fap44)
 TblGfiDouble(TblPeriods,IterNext(Ind),fap4z)
 TblGfiDouble(TblPeriods,IterNext(Ind),fap4zk)
 TblGfiDouble(TblPeriods,IterNext(Ind),fap4zs)
.endfields

 Ш──────────────────.{.?j900;┬─────────────────────────────.}
      По периодам .{.?j901;│@~@@@@@@@@@@@@@@@@@@@@@@@@@@@.}
 Просрочено       .{.?j902;┼──────────────┬──────────────.}
 в @@@@@@@@@@@@@@@.{.?j903;│  по товару   │  по оплате   .}
──────────────────.{.?j909;┼──────────────┼──────────────.}
 По продажам      .{.?j910;│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&.}
 По закупкам      .{.?j911;│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&.}
──────────────────.{.?j919;┼──────────────┴──────────────.}
 Фактическая      .{.?j920;│   &'&&&&&&&&&&&&&.&&        .}
 По контрагентам  .{.?j921;│   &'&&&&&&&&&&&&&.&&        .}
 Сальдированно    .{.?j922;│   &'&&&&&&&&&&&&&.&&        .}
──────────────────.{.?j999;┴─────────────────────────────.} Ш

.begin IterDone(Ind); end.

*
.endform

!******************************************************************************************************************************************************************************************************************
#doc
Фактические задолженности по периодам (развернутый) в разрезе договоров
#end
.linkform 'DebList01DR' prototype is DebList
.group '1.Фактические задолженности (по реальным оборотам)'
.nameinlist '03.Фактические задолженности по периодам (развернутый) в разрезе договоров'
.var
  Ind:Longint
.endvar
.fields
  CommonFormHeader
 DateToStr(ДатаОтчета,'DD/MM/YYYY')
 ВВалютеОтчета
 DateToStr(НачДатаОтчета,'DD/MM/YYYY')
 DateToStr(КонДатаОтчета,'DD/MM/YYYY')
.endfields
 ^

 С           ОТЧЕТ ПО ИСПОЛНЯЕМЫМ ДОКУМЕНТАМ-ОСНОВАНИЯМ ПО КОНТРАГЕНТАМ В РАЗРЕЗЕ
            ДОКУМЕНТОВ-ОСНОВАНИЙ С РАЗБИВКОЙ ПО ВРЕМЕНИ ФАКТИЧЕСКОЙ ЗАДОЛЖЕННОСТИ С

.begin
  Ind:=IterInitNew(KolPers);
end.
 Й  Сформирован на ^ в ^.
  Взяты документы-основания ( ДО )с ^ по ^. Й

 .{.?j000;;false;.}
 .{.?j001;;false;.}
 .{.?j002;;false;.}
 .{.?j003;;false;.}
 .{.?j009;;false;.}
 Ш Положительные задолженности соответствуют долгу контрагента,отрицательные - нашему долгу. Ш

.{fKatOrg CHECKENTER
.fields
 KatOrg_Name
 TblGfiString(TblPeriods,IterNext(Ind),fName1)
 TblGfiString(TblPeriods,IterNext(Ind),fName2)
.endfields

 Й Контрагент: ^ Й
 Ш──────────────┬──────────┬───────────┬───────────┬──────────┬──────────┬──────────┬──────────────┬.{.?j300;──────────────┬.}────────────────── Ш
 Ш     Тип ДО   │   Дата   │N документа│№ договора │   Дата   │ Оплатить │ Отгрузить│ Сумма по ДО  │.{.?j301;@~@@@@@@@@@@@@│.} Итого фактическая Ш
 Ш              │    ДО    │с дескрипт.│           │ договора │    до    │    до    │              │.{.?j302;@~@@@@@@@@@@@@│.}   задолженность Ш
 Ш──────────────┼──────────┼───────────┼───────────┼──────────┼──────────┼──────────┼──────────────┼.{.?j303;──────────────┼.}────────────────── Ш
 .{.?j309;;false;.}
.{fBaseDoc CHECKENTER
.{fStepDoc CHECKENTER
.fields
 IF (BaseDoc_TipMoney=1,'Руб.',
   IF (BaseDoc_TipMoney=2,'В-р.',
   IF (BaseDoc_TipMoney=3,'Вал.','')))+
  IF (BaseDoc_VidDoc=101, 'сч.закупки',
   IF (BaseDoc_VidDoc=102,'прием.конс',
   IF (BaseDoc_VidDoc=201,'сч.продажи',
   IF (BaseDoc_VidDoc=202,'отп.консиг',''))))
 DateToStr(StepDoc_dStart,'DD/MM/YYYY')
 NдокДескрДО
 Dogovor_NoDoc
 if (Trim(Dogovor_NoDoc) = '', '', Dogovor_dDoc)
 DateToStr(ОплатитьДо,'DD/MM/YYYY')
 DateToStr(ОтгрузитьДо,'DD/MM/YYYY')
 d01
 TblGfiDouble(TblPeriods,IterNext(Ind),fdp3z)
 d3z
.endfields
 .{.?j500;;false;.}
 .{.?j501;;false;.}
 .{.?j502;;false;.}
 .{.?j503;;false;.}
 .{.?j509;;false;.}
 Ш@@@@@@@@@@@@@@│@@@@@@@@@@│@@@@@@@@@@@│@@@@@@@@@@@│@@@@@@@@@@│@@@@@@@@@@│@@@@@@@@@@│&&&&&&&&&&&.&&│.{.?j510;&&&&&&&&&&&.&&│.}&'&&&&&&&&&&&&&.&& Ш
 .{.?j519;;false;.}
 .{.?j511;;false;.}
 .{.?j599;;false;.}
.}
.}
.fields
 TblGfiDouble(TblPeriods,IterNext(Ind),fkp3z)
 KatOrg_Name
 TblGfiDouble(TblPeriods,IterNext(Ind),fkp3zs)
 k3z
.endfields
 Ш──────────────┴──────────┴───────────┴───────────┴──────────┴──────────┴──────────┴──────────────┼.{.?j700;──────────────┼.}────────────────── Ш
 .{.?j701;;false;.}
 .{.?j702;;false;.}
 .{.?j703;;false;.}
 .{.?j709;;false;.}
 Ш Итого по контрагенту                                                  По документам-основаниям: │.{.?j710;&&&&&&&&&&&.&&│.} Ш
 .{.?j711;;false;.}
 .{.?j719;;false;.}
 Ш @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                        Сальдировано: │.{.?j720;&&&&&&&&&&&.&&│.}&'&&&&&&&&&&&&&.&& Ш
 .{.?j721;;false;.}
 Ш─────────────────────────────────────────────────────────────────────────────────────────────────┴.{.?j799;──────────────┴.}────────────────── Ш
.}

.fields
 a01
 TblGfiString(TblPeriods,IterNext(Ind),fName1)
 a02
 TblGfiString(TblPeriods,IterNext(Ind),fName2)
 If(AllKontr=0,'выбранным контрагентам:','контрагентам:')
 TblGfiDouble(TblPeriods,IterNext(Ind),fap3z)
 TblGfiDouble(TblPeriods,IterNext(Ind),fap3zk)
 TblGfiDouble(TblPeriods,IterNext(Ind),fap3zs)
 a3z
.endfields

 Ш──────────────────────────────────────────────────────────────────────────────────┬──────────────┬.{.?j900;──────────────┬.}────────────────── Ш
 Ш                                                             ДО продаж  на сумму: │&&&&&&&&&&&.&&│.{.?j901;@~@@@@@@@@@@@@│.} Итого фактическая Ш
 Ш                                                             ДО закупок на сумму: │&&&&&&&&&&&.&&│.{.?j902;@~@@@@@@@@@@@@│.}   задолженность Ш
 .{.?j903;;false;.}
 Ш                                                                                  └──────────────┼.{.?j909;──────────────┼.}────────────────── Ш
 Ш Итого по всем @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                                        По ДО:    │.{.?j910;&&&&&&&&&&&.&&│.} Ш
 .{.?j911;;false;.}
 .{.?j919;;false;.}
 Ш                                                                                По контрагентам: │.{.?j920;&&&&&&&&&&&.&&│.} Ш
 Ш                                                                                Сальдировано:    │.{.?j921;&&&&&&&&&&&.&&│.}&'&&&&&&&&&&&&&.&& Ш
 .{.?j922;;false;.}
 Ш─────────────────────────────────────────────────────────────────────────────────────────────────┴.{.?j999;──────────────┴.}────────────────── Ш
.begin IterDone(Ind); end.

*
.endform

!******************************************************************************************************************************************************************************************************************

