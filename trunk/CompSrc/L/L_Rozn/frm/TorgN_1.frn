!╔═════════════════════════════════════════════════════════════════════════╗
!║  Разработал:  Макс Голдин                                               ║
!║  Назначение:  форма №ТОРГ-1 "АКТ о приемке товаров"                     ║
!╚═════════════════════════════════════════════════════════════════════════╝


#doc
Акт о приемке товаров(форма №ТОРГ-1)
#end
.LinkForm 'TorgN_1' prototype is 'ReestrRZ'
.NameInList '3. Акт о приемке товаров(форма №ТОРГ-1)'
!===========================================================================
.DEFO PORTRAIT
.p 68
.var
  KolStr :Byte;  //количество строк на странице
.endvar
.begin
  KolStr :=68;   //не забудте исправить
end.
!===========================================================================
!.O1 8
.Set Filler ='-'
.var
  KolFItog, MassaBrFItog, MassaNetFItog, SumF2Itog, SumF3Itog, SumF4Itog :Double;
  Kol_Itog, MassaBr_Itog, MassaNet_Itog, Sum_2Itog, Sum_3Itog, Sum_4Itog :Double;
  Kol2Itog, MassaBr2Itog, MassaNet2Itog, Sum2Itog, Sum3Itog, Sum4Itog :Double;
  PrData, PrTara :Boolean;
  NomPp :Word;
  StrPos :Byte;
  Kol0Itog, MassaBr0Itog, MassaNet0Itog, Sum0Itog :Double;
  KolItog, MassaBrItog, MassaNetItog, SumItog :Double;
  Kol1Itog, MassaBr1Itog, MassaNet1Itog, Sum1Itog :Double;
.endvar
.begin
  PrData :=False;
  PrTara :=False;
end.
.fields
  CommonFormHeader
  Организация                     
  Организация_ОКПО
  Подразделение_получатель
  Организация_ОКОНХ

  DateToStr(Cur_Date, 'DD/MM/YYYY')  

  Руководитель_должность
  Руководитель_ФИО

  God

  Пункт_разгрузки

  God
  God
.endfields
.{
^
 Р                                                                                   Унифицированная форма №  ТОРГ-1 Р
 Р                                                                                   Утверждена постановлением Госкомстата Р
 Р                                                                                   России от 25.12.1998 г.  №  132 Р
 Р                                                                                                            ┌──────────┐ Р
 Р                                                                                                            │    Код   │ Р
 Р                                                                                                            ├──────────┤ Р
 Р                                                                                              Форма по ОКУД │  0330201 │ Р
 Р                                                                                                            ├──────────┤ Р
 РОрганизация:    Г@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Г  по ОКПО │@~@@@@@@@@│ Р
 Р               ─────────────────────────────────────────────────────────────────────────────────────────────┼──────────┤ Р
 РПодразделение:  Г@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Г  │          │ Р
 Р               ─────────────────────────────────────────────────────────────────────────────────────────────┼──────────┤ Р
 Р                                                                                   Вид деятельности по ОКДП │@~@@@@@@@@│ Р
 Р                                                                                                    ┌───────┼──────────┤ Р
 Р                                                                                               Номер│камера │          │ Р
 Р                                                                                                    ├───────┼──────────┤ Р
 Р                                                                                                    │секция │          │ Р
 Р                                                                                                    ├───────┼──────────┤ Р
 Р                    Основание для составления акта             приказ,  распоряжение                │ номер │          │ Р
 Р                                                   ─────────────────────────────────────────────────┼───────┼──┬──┬────┤ Р
 Р                                                                ненужное зачеркнуть                 │  дата │  │  │    │ Р
 Р                                                                                                    └───────┼──┴──┴────┤ Р
 Р                                                                                               Вид операции │          │ Р
 Р                                                                                                            └──────────┘ Р
 И                            ______________________ И
 И                           │   Номер  │   Дата    │ И
 И                            Д│ документа│составления│ Д         УТВЕРЖДАЮ И
 И                       АКТ │          │ @@@@@@@@@@│        Руководитель И
 И                           └──────────┴───────────┘ З@~@@@@@@@@@@@@@@@@@@@@@@@@@@ П
 И                о приемке товаров                            должность И
 И                                       ____________  З@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ П
 И                                          подпись          расшифровка подписи И
 И                                                       Б"__" ________ @@@@ г. Й

 ИМесто приемки товара  З @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ П
 ИНастоящий акт составлен комиссией, которая установила:  Б"__" ________ @@@@ г. Й
 Ипо сопроводительным документам ______________________________________________________ И
 И_____________________________________________________________________________________ И
 Идоставлен товар. Документ о вызове представителя  Х   грузоотправителя,  поставщика,  производителя: Х И
 И                                                          Рненужное зачеркнуть Ш
 И Х   телеграмма,  факс,  телефонограмма,  радиограмма    Х  №  Б__________ Б от  Б"__" ________ @@@@ г. Й
.fields
  Грузоотправитель
.endfields
 РГрузоотправитель  З@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Ч
 РПроизводитель    _______________________________________________________________________________________________________ Р
.fields
  Поставщик
.endfields
 РПоставщик         З@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Ч
 РСтраховая компания _____________________________________________________________________________________________________ Р
.fields
  if(Номер_договора <> '', Номер_договора, '')

  if(LongInt(Дата_договора) <> LongInt(0),
     DateToStr(Дата_договора, 'DD'), '')
  if(LongInt(Дата_договора) <> LongInt(0),
     DateToStr(Дата_договора, 'mon'), '')
  if(LongInt(Дата_договора) <> LongInt(0),
     DateToStr(Дата_договора, 'YYYY'), God)
.endfields
 ИДоговор(контракт) на поставку товара №  З@@@@@@@@@@ З от " З@@ З"  З@~@@@@@@ З  Б@@@@ г. Й
.fields
  if(Номер_счет_фактуры <> '', Номер_счет_фактуры, '')

  if(LongInt(Дата_счет_фактуры) <> LongInt(0),
     DateToStr(Дата_счет_фактуры, 'DD'), '')
  if(LongInt(Дата_счет_фактуры) <> LongInt(0),
     DateToStr(Дата_счет_фактуры, 'mon'), '')
  if(LongInt(Дата_счет_фактуры) <> LongInt(0),
     DateToStr(Дата_счет_фактуры, 'YYYY'), God)

  God
  God
.endfields
Счет - фактура №  З@@@@@@@@@@ З от " З@@ З"  З@~@@@@@@ З  Б@@@@ г. Б
Коммерческий акт  №  Б__________ Б от  Б"__" ________ @@@@ г. Б
Ветеринарное свидетельство №  Б__________ Б от  Б"__" ________ @@@@ г. Б
.fields
  Номер_накладной

  DateToStr(Дата_накладной, 'DD')
  DateToStr(Дата_накладной, 'mon')
  DateToStr(Дата_накладной, 'YYYY')
.endfields
Железнодорожная накладная  №  З@@@@@@@@@@ З от " З@@ З"  З@~@@@@@@ З  Б@@@@ г. Б
.fields
  Автомобиль
  if(Номер_автомобиля <> '', Номер_автомобиля, '')
.endfields
Способ доставки  З@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ З №  З@@@@@@@@@@@ З
                              Швид транспортного средства Ш
.fields
  if(LongInt(Дата_окончания_погрузки) <> LongInt(0),
     DateToStr(Дата_окончания_погрузки, 'DD'), '')
  if(LongInt(Дата_окончания_погрузки) <> LongInt(0),
     DateToStr(Дата_окончания_погрузки, 'mon'), '')
  if(LongInt(Дата_окончания_погрузки) <> LongInt(0),
     DateToStr(Дата_окончания_погрузки, 'YYYY г.(day)'), God+' г.')

  Пункт_погрузки
.endfields
 ИДата отправления товара " З@@ З"  З@~@@@@@@ З  Б^ Й
 Исо станции(пристани, порта) отправления _____________________________________________ И
 Иили со склада отправителя товара  З@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ П
 ИТемпература в толще мяса (рыбы) ________________ °С И
.fields
  if(LongInt(Дата_начала_разгрузки) <> LongInt(0),
     DateToStr(Дата_начала_разгрузки, 'DD/MM/YYYY'), '') +
   if(LongInt(Время_начала_разгрузки) <> LongInt(0),
      TimeToStr(Время_начала_разгрузки, ' в HH:MM'), '')

  if(LongInt(Дата_окончания_разгрузки) <> LongInt(0),
     DateToStr(Дата_окончания_разгрузки, 'DD/MM/YYYY'), '')+
   if(LongInt(Время_окончания_разгрузки) <> LongInt(0),
      TimeToStr(Время_окончания_разгрузки, ' в HH:MM'), '')
.endfields
 Р┌──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐ Р
 Р│                                                 Дата, время, ч. мин.                                                 │ Р
 Р├───────────────────────┬──────────────────────────────────────────────────────────────────────────────────────────────┤ Р
 Р│    прибытия товара    │                                       приемки товара                                         │ Р
 Р├───────────────────────┼──────────────────────┬───────────────────────┬───────────────────────┬───────────────────────┤ Р
 Р│                       │        начало        │    приостановление    │     возобновление     │       окончание       │ Р
 Р├───────────────────────┼──────────────────────┼───────────────────────┼───────────────────────┼───────────────────────┤ Р
 Р│                       │@~@@@@@@@@@@@@@@@@@@@@│                       │                       │@~@@@@@@@@@@@@@@@@@@@@@│ Р
 Р└───────────────────────┴──────────────────────┴───────────────────────┴───────────────────────┴───────────────────────┘ Р
!
!****************************************************************************

!********************** 2-я страница формы N ТОРГ-1 *************************

!--------------------------- Цикл по данным ----------------------------------
.{
.fields
   String(NomPp)+'.'+Название_МЦ1 :'D:R'
   Код_МЦ1 :'D:R'
   ед_измерения1 :'D:R'

   CenaNoNDS

   Количество_в_одном_месте1
   Учетное_количество_мест1
   Вес_брутто1 * Количество_всего_учетное1
   Вес_нетто1 * Количество_всего_учетное1
   CenaNoNDS * Количество_всего_учетное1

   Сертификат_качества1 :'D:R'
.endfields
.[h
.begin
  StrPos :=10;

  Kol1Itog      :=0;
  MassaBr1Itog  :=0;
  MassaNet1Itog :=0;
  Sum1Itog      :=0;
end.
 Ш┌─────────────────────────────────────────────────┬───────┬──────────────┬────────────┬────────────────────────────────────────────────────────────┐ Ш
 Ш│                     Товар                       │       │Един.измерения│            │             По документам поставщика значилось             │ Ш
 Ш├───────────────────────────────────┬─────────────┤Катего-├───────┬──────┤            ├───────────────────────┬─────────────────────┬──────────────┤ Ш
 Ш│                                   │             │  рия  │наиме- │ код  │    Цена,   │       количество      │         масса       │              │ Ш
 Ш│          Наименование             │     Код     │ сорт  │нование│  по  │  руб. коп. ├───────────┬───────────┼──────────┬──────────┤   стоимость  │ Ш
 Ш│                                   │             │       │       │ ОКЕИ │            │  в одном  │   мест,   │  брутто  │  нетто   │   руб. коп.  │ Ш
 Ш│                                   │             │       │       │      │            │   месте   │   штук    │          │          │              │ Ш
 Ш├───────────────────────────────────┼─────────────┼───────┼───────┼──────┼────────────┼───────────┼───────────┼──────────┼──────────┼──────────────┤ Ш
 Ш│               1                   │      2      │   3   │   4   │  5   │     6      │     7     │     8     │    9     │    10    │      11      │ Ш
 Ш├───────────────────────────────────┼─────────────┼───────┼───────┼──────┼────────────┼───────────┼───────────┼──────────┼──────────┼──────────────┤ Ш
.]h
.{?INTERNAL;(Код_группы_МЦ1 <> Код_группы_МЦ_тара);
.begin
  PrData :=True;

  KolItog       :=KolItog + Учетное_количество_мест1;
  MassaBrItog   :=MassaBrItog + Вес_брутто1 * Количество_всего_учетное1;
  MassaNetItog  :=MassaNetItog + Вес_нетто1 * Количество_всего_учетное1;
  SumItog       :=SumItog + CenaNoNDS * Количество_всего_учетное1;

  Kol1Itog      :=Kol1Itog + Учетное_количество_мест1;
  MassaBr1Itog  :=MassaBr1Itog + Вес_брутто1 * Количество_всего_учетное1;
  MassaNet1Itog :=MassaNet1Itog + Вес_нетто1 * Количество_всего_учетное1;
  Sum1Itog      :=Sum1Itog + CenaNoNDS * Количество_всего_учетное1;

  StrPos :=StrPos + 2;
  NomPp  :=NomPp + 1;
end.
 Ш│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│&&&&&&&&&&&&&│       │@~@@@@@│      │&#'&&&&&&.&&│&#'&&&&.&&&│&#'&&&&.&&&│&#'&&&.&&&│&#'&&&.&&&│&#'&&&&&&&&.&&│ Ш
 Ш│Сертификат  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@  Ш
.}
.{?INTERNAL;(Код_группы_МЦ1 = Код_группы_МЦ_тара);
.begin
  PrTara :=True;
end.
.}
.[f
.{?INTERNAL;(PrData);
.fields
  Kol1Itog      
  MassaBr1Itog  
  MassaNet1Itog 
  Sum1Itog
.endfields
.begin
  StrPos :=StrPos + 3;
end.
 Ш└─────────────────────────────────────────────────────────────────────────────────────────────────┬───────────┬──────────┬──────────┬──────────────┐ Ш
 Ш                                                                                     Итого товара │&#'&&&&.&&&│&#'&&&.&&&│&#'&&&.&&&│&#'&&&&&&&&.&&│ Ш
 Ш                                                                                                  └───────────┴──────────┴──────────┴──────────────┘ Ш
.}
.]f
.}
!----------------------------------------------------------------------------
!-------------------------------- всего данных ------------------------------
.{?INTERNAL;(PrData);
.fields
  KolItog      
  MassaBrItog  
  MassaNetItog 
  SumItog
.endfields
.begin
  StrPos :=StrPos + 3;
end.
 Ш                                                                                                  ┌───────────┬──────────┬──────────┬──────────────┐ Ш
 Ш                                                                        Всего товара по накладной │&#'&&&&.&&&│&#'&&&.&&&│&#'&&&.&&&│&#'&&&&&&&&.&&│ Ш
 Ш                                                                                                  └───────────┴──────────┴──────────┴──────────────┘ Ш
.}
!----------------------------------------------------------------------------
.{?INTERNAL;(PrTara);
.begin
  Kol0Itog      :=KolItog;
  MassaBr0Itog  :=MassaBrItog;
  MassaNet0Itog :=MassaNetItog;
  Sum0Itog      :=SumItog;

  KolItog      :=0;
  MassaBrItog  :=0;
  MassaNetItog :=0;
  SumItog      :=0;

  Kol1Itog      :=0;
  MassaBr1Itog  :=0;
  MassaNet1Itog :=0;
  Sum1Itog      :=0;

  StrPos :=StrPos + 3;
end.
 Ш┌───────────────────────────────────┬─────────────┬───────┬───────┬──────┬────────────┬───────────┬───────────┬──────────┬──────────┬──────────────┐ Ш
 Ш│              Тара                 │      2      │   3   │   4   │  5   │     6      │     7     │     8     │    9     │    10    │      11      │ Ш
 Ш├───────────────────────────────────┼─────────────┼───────┼───────┼──────┼────────────┼───────────┼───────────┼──────────┼──────────┼──────────────┤ Ш
.}
!----------------------------------------------------------------------------
!-------------------------------- Цикл по таре ------------------------------
.{
.fields
   String(NomPp)+'.'+Название_МЦ2 :'D:R'
   Код_МЦ2 :'D:R'
   ед_измерения2 :'D:R'

   CenaNoNDS
   Количество_в_одном_месте2
   Учетное_количество_мест2
   Вес_брутто2 * Количество_всего_учетное2
   Вес_нетто2 * Количество_всего_учетное2
   CenaNoNDS * Количество_всего_учетное2
.endfields
.[h Skip
.begin
  StrPos :=10;

  Kol1Itog      :=0;
  MassaBr1Itog  :=0;
  MassaNet1Itog :=0;
  Sum1Itog      :=0;
end.
 Ш┌─────────────────────────────────────────────────┬───────┬──────────────┬────────────┬────────────────────────────────────────────────────────────┐ Ш
 Ш│                     Тара                        │       │Един.измерения│            │             По документам поставщика значилось             │ Ш
 Ш├───────────────────────────────────┬─────────────┤Катего-├───────┬──────┤            ├───────────────────────┬─────────────────────┬──────────────┤ Ш
 Ш│                                   │             │  рия  │наиме- │ код  │    Цена,   │       количество      │         масса       │              │ Ш
 Ш│          Наименование             │     Код     │ сорт  │нование│  по  │  руб. коп. ├───────────┬───────────┼──────────┬──────────┤   стоимость  │ Ш
 Ш│                                   │             │       │       │ ОКЕИ │            │  в одном  │   мест,   │  брутто  │  нетто   │   руб. коп.  │ Ш
 Ш│                                   │             │       │       │      │            │   месте   │   штук    │          │          │              │ Ш
 Ш├───────────────────────────────────┼─────────────┼───────┼───────┼──────┼────────────┼───────────┼───────────┼──────────┼──────────┼──────────────┤ Ш
 Ш│               1                   │      2      │   3   │   4   │  5   │     6      │     7     │     8     │    9     │    10    │      11      │ Ш
 Ш├───────────────────────────────────┼─────────────┼───────┼───────┼──────┼────────────┼───────────┼───────────┼──────────┼──────────┼──────────────┤ Ш
.]h
.{?INTERNAL;(Код_группы_МЦ2 = Код_группы_МЦ_тара);
.begin
  KolItog       :=KolItog + Учетное_количество_мест2;
  MassaBrItog   :=MassaBrItog + Вес_брутто2 * Количество_всего_учетное2;
  MassaNetItog  :=MassaNetItog + Вес_нетто2 * Количество_всего_учетное2;
  SumItog       :=SumItog + CenaNoNDS * Количество_всего_учетное2;

  Kol1Itog      :=Kol1Itog + Учетное_количество_мест2;
  MassaBr1Itog  :=MassaBr1Itog + Вес_брутто2 * Количество_всего_учетное2;
  MassaNet1Itog :=MassaNet1Itog + Вес_нетто2 * Количество_всего_учетное2;
  Sum1Itog      :=Sum1Itog + CenaNoNDS * Количество_всего_учетное2;

  StrPos :=StrPos + 1;
  NomPp  :=NomPp + 1;
end.
 Ш│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│&&&&&&&&&&&&&│       │@~@@@@@│      │&#'&&&&&&.&&│&#'&&&&.&&&│&#'&&&&.&&&│&#'&&&.&&&│&#'&&&.&&&│&#'&&&&&&&&.&&│ Ш
.}
.[f
.{?INTERNAL;(PrTara);
.fields
  Kol1Itog      
  MassaBr1Itog  
  MassaNet1Itog 
  Sum1Itog
.endfields
.begin
  StrPos :=StrPos + 3;
end.
 Ш└───────────────────────────────────┴─────────────┴───────┴───────┴──────┴────────────┴───────────┼───────────┼──────────┼──────────┼──────────────┤ Ш
 Ш                                                                                       Итого тары │&#'&&&&.&&&│&#'&&&.&&&│&#'&&&.&&&│&#'&&&&&&&&.&&│ Ш
 Ш                                                                                                  └───────────┴──────────┴──────────┴──────────────┘ Ш
.}
.]f
.}
!----------------------------------------------------------------------------
!-------------------------------- Всего тары --------------------------------
.{?INTERNAL;(PrTara);
.fields
  KolItog      
  MassaBrItog  
  MassaNetItog 
  SumItog
.endfields
.begin
  StrPos :=StrPos + 3;
end.
 Ш                                                                                                  ┌───────────┬──────────┬──────────┬──────────────┐ Ш
 Ш                                                                          Всего тары по накладной │&#'&&&&.&&&│&#'&&&.&&&│&#'&&&.&&&│&#'&&&&&&&&.&&│ Ш
 Ш                                                                                                  └───────────┴──────────┴──────────┴──────────────┘ Ш
.}
!----------------------------------------------------------------------------
!-------------------------------- Всего -------------------------------------
.begin
  StrPos :=StrPos + 5;
end.
.fields
  Kol0Itog + KolItog
  MassaBr0Itog + MassaBrItog
  MassaNet0Itog + MassaNetItog
  Sum0Itog + SumItog
.endfields
 Ш┌───────────────────────────────────┬─────────────┬───────┬───────┬──────┬────────────┬───────────┬───────────┬──────────┬──────────┬──────────────┐ Ш
 Ш│              Тариф                │             │       │       │      │            │           │           │          │          │              │ Ш
 Ш└───────────────────────────────────┴─────────────┴───────┴───────┴──────┴────────────┴───────────┼───────────┼──────────┼──────────┼──────────────┤ Ш
 Ш                                                                               Всего по накладной │&#'&&&&.&&&│&#'&&&.&&&│&#'&&&.&&&│&#'&&&&&&&&.&&│ Ш
 Ш                                                                                                  └───────────┴──────────┴──────────┴──────────────┘ Ш

 И_____________________________________________________________________________________ И
 И_____________________________________________________________________________________ И
 ИСостояние товара, тары и упаковки в момент осмотра __________________________________ И
 И_____________________________________________________________________________________ И
 И_____________________________________________________________________________________ И
 ИСпособ определения недостающего товара ______________________________________________ И
 ИЗаключение о причинах и месте образования недостачи товара __________________________ И
 И_____________________________________________________________________________________ И
 И_____________________________________________________________________________________ И
 И_____________________________________________________________________________________ И
!----------------------------------------------------------------------------
!---------------- добиваю пустыми строками до конца страницы ----------------
.begin
  StrPos :=StrPos +10;

  //строк осталось до конца страницы
  if StrPos > KolStr
   StrPos :=2 * KolStr - StrPos;
  else
  StrPos :=KolStr - StrPos;  
end.
.{while StrPos <> 0

.begin
  StrPos :=StrPos - 1;
end.
.}
!****************************************************************************
!********************** 3-я страница формы N ТОРГ-1 *************************
.begin
  Kol0Itog      :=0;
  MassaBr0Itog  :=0;
  MassaNet0Itog :=0;
  Sum0Itog      :=0;

  KolItog       :=0;
  MassaBrItog   :=0;
  MassaNetItog  :=0;
  SumItog       :=0;

  Kol1Itog      :=0;
  MassaBr1Itog  :=0;
  MassaNet1Itog :=0;
  Sum1Itog      :=0;
end.
!----------------------------------------------------------------------------
!----------------------------- Цикл по данным -------------------------------
.{
.fields
  Количество_в_одном_месте3
  Фактическое_количество_мест3
  Вес_брутто3 * Количество_всего_фактическое3
  Вес_нетто3 * Количество_всего_фактическое3
  CenaNoNDS * Количество_всего_фактическое3

  SumWithNDS
  Ставка_налога_НДС3
  cумма_вход_НДС3

  // отклонения
  if((Фактическое_количество_мест3 - Учетное_количество_мест3) <> 0,
      Количество_в_одном_месте3, 0)
  Фактическое_количество_мест3 - Учетное_количество_мест3
  Вес_брутто3   * (Фактическое_количество_мест3 - Учетное_количество_мест3)
  Вес_нетто3    * (Фактическое_количество_мест3 - Учетное_количество_мест3)
  CenaNoNDS * (Фактическое_количество_мест3 - Учетное_количество_мест3)
.endfields
.[h 
.begin
  Kol1Itog      :=0;
  MassaBr1Itog  :=0;
  MassaNet1Itog :=0;
  Sum1Itog      :=0;

  Kol2Itog      :=0;
  MassaBr2Itog  :=0;
  MassaNet2Itog :=0;
  Sum2Itog      :=0;

  Sum3Itog      :=0;
  Sum4Itog      :=0;
end.
 Ш┌─────────────────────────────────────────────────────────┬──────────────┬──────────────────┬──────────────────────────────────────────────────────┐ Ш
 Ш│                  Фактически принято                     │              │       НДС        │                   Отклонение (+, -)                  │ Ш
 Ш├─────────────────────┬─────────────────────┬─────────────┤              ├─────┬────────────┼───────────────────┬─────────────────────┬────────────┤ Ш
 Ш│      количество     │         масса       │             │Сумма с учетом│     │            │     количество    │         масса       │            │ Ш
 Ш├──────────┬──────────┼──────────┬──────────┤  стоимость, │     НДС,     │став-│   Сумма,   ├─────────┬─────────┼──────────┬──────────┤ стоимость, │ Ш
 Ш│ в одном  │   мест,  │  брутто  │  нетто   │  руб. коп.  │   руб. коп.  │ка, %│  руб. коп. │ в одном │  мест,  │  брутто  │  нетто   │ руб. коп.  │ Ш
 Ш│  месте   │   штук   │          │          │             │              │     │            │  месте  │  штук   │          │          │            │ Ш
 Ш├──────────┼──────────┼──────────┼──────────┼─────────────┼──────────────┼─────┼────────────┼─────────┼─────────┼──────────┼──────────┼────────────┤ Ш
 Ш│    12    │    13    │    14    │    15    │     16      │      17      │ 18  │     19     │   20    │   21    │    22    │    23    │     24     │ Ш
 Ш├──────────┼──────────┼──────────┼──────────┼─────────────┼──────────────┼─────┼────────────┼─────────┼─────────┼──────────┼──────────┼────────────┤ Ш
.]h
.{?INTERNAL;(Код_группы_МЦ3 <> Код_группы_МЦ_тара);
.begin
  KolItog       :=KolItog + Учетное_количество_мест3;
  MassaBrItog   :=MassaBrItog + Вес_брутто3 * Количество_всего_учетное3;
  MassaNetItog  :=MassaNetItog + Вес_нетто3 * Количество_всего_учетное3;
  SumItog       :=SumItog + CenaNoNDS * Количество_всего_учетное3;

  Kol1Itog      :=Kol1Itog + Учетное_количество_мест3;
  MassaBr1Itog  :=MassaBr1Itog + Вес_брутто3 * Количество_всего_учетное3;
  MassaNet1Itog :=MassaNet1Itog + Вес_нетто3 * Количество_всего_учетное3;
  Sum1Itog      :=Sum1Itog + CenaNoNDS * Количество_всего_учетное3;

  SumF3Itog     :=SumF3Itog + SumWithNDS;
  SumF4Itog     :=SumF4Itog + cумма_вход_НДС3;

  Sum3Itog      :=Sum3Itog + SumWithNDS;
  Sum4Itog      :=Sum4Itog + cумма_вход_НДС3;

  KolFItog      :=KolFItog + Фактическое_количество_мест3;
  MassaBrFItog  :=MassaBrFItog + Вес_брутто3 * Количество_всего_фактическое3;
  MassaNetFItog :=MassaNetFItog + Вес_нетто3 * Количество_всего_фактическое3;
  SumF2Itog     :=SumF2Itog + CenaNoNDS * Количество_всего_фактическое3;

  Kol2Itog      :=Kol2Itog + Фактическое_количество_мест3;
  MassaBr2Itog  :=MassaBr2Itog + Вес_брутто3 * Количество_всего_фактическое3;
  MassaNet2Itog :=MassaNet2Itog + Вес_нетто3 * Количество_всего_фактическое3;
  Sum2Itog      :=Sum2Itog + CenaNoNDS * Количество_всего_фактическое3;
end.
 Ш│&#'&&&.&&&│&#'&&&.&&&│&#'&&&.&&&│&#'&&&.&&&│&#'&&&&&&&.&&│&#'&&&&&&&&.&&│&#.&&│&#'&&&&&&.&&│&#'&&.&&&│&#'&&.&&&│&#'&&&.&&&│&#'&&&.&&&│&#'&&&&&&.&&│ Ш
 Ш                                                                                                                                                   │ Ш
.}
.[f
.{?INTERNAL;(PrData);
.fields
  Kol2Itog      
  MassaBr2Itog  
  MassaNet2Itog 
  Sum2Itog

  Sum3Itog
  Sum4Itog

  Kol2Itog - Kol1Itog     
  MassaBr2Itog - MassaBr1Itog  
  MassaNet2Itog - MassaNet1Itog
  Sum2Itog - Sum1Itog
.endfields
 Ш┌──────────┬──────────┬──────────┬──────────┬─────────────┬──────────────┬─────┬────────────┬─────────┬─────────┬──────────┬──────────┬────────────┤ Ш
 Ш│          │&#'&&&.&&&│&#'&&&.&&&│&#'&&&.&&&│&#'&&&&&&&.&&│&#'&&&&&&&&.&&│     │&#'&&&&&&.&&│         │&#'&&.&&&│&#'&&&.&&&│&#'&&&.&&&│&#'&&&&&&.&&│ Ш
 Ш└──────────┴──────────┴──────────┴──────────┴─────────────┴──────────────┴─────┴────────────┴─────────┴─────────┴──────────┴──────────┴────────────┘ Ш
.}
.]f
.}
!----------------------------------------------------------------------------
!------------------------------- Всего данных -------------------------------
.{?INTERNAL;(PrData);
.fields
  KolFItog      
  MassaBrFItog  
  MassaNetFItog 
  SumF2Itog

  SumF3Itog
  SumF4Itog

  KolFItog - KolItog     
  MassaBrFItog - MassaBrItog  
  MassaNetFItog - MassaNetItog
  SumF2Itog - SumItog
.endfields
 Ш┌──────────┬──────────┬──────────┬──────────┬─────────────┬──────────────┬─────┬────────────┬─────────┬─────────┬──────────┬──────────┬────────────┐ Ш
 Ш│          │&#'&&&.&&&│&#'&&&.&&&│&#'&&&.&&&│&#'&&&&&&&.&&│&#'&&&&&&&&.&&│     │&#'&&&&&&.&&│         │&#'&&.&&&│&#'&&&.&&&│&#'&&&.&&&│&#'&&&&&&.&&│ Ш
 Ш└──────────┴──────────┴──────────┴──────────┴─────────────┴──────────────┴─────┴────────────┴─────────┴─────────┴──────────┴──────────┴────────────┘ Ш
.}
!----------------------------------------------------------------------------
.{?INTERNAL;(PrTara);
.begin
  Kol0Itog      :=KolItog;
  MassaBr0Itog  :=MassaBrItog;
  MassaNet0Itog :=MassaNetItog;
  Sum0Itog      :=SumItog;

  KolItog       :=0;
  MassaBrItog   :=0;
  MassaNetItog  :=0;
  SumItog       :=0;

  Kol1Itog      :=0;
  MassaBr1Itog  :=0;
  MassaNet1Itog :=0;
  Sum1Itog      :=0;

  Kol_Itog      :=KolFItog;
  MassaBr_Itog  :=MassaBrFItog;
  MassaNet_Itog :=MassaNetFItog;
  Sum_2Itog     :=SumF2Itog;
  Sum_3Itog     :=SumF3Itog;
  Sum_4Itog     :=SumF4Itog;

  KolFItog      :=0;
  MassaBrFItog  :=0;
  MassaNetFItog :=0;
  SumF2Itog     :=0;
  SumF3Itog     :=0;
  SumF4Itog     :=0;

  Kol2Itog      :=0;
  MassaBr2Itog  :=0;
  MassaNet2Itog :=0;
  Sum2Itog      :=0;
  Sum3Itog      :=0;
  Sum4Itog      :=0;
end.
 Ш┌──────────┬──────────┬──────────┬──────────┬─────────────┬──────────────┬─────┬────────────┬─────────┬─────────┬──────────┬──────────┬────────────┐ Ш
 Ш│    12    │    13    │    14    │    15    │     16      │      17      │ 18  │     19     │   20    │   21    │    22    │    23    │     24     │ Ш
 Ш├──────────┼──────────┼──────────┼──────────┼─────────────┼──────────────┼─────┼────────────┼─────────┼─────────┼──────────┼──────────┼────────────┤ Ш
.}
!----------------------------------------------------------------------------
!------------------------------- Цикл по таре -------------------------------
.{
.fields
  Количество_в_одном_месте4
  Фактическое_количество_мест4
  Вес_брутто4 * Количество_всего_фактическое4
  Вес_нетто4 * Количество_всего_фактическое4
  CenaNoNDS * Количество_всего_фактическое4

  Цена_единицы4 * Количество_всего_фактическое4
  Ставка_налога_НДС4
  cумма_вход_НДС4

  // отклонения
  if((Фактическое_количество_мест4 - Учетное_количество_мест4) <> 0,
      Количество_в_одном_месте4, 0)
  Фактическое_количество_мест4 - Учетное_количество_мест4
  Вес_брутто4   * (Фактическое_количество_мест4 - Учетное_количество_мест4)
  Вес_нетто4    * (Фактическое_количество_мест4 - Учетное_количество_мест4)
  CenaNoNDS * (Фактическое_количество_мест4 - Учетное_количество_мест4)
.endfields
.[h Skip
.begin
  Kol1Itog      :=0;
  MassaBr1Itog  :=0;
  MassaNet1Itog :=0;
  Sum1Itog      :=0;
  Kol2Itog      :=0;
  MassaBr2Itog  :=0;
  MassaNet2Itog :=0;
  Sum2Itog      :=0;
  Sum3Itog      :=0;
  Sum4Itog      :=0;
end.
 Ш┌─────────────────────────────────────────────────────────┬──────────────┬──────────────────┬──────────────────────────────────────────────────────┐ Ш
 Ш│                  Фактически принято                     │              │       НДС        │                   Отклонение (+, -)                  │ Ш
 Ш├─────────────────────┬─────────────────────┬─────────────┤              ├─────┬────────────┼───────────────────┬─────────────────────┬────────────┤ Ш
 Ш│      количество     │         масса       │             │Сумма с учетом│     │            │     количество    │         масса       │            │ Ш
 Ш├──────────┬──────────┼──────────┬──────────┤  стоимость, │     НДС,     │став-│   Сумма,   ├─────────┬─────────┼──────────┬──────────┤ стоимость, │ Ш
 Ш│ в одном  │   мест,  │  брутто  │  нетто   │  руб. коп.  │  руб. коп.   │ка, %│  руб. коп. │ в одном │  мест,  │  брутто  │  нетто   │ руб. коп.  │ Ш
 Ш│  месте   │   штук   │          │          │             │              │     │            │  месте  │  штук   │          │          │            │ Ш
 Ш├──────────┼──────────┼──────────┼──────────┼─────────────┼──────────────┼─────┼────────────┼─────────┼─────────┼──────────┼──────────┼────────────┤ Ш
 Ш│    12    │    13    │    14    │    15    │     16      │      17      │ 18  │     19     │   20    │   21    │    22    │    23    │     24     │ Ш
 Ш├──────────┼──────────┼──────────┼──────────┼─────────────┼──────────────┼─────┼────────────┼─────────┼─────────┼──────────┼──────────┼────────────┤ Ш
 Ш│          │          │          │          │             │              │     │            │         │         │          │          │            │ Ш
 Ш├──────────┼──────────┼──────────┼──────────┼─────────────┼──────────────┼─────┼────────────┼─────────┼─────────┼──────────┼──────────┼────────────┤ Ш
.]h
.{?INTERNAL;(Код_группы_МЦ4 = Код_группы_МЦ_тара);
.begin
  KolItog       :=KolItog + Учетное_количество_мест4;
  MassaBrItog   :=MassaBrItog + Вес_брутто4 * Количество_всего_учетное4;
  MassaNetItog  :=MassaNetItog + Вес_нетто4 * Количество_всего_учетное4;
  SumItog       :=SumItog + CenaNoNDS * Количество_всего_учетное4;

  Kol1Itog      :=Kol1Itog + Учетное_количество_мест4;
  MassaBr1Itog  :=MassaBr1Itog + Вес_брутто4 * Количество_всего_учетное4;
  MassaNet1Itog :=MassaNet1Itog + Вес_нетто4 * Количество_всего_учетное4;
  Sum1Itog      :=Sum1Itog + CenaNoNDS * Количество_всего_учетное4;

  SumF3Itog     :=SumF3Itog + SumWithNDS;
  SumF4Itog     :=SumF4Itog + cумма_вход_НДС4;

  Sum3Itog      :=Sum3Itog + SumWithNDS;
  Sum4Itog      :=Sum4Itog + cумма_вход_НДС4;

  KolFItog      :=KolFItog + Фактическое_количество_мест4;
  MassaBrFItog  :=MassaBrFItog + Вес_брутто4 * Количество_всего_фактическое4;
  MassaNetFItog :=MassaNetFItog + Вес_нетто4 * Количество_всего_фактическое4;
  SumF2Itog     :=SumF2Itog + CenaNoNDS * Количество_всего_фактическое4;

  Kol2Itog      :=Kol2Itog + Фактическое_количество_мест4;
  MassaBr2Itog  :=MassaBr2Itog + Вес_брутто4 * Количество_всего_фактическое4;
  MassaNet2Itog :=MassaNet2Itog + Вес_нетто4 * Количество_всего_фактическое4;
  Sum2Itog      :=Sum2Itog + CenaNoNDS * Количество_всего_фактическое4;
end.
 Ш│&#'&&&.&&&│&#'&&&.&&&│&#'&&&.&&&│&#'&&&.&&&│&#'&&&&&&&.&&│&#'&&&&&&&&.&&│&#.&&│&#'&&&&&&.&&│&#'&&.&&&│&#'&&.&&&│&#'&&&.&&&│&#'&&&.&&&│&#'&&&&&&.&&│ Ш
.}
.[f
.{?INTERNAL;(PrTara);
.fields
  Kol2Itog      
  MassaBr2Itog  
  MassaNet2Itog 
  Sum2Itog

  Sum3Itog
  Sum4Itog

  Kol2Itog - Kol1Itog     
  MassaBr2Itog - MassaBr1Itog  
  MassaNet2Itog - MassaNet1Itog
  Sum2Itog - Sum1Itog
.endfields
 Ш├──────────┼──────────┼──────────┼──────────┼─────────────┼──────────────┼─────┼────────────┼─────────┼─────────┼──────────┼──────────┼────────────┤ Ш
 Ш│          │&#'&&&.&&&│&#'&&&.&&&│&#'&&&.&&&│&#'&&&&&&&.&&│&#'&&&&&&&&.&&│     │&#'&&&&&&.&&│         │&#'&&.&&&│&#'&&&.&&&│&#'&&&.&&&│&#'&&&&&&.&&│ Ш
 Ш└──────────┴──────────┴──────────┴──────────┴─────────────┴──────────────┴─────┴────────────┴─────────┴─────────┴──────────┴──────────┴────────────┘ Ш
.}
.]f
.}
!----------------------------------------------------------------------------
!-------------------------------- всего тары --------------------------------
.{?INTERNAL;(PrTara);
.fields
  KolFItog      
  MassaBrFItog  
  MassaNetFItog 
  SumF2Itog

  SumF3Itog
  SumF4Itog

  KolFItog - KolItog     
  MassaBrFItog - MassaBrItog  
  MassaNetFItog - MassaNetItog
  SumF2Itog - SumItog
.endfields
 Ш┌──────────┬──────────┬──────────┬──────────┬─────────────┬──────────────┬─────┬────────────┬─────────┬─────────┬──────────┬──────────┬────────────┐ Ш
 Ш│          │&#'&&&.&&&│&#'&&&.&&&│&#'&&&.&&&│&#'&&&&&&&.&&│&#'&&&&&&&&.&&│     │&#'&&&&&&.&&│         │&#'&&.&&&│&#'&&&.&&&│&#'&&&.&&&│&#'&&&&&&.&&│ Ш
 Ш└──────────┴──────────┴──────────┴──────────┴─────────────┴──────────────┴─────┴────────────┴─────────┴─────────┴──────────┴──────────┴────────────┘ Ш
.}
!----------------------------------------------------------------------------
!---------------------------------- всего -----------------------------------
.fields
  Kol_Itog + KolFItog     
  MassaBr_Itog + MassaBrFItog
  MassaNet_Itog + MassaNetFItog
  Sum_2Itog + SumF2Itog

  Sum_3Itog + SumF3Itog
  Sum_4Itog + SumF4Itog

  (Kol_Itog + KolFItog) - (Kol0Itog + KolItog)
  (MassaBr_Itog + MassaBrFItog) - (MassaBr0Itog + MassaBrItog)
  (MassaNet_Itog + MassaNetFItog) - (MassaNet0Itog + MassaNetItog)
  (Sum_2Itog + SumF2Itog) - (Sum0Itog + SumItog)
.endfields
 Ш┌──────────┬──────────┬──────────┬──────────┬─────────────┬──────────────┬─────┬────────────┬─────────┬─────────┬──────────┬──────────┬────────────┐ Ш
 Ш│          │          │          │          │             │              │     │            │         │         │          │          │            │ Ш
 Ш├──────────┼──────────┼──────────┼──────────┼─────────────┼──────────────┼─────┼────────────┼─────────┼─────────┼──────────┼──────────┼────────────┤ Ш
 Ш│          │&#'&&&.&&&│&#'&&&.&&&│&#'&&&.&&&│&#'&&&&&&&.&&│&#'&&&&&&&&.&&│     │&#'&&&&&&.&&│         │&#'&&.&&&│&#'&&&.&&&│&#'&&&.&&&│&#'&&&&&&.&&│ Ш
 Ш└──────────┴──────────┴──────────┴──────────┴─────────────┴──────────────┴─────┴────────────┴─────────┴─────────┴──────────┴──────────┴────────────┘ Ш
 И_____________________________________________________________________________________ И
 И_____________________________________________________________________________________ И
 И_____________________________________________________________________________________ И
 И_____________________________________________________________________________________ И
 И_____________________________________________________________________________________ И
 И_____________________________________________________________________________________ И
 И_____________________________________________________________________________________ И
 И_____________________________________________________________________________________ И
 И_____________________________________________________________________________________ И
 И_____________________________________________________________________________________ И
!****************************************************************************
!********************* 4-я страница формы N ТОРГ-1 **************************
.fields
  'true' : 's'
.endfields
 И^  Все члены комиссии ознакомлены с правилами приемки товаров по количеству и качеству И
 Ии предупреждены об ответственности за подписание акта, содержащего данные, не соответ- И
 Иствующие действительности. И

     Правильность количества и качества товара подтверждаем.

 ИПредседатель комиссии ___________________________ __________ ________________________ И
 И                        место работы,должность      подпись     расшифровка подписи И
 ИЧлены комиссии:       ___________________________ __________ ________________________ И
 И                        место работы,должность      подпись     расшифровка подписи И
 И                      ___________________________ __________ ________________________ И
 И                        место работы,должность      подпись     расшифровка подписи И
 И                      ___________________________ __________ ________________________ И
 И                        место работы,должность      подпись     расшифровка подписи И
 ИЗаключение комиссии _________________________________________________________________ И
 И_____________________________________________________________________________________ И
 И_____________________________________________________________________________________ И
 ИПредставитель грузоотправителя (поставщика, производителя) И
 ИДокумент, удостоверяющий полномочия _________________________________________________ И
.fields
  God
.endfields
№  Б__________ Б выдан  Б"__" ________ @@@@ г. Б
 И __________________________ ____________ __________________________________ И
 И   место работы, должность     подпись         фамилия, имя, отчество И

Акт с приложением на ___________________ листах получил

.fields
  Гл_бух_ФИО

  God
.endfields
 ИГлавный(старший) бухгалтер _________________  З@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ П
 И                                подпись              расшифровка подписи И
   Б"__" ________ @@@@ г. Б

 ИРешение руководителя ________________________________________________________________ И
 И_____________________________________________________________________________________ И
 И_____________________________________________________________________________________ И
 И_____________________________________________________________________________________ И
 И_____________________________________________________________________________________ И

Товар и тару на ответственное хранение принял
.fields
  МОЛ_получатель_ФИО
.endfields
 ИЗаведующий складом(кладовщик) _______________  З@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ П
 И                                  подпись             расшифровка подписи И

.}
.endform