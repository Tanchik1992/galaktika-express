/*
 ╔════════════════════════════════════════════════════════════════════════════╗
 ║                     (c) Корпорация ГАЛАКТИКА, 1997,98                      ║
 ║ Проект        : ГАЛАКТИКА                                                  ║
 ║ Система       : Оперативный контур                                         ║
 ║ Версия        : 5.50                                                       ║
 ║ Назначение    : Печать ДО на ЗАКУПКУ                                       ║
 ║ Ответственный : Шукан Александр Леонидович (SAL)                           ║
 ╚════════════════════════════════════════════════════════════════════════════╝
*/
#include predefs.inc

#doc
Счет СТАНДАРТНЫЙ - А4
#end
.linkform 'PRBDOC_2010' prototype is 'PRBDOC'
.NameInList 'Счет СТАНДАРТНЫЙ - А4'
.group 'Закупка'
.group 'Предоплата закупок'
.FIELDS
  mnd nomer ddoc
  post
.ENDFIELDS
.{?Internal;(wCountry<=1)
.fields
  sGetTune('KatOrg.FldView.UNN')
  innpost
.endfields
.}
.FIELDS
  bpost rspost mfobik mpost adpost telpost
  pol
.ENDFIELDS
.{?Internal;(wCountry<=1)
.fields
  sGetTune('KatOrg.FldView.UNN')
  innpol
.endfields
.}
.FIELDS
  bpol rspol mfobik mpol adpol telpol pname
  np barkod mc ed kol cena summa
  i1 i2
.ENDFIELDS
.{
 Ш^ Ш
                  БСЧЕТ на закупку № Б ^   Бот Б  ^

       БПОЛУЧАТЕЛЬ: Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.{?Internal;(wCountry<=1)
       Б@@@@@@@@@@: Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.}
       ББанк      : Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
       БСчет № Б ^ ^ ^
       БАдрес     : Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
       Бтел./факс : Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

.{ CheckEnter IsBaseFin
.}

       БПОСТАВЩИК : Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.{?Internal;(wCountry<=1)
       Б@@@@@@@@@@: Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.}
       ББанк      : Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
       БСчет № Б ^ ^ ^
       БАдрес     : Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
       Бтел./факс : Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

        ^
.{ CheckEnter IsExClass
.}
.{ CheckEnter IsGroup
.}
 Р
        ───┬────────────────┬──────────────────────────────┬─────────┬────────────┬─────────────────┬───────────────────────
         БNo Б │  БНоменклатурный Б │                              │  БЕдиница Б │            │                 │
         Бп/п Б│      Бномер Б      │   БНаименование, сорт, размер Б  │ Бизмерения Б│  БКоличество Б │        БЦена Б      │           БСумма Б
        ───┴────────────────┴──────────────────────────────┴─────────┴────────────┴─────────────────┴─────────────────────── Р
.{
 Р        &&& @@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @~@@@@@@@ &'&&&&&&&&&& &'&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&&.&& Р
.}
 Р        ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────── Р
 Р                                                             Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&&&&&&&&.&& Ф
.{?Internal;(SumSkidPos>0)
.FIELDS SumSkidPos (i2-SumSkidPos) .ENDFIELDS
 Р                                                             ДСумма скидок к позициям                  &'&&&&&&&&&&&&&&&&&&.&& Ф
 Р                                                             ДИтого с учетом скидок к позициям         &'&&&&&&&&&&&&&&&&&&.&& Ф
.}
.{?Internal;(op1<>'')
.FIELDS  op1 op2 .ENDFIELDS
 Р                                                             Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&&&&&&&&.&& Ф
.}
.{?Internal;(d2>0)
.FIELDS (d1 + ' ' + StringNLZR(if(d3=' %',d2,SkRub),0,3) + ' %') if(d3=' %',SkRub,d2) .ENDFIELDS
 Р                                                             Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&&&&&&&&.&& Ф
.}
.FIELDS  k1 sdoc .ENDFIELDS

 С                                                             ДИТОГО к оплате                           &'&&&&&&&&&&&&&&&&&&.&& Д  И^ Щ
.{?Internal;((n2>0)or(c2>0))
 Р                                                              в том числе: Р
.}
.{?Internal;(n2>0)
.FIELDS n1 n2 .ENDFIELDS
 Р                                                                     Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&&&&&&&&.&& Ф
.}
.{?Internal;(c2>0)
.FIELDS c1 c2 .ENDFIELDS
 Р                                                                     Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&&&&&&&&.&& Ф
.}
.FIELDS
  k3    // прописью
  k4 k5
  kDay
  page_symb
.ENDFIELDS

        БСумма прописью: Б  Р@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Р
         ^ ^
        БСчет действителен в течение Б ^  Бдней Б

        БРуководитель ___________          Гл.(старший) бухгалтер ____________ Б

.if Delimiter
 Р---------------------------------------------------------------------------------------------------------------------------- Р
.end
^
.}
.endform
!
!===============================================================================
!
#doc
Рублевый счет на закупку (для вал-руб документов)
#end
.linkform 'PRBDOC_203' prototype is 'PRBDOC'
.NameInList 'Рублевый счет на закупку (для вал-руб документов)'
.group 'Закупка'
.group 'Предоплата закупок'
.fields
  mnd nomer ddoc
  post bpost rspost mfobik mpost adpost telpost
  pol bpol rspol mfobik mpol adpol telpol
  pname
  np barkod mc ed kol cenar summar
  i1 i2r op1 op2r
//  d1 d2 d3 SkNDE SNDE
  k1r srub n2r k3r k4 k5 kDay
  page_symb
.endfields
.{

          Ш^ Ш          БСЧЕТ НА ЗАКУПКУ № ^  от  ^ Б

         ПОЛУЧАТЕЛЬ : ^
         Банк      : ^
         Счет № ^ ^ ^
         Адрес : ^
         тел./факс ^

.{ CheckEnter IsBaseFin
.}

         ПОСТАВЩИК :  ^
         Банк      :  ^
         Счет № ^ ^ ^
         Адрес : ^
         тел./факс ^

        ^
.{ CheckEnter IsExClass
.}
.{ CheckEnter IsGroup
.}
 Р  ───┬────────────────────┬───────────────────────────────────┬─────────┬────────────┬─────────────────────┬───────────────────────
   № │    Номенклатурный  │                                   │ Единица │            │                     │
  п/п│       номер        │   Наименование, сорт, размер      │измерения│ Количество │         Цена        │          Сумма
  ───┴────────────────────┴───────────────────────────────────┴─────────┴────────────┴─────────────────────┴─────────────────────── Р
.{
 Р  &&& @@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @~@@@@@@@ &'&&&&&&&&&& &'&&&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&&.&& Р
.}
 Р  ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 Б                                                                        &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&&&&&
                                                                        &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&&&&& С


     Итого к оплате: ^' ^ (НДС ^)
        прописью:     Р@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Р
         ^ ^

      БСчет действителен в течение ^ дней Б

        Руководитель ___________          Гл.(старший) бухгалтер ____________

.if Delimiter
 Р---------------------------------------------------------------------------------------------------------------------------- Р
.end
^
.}
.endform
!
!===============================================================================
!
#doc
Счет на закупку ( скидки и налоги к позиции )
#end
.linkform 'PRBDOC_204' prototype is 'PRBDOC'
.NameInList 'Счет на закупку ( скидки и налоги к позиции )'
.group 'Закупка'
.group 'Предоплата закупок'
.fields
  mnd nomer ddoc
  post bpost rspost mfobik mpost adpost telpost
  pol bpol rspol mfobik mpol adpol telpol
  pname
  np barkod mc ed kol cena skidka nds summa
  i1 i2 sdoc op1 op2 op2doc
//  d1 d2 d3
  k1 sdoc n2 k3 k4 k5 kDay
  page_symb
.endfields
.{

          Ш^ Ш               БСЧЕТ НА ЗАКУПКУ № ^  от  ^ Б

         ПОЛУЧАТЕЛЬ : ^
         Банк       : ^
         Счет № ^ ^ ^
         Адрес : ^
         тел./факс ^

.{ CheckEnter IsBaseFin
.}

         ПОСТАВЩИК  : ^
         Банк       : ^
         Счет № ^ ^ ^
         Адрес : ^
         тел./факс ^

        ^
.{ CheckEnter IsExClass
.}
.{ CheckEnter IsGroup
.}
 Ш    ───┬────────────────────┬───────────────────────────────────┬─────────┬────────────┬─────────────────┬────────────┬────────────┬───────────────────────
     № │    Номенклатурный  │                                   │ Единица │            │                 │            │            │
    п/п│       номер        │   Наименование, сорт, размер      │измерения│ Количество │       Цена      │   Скидка   │    НДС     │          Сумма
    ───┴────────────────────┴───────────────────────────────────┴─────────┴────────────┴─────────────────┴────────────┴────────────┴─────────────────────── Ш
.{
 Ш    &&& @@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @~@@@@@@@ &'&&&&&&&&&& &'&&&&&&&&&&&&&&& &'&&&&&&&&&& &'&&&&&&&.&& &'&&&&&&&&&&&&&&&&&&.&& Ш
.}
 Ш    ───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 Б                                                                                                    &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&&&&& ^
                                                                                                   &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& &#'&&&&&&&&&&&&&&&&&&&&& Щ ^


     Итого к оплате: ^' ^ (НДС ^)
        прописью:     Ш@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Ш
         ^ ^

 Б     Счет действителен в течение ^ дней Б

        Руководитель ___________          Гл.(старший) бухгалтер ____________

.if Delimiter
 Р---------------------------------------------------------------------------------------------------------------------------- Р
.end
^
.}
.endform
!
!===============================================================================
!
#doc
Счет-фактура на закупку строгой отчетности для РФ (A4)
#end
.linkform 'PRBDOC_205' prototype is 'PRBDOC'
.NameInList 'Счет-фактура на закупку строгой отчетности для РФ (A4)'
.group 'Закупка'
.group 'Предоплата закупок'
.var
 Akciz : double
 CenaAk : double
 SumAk  : double
 totSumAk : double
.endvar
.fields
 pol adpol telpol rspol mpol bpol+if(rspol2<>'', ', К/С '+rspol2, '')
 citypol
 sGetTune('KatOrg.FldView.UNN')
 innpol
 sGetTune('KatOrg.FldView.OKONH')
 okonhpol
 sGetTune('KatOrg.FldView.OKPO')
 OKPOpol
 Grpost gradpost
 grpol gradpol
! Nplras DPlras
 BaseFinNumber BaseFinDate
  nomer ddoc
 post adpost telpost rspost mpost bpost+if(rspost2<>'', ', К/С '+rspost2, '')
 citypost
 sGetTune('KatOrg.FldView.UNN')
 innpost
 sGetTune('KatOrg.FldView.OKONH')
 okonhpost
 sGetTune('KatOrg.FldView.OKPO')
 OKPOpost
 pname
!  pname1
!  pname2
  mc barkod2 ed kol cenaAk akciz sumAk Ak procnds
  Nds Newsumma
  TotSumAk c2 n2 k1
  page_symb
.endfields
.{

 Ш   Поставщик @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
   Адрес @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Телефон @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
   Расчетный счет № @@@@@@@@@@@@@@@@@@@@ БИК @@@@@@@@@@ в @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
   Город @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
   Идентификационный номер поставщика (@@@@@) @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
   Код по @@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
   Код по @@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
   Грузоотправитель и его адрес @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
   Грузополучатель и его адрес @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
   К платежно-расчетному документу
.{ CheckEnter IsBaseFin
      № @@@@@@@@@@@@@@@@@@@@@ от @@@@@@@@@@@
.}
!    @@@@@@@@@ от @@@@@@@@@@@@@@@@

 С                                  СЧЕТ - ФАКТУРА № @@@@@@@@@ от @@@@@@@@@@@@@@@@ С

 Ш   Покупатель @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
   Адрес @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Телефон @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
   Расчетный счет № @@@@@@@@@@@@@@@@@@@@ БИК @@@@@@@@@@ в @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
   Город @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
   Идентификационный номер покупателя (@@@@@) @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
   Код по @@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
   Код по @@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
   Дополнение (условия   оплаты   по   договору  (контракту),  способ отправления и т.п.)
   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Ш
!   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

.{ CheckEnter IsExClass
.}
.{ CheckEnter IsGroup
.}
 Ш   ┌───────────────────────────┬─────────┬────────┬──────────┬─────────────┬──────┬────────────────┬──────┬──────┬─────────────┬────────────────────┐
   │       Наименование        │ Код по  │Единица │Количество│    Цена     │в т.ч.│     Сумма      │в т.ч.│Ставка│    Сумма    │       Всего        │
   │         товара            │  ОКДП   │измерен.│          │             │акциз │                │акциз │ НДС  │     НДС     │       с НДС        │
   ├───────────────────────────┼─────────┼────────┼──────────┼─────────────┼──────┼────────────────┼──────┼──────┼─────────────┼────────────────────┤
   │             1             │    2    │   3    │    4     │      5      │  6   │       7        │  8   │  9   │      10     │         11         │
   └───────────────────────────┴─────────┴────────┴──────────┴─────────────┴──────┴────────────────┴──────┴──────┴─────────────┴────────────────────┘ Ш
.begin
  TotSumAk := 0;
 end.
.{
.begin
 Akciz := Ak/kol;
 CenaAk := cenabez + AkCiz;
 SumAk  := sbez + Ak;
 TotSumAk := TotSumAk + SumAk;
 end.
 Ш    @@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@ @@@@@@@@ &&&&&&&&&& &'&&&&&&&&.&& &'&.&& &'&&&&&&&&&&&.&& &'&&&& &&&&&. &'&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&& Ш
.}
 Ш
    Всего к оплате                                                                 &'&&&&&&&&&&&.&& &'&&&&        &'&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&&

                     Руководитель предприятия                                   Гл. бухгалтер


                                                      М.П.

                     ПОЛУЧИЛ                                                     ВЫДАЛ Ш

.if Delimiter
 Р---------------------------------------------------------------------------------------------------------------------------- Р
.end
^
.}
.endform
!
!===============================================================================
!
#doc
Счет-фактура на закупку для РФ (новая, A4)
#end
.linkform 'PRBDOC_206' prototype is 'PRBDOC'
.NameInList 'Счет-фактура на закупку для РФ (новая, A4)'
.group 'Закупка'
.group 'Предоплата закупок'
.var
 Akciz : double
 CenaAk : double
 SumAk  : double
 totSumAk : double
.endvar
.fields
 nomer ddoc
 pol  adpol  telpol sGetTune('KatOrg.FldView.UNN') innpol
 Grpost gradpost
 grpol gradpol
 BaseFinNumber BaseFinDate
 post adpost telpost sGetTune('KatOrg.FldView.UNN') innpost
 pname
  mc ed kol cenaAk akciz sumAk Ak procnds
  Nds Newsumma
  TotSumAk c2 n2 k1
 page_symb
.endfields
.{

 Б           Счет-фактура № @@@@@@@@@@@@ от @@@@@@@@@@@@@@@@@@@@@@ Б
 И
 Поставщик @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 Адрес @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 Телефон @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 Идентификационный номер поставщика (@@@@@) @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 Грузоотправитель и его адрес @@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 Грузополучатель и его адрес  @@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 К платежно-расчетному документу
.{ CheckEnter IsBaseFin
    № @@@@@@@@@@@@@@@@@@@@@ от @@@@@@@@@@@
.}
 Покупатель @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 Адрес @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 Телефон @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 Идентификационный номер покупателя (@@@@@) @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 Дополнение (условия оплаты по договору (контракту), способ отправления и т.п.)
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ И

.{ CheckEnter IsExClass
.}
.{ CheckEnter IsGroup
.}
 Ш┌──────────────────────────────────┬──────────┬───────────┬─────────────┬─────────────┬─────────────┬─────────────┬──────┬─────────────┬─────────────┐
│ Наименование товара              │ Един.изм.│ Количество│     Цена    │ В т.ч.акциз │    Сумма    │ В т.ч.акциз │Ставка│  Сумма НДС  │ Всего с НДС │
├──────────────────────────────────┼──────────┼───────────┼─────────────┼─────────────┼─────────────┼─────────────┼──────┼─────────────┼─────────────┤
│             1                    │     2    │      3    │      4      │       5     │      6      │      7      │   8  │       9     │      10     │
├──────────────────────────────────┼──────────┼───────────┼─────────────┼─────────────┼─────────────┼─────────────┼──────┼─────────────┼─────────────┤ Ш
.begin
  TotSumAk := 0;
 end.
.{
.begin
 Akciz := Ak/kol;
 CenaAk := cenabez + AkCiz;
 SumAk  := sbez + Ak;
 TotSumAk := TotSumAk + SumAk;
 end.
 Ш│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@~@@@@@@@@│&#&&&&&&.&&│&#&&&&&&&&.&&│&#&&&&&&&&.&&│&#&&&&&&&&.&&│&#&&&&&&&&.&&│@~#@@@│&#&&&&&&&&.&&│&#&&&&&&&&.&&│ Ш
.}
 Ш├──────────────────────────────────┴──────────┴───────────┴─────────────┴─────────────┴─────────────┴─────────────┼──────┼─────────────┼─────────────┤
│  Всего к оплате                                                                      &#&&&&&&&&.&& &#&&&&&&&&.&&│      │&#&&&&&&&&.&&│&#&&&&&&&&.&&│
└─────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘      └─────────────┴─────────────┘ Ш

 Ш       Руководитель организации (предприятия)

       Гл. бухгалтер

       М.П.

       Выдал
       (подпись ответственного лица от поставщика)

       Примечание. Без печати недействительно.
       Первый экземпляр (оригинал) - покупателю.
       Второй экземпляр (копия) - продавцу. Ш

.if Delimiter
 Р---------------------------------------------------------------------------------------------------------------------------- Р
.end
^
.}
.endform
!
!===============================================================================
!
#doc
Счет-фактура на закупку строгой отчетности для РФ (A4, сумма прописью)
#end
.linkform 'PRBDOC_207' prototype is 'PRBDOC'
.NameInList 'Счет-фактура на закупку строгой отчетности для РФ (A4, сумма прописью)'
.group 'Закупка'
.group 'Предоплата закупок'
.var
 Akciz : double
 CenaAk : double
 SumAk  : double
 totSumAk : double
.endvar
.fields
 pol adpol telpol rspol mpol bpol+if(rspol2<>'', ', К/С '+rspol2, '')
 citypol
 sGetTune('KatOrg.FldView.UNN')
 innpol
 sGetTune('KatOrg.FldView.OKONH')
 okonhpol
 sGetTune('KatOrg.FldView.OKPO')
 OKPOpol
 Grpost gradpost
 grpol gradpol
! Nplras DPlras
 BaseFinNumber BaseFinDate
  nomer ddoc
 post adpost telpost rspost mpost bpost+if(rspost2<>'', ', К/С '+rspost2, '')
 citypost
 sGetTune('KatOrg.FldView.UNN')
 innpost
 sGetTune('KatOrg.FldView.OKONH')
 okonhpost
 sGetTune('KatOrg.FldView.OKPO')
 OKPOpost
 pname
!  pname1
!  pname2
  mc barkod2 ed kol cenaAk akciz sumAk Ak procnds
  Nds Newsumma
  TotSumAk c2 n2 k1 k3
  page_symb
.endfields
.{

 Ш   Поставщик @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
   Адрес @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Телефон @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
   Расчетный счет № @@@@@@@@@@@@@@@@@@@@ БИК @@@@@@@@@@ в @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
   Город @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
   Идентификационный номер поставщика (@@@@@) @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
   Код по @@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
   Код по @@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
   Грузоотправитель и его адрес @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
   Грузополучатель и его адрес @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
   К платежно-расчетному документу
.{ CheckEnter IsBaseFin
      № @@@@@@@@@@@@@@@@@@@@@ от @@@@@@@@@@@
.}
!    @@@@@@@@@ от @@@@@@@@@@@@@@@@

                                        ЙСЧЕТ - ФАКТУРА № @@@@@@@@@ от @@@@@@@@@@@@@@@@ Й

   Покупатель @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
   Адрес @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Телефон @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
   Расчетный счет № @@@@@@@@@@@@@@@@@@@@ БИК @@@@@@@@@@ в @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
   Город @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
   Идентификационный номер покупателя (@@@@@) @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
   Код по @@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
   Код по @@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
   Дополнение (условия   оплаты   по   договору  (контракту),  способ отправления и т.п.)
   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
!   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Ш

.{ CheckEnter IsExClass
.}
.{ CheckEnter IsGroup
.}
 Ш   ┌───────────────────────────┬─────────┬────────┬──────────┬─────────────┬──────┬────────────────┬──────┬──────┬─────────────┬────────────────────┐
   │       Наименование        │ Код по  │Единица │Количество│    Цена     │в т.ч.│     Сумма      │в т.ч.│Ставка│    Сумма    │       Всего        │
   │         товара            │  ОКДП   │измерен.│          │             │акциз │                │акциз │ НДС  │     НДС     │       с НДС        │
   ├───────────────────────────┼─────────┼────────┼──────────┼─────────────┼──────┼────────────────┼──────┼──────┼─────────────┼────────────────────┤
   │             1             │    2    │   3    │    4     │      5      │  6   │       7        │  8   │  9   │      10     │         11         │
   └───────────────────────────┴─────────┴────────┴──────────┴─────────────┴──────┴────────────────┴──────┴──────┴─────────────┴────────────────────┘ Ш
.begin
  TotSumAk := 0;
 end.
.{
.begin
 Akciz := Ak/kol;
 CenaAk := cenabez + AkCiz;
 SumAk  := sbez + Ak;
 TotSumAk := TotSumAk + SumAk;
 end.
 Ш    @@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@ @@@@@@@@ &&&&&&&&&& &'&&&&&&&&.&& &'&.&& &'&&&&&&&&&&&.&& &'&&&& &&&&&. &'&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&& Ш
.}

 Щ    Всего к оплате                                                                 &'&&&&&&&&&&&.&& &'&&&&        &'&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&&
    Прописью:@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Щ
 Ш
                     Руководитель предприятия                                   Гл. бухгалтер


                                                      М.П.

                     ПОЛУЧИЛ                                                     ВЫДАЛ Ш

.if Delimiter
 Р---------------------------------------------------------------------------------------------------------------------------- Р
.end
^
.}
.endform

!
!===============================================================================
!
#ifdef GAL5_80
#doc
Паспорт импортной сделки для России
#end
.linkform 'PRBDOC_208' prototype is 'PRBDOC'
.NameInList 'Паспорт импортной сделки для России'
.group 'Закупка'
.group 'Предоплата закупок'
.create view loBD
var
  cBaseDoc: comp;
from
    BaseDoc
  , KlVal
  , synonym KatOrg Pol
  , synonym KatOrg Post
  , synonym KatCity CityPol
  , synonym KatCity CityPost
  , synonym KatState StatePost
  , synonym KatBank BankPost
  , synonym KatBank BankPol
  , synonym KlVal SpVal
where
((
                cBaseDoc == BaseDoc.NRec
and         BaseDoc.cVal == KlVal.NRec
and         BaseDoc.cOrg == Post.NRec
and   coGetTune('MyOrg') == Pol.NRec
and           Post.cCity == CityPost.NRec
and            Pol.cCity == CityPol.NRec
and          Post.cState == StatePost.NRec
and        BaseDoc.cBank == BankPost.NRec
and      BaseDoc.cMyBank == BankPol.NRec
and         BaseDoc.NRec == StepDoc.cBaseDoc
and         StepDoc.NRec == SpStep.cStepDoc
and          SpStep.cVal == SpVal.NRec
))
;
.var
  PSINum: string
  PSIDate: date
  FormRasc: string
  OplTov: string
.endvar
.begin
  loBD.cBaseDoc := Comp(BaseDocNRec);
  if (loBD.GetFirst Pol = 0) then {}
  if (loBD.GetFirst BaseDoc = 0) then {
    var ExtAttr: IExtAttr;
    var ExtClass: IExtClass;
    var cAttrNam : comp;
    var wTypeAttr: word;

    // ПС
    PSINum := ExtAttr.sGetAttr(coBaseDoc, Comp(BaseDocNRec), 'Паспорт сделки (ПС)');
    // дата регистрации ПС
    PSIDate := ExtAttr.dGetAttr(coBaseDoc, Comp(BaseDocNRec), 'Дата регистрации ПС');
    //форма расчетов
    wTypeAttr:=ExtClass.GetClassCode(coBaseDoc,'Форма расчетов');
    if (wTypeAttr<>0)
     {
       FormRasc:=ExtClass.GetSegName(wTypeAttr,Comp(BaseDocNRec));
       if (Length(FormRasc) > 2) then FormRasc:=SubStr(FormRasc,1,2);
     }
    else
     FormRasc:='';

    //оплата товара
    wTypeAttr:=ExtClass.GetClassCode(coBaseDoc,'Оплата товара');
    if (wTypeAttr<>0)
     {
       OplTov:=ExtClass.GetSegName(wTypeAttr,Comp(BaseDocNRec));
       if (Length(OplTov) > 2) then OplTov:=SubStr(OplTov,1,2);
     }
    else
     OplTov:='';

  };
end.
.fields
  PSINum PSIDate

  loBD.BankPol.Name loBD.BankPol.Addr

  loBD.Pol.Name sGetTune('KatOrg.FldView.OKPO') loBD.Pol.OKPO loBD.Pol.Addr+', '+loBD.CityPol.Name loBD.BankPol.Schet1 sGetTune('KatOrg.FldView.UNN') loBD.Pol.UNN

  loBD.Post.Name loBD.StatePost.Name loBD.StatePost.Kod loBD.Post.Addr+', '+loBD.CityPost.Name

  loBD.BaseDoc.NoDoc DateToStr(Add_Day(loBD.BaseDoc.ddoc, loBD.BaseDoc.KolDn), 'DD/MM/YYYY')

  loBD.BaseDoc.ddoc loBD.KlVal.Dollar loBD.BaseDoc.Summa loBD.KlVal.ISO

  loBD.SpVal.Dollar FormRasc loBD.SpVal.ISO OplTov ''

  '' '' '' ''

  page_symb
.endfields
.{
.{ CheckEnter IsBaseFin
.}
.{ CheckEnter IsExClass
.}
.{ CheckEnter IsGroup
.}

  ПАСПОРТ ИМПОРТНОЙ СДЕЛКИ №  Б^ Б
  от  Б^ Б

  Реквизиты Банка Импортера:
  Наименование -                         Б^ Б
  Филиал -
  Почтовый адрес -                       Б^ Б

  Реквизиты Импортера:
  Наименование -                         Б^ Б
  Код @@@@@@@ -                          Б^ Б
  Адрес -                                Б^ Б
  Номер счета -                          Б^ Б
  Номер налогоплательщика(@@@@@@@@@@) -  Б^ Б

  Реквизиты иностранной стороны:
  Наименование -                         Б^ Б
  Страна -                               Б^ Б
  Код страны -                           Б^ Б
  Адрес -                                Б^ Б

  Реквизиты условия контракта:
  Номер -             Б@@@@@@@@@@@@@@@@@@ Б  Последняя дата -      Б@@@@@@@@@@@@@@@@@@ Б
  Дата -              Б@@@@@@@@@@@@@@@@@@ Б  Валюта платежа -      Б@@@@@@@@@@@@@@@@@@ Б
  Сумма контракта -   Б&'&&&&&&&&&&&&&.&& Б  Код валюты платежа -  Б@@@@@@@@@@@@@@@@@@ Б
  Валюта цены -       Б@@@@@@@@@@@@@@@@@@ Б  Форма расчетов -      Б@@@@@@@@@@@@@@@@@@ Б
  Код валюты цены -   Б@@@@@@@@@@@@@@@@@@ Б  Оплата товара -       Б@@@@@@@@@@@@@@@@@@ Б
  Валютная оговорка - Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б

  Лицензия Банка России:
  Номер лицензии -                                        Дата -
  Дата окончания действия лицензии -
  Стоимость отсроченной поставки -

  Особые отметки Банка Импортера:



  Подписи уполномоченных лиц:
  От Банка Импортера                        От Импортера
  Должность Б@@@@@@@@@@@@@@@@@@@@@@ Б           Должность Б@@@@@@@@@@@@@@@@@@@@@@ Б
  И.О.Фамилия  Б@@@@@@@@@@@@@@@@@@@ Б           И.О.Фамилия  Б@@@@@@@@@@@@@@@@@@@ Б




      М.П.          Дата                        М.П.          Дата



  Копия верна:           Должность          И.О.Фамилия (подпись)
  _______________________________________________________________



      М.П.          Дата


.{
.}
.if Delimiter
 Р---------------------------------------------------------------------------------------------------------------------------- Р
.end
^
.}
.endform

#doc
Паспорт импортной сделки для Казахстана
#end
.linkform 'PRBDOC_208_1' prototype is 'PRBDOC'
.NameInList 'Паспорт импортной сделки для Казахстана'
.group 'Закупка'
.group 'Предоплата закупок'
.create view loBD
var
  cBaseDoc: comp;
  PosrName: string;
from
    BaseDoc
  , StepDoc
  , SpStep
  , KatMC
  , KatUsl
  , KlVal
  , Persons
  , KatPayment
  , Appointments
  , Passports
  , Catalogs
  , synonym KatOrg Pol
  , synonym KatOrg Post
  , synonym KatOrg Posr
  , synonym KatCity CityPol
  , synonym KatCity CityPost
  , synonym KatCity CityPosr
  , synonym KatState StatePost
  , synonym KatBank BankPlat
  , synonym KatBank BankPol
  , synonym KatBank BankPosr
  , synonym KlVal SpVal
where
((
                cBaseDoc == BaseDoc.NRec
and     BaseDoc.cPayment == KatPayment.nRec
and         BaseDoc.Nrec == StepDoc.cBaseDoc
and         StepDoc.Nrec == SpStep.cStepDoc
and        SpStep.cMcUsl == KatMC.nRec
and        SpStep.cMcUsl == KatUsl.nRec
and    coGetTune('Boss') == Persons.nRec
and     Persons.PasspRus == Passports.nRec
and   Persons.AppointCur == Appointments.Nrec
and    Appointments.Post == Catalogs.Nrec
and         BaseDoc.cVal == KlVal.NRec
and         BaseDoc.cOrg == Post.NRec
and   coGetTune('MyOrg') == Pol.NRec
and           Post.cCity == CityPost.NRec
and            Pol.cCity == CityPol.NRec
and             PosrName == Posr.Name
and          Post.cState == StatePost.NRec
and           Posr.cCity == CityPosr.NRec
and        BaseDoc.cBank == BankPol.NRec
and      BaseDoc.cMyBank == BankPlat.NRec
and         BaseDoc.NRec == StepDoc.cBaseDoc
and         StepDoc.NRec == SpStep.cStepDoc
and          SpStep.cVal == SpVal.NRec
))
;
.var
  PSINum: string
  PSIDate: date
  BankPlatRNN, BankPlatOKPO: string
  Tovar: string
  OplTov: string
  NalOrgAddrImp: string
  NalOrgAddr3: string
  SrokOpl: string
  ValOgovorka: string
  BankNotes: string
.endvar
.begin
  loBD.cBaseDoc := Comp(BaseDocNRec);
  if (loBD.GetFirst fastfirstrow BaseDoc = 0) then {
    if (loBD.GetFirst fastfirstrow KatPayment = 0) then {}
    if (loBD.GetFirst fastfirstrow Post = 0) then {}
    if (loBD.GetFirst fastfirstrow Pol = 0) then {}
    if (loBD.GetFirst fastfirstrow Persons = 0) then {}
    var ExtAttr: IExtAttr;
    var ExtClass: IExtClass;
    var cAttrNam : comp;
    var wTypeAttr: word;

    BankPlatRNN   := ExtAttr.sGetAttr(coKatBank, loBD.BaseDoc.cMyBank, 'РНН'                    );
    BankPlatOKPO  := ExtAttr.sGetAttr(coKatBank, loBD.BaseDoc.cMyBank, sGetTune('KatOrg.FldView.OKPO'));
    NalOrgAddrImp := ExtAttr.sGetAttr(coKatOrg , coGetTune('MyOrg')  , 'Адрес налогового органа');
    PosrName      := ExtAttr.sGetAttr(coBaseDoc, Comp(BaseDocNRec)   , 'Третье лицо'            );
    if (loBD.GetFirst fastfirstrow Posr = 0)
    {
      NalOrgAddr3 := ExtAttr.sGetAttr(coKatOrg, loBD.Posr.NRec, 'Адрес налогового органа');
      if (loBD.GetFirst fastfirstrow BankPosr where (( loBD.Posr.NRec == BankPosr.cOrg and
                                                 word(1) == BankPosr.Aktiv )) <> 0)
        if (loBD.GetFirst fastfirstrow BankPosr
                    where (( loBD.Posr.NRec == BankPosr.cOrg )) = 0) then {}
    }
    // ПС
    Tovar:='';
    loBD._loop SpStep
     {
      if (loBD.SpStep.PrMc = 1)
        Tovar := Tovar + if(Tovar = '', '', ',') + KatMC.Name
      else
        Tovar := Tovar + if(Tovar = '', '', ',') + KatUsl.Name;
     }
    PSINum := ExtAttr.sGetAttr(coBaseDoc, Comp(BaseDocNRec), 'Паспорт сделки (ПС)');
    // Валютная оговорка
    ValOgovorka := ExtAttr.sGetAttr(coBaseDoc, Comp(BaseDocNRec), 'Валютная оговорка');
    // Особые отметки Банка, Таможенного органа
    BankNotes := ExtAttr.sGetAttr(coBaseDoc, Comp(BaseDocNRec), 'Особые отметки Банка, Таможенного органа');
    // дата регистрации ПС
    PSIDate := ExtAttr.dGetAttr(coBaseDoc, Comp(BaseDocNRec), 'Дата регистрации ПС');

    //оплата товара
    wTypeAttr:=ExtClass.GetClassCode(coBaseDoc,'Оплата товара');
    if (wTypeAttr<>0)
     {
       OplTov:=ExtClass.GetSegName(wTypeAttr,Comp(BaseDocNRec));
     }
    else
     OplTov:='';

  };
end.
.fields
!  ПАСПОРТ СДЕЛКИ ПО ИМПОРТУ №  Б^ Б от  Б^ Б
  PSINum
  if (longint(PSIDate) = 0, '', DateToStr(PSIDate, 'DD/MM/YYYY г.'))

!  Реквизиты банка:
!  Наименование -                    Б^ Б
!  Филиал -
!  Адрес -                           Б^ Б
!  РНН -                             Б^ Б
!  Код ОКПО банка (филиала банка) -  Б^ Б
  loBD.BankPlat.Name
  loBD.BankPlat.Addr
  BankPlatRNN
  sGetTune('KatOrg.FldView.OKPO')
  BankPlatOKPO

!  Реквизиты импортера:
!  Наименование -                    Б^ Б
!  Код ОКПО -                        Б^ Б
!  Адрес -                           Б^ Б
!  Номер банковского счета -         Б^ Б
!  РНН -                             Б^ Б
!  Адрес налогового органа -         Б^ Б
  loBD.Pol.Name
  sGetTune('KatOrg.FldView.OKPO')
  loBD.Pol.OKPO
  loBD.Pol.Addr+', '+loBD.CityPol.Name
  loBD.BankPlat.Schet1
  loBD.Pol.UNN
  NalOrgAddrImp

!  Реквизиты третьего лица:
!  Наименование -                    Б^ Б
!  Код ОКПО -                        Б^ Б
!  Адрес -                           Б^ Б
!  Номер банковского счета -         Б^ Б
!  РНН -                             Б^ Б
!  Адрес налогового органа -         Б^ Б
  loBD.Posr.Name
  sGetTune('KatOrg.FldView.OKPO')
  loBD.Posr.OKPO
  loBD.Posr.Addr+', '+loBD.CityPosr.Name
  loBD.BankPosr.Schet1
  loBD.Posr.UNN
  NalOrgAddr3

!  Реквизиты инопартнера:
!  Наименование -                    Б^ Б
!  Страна -                          Б^ Б
!  Адрес -                           Б^ Б
!  Реквизиты банка инопартнера -     Б^ Б
  loBD.Post.Name
  loBD.StatePost.Name
  loBD.Post.Addr+', '+loBD.CityPost.Name
  loBD.BankPol.Name+
    if(loBD.BankPol.Addr = '', '', ', '+loBD.BankPol.Addr)+
    if(loBD.BankPol.Schet1 = '', '', ', р/с'+loBD.BankPol.Schet1)

!  Реквизиты и условия контракта:
!  Номер -                    Б@@@@@@@@@@@@@@@@@@ Б   Последняя дата -      Б^ Б
!  Дата -                     Б@@@@@@@@@@@@@@@@@@ Б   Валюта платежа -      Б^ Б
!  Сумма контракта -          Б&'&&&&&&&&&&&&&.&& Б   Код валюты платежа -  Б^ Б
!  Товар -                    Б@@@@@@@@@@@@@@@@@@ Б   Форма расчетов -      Б^ Б
!  Валюта по контракту -      Б@@@@@@@@@@@@@@@@@@ Б
!  Код валюты по контракту -  Б@@@@@@@@@@@@@@@@@@ Б
!  Валютная оговорка -        Б^ Б
  loBD.BaseDoc.NoDoc DateToStr(Add_Day(loBD.BaseDoc.dDoc, loBD.BaseDoc.KolDn), 'DD/MM/YYYY')
  loBD.BaseDoc.dDoc  if(loBD.BaseDoc.cVal = 0, sGetTune('NDE.SimvRub'), loBD.KlVal.Dollar)
  loBD.BaseDoc.Summa if(loBD.BaseDoc.cVal = 0, sGetTune('NDE.RublISO'), loBD.KlVal.ISO)
  Tovar loBD.KatPayment.Name
  if(loBD.SpStep.cVal = 0, sGetTune('NDE.SimvRub'), loBD.SpVal.Dollar)
  if(loBD.SpStep.cVal = 0, sGetTune('NDE.RublISO'), loBD.SpVal.ISO)
  ValOgovorka

  ''  Catalogs.Name     ''
  ''  sGetTune('Boss')  ''
  ''  ''
  ''  ''
  BankNotes

  page_symb
.endfields
.{
.{ CheckEnter IsBaseFin
.}
.{ CheckEnter IsExClass
.}
.{ CheckEnter IsGroup
.}

  ПАСПОРТ СДЕЛКИ ПО ИМПОРТУ №  Б^ Б
                           от  Б^ Б

  Реквизиты банка:
  Наименование -                      Б^ Б
  Филиал -
  Адрес -                             Б^ Б
  РНН -                               Б^ Б
  Код @@@@@@ банка (филиала банка) -  Б^ Б

  Реквизиты импортера:
  Наименование -                      Б^ Б
  Код @@@@@@ -                        Б^ Б
  Адрес -                             Б^ Б
  Номер банковского счета -           Б^ Б
  РНН -                               Б^ Б
  Адрес налогового органа -           Б^ Б

  Реквизиты третьего лица:
  Наименование -                      Б^ Б
  Код @@@@@@ -                        Б^ Б
  Адрес -                             Б^ Б
  Номер банковского счета -           Б^ Б
  РНН -                               Б^ Б
  Адрес налогового органа -           Б^ Б

  Реквизиты инопартнера:
  Наименование -                      Б^ Б
  Страна -                            Б^ Б
  Адрес -                             Б^ Б
  Реквизиты банка инопартнера -       Б^ Б

  Реквизиты и условия контракта:
  Номер -                    Б@@@@@@@@@@@@@@@@@@ Б   Последняя дата -      Б^ Б
  Дата -                     Б@@@@@@@@@@@@@@@@@@ Б   Валюта платежа -      Б^ Б
  Сумма контракта -          Б&'&&&&&&&&&&&&&.&& Б   Код валюты платежа -  Б^ Б
  Товар -                    Б@@@@@@@@@@@@@@@@@@ Б   Форма расчетов -      Б^ Б
  Валюта по контракту -      Б@@@@@@@@@@@@@@@@@@ Б
  Код валюты по контракту -  Б@@@@@@@@@@@@@@@@@@ Б
  Валютная оговорка -        Б^ Б

  Лицензия Национального банка Республики Казахстан:
  Номер лицензии                                 Дата
  Регистрационное свидетельство Национального Банка Республики Казахстан
  Номер регистрационного свидетельства                  Дата

  Подписи уполномоченных лиц:
  От Банка                                  От Импортера                              От тамож. органа
  Должность  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б    Должность  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б    Должность  Б^ Б
  Фамилия И.О.  Б@@@@@@@@@@@@@@@@@@@@@@@@@ Б    Фамилия И.О.  Б@@@@@@@@@@@@@@@@@@@@@@@@@ Б    Фамилия И.О.  Б^ Б




      М.П.          Дата                        М.П.          Дата                        М.П.          Дата




  От третьего лица                          От банка третьего лица
  Должность  Б^ Б                           Должность  Б^ Б
  Фамилия И.О.  Б^ Б                        Фамилия И.О.  Б^ Б




      М.П.          Дата                        М.П.          Дата




  Особые отметки банка, таможенного органа:
  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@



.{
.}
.if Delimiter
 Р---------------------------------------------------------------------------------------------------------------------------- Р
.end
^
.}
.endform

#doc
Паспорт экспортной сделки для Казахстана
#end
.linkform 'PRBDOC_208_2' prototype is 'PRBDOC'
.NameInList 'Паспорт экспортной сделки для Казахстана'
.group 'Продажа'
.group 'Предоплата продаж'
.create view loBD
var
  cBaseDoc: comp;
  PosrName: string;
from
    BaseDoc
  , StepDoc
  , SpStep
  , KatMC
  , KatUsl
  , KlVal
  , Persons
  , KatPayment
  , Appointments
  , Passports
  , Catalogs
  , synonym KatOrg Pol
  , synonym KatOrg Post
  , synonym KatOrg Posr
  , synonym KatCity CityPol
  , synonym KatCity CityPost
  , synonym KatCity CityPosr
  , synonym KatState StatePost
  , synonym KatBank BankPlat
  , synonym KatBank BankPol
  , synonym KatBank BankPosr
  , synonym KlVal SpVal
where
((
                cBaseDoc == BaseDoc.NRec
and     BaseDoc.cPayment == KatPayment.nRec
and         BaseDoc.Nrec == StepDoc.cBaseDoc
and         StepDoc.Nrec == SpStep.cStepDoc
and        SpStep.cMcUsl == KatMC.nRec
and        SpStep.cMcUsl == KatUsl.nRec
and    coGetTune('Boss') == Persons.nRec
and     Persons.PasspRus == Passports.nRec
and   Persons.AppointCur == Appointments.Nrec
and    Appointments.Post == Catalogs.Nrec
and         BaseDoc.cVal == KlVal.NRec
and         BaseDoc.cOrg == Post.NRec
and   coGetTune('MyOrg') == Pol.NRec
and           Post.cCity == CityPost.NRec
and            Pol.cCity == CityPol.NRec
and           Posr.cCity == CityPosr.NRec
and          Post.cState == StatePost.NRec
and        BaseDoc.cBank == BankPlat.NRec
and      BaseDoc.cMyBank == BankPol.NRec
and         BaseDoc.NRec == StepDoc.cBaseDoc
and         StepDoc.NRec == SpStep.cStepDoc
and          SpStep.cVal == SpVal.NRec
))
;
.var
  PSINum: string
  PSIDate: date
  BankPolRNN, BankPolOKPO: string
  Tovar: string
  OplTov: string
  NalOrgAddrImp: string
  NalOrgAddr3: string
  SrokOpl: string
  ValOgovorka: string
  BankNotes: string
.endvar
.begin
  loBD.cBaseDoc := Comp(BaseDocNRec);
  if (loBD.GetFirst fastfirstrow BaseDoc = 0) then {

    if (loBD.GetFirst fastfirstrow KatPayment = 0) then {}
    if (loBD.GetFirst fastfirstrow Post = 0) then {}
    if (loBD.GetFirst fastfirstrow Pol = 0) then {}
    if (loBD.GetFirst fastfirstrow Persons = 0) then {}
    var ExtAttr: IExtAttr;
    var ExtClass: IExtClass;
    var cAttrNam : comp;
    var wTypeAttr: word;

    BankPolRNN    := ExtAttr.sGetAttr(coKatBank, loBD.BaseDoc.cMyBank, 'РНН'                    );
    BankPolOKPO   := ExtAttr.sGetAttr(coKatBank, loBD.BaseDoc.cMyBank, sGetTune('KatOrg.FldView.OKPO'));
    NalOrgAddrImp := ExtAttr.sGetAttr(coKatOrg , coGetTune('MyOrg')  , 'Адрес налогового органа');
    PosrName      := ExtAttr.sGetAttr(coBaseDoc, Comp(BaseDocNRec)   , 'Третье лицо'            );
    if (loBD.GetFirst fastfirstrow Posr = 0)
    {
      NalOrgAddr3 := ExtAttr.sGetAttr(coKatOrg, loBD.Posr.NRec, 'Адрес налогового органа');
      if (loBD.GetFirst fastfirstrow BankPosr where (( loBD.Posr.NRec == BankPosr.cOrg and
                                                 word(1) == BankPosr.Aktiv )) <> 0)
        if (loBD.GetFirst fastfirstrow BankPosr
                    where (( loBD.Posr.NRec == BankPosr.cOrg )) = 0) then {}
    }
    // ПС
    Tovar:='';
    loBD._loop SpStep
     {
      if (loBD.SpStep.PrMc = 1)
        Tovar := Tovar + if(Tovar = '', '', ',') + KatMC.Name
      else
        Tovar := Tovar + if(Tovar = '', '', ',') + KatUsl.Name;
     }
    PSINum := ExtAttr.sGetAttr(coBaseDoc, Comp(BaseDocNRec), 'Паспорт сделки (ПС)');
    // Валютная оговорка
    ValOgovorka := ExtAttr.sGetAttr(coBaseDoc, Comp(BaseDocNRec), 'Валютная оговорка');
    // Особые отметки Банка, Таможенного органа
    BankNotes := ExtAttr.sGetAttr(coBaseDoc, Comp(BaseDocNRec), 'Особые отметки Банка, Таможенного органа');
    // дата регистрации ПС
    PSIDate := ExtAttr.dGetAttr(coBaseDoc, Comp(BaseDocNRec), 'Дата регистрации ПС');

    //оплата товара
    wTypeAttr:=ExtClass.GetClassCode(coBaseDoc,'Оплата товара');
    if (wTypeAttr<>0)
     {
       OplTov:=ExtClass.GetSegName(wTypeAttr,Comp(BaseDocNRec));
     }
    else
     OplTov:='';

  };
end.
.fields
!  ПАСПОРТ СДЕЛКИ ПО ЭКСПОРТУ №  Б^ Б от  Б^ Б
  PSINum
  if (longint(PSIDate) = 0, '', DateToStr(PSIDate, 'DD/MM/YYYY г.'))

!  Реквизиты банка экспортера:
!  Наименование -                    Б^ Б
!  Филиал -
!  Адрес -                           Б^ Б
!  РНН -                             Б^ Б
!  Код ОКПО банка (филиала банка) -  Б^ Б
  loBD.BankPol.Name
  loBD.BankPol.Addr
  BankPolRNN
  sGetTune('KatOrg.FldView.OKPO')
  BankPolOKPO

!  Реквизиты экспортера:
!  Наименование -                    Б^ Б
!  Код ОКПО -                        Б^ Б
!  Адрес -                           Б^ Б
!  Номер банковского счета -         Б^ Б
!  РНН -                             Б^ Б
!  Адрес налогового органа -         Б^ Б
  loBD.Pol.Name
  sGetTune('KatOrg.FldView.OKPO')
  loBD.Pol.OKPO
  loBD.Pol.Addr+', '+loBD.CityPol.Name
  loBD.BankPol.Schet1
  loBD.Pol.UNN
  NalOrgAddrImp

!  Реквизиты третьего лица:
!  Наименование -                    Б^ Б
!  Код ОКПО -                        Б^ Б
!  Адрес -                           Б^ Б
!  Номер банковского счета -         Б^ Б
!  РНН -                             Б^ Б
!  Адрес налогового органа -         Б^ Б
  loBD.Posr.Name
  sGetTune('KatOrg.FldView.OKPO')
  loBD.Posr.OKPO
  loBD.Posr.Addr+', '+loBD.CityPosr.Name
  loBD.BankPosr.Schet1
  loBD.Posr.UNN
  NalOrgAddr3

!  Реквизиты иностранного покупателя:
!  Наименование -                    Б^ Б
!  Страна -                          Б^ Б
!  Адрес -                           Б^ Б
!  Реквизиты банка покупателя -      Б^ Б
  loBD.Post.Name
  loBD.StatePost.Name
  loBD.Post.Addr+', '+loBD.CityPost.Name
  loBD.BankPlat.Name+
    if(loBD.BankPlat.Addr = '', '', ', '+loBD.BankPlat.Addr)+
    if(loBD.BankPlat.Schet1 = '', '', ', р/с'+loBD.BankPlat.Schet1)

!  Реквизиты и условия контракта:
!  Номер -                    Б@@@@@@@@@@@@@@@@@@ Б   Последняя дата -       Б^ Б
!  Дата -                     Б@@@@@@@@@@@@@@@@@@ Б   Валюта платежа -       Б^ Б
!  Сумма контракта -          Б&'&&&&&&&&&&&&&.&& Б   Код валюты платежа -   Б^ Б
!  Товар -                    Б@@@@@@@@@@@@@@@@@@ Б   Форма расчетов -       Б^ Б
!  Валюта по контракту -      Б@@@@@@@@@@@@@@@@@@ Б
!  Код валюты по контракту -  Б^ Б
!  Валютная оговорка -        Б^ Б
  loBD.BaseDoc.NoDoc DateToStr(Add_Day(loBD.BaseDoc.dDoc, loBD.BaseDoc.KolDn), 'DD/MM/YYYY')
  loBD.BaseDoc.dDoc  if(loBD.BaseDoc.cVal = 0, sGetTune('NDE.SimvRub'), loBD.KlVal.Dollar)
  loBD.BaseDoc.Summa if(loBD.BaseDoc.cVal = 0, sGetTune('NDE.RublISO'), loBD.KlVal.ISO)
  Tovar loBD.KatPayment.Name
  if(loBD.SpStep.cVal = 0, sGetTune('NDE.SimvRub'), loBD.SpVal.Dollar)
  if(loBD.SpStep.cVal = 0, sGetTune('NDE.RublISO'), loBD.SpVal.ISO)
  ValOgovorka

  ''  Catalogs.Name     ''
  ''  sGetTune('Boss')  ''
  BankNotes

  page_symb
.endfields
.{
.{ CheckEnter IsBaseFin
.}
.{ CheckEnter IsExClass
.}
.{ CheckEnter IsGroup
.}

  ПАСПОРТ СДЕЛКИ ПО ЭКСПОРТУ №  Б^ Б
                            от  Б^ Б

  Реквизиты банка экспортера:
  Наименование -                      Б^ Б
  Филиал -
  Адрес -                             Б^ Б
  РНН -                               Б^ Б
  Код @@@@@@ банка (филиала банка) -  Б^ Б

  Реквизиты экспортера:
  Наименование -                      Б^ Б
  Код @@@@@@ -                        Б^ Б
  Адрес -                             Б^ Б
  Номер банковского счета -           Б^ Б
  РНН -                               Б^ Б
  Адрес налогового органа -           Б^ Б

  Реквизиты третьего лица:
  Наименование -                      Б^ Б
  Код @@@@@@ -                        Б^ Б
  Адрес -                             Б^ Б
  Номер банковского счета -           Б^ Б
  РНН -                               Б^ Б
  Адрес налогового органа -           Б^ Б

  Реквизиты иностранного покупателя:
  Наименование -                      Б^ Б
  Страна -                            Б^ Б
  Адрес -                             Б^ Б
  Реквизиты банка покупателя -        Б^ Б

  Реквизиты и условия контракта:
  Номер -                    Б@@@@@@@@@@@@@@@@@@ Б   Последняя дата -       Б^ Б
  Дата -                     Б@@@@@@@@@@@@@@@@@@ Б   Валюта платежа -       Б^ Б
  Сумма контракта -          Б&'&&&&&&&&&&&&&.&& Б   Код валюты платежа -   Б^ Б
  Товар -                    Б@@@@@@@@@@@@@@@@@@ Б   Форма расчетов -       Б^ Б
  Валюта по контракту -      Б@@@@@@@@@@@@@@@@@@ Б
  Код валюты по контракту -  Б^ Б
  Валютная оговорка -        Б^ Б

  Лицензия Национального банка Республики Казахстан:
  Номер лицензии                                 Дата

  Регистрационное свидетельство Национального Банка Республики Казахстан

  Номер регистрационного свидетельства                  Дата

  Подписи уполномоченных лиц:
  От Банка                                  От Экспортера                             От тамож. органа
  Должность  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б    Должность  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б    Должность  Б^ Б
  Фамилия И.О.  Б@@@@@@@@@@@@@@@@@@@@@@@@@ Б    Фамилия И.О.  Б@@@@@@@@@@@@@@@@@@@@@@@@@ Б    Фамилия И.О.  Б^ Б




      М.П.          Дата                        М.П.          Дата                        М.П.          Дата




  Особые отметки банка, таможенного органа:
  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@



.{
.}
.if Delimiter
 Р---------------------------------------------------------------------------------------------------------------------------- Р
.end
^
.}
.endform
#end