! Почтовый или юридический адрес организации
.function GetKatOrgAddr_ForSF(cOrgRec : Comp; IsNeedJurAddr : Boolean) : String;
var
  aAddr : Comp;
  Str   : String;
begin
  GetKatOrgAddr_ForSF := '';

  if (loFullOrgAdr.GetFirst FastFirstRow PodrInfo where ((cOrgRec == PodrInfo.cPodr)) <> tsOK)
    Exit;

  if (IsNeedJurAddr)
    aAddr := Comp(loFullOrgAdr.PodrInfo.InsNomer);  // Юридический адрес
  else
    aAddr := Comp(loFullOrgAdr.PodrInfo.OKVED);     // Почтовый адрес

  if (loFullOrgAdr.GetFirst FastFirstRow AddressN where ((aAddr == AddressN.NRec)) <> tsOK)
    Exit;

  // Индекс
  Str := '';
  if (loFullOrgAdr.AddressN.sPostInd <> '0')
    Str := Trim(loFullOrgAdr.AddressN.sPostInd);

  // Адрес
  if (Trim(loFullOrgAdr.AddressN.sAddress2) <> '')
  Str := if (Str <> '', Str + ', ', '') + loFullOrgAdr.AddressN.sAddress2;

  if (Trim(loFullOrgAdr.AddressN.sHouse) <> '')
    Str := if (Str <> '', Str + ', ', '') + 'дом ' + loFullOrgAdr.AddressN.sHouse;

  if (Trim(loFullOrgAdr.AddressN.sBlock) <> '')
  {
    Str := Str + if (loFullOrgAdr.AddressN.wDopField1 = 0, ', кор.', ', стр.');
    Str := Str + loFullOrgAdr.AddressN.sBlock;
  }

  if (Trim(loFullOrgAdr.AddressN.sFlat) <> '')
    Str := Str + ', кв. ' + loFullOrgAdr.AddressN.sFlat;

  GetKatOrgAddr_ForSF := Str;
end.

! Полный адрес организации в формах (юридичесикй)
.function FullKatOrgAddr(cOrgRec : Comp): String;
var
  s: string;
  csAttrAddress: string;
  ExAttrFun: iExtAttr;
  LL: KatOrg;
begin
  FullKatOrgAddr := '';
  s := '';
  csAttrAddress:='Юридический адрес';
  loFullOrgAdr.cRecOrg := cOrgRec;

  if (loFullOrgAdr.GetFirst FastFirstRow KatOrg <> 0)
    Exit;

  // Юридический адрес из внешних атрибутов
  s := ExAttrFun.sGetAttr(coKatOrg, loFullOrgAdr.KatOrg.nRec, csAttrAddress);

  // Адрес с закладки Прочее (полный или сокращенный)
  if (Trim(s) = '')
    if boGetTune('Rep.FullOrgAddr')
      s := LL.FullOrgAddr(loFullOrgAdr.KatOrg.nRec);
    else
      s := loFullOrgAdr.KatOrg.Addr;

  // Юридический адрес, закладка Юридическая инфорамация
  if (Trim(s) = '')
    s := GetKatOrgAddr_ForSF(cOrgRec, True);

  FullKatOrgAddr := s;
end.

! Почтовый адрес организации в формах (для грузо-отправителей/получателей)
.function PostKatOrgAddr(cOrgRec : Comp): String;
begin
  PostKatOrgAddr := '';
  loFullOrgAdr.cRecOrg := cOrgRec;

  if (loFullOrgAdr.GetFirst FastFirstRow KatOrg <> 0)
    Exit;

  // Почтовый адрес, закладка Юридическая инфорамация
  PostKatOrgAddr := GetKatOrgAddr_ForSF(cOrgRec, False);
end.

! код плательщика НДС
.function GetKPPOrg(cOrgRec: comp): string;
var  s: string;
begin
  s := '';
  loFullOrgAdr.cRecOrg := cOrgRec;
  if (loFullOrgAdr.GetFirst fastfirstrow KatOrg = 0)
    s := loFullOrgAdr.KatOrg.KodPlatNDS;
  GetKPPOrg := s;
end.

! код УНН
.function GetUnnOrg(cOrgRec: comp): string;
var  s: string;
begin
  s := '';
  loFullOrgAdr.cRecOrg := cOrgRec;
  if (loFullOrgAdr.GetFirst fastfirstrow KatOrg = 0)
    s := loFullOrgAdr.KatOrg.UNN;
  GetUnnOrg := s;
end.
