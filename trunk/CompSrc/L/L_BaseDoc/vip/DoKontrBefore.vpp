//******************************************************************************
//                                                      (c) корпорация Галактика
// Галактика 7.12 - Логистика - документы-основания
// Выбор контрагента в ДО . Часть 1 - проверки перед выбором
//******************************************************************************

  var NRecOld : comp; NRecOld  := BaseDoc.cOrg;
  var NRecBank: comp; NRecBank := BaseDoc.cBank;

  if IsValid(#SpStep)
    if boGetTune('Doc.NotEditOrgWithSpec')
      {
        Message('Не допускается изменять контрагента при заполненной спецификации!'#13 + GetTuneName('Doc.NotEditOrgWithSpec'));
        Exit;
      }

  #ifNdef __manservi__
  var sM_txt: string; sM_txt := '';

  if ( BaseDoc.Nrec <> 0 )
    {
      if IsValid(tnKatSopr)
        sM_txt := ' сопроводительные документы'#13;

      if IsValid(tnBaseFin)
        sM_txt := sM_txt + ' платежные документы'#13;
 
      if ( sM_txt <> '' )
        if ( Message('Внимание!'#13
                   + 'По документу-основанию сформированы: '#13
                   + sM_txt + ''#13
                   + 'Продолжить?', YesNo + mfSwapButtons) <> cmYes )
          Exit;
    }
  #end

  if ( ( BaseDoc.Direct = 1 ) AND ( BaseDoc.cNalog = 2 ) )
    if IsValid(#SpStep)
      {
        Message('При данной настройке пользователя (скидка по контрагенту)'#13
              + 'не допускается изменять контрагента при заполненной спецификации!', Information);
        Exit;
      }
//******************************************************************************
