/*
 ╔═══════════════════════════════════════════════════════════════════════════╗
 ║                     (c) 1994,97 корпорация ГАЛАКТИКА                      ║
 ║ Проект        : ГАЛАКТИКА                                                 ║
 ║ Система       : Оперативный контур                                        ║
 ║ Версия        : 5.00                                                      ║
 ║ Назначение    : процедура проверки корректности каталога кат.док-тов      ║
 ║ Ответственный : Володько Вадим Геннадьевич (VVG)                          ║
 ╚═══════════════════════════════════════════════════════════════════════════╝
*/

Procedure CheckCorrStatDoc;
{
  var n : longint; n := 0;
  PushPos(#StatDoc);

  StartNewVisual(vtIndicatorVisual, vfTimer+vfBreak+vfConfirm,
             ''#3'Проверяю корректность каталога категорий документов...'#13, RecordsInTable(#StatDoc));
  ResetBounds(#StatDoc);
  if (GetFirst StatDoc = tsOK)
  do
    if (not nextvisual)
      break
    else
      if (StatDoc.lStatCode <> length(StatDoc.StatCode))
        {
          StatDoc.lStatCode := length(StatDoc.StatCode);
          if (update current StatDoc <> tsok) {};
          n := n + 1;
        }
  while (GetNext StatDoc = tsOK);
  SetBounds(#StatDoc);
  StopVisual('',0)
  PopPos(#StatDoc);
  if (n > 0)
    message(''#3'Подкорректировано '+string(n) + ' записей в каталоге категорий документов',
                Information + OkButton);
}
