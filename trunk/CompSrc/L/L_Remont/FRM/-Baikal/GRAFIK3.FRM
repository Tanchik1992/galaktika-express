#doc
Годовой график ремонтов
#end
.linkform 'Fgrafik1_07' prototype is 'Fgrafik1'
.group 'Годовой график ремонтов'
.nameinlist '7. Годовой график ремонтов (по объектам)'
.p 60
.defo landscape
.var
  RecObjRem : comp;
  pTIPS     : double;
.endvar
.Create View ObjView
    As Select *
    from ObjRem
    Where ((RecObjRem==ObjRem.nRec));
.fields
NameForm
! период выборки
Date1Filtr Date2Filtr
! фильтр (ограничения)
NameFiltr
! дата формирования
DateForm TimeForm
! поля цикла
NameObj1 InNum Plan R1 R2 R3 R4 R5 R6 R7 R8 R9 R10 R11 R12 DLastRem KolRem NeRab pTIPS
NameObj2 GroupObj   C1 C2 C3 C4 C5 C6 C7 C8 C9 C10 C11 C12
         TexN
         Podr  Fakt
! поля цикла норм
! цикл итоговых сумм
ItogName ItogKol ItogNeRab ItogRab
! всего
TotalName TotalKol TotalNeRab TotalRab
.endfields

 Р              @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

        за период  с: @@@@@@@@@@  по: @@@@@@@@@@
 Р
.{
 Р        @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Р
.}

 Р дата: @@@@@@@@@@         время: @@@@@@@@@@ Р
.{
.[h
 Ш                                                                                                                                  Лист @np@
--------------------------------------------------------------------------------------------------------------------------------------------
  Наименование   : Инвент.номер:    :    I квартал    :   II квартал    :   III квартал   :   IV квартал    : Дата   :Колич: Простои: Работа
  объекта        : группа,нитка:    :-----------------------------------------------------------------------:последн.:ремон: (час)  : (час)
  ремонта        : подразделен.:    :  01 :  02 :  03 :  04 :  05 :  06 :  07 :  08 :  09 :  10 :  11 :  12 :кап.рем.:тов  :        :
-------------------------------------------------------------------------------------------------------------------------------------------- Ш
.]h
.{
.{
.begin
  RecObjRem := NrecObj;
  pTIPS := double(Rab);
  if (ObjView.GetFirst ObjRem = tsOk)
    if (ObjView.ObjRem.TISP > 0)
      pTIPS := ObjView.ObjRem.TISP * 365 - double(NeRab);
end.
 Ш@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@:@@@@:&&&& :&&&& :&&&& :&&&& :&&&& :&&&& :&&&& :&&&& :&&&& :&&&& :&&&& :&&&& :&&&&&&&&:&&&&&:&&&&&&& :&&&&&&&
@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@:    :&&&& :&&&& :&&&& :&&&& :&&&& :&&&& :&&&& :&&&& :&&&& :&&&& :&&&& :&&&& :        :     :        :
                  @@@@@@@@@@@@@:----:-------------------------------------------------------------------------------------------------------
                  @@@@@@@@@@@@@:@@@@:     :     :     :     :     :     :     :     :     :     :     :     :        :     :        :
-------------------------------------------------------------------------------------------------------------------------------------------- Ш
.{
.}
.}
.{
 Ш                                    &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&            &&&&& &&&&&&&& &&&&&&&&
-------------------------------------------------------------------------------------------------------------------------------------------- Ш
.}
.}
 Ш                                    &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&            &&&&& &&&&&&&& &&&&&&&& Ш
.[f

 Ш-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
 Ш
.]f
.}
.endform
