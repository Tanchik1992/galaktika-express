/*
 ╔═══════════════════════════════════════════════════════════════════════════╗
 ║                     (c) 1994, 2001 корпорация ГАЛАКТИКА                   ║
 ║ Проект        : ГАЛАКТИКА                                                 ║
 ║ Система       : Sky Shop                                                  ║
 ║ Версия        : 5.8                                                       ║
 ║ Назначение    : Отчет "О продажах"                                        ║
 ║ Ответственный : Боровский Евгений Васильевич                              ║
 ╚═══════════════════════════════════════════════════════════════════════════╝
*/
#doc
Отчет "О продажах"
#end
.set name = 'Sales'
.hide
.fields
  cGRMC : comp cPlanType : comp cOtvBP : comp DatNakl : word
  bAirPort : boolean bAirKomp : boolean bIATA : boolean
  Заголовок
  НачДата
  КонДата
  ГруппаМЦ
  Самолет
.endfields
  ^ ^ ^ ^ ^ ^ ^
  ^
  ^ ^
  ^
  ^
.{ Sales_ForPort CHECKENTER
.fields
  АэропортН
.endfields
  ^
.}
.{ Sales_ForReys CHECKENTER
.fields
  Рейс
.endfields
  ^
.}
.{ Sales_ForKomp CHECKENTER
.fields
  АвиаКомпания
.endfields
  ^
.}
.fields
  НачДатНакл
  КонДатНакл
  Проводник
  Группировка
.endfields
  ^ ^ ^ ^
.{ Sales_ForRep CHECKENTER
.fields
  Sdvig : boolean
  НаименМЦ
  КодМЦ
  Количество
  Прод
  Цена
  Стоимость
.endfields
  ^
  ^
  ^
  ^
  ^
  ^
  ^
.}
.fields
  Всего
.endfields
  ^
.endform

#doc
О продажах
#end
.linkform  'Sales1' prototype is Sales
.NameInList 'О продажах'
.fields
  CommonFormHeader
  Заголовок
  НачДата
  КонДата
.endfields
^
  Б                                     Отчет о продажах
  @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  Б
 Период вылета:  Б^г.-^г. Б
.{ ?INTERNAL;(cGrMC <> comp(0));
.fields
  ГруппаМЦ
.endfields
 Группа МЦ:  Б^ Б
.}
.{ ?INTERNAL;(cPlanType <> comp(0));
.fields
  Самолет
.endfields
 Тип самолета:  Б^ Б
.}
.{ ?INTERNAL;(bAirPort);
 Аэропорт назначения:
.{ Sales_ForPort CHECKENTER
.fields
  АэропортН
.endfields
  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
.}
.}
.{ ?INTERNAL;(bIATA);
 Рейс:
.{ Sales_ForReys CHECKENTER
.fields
  Рейс
.endfields
  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
.}
.}
.{ ?INTERNAL;(bAirKomp);
 Авиакомпания:
.{ Sales_ForKomp CHECKENTER
.fields
  АвиаКомпания
.endfields
  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
.}
.}
.{ ?INTERNAL;(DatNakl = word(12));
.fields
  НачДатНакл
  КонДатНакл
.endfields
 Период формирования денежной накладной:  Б^г.-^г. Б
.}
.{ ?INTERNAL;(DatNakl = word(1));
.fields
  НачДатНакл
.endfields
 Период формирования денежной накладной:  Бс ^г.
.}
.{ ?INTERNAL;(DatNakl = word(2));
.fields
  КонДатНакл
.endfields
 Период формирования денежной накладной:  Бпо ^г.
.}
.{ ?INTERNAL;(cOtvBP <> comp(0));
.fields
  Проводник
.endfields
 Ответственный б/п:  Б^ Б
.}
.fields
  Группировка
.endfields
 Группировка:  Б^ Б
 ┌────────────────────────────────────────────┬──────────────┬─────────────────────────┬──────────────┬──────────────┐
 │                                            │              │       Количество        │              │              │
 │            Наименование МЦ                 │     Код      ├────────────┬────────────┤     Цена     │   Стоимость  │
 │                                            │              │  Отпущено  │  Продано   │              │              │
 ├────────────────────────────────────────────┼──────────────┼────────────┼────────────┼──────────────┼──────────────┤
 │                    1                       │      2       │     3      │     4      │      5       │       6      │
 └────────────────────────────────────────────┴──────────────┴────────────┴────────────┴──────────────┴──────────────┘
.{ Sales_ForRep CHECKENTER
.{ ?INTERNAL;(not Sdvig);
.fields
  НаименМЦ
  КодМЦ
  Количество
  Прод
  Цена
  Стоимость
.endfields
   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@       @@@@@@@@@@@@   &'&&&&&&&&   &'&&&&&&&&   &'&&&&&&&.&&    Б&'&&&&&&&.&& Б
.}
.{ ?INTERNAL;(Sdvig);
.fields
  НаименМЦ
  КодМЦ
  Количество
  Прод
  Цена
  Стоимость
.endfields
      @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@       @@@@@@@@@@@@   &'&&&&&&&&   &'&&&&&&&&   &'&&&&&&&.&&   &'&&&&&&&.&&
.}
.}

.fields
  Всего
.endfields
                                 ВСЕГО:                                                               Б&'&&&&&&&&&&.&& Б

.endform
