/*
 ╔════════════════════════════════════════════════════════════════════════════╗
 ║                     (c) Корпорация ГАЛАКТИКА, 1996,97                      ║
 ║ Проект        : ГАЛАКТИКА                                                  ║
 ║ Система       : Оперативный контур                                         ║
 ║ Версия        : 5.00                                                       ║
 ║ Назначение    : Отчет по курсам валют                                      ║
 ║ Ответственный : Володько Вадим Геннадьевич (VVG)                           ║
 ╚════════════════════════════════════════════════════════════════════════════╝
*/
#doc
Отчет по курсам валют
#end
.set name = 'CURSVAL'
.hide
.fields
  dat1 dat2
  rublah
  sumv simvv
  datcurs curse diflast diffirst
.endfields
с ^ по ^
.{
наименование нац.валюты: ^
сумма в валюте: ^
символ валюты: ^
.{
дата: @@@@@@@@@@ курс: &&&&&&&&&&&& изменения (last)&&&&&.&&&& (first)&&&&.&&&&
.}
.}
.endform
!
!
!
#doc
Отчет по курсам валют: ДАТА - КУРС
#end
.linkform 'cursval_1' prototype is 'cursval'
.nameinlist 'Отчет по курсам валют: ДАТА - КУРС'
.fields
  CommonFormHeader
  dat1 dat2
  'Сумма в ' + rublah + ' за ' + sumv + ' ' + simvv
  datcurs curse
.endfields
^
     ┌─────────────────────────────────────────┐
     │ Курсы валюты с @@@@@@@@@@ по @@@@@@@@@@ │
     └─────────────────────────────────────────┘
.{
           ┌──────────────┬────────────────┐
           │              │                │
           │  Дата курса  │@~@@@@@@@@@@@@@@│
           ├──────────────┼────────────────┤
.{
           │ @@@@@@@@@@ г.│&'&&&&&&&&&.&&&&│
.}
           └──────────────┴────────────────┘
----------------------------------------------------------------
.}
.endform
!
!
!
#doc
Отчет по курсам валют: ДАТА - КУРС - ИЗМЕНЕНИЯ
#end
.linkform 'cursval_2' prototype is 'cursval'
.nameinlist 'Отчет по курсам валют: ДАТА - КУРС - ИЗМЕНЕНИЯ'
.fields
  CommonFormHeader
  dat1 dat2
  'Сумма в ' + rublah + ' за ' + sumv + ' ' + simvv
  datcurs curse diflast diffirst
.endfields
^
         ┌─────────────────────────────────────────┐
         │ Курсы валюты с @@@@@@@@@@ по @@@@@@@@@@ │
         └─────────────────────────────────────────┘
.{
 ┌────────────┬────────────────┬───────────────────────────┐
 │ Дата курса │@~@@@@@@@@@@@@@@│      Изменения курса      │
 │            │                │  за день    │  с начала   │
 ├────────────┼────────────────┼─────────────┼─────────────┤
.{
 │@@@@@@@@@@г.│&'&&&&&&&&&.&&&&│&&&&&&&.&&&& │&&&&&&&.&&&& │
.}
 └────────────┴────────────────┴─────────────┴─────────────┘

----------------------------------------------------------------
.}

ПРИМЕЧАНИЯ:
1) изменение "за день" означает изменение курса от предыдущей даты
2) изменение "с начала" - прирост в процентах от первой найденной даты курса

.endform
!
!
!
#doc
Отчет по курсам валют: ДАТА - КУРС - ИЗМЕНЕНИЯ от 1й даты
#end
.linkform 'cursval_3' prototype is 'cursval'
.nameinlist 'Отчет по курсам валют: ДАТА - КУРС - ИЗМЕНЕНИЯ от 1й даты'
.fields
  CommonFormHeader
  dat1 dat2
  'Сумма в ' + rublah + ' за ' + sumv + ' ' + simvv
  datcurs curse diffirst
.endfields
^
       ┌──────────────────────────────────────────┐
       │ Курсы валюты  с @@@@@@@@@@ по @@@@@@@@@@ │
       └──────────────────────────────────────────┘
.{
    ┌────────────┬────────────────┬──────────────────┐
    │            │                │                  │
    │ Дата курса │@~@@@@@@@@@@@@@@│ Рост от 1й даты  │
    ├────────────┼────────────────┼──────────────────┤
.{
    │@@@@@@@@@@г.│&'&&&&&&&&&.&&&&│   &&&&&&&.&&&&   │
.}
    └────────────┴────────────────┴──────────────────┘
----------------------------------------------------------------
.}

ПРИМЕЧАНИЕ:
"Рост от 1й даты" - прирост в процентах
         от первой найденной даты курса
.endform
!
!
!
#doc
Отчет по курсам валют: ДАТА - КУРС - ПРОЦЕНТ РОСТА
#end
.linkform 'cursval_4' prototype is 'cursval'
.nameinlist 'Отчет по курсам валют: ДАТА - КУРС - ПРОЦЕНТ РОСТА'
.fields
  CommonFormHeader
  dat1 dat2
  'Сумма в ' + rublah + ' за ' + sumv + ' ' + simvv
  datcurs curse diflast
.endfields
^
       ┌──────────────────────────────────────────┐
       │ Курсы валюты  с @@@@@@@@@@ по @@@@@@@@@@ │
       └──────────────────────────────────────────┘
.{
    ┌────────────┬────────────────┬──────────────────┐
    │            │                │                  │
    │ Дата курса │@~@@@@@@@@@@@@@@│   Процент роста  │
    ├────────────┼────────────────┼──────────────────┤
.{
    │@@@@@@@@@@г.│&'&&&&&&&&&.&&&&│   &&&&&&&.&&&&   │
.}
    └────────────┴────────────────┴──────────────────┘
----------------------------------------------------------------
.}
.endform
!
!
!