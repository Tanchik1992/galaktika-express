/*
 ╔═══════════════════════════════════════════════════════════════════════════╗
 ║                     (c) 1994,99 корпорация ГАЛАКТИКА                      ║
 ║ Проект        : ГАЛАКТИКА                                                 ║
 ║ Система       : Автотранспорт                                             ║
 ║ Версия        : 5.71                                                      ║
 ║ Назначение    : Оплата водителям                                          ║
 ║ Ответственный : Лисица Наталья Михайловна                                 ║
 ╚═══════════════════════════════════════════════════════════════════════════╝
*/
.set name='Ved_OPL'
.hide
!.p 60
.fields
  Filtr
 BegDate  EndDate
 NaimPred  dat
 Podraz
 VidOplName
 BegDatef  EndDatef   Podrazf  Tabn FIO Nudo FIOSt NudoSt
 NrecPutLst NomPutLst DataVip DataVZ DataVoz TimeVz TimeVoz
 TranspNom GarNom
 Katzak_nrec :comp  NumZak OKPOORG NameORG KatpodrToKod KatpodrTo
 DataExitFk  TimeExitFk
 DataReturnFk  TimeReturnFk
 Katzak_Mainnrec :comp  NumZak_Main
 DataExitPl  TimeExitPl
 DataReturnPl TimeReturnPl
 NoVod TabnPl  FioPL
 GsmWydano GsmOstBeg GsmOstEnd GsmNorm GsmFact GsmEkonom GsmPeregog Probeg Stoim
 Marshrut SpeedExi SpeedRet npVirVal vkVirVal TCSdal TCPrinJal DoktExi DoktRet
 NrecPutLstD NomPutLstD KolDn Chasf Vidopl NaimVidopl  Summa : Double
 ItgSumma
.endfields

.{
^
.}
^ ^ ^ ^
.{
^
.{
^
.{
^ ^ ^ ^ ^ ^ ^ ^
.{
^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^
^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^  ^
.{
^ ^ ^ ^ ^ ^ ^
.}
^
.}
.}
.}
.}
.endform

.linkform 'Ved_Opl_01' prototype is 'Ved_OPL'
.NameInList 'Справка о заработной плате водителей'
.Group 'Оплата'
!.p 60
.fields
! CommonFormHeader
  Filtr
 BegDate  EndDate
 NaimPred  dat
 Podraz
 VidOplName

 Podrazf  Tabn FIO
 DataVip DataVZ DataVoz NomPutLst TimeVz TimeVoz
 KolDn Chasf Vidopl NaimVidopl  Summa
 ItgSumma
.endfields

.{
^
.}
       Справка о заработной плате водителей по путевым листам
             дата выписки: c @@@@@@@@@@ по  @@@@@@@@@@
         @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                                         @@@@@@@@@@@@@@@@@@@@@
.{
   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.{
   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.{
─────────┬──────────┬───────────────────────────────────────────
Подразд. │Таб.номер │  Фамилия И.О.
@@@@@@@@@│&&&&&&&&&&│   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
─────────┴──────────┴───────────────────────────────────────────
.{
N путев.  :  Вып-ка: @@@@@@@@@@  выез.@@@@@@@@@@ возв.@@@@@@@@@@
@@@@@@@@@@@@@@         время :    выез.@@@@@@@@   возв.@@@@@@@@
──────┬──────┬────┬────────────────────────────────┬────────────
Кол.дн│ Часов│ Код│   Наименование вида оплат      │  Сумма
──────┴──────┴────┴────────────────────────────────┴────────────
.{
&&&&.& &&&&.& &&&&  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@  &'&&&&&&&.&&
.}
                                      Начислено____ &'&&&&&&&.&&
────────────────────────────────────────────────────────────────
.}

-----------------------------------------------------------------
.}
.}
.}
.endform

.linkform 'Ved_Opl_02' prototype is 'Ved_OPL'
.NameInList 'Ведомость о заработной плате водителей'
.Group 'Оплата'
.var
  Money : Double ;
  Moneypodraz : Double ;
.endvar
!.p 60
.fields
! CommonFormHeader
  Filtr
 BegDate  EndDate
 NaimPred  dat
 Podraz
 VidOplName

 Podrazf  Tabn FIO

 KolDn Chasf Vidopl Summa
 ItgSumma
.endfields

.{
^
.}
.Begin
  Money := 0 ;
  Moneypodraz := 0 ;
End.
       Ведомость о заработной плате водителей по путевым листам
             дата выписки: c @@@@@@@@@@ по  @@@@@@@@@@
         @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                                         @@@@@@@@@@@@@@@@@@@@@
.{
.Begin
  Moneypodraz := 0 ;
End.
   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.{
.Begin
  Money := 0 ;
End.
   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.{
─────────┬──────────┬───────────────────────────────────────────
Подразд. │Таб.номер │  Фамилия И.О.
@@@@@@@@@│&&&&&&&&&&│   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
─────────┴──────────┴───────────────────────────────────────────
.{
──────┬──────┬────┬────────────
Кол.дн│ Часов│ Код│  Сумма
──────┴──────┴────┴────────────
.{
&&&&.& &&&&.& &&&& &'&&&&&&&.&&
.Begin
  Money := Money + Summa ;
End.
.}
     Начислено____ &'&&&&&&&.&&
───────────────────────────────
.}
.}
.Fields
  VidOplName Money
.endfields
.Begin
  Moneypodraz := Money + Moneypodraz;
End.
Итого по @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@  &'&&&&&&&.&&
.}
.Fields
  Podraz Moneypodraz
.endfields
Итого по @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@  &'&&&&&&&.&&


.}
.endform

.linkform 'Ved_Opl_03' prototype is 'Ved_OPL'
.NameInList 'Итоговая ведомость оплаты водителей'
.Group 'Оплата'
.var
  TAbNNN : String ;
  FIONNN : String ;
  Money : Double ;
  Moneypodraz : Double ;
  NomPutLstDT : String ;
  KolDnT: String ;
  ChasfT: String ;
  SummaT: Double ;
.endvar
!.p 60
.fields
! CommonFormHeader
  Filtr
 BegDate  EndDate
 NaimPred  dat
 Podraz
 VidOplName
.endfields

.{
^
.}
.Begin
  Money := 0 ;
  Moneypodraz := 0 ;
End.
       Итоговая ведомость оплаты водителей по путевым листам
             дата выписки: c @@@@@@@@@@ по  @@@@@@@@@@
         @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                                         @@@@@@@@@@@@@@@@@@@@@
.{
.Begin
  Moneypodraz := 0 ;
End.
   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.{
.Begin
  Money := 0 ;
End.
   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.{
──────────┬──────────────────────────────────────────┬───────────────┬───────┬──────┬────────────
Таб.номер │  Фамилия И.О.                            │ N путев.  :   │ Кол.дн│ Часов│   Сумма
──────────┴──────────────────────────────────────────┴───────────────┴───────┴──────┴────────────
.{
.{
.Begin
  TabNNN := TabN ;
  FIONNN := FIO ;
  NomPutLstDT := NomPutLstD ;
  KolDnT := KolDn ;
  ChasfT := Chasf ;
  SummaT := Summa ;
End.
.Fields
  TabNNN FioNNN
  NomPutLstDT
  KolDnT
  ChasfT
  SummaT
.endfields
&&&&&&&&&& @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@   &&&&.& &&&&.& &'&&&&&&&.&&
.Begin
  Money := Money + Summa ;
End.
.}
────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.}
.}
.Fields
  VidOplName Money
.endfields
.Begin
  Moneypodraz := Money + Moneypodraz;
End.
Итого по @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@  &'&&&&&&&.&&

.}
.Fields
  Podraz Moneypodraz
.endfields
Итого по @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@  &'&&&&&&&.&&


.}
.endform
.linkform 'Ved_Opl_04' prototype is 'Ved_OPL'
.NameInList 'Лицевая карточка в формате ТЕКСТ'
.Group 'Карточка'
!.p 60
.fields
! CommonFormHeader
  Filtr
 NaimPred
 BegDatef EndDatef FIO Tabn
 DataVoz NomPutLst TranspNom GsmNorm GsmFact GsmEkonom GsmPeregog
.endfields
.{
^
.}
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

.{
.{
.{
                    ЛИЦЕВАЯ КАРТОЧКА
        за период c @@@@@@@@@@ по  @@@@@@@@@@

ФИО @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
Табельный номер &&&&&&&&&&
┌──────────┬──────────┬──────────┬────────────────────────────────────────┐
│  Дата    │ Номер    │Номер     │         Расход топлива                 │
│          │ путевого │автомобиля├─────────┬──────────┬─────────┬─────────┤
│          │          │          │По норме │Фактически│ Экономия│Пережег  │
├──────────┼──────────┼──────────┼─────────┼──────────┼─────────┼─────────┤
.{
│@@@@@@@@@@│@@@@@@@@@@│@@@@@@@@@@│@@@@@@@@@│@@@@@@@@@ │@@@@@@@@@│@@@@@@@@@│
.{
.}
.}
└──────────┴──────────┴──────────┴─────────┴──────────┴─────────┴─────────┘

---------------------------------------------------------------------------
.}
.}
.}
.endform
.linkform 'Ved_Opl_06' prototype is 'Ved_OPL'
.NameInList 'Ведомость расчетов по ГСМ в формате ТЕКСТ'
.Group 'Карточка'
.var
 Npp : word;
.endVar
.fields
 Filtr
 BegDate  EndDate
 NaimPred  dat
 Podraz
 Npp FIO Tabn TranspNom GarNom Probeg GsmNorm GsmFact GsmEkonom Stoim GsmPeregog
.endfields

.{
^
.}
                            ВЕДОМОСТЬ РАСЧЕТОВ
                с водителями за экономию и перерасход топлива

             за период: c @@@@@@@@@@ по  @@@@@@@@@@
         @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                                         @@@@@@@@@@@@@@@@@@@@@
.{
   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
┌────┬───────────────┬──────────┬───────────────────┬───────┬─────────────────────┬─────────┬─────────┬──────────┐
│N   │     ФИО       │ Табельный│  Номер автомобиля │Пробег │    Расход топлива   │Экономия │  Сумма  │Перерасход│
│п.п.│               │ номер    ├─────────┬─────────┤автом.,├──────────┬──────────┤         │         │          │
│    │               │          │ Гос.    │ Гар.    │км     │По норме  │Фактически│         │         │          │
├────┼───────────────┼──────────┼─────────┼─────────┼───────┼──────────┼──────────┼─────────┼─────────┼──────────┤
.begin
Npp := 1
end.
.{
.{
.{
│@@@ │@@@@@@@@@@@@@@@│@@@@@@@@@@│@@@@@@@@@│@@@@@@@@@│@@@@@@@│@@@@@@@@@@│@@@@@@@@@@│@@@@@@@@@│@@@@@@@@@│@@@@@@@@@ │
.begin
Npp := Npp + 1
end.
.{
.}
.}
.}
.}
└────┴───────────────┴──────────┴─────────┴─────────┴───────┴──────────┴──────────┴─────────┴─────────┴──────────┘
-----------------------------------------------------------------------------------------------------------------
.}
.endform
.linkform 'Ved_Opl_08' prototype is 'Ved_OPL'
.NameInList 'Маршрутный лист в формате ТЕКСТ'
.Group 'Маршрутный лист'
.fields
 Filtr
 NaimPred
 Podraz
 dat
 FIO
 Nudo
 FIOSt
 NudoSt
 NomPutLst
 GarNom
 DataVip
 TimeVz
 Marshrut
 DoktExi
 DoktRet
 SpeedExi
 SpeedRet
 npVirVal
 vkVirVal
 GsmWydano
 GsmOstBeg
 GsmOstEnd
 TCSdal
 TCPrinJal
.endfields
.{
^
.}
.{
  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

  Маршрутный лист N
.{
.{
Дата выдачи  @@@@@@@@@@@@@@@@@@@@@@@
Водитель @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
Удостоверение @@@@@@@@@@@@@@@@@@@@@
Стажер @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
Удостоверение @@@@@@@@@@@@@@@@@@@@@
┌────────┬───────┬──────────┬──────┬────────────────┬──────────┬──────────┬───────────────────────────────────┬─────────────────────────────────┬──────────┬──────────┬──────────┐
│Номер   │Гар.   │  Дата    │Время │Задание водителю│  Выезд   │  Заезд   │             Показания             │       Движение горючего         │Автомобиль│Автомобиль│Подпись   │
│путевого│номер  │ выезда   │выезда│маршрут и его   │ разрешаю │ разрешаю ├─────────────────┬─────────────────┼───────────────┬─────────────────┤сдал      │принял    │лица      │
│листа   │а.с    │          │      │наименование    │ фельдшер │ фельдшер │   Спидометр     │     Моточасы    │     Выдано    │     Остаток     │водитель  │водитель  │тех.      │
│        │       │          │      │                │          │          ├────────┬────────┼────────┬────────┼────────┬──────┼────────┬────────┤          │          │надзора   │
│        │       │          │      │                │          │          │ выезд  │  заезд │ выезд  │заезд   │        │подп. │ выезд  │ заезд  │          │          │          │
│        │       │          │      │                │          │          │        │        │        │ опер.  │        │      │        │        │          │          │          │
├────────┼───────┼──────────┼──────┼────────────────┼──────────┼──────────┼────────┼────────┼────────┼────────┼────────┼──────┼────────┼────────┼──────────┼──────────┼──────────┤
│   1    │   2   │    3     │  4   │       5        │     6    │     7    │    8   │   9    │   10   │   11   │    12  │  13  │   14   │   15   │    16    │    17    │    18    │
├────────┼───────┼──────────┼──────┼────────────────┼──────────┼──────────┼────────┼────────┼────────┼────────┼────────┼──────┼────────┼────────┼──────────┼──────────┼──────────┤
.{
│@@@@@@@@│@@@@@@@│@@@@@@@@@@│@@@@@@│@@@@@@@@@@@@@@@@│@@@@@@@@@@│@@@@@@@@@@│&&&&&.&&│&&&&&.&&│&&&&&.&&│&&&&&.&&│&&&&&.&&│      │&&&&&.&&│&&&&&.&&│@@@@@@@@@@│@@@@@@@@@@│          │
.{
.}
.}
└────────┴───────┴──────────┴──────┴────────────────┴──────────┴──────────┴────────┴────────┴────────┴────────┴────────┴──────┴────────┴────────┴──────────┴──────────┴──────────┘
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
.}
.}
.}
.endform
.linkform 'Ved_Opl_77' prototype is 'Ved_OPL'
.NameInList 'Журнал c заказами'
.Group 'Журнал с учетом заказам'
.fields
 Filtr
 NaimPred
 Podraz
 FIO
 NomPutLst
 TranspNom
 GarNom
 DataExitFk TimeExitFk
 DataExitPl  TimeExitPl
 DataReturnFk TimeReturnFk
 DataReturnPl  TimeReturnPl
 NameORG
 SpeedExi
 SpeedRet
 NoVod
.endfields
.{
^
.}
.{
  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

.{
.{
Водитель @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
┌──────────┬─────────┬──────────┬──────────┬──────┬──────────┬──────┬──────────┬──────┬──────────┬──────┬────────────────┬─────────────────┬─────┬──────────┐
│ Номер    │ Гoc.    │ Гар.     │  Дата    │Время │  Дата    │Время │  Дата    │Время │  Дата    │Время │   Заказчик     │                 │Отм. │Подпись   │
│ путевого │ номер   │ номер    │ выезда   │выезда│ выезда   │выезда│ возвр.   │возвр.│  возвр.  │возвр.│                │   Спидометр     │ о   │          │
│ листа    │         │          │  факт    │ факт │  план    │ план │ факт     │ факт │  план    │ план │                │                 │заме-│          │
│          │         │          │          │      │          │      │          │      │          │      │                ├────────┬────────│не   │          │
│          │         │          │          │      │          │      │          │      │          │      │                │ выезд  │  заезд │води-│          │
│          │         │          │          │      │          │      │          │      │          │      │                │        │        │теля │          │
├──────────┼─────────┼──────────┼──────────┼──────┼──────────┼──────┼──────────┼──────┼──────────┼──────┼────────────────┼────────┼────────┼─────┼──────────┤
│    1     │    2    │    3     │    4     │  5   │    6     │  7   │    8     │  9   │    10    │  11  │       12       │   13   │   14   │ 15  │    16    │
├──────────┼─────────┼──────────┼──────────┼──────┼──────────┼──────┼──────────┼──────┼──────────┼──────┼────────────────┼────────┼────────┼─────┼──────────┤
.{
│@@@@@@@@@@│@@@@@@@@@│@@@@@@@@@@│@@@@@@@@@@│@@@@@@│@@@@@@@@@@│@@@@@@│@@@@@@@@@@│@@@@@@│@@@@@@@@@@│@@@@@@│@@@@@@@@@@@@@@@@│&&&&&.&&│&&&&&.&&│@@@@@│          │
.{
.}
.}
└──────────┴─────────┴──────────┴──────────┴──────┴──────────┴──────┴──────────┴──────┴──────────┴──────┴────────────────┴────────┴────────┴─────┴──────────┘
.}
.}
.}
.endform