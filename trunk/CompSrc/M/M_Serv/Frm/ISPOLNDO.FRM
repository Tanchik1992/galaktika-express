/*
 ╔═══════════════════════════════════════════════════════════════════════════╗
 ║                     (c) 1994,97 корпорация ГАЛАКТИКА                      ║
 ║ Проект        : ГАЛАКТИКА                                                 ║
 ║ Система       : Производство                                              ║
 ║ Версия        : 5.20                                                      ║
 ║ Назначение    : Отчеты-Ведомость по закрытым заявкам на обслуживание      ║
 ║ Ответственный : Журбенко Юрий Иванович (YURI)                             ║
 ╚═══════════════════════════════════════════════════════════════════════════╝
*/

.Set Name = 'IspolnDo'
.NameInList '00. Базовая форма'
.hide
.fields
 с_дата_по_дата

 имя_подразделения
  поряд_номер
   по_заказу комплект Заказчик ФИО_Заказчик Предмет_ремонта ПримечаниеДО
     ГруппаТ НоменклТ Имя_Товар ЕдИзмТ КоличвоТ ЦенаТ СтоимостьТ
      Итого_Товар
     ГруппаУ НоменклУ Имя_Услуг ЕдИзмУ КоличвоУ ЦенаУ СтоимостьУ
      Итого_Услуг
   Итого_по_заказу
 заказов_по_подразделению
 Итого_по_подразделению
 заказов_по_предприятию
Итого_по_предприятию
.endfields

                         По закрытым заявкам
@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

.{ // подразделение
^
.{ // заказ+дата Комлект Заказчик ФИО Предмет_ремонта ПримечаниеДО
^
 ^  ^
  ^
   @@@@@@@@@@@@@@@@@@@@@@@@   ^ ^
.{ // группа    номенкл          имя            ЕдИзм     Количво            Цена            Стоимость
@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@ @@@@@@@@@@@@@  @@@@@@@@@@ &'&&&&&&&&&.&&& &'&&&&&&&&&&&&.&& &'&&&&&&&&&&&&.&&
.}
                                                         Итого по запчастям: &'&&&&&&&&&&&&.&&
.{ // группа    номенкл          имя            ЕдИзм     Количво            Цена            Стоимость
@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@ @@@@@@@@@@@@@  @@@@@@@@@@ &'&&&&&&&&&.&&& &'&&&&&&&&&&&&.&& &'&&&&&&&&&&&&.&&
.}
                                                         Итого по услугам:   &'&&&&&&&&&&&&.&&
                                                         Итого по заказу:    &'&&&&&&&&&&&&.&&
.}
Итого по подразделению   заказов @@@@@ на сумму:                             &'&&&&&&&&&&&&.&&
.if BreakIspoln
.end
.}

Итого по предприятию     заказов @@@@@ на сумму:                             &'&&&&&&&&&&&&.&&

.endform
//--------------------------------------------------------------------------
.Linkform 'IspolnDo1' prototype is 'IspolnDo'
.NameInList '01. Подробная ведомость по закрытым заявкам на обслуживание'
.fields
 с_дата_по_дата

 имя_подразделения
   по_заказу комплект
     ГруппаТ НоменклТ Имя_Товар ЕдИзмТ КоличвоТ ЦенаТ СтоимостьТ
      Итого_Товар
     ГруппаУ НоменклУ Имя_Услуг ЕдИзмУ КоличвоУ ЦенаУ СтоимостьУ
      Итого_Услуг
   Итого_по_заказу
 Итого_по_подразделению
Итого_по_предприятию
.endfields

          Подробная ведомость по закрытым заявкам на обслуживание
@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

.{ // подразделение
  ^
┌───────────────────┬──────────────┬────────────────────┬──────────┬───────────────┬─────────────────┬─────────────────┐
│   Г р у п п а     │ Номенкл.номер│    Наименование    │  Ед.Изм. │  Количество   │      Цена       │    Стоимость    │
└───────────────────┴──────────────┴────────────────────┴──────────┴───────────────┴─────────────────┴─────────────────┘
.{ // заказ+дата Комлект
 по заказу ^  ^
.{ //               номенкл           имя               ЕдИзм     Количво            Цена            Стоимость
 @@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@ &'&&&&&&&&&.&&& &'&&&&&&&&&&&&.&& &'&&&&&&&&&&&&.&&
.}
                                                Итого по запчастям:             &'&&&&&&&&&&&&&&.&&

.{ //               номенкл           имя               ЕдИзм     Количво            Цена            Стоимость
 @@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@ &'&&&&&&&&&.&&& &'&&&&&&&&&&&&.&& &'&&&&&&&&&&&&.&&
.}

                                                Итого по услугам:               &'&&&&&&&&&&&&&&.&&

                                                Итого по заказу:               &'&&&&&&&&&&&&&&&.&&
.}
                                                Итого по подразделению:       &'&&&&&&&&&&&&&&&&.&&

────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.if BreakIspoln
.end
.}
                                                Итого по предприятию:         &'&&&&&&&&&&&&&&&&.&&
.endform
//-------------------------------------------------------------------------------------------------
.Linkform 'IspolnDo2' prototype is 'IspolnDo'
.NameInList '02. Ведомость по закрытым заявкам на обслуживание'
.p 60
.fields
 с_дата_по_дата

 имя_подразделения
  поряд_номер
   по_заказу Заказчик ФИО_Заказчик Предмет_ремонта
      Итого_Товар
      Итого_Услуг
   Итого_по_заказу ПримечаниеДО
 заказов_по_подразделению
 Итого_по_подразделению
'true':'s'
 заказов_по_предприятию
Итого_по_предприятию
.endfields

              Ведомость по закрытым заявкам на обслуживание
@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

.{ // подразделение
  ^
 ───────────────────────┬────────────────────┬─────────────────────────┬───────────────────────────────────┬─────────────────┬─────────────────┬─────────────────┬───────────────
    Номер и дата заказа │      Заказчик      │      Фамилия И.О.       │          Предмет ремонта          │  По запчастям   │   По услугам    │     По заказу   │  Примечание
 ───────────────────────┴────────────────────┴─────────────────────────┴───────────────────────────────────┴─────────────────┴─────────────────┴─────────────────┴───────────────
.{
.{
.}
.{
.}
@@@@ @@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&&.&& &'&&&&&&&&&&&&.&& &'&&&&&&&&&&&&.&& @@@@@@@@@@@@@@@
.}
                            Итого по подразделению заказов: @@@@@@                                                      на сумму :          &'&&&&&&&&&&&&&&&&.&&
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.if BreakIspoln
^
.end
.}
                            Итого по предприятию заказов  : @@@@@@                                                      на сумму :          &'&&&&&&&&&&&&&&&&.&&
.endform


//-------------------------------------------------------------------------------------------------
.Linkform 'IspolnDo3' prototype is 'IspolnDo'
!.NameInList '03. Краткая ведомость по закрытым заявкам на обслуживание'
.hide
.fields
 с_дата_по_дата

 имя_подразделения
   по_заказу Заказчик ФИО_Заказчик Предмет_ремонта
      Итого_Товар
      Итого_Услуг
   Итого_по_заказу
 Итого_по_подразделению
Итого_по_предприятию
.endfields

              Ведомость по закрытым заявкам на обслуживание
@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

.{ // подразделение
  ^
┌─────────────────────┬────────────────────┬──────────────┐
│ Номер и дата заказа │        Заказчик    │   Ф.И.О.     │
└─────────────────────┴────────────────────┴──────────────┘
.{
 @@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@
 ^
.{
.}
    Итого по запчастям :   &'&&&&&&&&&&&&.&&
.{
.}
    Итого по услугам   :   &'&&&&&&&&&&&&.&&
    Итого по заказу    :  &'&&&&&&&&&&&&&.&&

.}
Итого по подразделению : &'&&&&&&&&&&&&&&.&&
───────────────────────────────────────────────────────────
.if BreakIspoln
.end
.}
Итого по предприятию   : &'&&&&&&&&&&&&&&.&&
.endform
//------------------------------------------------------------------------------
