/*
 ╔═══════════════════════════════════════════════════════════════════════════╗
 ║                     (c) 1994,97 корпорация ГАЛАКТИКА                      ║
 ║ Проект        : ГАЛАКТИКА                                                 ║
 ║ Система       : Производство                                              ║
 ║ Версия        : 5.00                                                      ║
 ║ Назначение    : Отчеты-Оборотно сальдовая ведомость движения МЦ           ║
 ║                        в производстве                                     ║
 ║ Ответственный : Журбенко Юрий Иванович (YURI)                             ║
 ║ Изменения : Зайцев Александ Владимирович (AXE) - добавлены итоговые суммы ║
 ╚═══════════════════════════════════════════════════════════════════════════╝
*/
.Set Name = 'ObSaldo'
.NameInList 'Базовая форма'
.hide
.fields
  c_no_дата
  получатель имя_подразделения
  матценность номенклномер един_измерения   //5

  вх_остат   : double  цена_вх               стоим_вх      : double
  приход     : double  цена_прихода : double стоим_прихода : double
  перераб    : double  цена_перераб          стоим_перераб : double
  перем    : double  цена_перем          стоим_перем       : double
  возврат    : double  цена_возврат          стоим_возврат : double
  исход_остат: double  цена_исх              стоим_исх     : double
.endfields

       ОБОРОТНО САЛЬДОВАЯ ВЕДОМОСТЬ ДВИЖЕНИЯ МЦ В ПРОИЗВОДСТВЕ

@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.{
 ^^
.{
  Наименование         НоменклНомер ЕдUзм
  @@@@@@@@@@@@@@@@@@@@ ^            ^
  ВходOct     Цена  вх.ост      // Стоим вх.ост
  &&&&&&.&&&  &'&&&&&&&&&.&&   &'&&&&&&&&&&.&&
  Поступило   ЦенаПриходов       CтоимПриходов
  &&&&&&.&&&  &'&&&&&&&&&.&&   &'&&&&&&&&&&.&&
  Переработ   Цена Перераб        СтоимостьПерераб
  &&&&&&.&&&  &'&&&&&&&&&.&&   &'&&&&&&&&&&.&&
  Перемещено   Цена Перемещено  СтоимостьПеремещено
  &&&&&&.&&&  &'&&&&&&&&&.&&   &'&&&&&&&&&&.&&
  Возвращено  Цена Возвращ        СтоимосВозвращ
  &&&&&&.&&&  &'&&&&&&&&&.&&   &'&&&&&&&&&&.&&
  ИсходOct    Цена ИсходОст       СтоимостьИсходОст
  &&&&&&.&&&  &'&&&&&&&&&.&&   &'&&&&&&&&&&.&&
.}
!  &&&&&&&.&&&
.}

.endform

.linkform 'ObSaldo_01' prototype is ObSaldo
.NameInList 'ОБОРОТЫ  ПО ОТПУСКУ МЦ В ПОДРАЗДЕЛЕНИЯ'

.fields
!  CommonFormHeader
  c_no_дата
  получатель имя_подразделения
  матценность номенклномер един_измерения
  вх_остат    стоим_вх
  приход      стоим_прихода
  перераб     стоим_перераб
  перем       стоим_перем
  возврат     стоим_возврат
  исход_остат стоим_исх
.endfields
.var
 sumvhost:Double
sumprih :Double
sumperer:Double
sumperem:Double
sumvozvr:Double
sumishost:Double
.endVar
! ^

       ОБОРОТНО САЛЬДОВАЯ ВЕДОМОСТЬ ДВИЖЕНИЯ МЦ В ПРОИЗВОДСТВЕ

@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

 Ш────────────┬─────────────────┬───────────┬─────────────────┬───────────┬─────────────────┬───────────┬─────────────────┬───────────┬─────────────────┬───────────┬─────────────────
  Входящий  │   Стоимость     │  Приходы  │   Стоимость     │Переработа-│   Стоимость     │ Перемещено│    Стоимость    │ Возвращено│    Стоимость    │ Исходящий │   Стоимость
  остаток   │   вх.остатка    │           │    прихода      │    но     │ переработанного │           │  перемещенного  │           │  возвращенного  │  остаток  │  исх.остатка
────────────┴─────────────────┴───────────┴─────────────────┴───────────┴─────────────────┴───────────┴─────────────────┴───────────┴─────────────────┴───────────┴───────────────── Ш
.{
  Й^^ Й
.begin
sumvhost:=0
sumprih:=0
sumperer:=0
sumperem:=0
sumvozvr:=0
sumishost:=0
end.
.{
.begin
sumvhost:=sumvhost+стоим_вх
sumprih:=sumprih+стоим_прихода
sumperer:=sumperer+стоим_перераб
sumperem:=sumperem+стоим_перем
sumvozvr:=sumvozvr+стоим_возврат
sumishost:=sumishost+стоим_исх
end.
 И @@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@ И
 Ш &&&&&&&.&&& &'&&&&&&&&&&&&.&& &&&&&&&.&&& &'&&&&&&&&&&&&.&& &&&&&&&.&&& &'&&&&&&&&&&&&.&& &&&&&&&.&&& &'&&&&&&&&&&&&.&& &&&&&&&.&&& &'&&&&&&&&&&&&.&& &&&&&&&.&&& &'&&&&&&&&&&&&.&& Ш
.}
.fields  
sumvhost
sumprih
sumperer
sumperem
sumvozvr
sumishost
.endfields
 Ш Итого:      &'&&&&&&&&&&&&.&&             &'&&&&&&&&&&&&.&&             &'&&&&&&&&&&&&.&&             &'&&&&&&&&&&&&.&&             &'&&&&&&&&&&&&.&&             &'&&&&&&&&&&&&.&& Ш

.}
.endform
