//------------------------------------------------------------------------------
//                                                      (c) корпорация ГАЛАКТИКА
// ГАЛАКТИКА 7.11 - Производственное планирование
// Маршрутная карта изготовления изделия
//------------------------------------------------------------------------------

#doc
Базовая форма отчета Маршрутная карта изготовления изделия</brief>
#end

.Form TechMK
.HIDE
.Fields
  Шифр_тех_процесса
  Наименование_тех_процесса
  Тип_тех_процесса
  Литера
  Разработал_Фамилия
  Разработал_Дата
  Подписал_2_Кто
  Подписал_2_Фамилия
  Подписал_2_Дата
  Подписал_3_Кто
  Подписал_3_Фамилия
  Подписал_3_Дата
  Подписал_4_Кто
  Подписал_4_Фамилия
  Подписал_4_Дата
  Нормоконтролер_Фамилия
  Нормоконтролер_Дата
  Инвентарный_номер_подлинника
  Взамен_инвентарного_номера
  Инвентарный_номер_дубликата
  Дополнительные_указания
  Номер_изделия_с_которого_вводится
  Обозначение_основного_документата
  Условное_обозначение_вида_документа
  Тип_изделия
  Наименование_изделия
  Обозначение_изделия
  Ном_номер_изделия
  Минимальный_объем_выпуска
  Код_Цеха_изготовителя
  Наименование_Цеха_изготовителя
  Код_технологической_класификации
  Общая_единица_нормирования
  Единица_измерения_нормирования
  Код_рабочего_места_процесса
  Наименование_рабочего_места_процесса
  Длительность_цикл_производства_дней
  Дата_отчета
.endfields
 Тех.процесс: шифр         @@@@@@@@@@@@@@@@@@@@
              наименование @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
              тип          @
! поля основной надписи
  Литера                               @@@
  Разработал_Фамилия                   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  Разработал_Дата                      @@@@@@@@@@
  Подписал_2_Кто                       @@@@@@@@@@
  Подписал_2_Фамилия                   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  Подписал_2_Дата                      @@@@@@@@@@
  Подписал_3_Кто                       @@@@@@@@@@
  Подписал_3_Фамилия                   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  Подписал_3_Дата                      @@@@@@@@@@
  Подписал_4_Кто                       @@@@@@@@@@
  Подписал_4_Фамилия                   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  Подписал_4_Дата                      @@@@@@@@@@
  Нормоконтролер_Фамилия               @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  Нормоконтролер_Дата                  @@@@@@@@@@
  Инвентарный_номер_подлинника         @@@@@@@@@@@@@
  Взамен_инвентарного_номера           @@@@@@@@@@@@@
  Инвентарный_номер_дубликата          @@@@@@@@@@@@@
  Дополнительные_указания              @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  Номер_изделия_с_которого_вводится    @@@@@@@@@@@@@@@@@@@
  Обозначение_основного_документата    @@@@@@@@@@@@@@@@@@@
  Условное_обозначение_вида_документа  @@@@
 Изделие:     тип          @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
              наименование @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
              обозначение  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                Ном_номер_изделия @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 Минимальный объем выпуска @@@@@@@@@@@@@@@@
 Цех-изготовитель: код     @@@@@@@@@@@@@@@@@@@@@@@@
              наименование @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 Код технологической класификации @@@@@@@@@@@@@@@@@@@@@@@@@
 Общая единица нормирования @@@@@@@@@@@@@@@@@@@@@@
 Единица_измерения_нормирования @@@@@@@@@@
 Код рабочего места          @@@
 Наименование рабочего места @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 Длительность цикл производства (дней) @@@@@@@@@@@@@@@
 Дата формирования отчета    @@@@@@@@@@@@@@@
.{ TechMK_ByOp CheckEnter
.Fields
! Операция
  номер_записи_пп
  номер_цеха_пп
  номер_цеха
  название_цеха
  номер_операции_пп
  код_операции
  название_операции
  Норма_обслуживания
  Код_Рабочего_места
  Наименование_Рабочего_места
  Единица_нормирования
  Единица_измерения_ед_нормирования
  Разряд_операции
  Процент_использования_операции
  Процент_выхода_годных
  Код_единицы_времени
!  (0-час,  1-мин.,  2-сек., 3-сутки, 4-неделя)
  Название_Единицы_времени
  Код_нормы_времени
!  (0 - технологическая, 1 - расчетная, 2 - опытно-статстическая)
  Название_нормы_времени
  Норма_времени_технологическая
  Норма_времени_расчетная
  Норма_времени_опытно_статистическая
  Норма_подг_закл_технологическая
  Норма_подг_закл_расчетная
  Норма_подг_закл_опытно_статистическая
  Норма_подг_закл
  Норма_основное_машинное
  Норма_основное_ручное
  Норма_времени_на_операцию
  Пояснения_к_тех_операции
  Степень_механизации
  Одновременно_обрабатываемых_деталей
  Объем_партии
  Коэффициент_штучного_времени
  тип_нормы
! Материалы, комплектующие
  Обозначение_ЧТО_Входит
  Наименование_ЧТО_Входит
  Наименование_типа_МЦ_ЧТО
  Категория_типа_МЦ_ЧТО
  Признак_материала_типа_МЦ_ЧТО
  Признак_доработки_покупных_типа_МЦ_ЧТО
  Единица_нормирования_КУДА
  Единица_измерения_нормирования_КУДА
  Норма_расхода
  Единица_Измерения_ЧТО
  Процент_потерь
  Коэф_использования_в_заготовке
  Чистый_вес_детали
  Коэф_отходов_используемых
  Коэф_отходов_неиспользуемых
  Процент_списания_себестоимости
  Процент_использ_материала_в_техпроцессе
  Масса_заготовки
  Количество_деталей_из_заготовки
  Профиль_и_размеры_заготовки
! Трудовые нормы
  Код_профессии
  Наименование_профессии
  Единица_нормирования_труда
  Единица_измерения_нормирования_труда
  Количество_исполнителей
  Код_тарифа
  Наименование_тарифа
  Код_системы_оплаты
  Разряд
  Оплата
  Код_условий_труда
! Нормы оборудования
  Обозначение_оборудования
  Модель_оборудования
  Краткое_название_оборудования
  Наименование_группы_оборудования
  Наименование_оборудования
  Единица_нормирования_оборудования
  Единица_измерения_единицы_нормирования
  Норма_обслуживания_оборудования
! Нормы инструмента
  Обозначение_инструмента
  Наименование_инструмента
  Наименование_типа_МЦ_инструмента
  Категория_типа_МЦ_инструмента
  Признак_материала_типа_МЦ_инструмента
  Признак_доработки_покупных_типа_МЦ_инструмента
  Единица_нормирования_инструмента
  Единица_измерения_нормирования_инструмента
  Норма_применения_инструмента
  Единица_измерения_нормы_применения_инструмента
  Количество_применений_инструмента_до_износа
! Инструктивные документы
  Наименование_документа
  Доп_информация_о_документе
.EndFields
! Операция
  номер_записи_пп                                                       ^
  номер_цеха_пп                                                         ^
  номер_цеха                                                            ^
  название_цеха                                                         ^
  номер_операции_пп                                                     ^
  код_операции                                                          ^
  название_операции                                                     ^
  Норма_обслуживания                                                    ^
  Код_Рабочего_места                                                    ^
  Наименование_Рабочего_места                                           ^
  Единица_нормирования                                                  ^
  Единица_измерения_ед_нормирования                                     ^
  Разряд_операции                                                       ^
  Процент_использования_операции                                        ^
  Процент_выхода_годных                                                 ^
  Код_единицы_времени                                                   ^
!  (0-час,  1-мин.,  2-сек., 3-сутки, 4-неделя)                         ^
  Название_Единицы_времени                                              ^
  Код_нормы_времени                                                     ^
!  (0 - технологическая, 1 - расчетная, 2 - опытно-статистическая)      ^
  Название_нормы_времени                                                ^
  Норма_времени_технологическая                                         ^
  Норма_времени_расчетная                                               ^
  Норма_времени_опытно_статистическая                                   ^
  Норма_подг_закл_технологическая                                       ^
  Норма_подг_закл_расчетная                                             ^
  Норма_подг_закл_опытно_статистическая                                 ^
  Норма_подг_закл                                                       ^
  Норма_основное_машинное                                               ^
  Норма_основное_ручное                                                 ^
  Норма_времени_на_операцию                                             ^
.{ Asup_ByOp CheckEnter
  Пояснения_к_тех_операции                                              ^
.}
  Степень_механизации                                                   ^
  Одновременно_обрабатываемых_деталей                                   ^
  Объем_партии                                                          ^
  Коэффициент_штучного_времени                                          ^
  тип_нормы                                                             ^
! Материалы, комплектующие                                              ^
  Обозначение_ЧТО_Входит                                                ^
  Наименование_ЧТО_Входит                                               ^
  Наименование_типа_МЦ_ЧТО                                              ^
  Категория_типа_МЦ_ЧТО                                                 ^
  Признак_материала_типа_МЦ_ЧТО                                         ^
  Признак_доработки_покупных_типа_МЦ_ЧТО                                ^
  Единица_нормирования_КУДА                                             ^
  Единица_измерения_нормирования_КУДА                                   ^
  Норма_расхода                                                         ^
  Единица_Измерения_ЧТО                                                 ^
  Процент_потерь                                                        ^
  Коэф_использования_в_заготовке                                        ^
  Чистый_вес_детали                                                     ^
  Коэф_отходов_используемых                                             ^
  Коэф_отходов_неиспользуемых                                           ^
  Процент_списания_себестоимости                                        ^
  Процент_использ_материала_в_техпроцессе                               ^
  Масса_заготовки                                                       ^
  Количество_деталей_из_заготовки                                       ^
  Профиль_и_размеры_заготовки                                           ^
! Трудовые нормы                                                        ^
  Код_профессии                                                         ^
  Наименование_профессии                                                ^
  Единица_нормирования_труда                                            ^
  Единица_измерения_нормирования_труда                                  ^
  Количество_исполнителей                                               ^
  Код_тарифа                                                            ^
  Наименование_тарифа                                                   ^
  Код_системы_оплаты                                                    ^
  Разряд                                                                ^
  Расценка                                                              ^
  Код_условий_труда                                                     ^
! Нормы оборудования                                                    ^
  Обозначение_оборудования                                              ^
  Модель_оборудования                                                   ^
  Краткое_название_оборудования                                         ^
  Наименование_группы_оборудования                                      ^
  Наименование_оборудования                                             ^
  Единица_нормирования_оборудования                                     ^
  Единица_измерения_единицы_нормирования                                ^
  Норма_обслуживания_оборудования                                       ^
! Нормы инструмента                                                     ^
  Обозначение_инструмента                                               ^
  Наименование_инструмента                                              ^
  Наименование_типа_МЦ_инструмента                                      ^
  Категория_типа_МЦ_инструмента                                         ^
  Признак_материала_типа_МЦ_инструмента                                 ^
  Признак_доработки_покупных_типа_МЦ_инструмента                        ^
  Единица_нормирования_инструмента                                      ^
  Единица_измерения_нормирования_инструмента                            ^
  Норма_применения_инструмента                                          ^
  Единица_измерения_нормы_применения_инструмента                        ^
  Количество_применений_инструмента_до_износа                           ^
! Инструктивные документы                                               ^
  Наименование_документа                                                ^
  Доп_информация_о_документе                                            ^
.}
.EndForm

.LINKFORM 'TechMK01' PROTOTYPE IS TechMK
.NameInList "список операций"
.group 'Маршрутная карта изготовления изделия'
.fields
  Тип_изделия
  Наименование_изделия
  Обозначение_изделия
  Ном_номер_изделия
  Наименование_тех_процесса
  Шифр_тех_процесса
  Дата_отчета
.endfields
.var
CurNum, OperNum : string;
.endvar
.begin
CurNum := '';
OperNum:= '';
end.

 МАРШРУТНАЯ КАРТА ИЗГОТОВЛЕНИЯ ИЗДЕЛИЯ

 Изделие (^):
   наименование  : ^
   обозначение   : ^
   номенкл. номер: ^
 Документ (МаршКарт):
   наименование  : ^
   код           : ^
 Параметры расчета:
   на дату       : ^
────────────┬───────┬───────┬─────────────────────┬────────┬─────────┬─────────────┬─────────┬─────────────
    Цех     │ Номер │  Код  │     Наименование    │ Разряд │  Норма  │    Единица  │ Единица │   Процент
            │       │       │       операции      │        │времени,ч│ нормирования│измерения│использования
────────────┼───────┼───────┼─────────────────────┼────────┼─────────┼─────────────┼─────────┼─────────────
.{TechMK_ByOp CheckEnter
.{?Internal;(CurNum <> номер_записи_пп) and (OperNum <> номер_операции_пп)
.fields
  номер_цеха
  номер_операции_пп
  код_операции
  название_операции
  Разряд_операции
  Норма_времени_на_операцию
  Единица_нормирования
  Единица_измерения_ед_нормирования
  Процент_использования_операции
.endfields
 @~@@@@@@@@@│@~@@@@@│@~@@@@@│ @@@@@@@@@@@@@@@@@@@@│ @~@@@@ │&~&&&.&&&│ &~&&&&&.&&& │&~&&&&&&&│    &&&.&&
.}
.{ Asup_ByOp CheckEnter
.fields
  Пояснения_к_тех_операции
.endfields
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.}
.{?Internal;(CurNum <> номер_записи_пп) and (OperNum <> номер_операции_пп)
.begin
CurNum := номер_записи_пп;
OperNum:= номер_операции_пп;
end.
.}
.}
────────────┴───────┴───────┴─────────────────────┴────────┴─────────┴─────────────┴─────────┴─────────────
.EndForm

.LINKFORM 'TechMK02' PROTOTYPE IS TechMK
.NameInList "трудовые ресурсы"
.group 'Маршрутная карта изготовления изделия'
.fields
  Тип_изделия
  Наименование_изделия
  Обозначение_изделия
  Ном_номер_изделия
  Наименование_тех_процесса
  Шифр_тех_процесса
  Дата_отчета
.endfields
.var
isJob,         // = 1 - вышли из трудовых
isFirst: comp; // = 2 - выводится первая операция и главная шапка,
               // = 1 - вышли из ресурсов
               // = 0 - вышли из операции
CurNum, OperNum : string;
.endvar
.begin
isFirst:= 2;
isJob  := 0;
CurNum := '';
OperNum:= '';
end.

 МАРШРУТНАЯ КАРТА ИЗГОТОВЛЕНИЯ ИЗДЕЛИЯ

 Изделие (^):
   наименование  : ^
   обозначение   : ^
   номенкл. номер: ^
 Документ (МаршКарт):
   наименование  : ^
   код           : ^
 Параметры расчета:
   на дату       : ^
────────────┬───────┬───────┬─────────────────────┬────────┬─────────┬─────────────┬─────────┬─────────────
    Цех     │ Номер │  Код  │     Наименование    │ Разряд │  Норма  │    Единица  │ Единица │   Процент
            │       │       │       операции      │        │времени,ч│ нормирования│измерения│использования
────────────┼───────┼───────┼─────────────────────┼────────┼─────────┼─────────────┼─────────┼─────────────
.{TechMK_ByOp CheckEnter
.{?Internal;(CurNum <> номер_записи_пп) and (OperNum <> номер_операции_пп)
.{?Internal;(isFirst=1)
────────────┬───────┬───────┬─────────────────────┬────────┬─────────┬─────────────┬─────────┬─────────────
.}
.begin
isFirst:= 0;
isJob  := 0;
end.
.fields
  номер_цеха
  номер_операции_пп
  код_операции
  название_операции
  Разряд_операции
  Норма_времени_на_операцию
  Единица_нормирования
  Единица_измерения_ед_нормирования
  Процент_использования_операции
.endfields
 @~@@@@@@@@@│@~@@@@@│@~@@@@@│ @@@@@@@@@@@@@@@@@@@@│ @~@@@@ │&~&&&.&&&│ &~&&&&&.&&& │&~&&&&&&&│    &&&.&&
.}
.{ Asup_ByOp CheckEnter
.fields
  Пояснения_к_тех_операции
.endfields
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.}
.{?Internal;(CurNum <> номер_записи_пп) and (OperNum <> номер_операции_пп)
.begin
CurNum := номер_записи_пп;
OperNum:= номер_операции_пп;
end.
.}
.{?Internal;(тип_нормы = 'Job')
.{?Internal;(isFirst = 0)
.begin
isFirst:= 1;
end.
────────────┴───────┴───────┴─────────────────────┴────────┴─────────┴─────────────┴─────────┴─────────────
.}
.{?Internal;(isJob = 0)
.begin
isJob:= 1;
end.
 Трудовые ресурсы:                                            Количество: Ед. нормирования:
.}
.fields
  Код_профессии
  Наименование_профессии
  Количество_исполнителей
  Единица_нормирования_труда
  Единица_измерения_нормирования_труда
.endfields
   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@   &&&&&.&&&&  &&&&&&&.&&&& @@@@@@@@
.}
.}
.{?Internal;(isFirst = 0)
────────────┴───────┴───────┴─────────────────────┴────────┴─────────┴─────────────┴─────────┴─────────────
.}
.EndForm

.LINKFORM 'TechMK03' PROTOTYPE IS TechMK
.NameInList "ресурсы оборудования"
.group 'Маршрутная карта изготовления изделия'
.fields
  Тип_изделия
  Наименование_изделия
  Обозначение_изделия
  Ном_номер_изделия
  Наименование_тех_процесса
  Шифр_тех_процесса
  Дата_отчета
.endfields
.var
isEquip,       // = 1 - вышли из оборудования
isFirst: comp; // = 2 - выводится первая операция и главная шапка,
               // = 1 - вышли из ресурсов
               // = 0 - вышли из операции
CurNum, OperNum : string;
.endvar
.begin
isFirst:= 2;
isEquip:= 0;
CurNum := '';
OperNum:= '';
end.

 МАРШРУТНАЯ КАРТА ИЗГОТОВЛЕНИЯ ИЗДЕЛИЯ

 Изделие (^):
   наименование  : ^
   обозначение   : ^
   номенкл. номер: ^
 Документ (МаршКарт):
   наименование  : ^
   код           : ^
 Параметры расчета:
   на дату       : ^
────────────┬───────┬───────┬─────────────────────┬────────┬─────────┬─────────────┬─────────┬─────────────
    Цех     │ Номер │  Код  │     Наименование    │ Разряд │  Норма  │    Единица  │ Единица │   Процент
            │       │       │       операции      │        │времени,ч│ нормирования│измерения│использования
────────────┼───────┼───────┼─────────────────────┼────────┼─────────┼─────────────┼─────────┼─────────────
.{TechMK_ByOp CheckEnter
.{?Internal;(CurNum <> номер_записи_пп) and (OperNum <> номер_операции_пп)
.{?Internal;(isFirst=1)
────────────┬───────┬───────┬─────────────────────┬────────┬─────────┬─────────────┬─────────┬─────────────
.}
.begin
isFirst:= 0;
isEquip:= 0;
end.
.fields
  номер_цеха
  номер_операции_пп
  код_операции
  название_операции
  Разряд_операции
  Норма_времени_на_операцию
  Единица_нормирования
  Единица_измерения_ед_нормирования
  Процент_использования_операции
.endfields
 @~@@@@@@@@@│@~@@@@@│@~@@@@@│ @@@@@@@@@@@@@@@@@@@@│ @~@@@@ │&~&&&.&&&│ &~&&&&&.&&& │&~&&&&&&&│    &&&.&&
.}
.{ Asup_ByOp CheckEnter
.fields
  Пояснения_к_тех_операции
.endfields
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.}
.{?Internal;(CurNum <> номер_записи_пп) and (OperNum <> номер_операции_пп)
.begin
CurNum := номер_записи_пп;
OperNum:= номер_операции_пп;
end.
.}
.{?Internal;(тип_нормы = 'Equip')
.{?Internal;(isFirst = 0)
.begin
isFirst:= 1;
end.
────────────┴───────┴───────┴─────────────────────┴────────┴─────────┴─────────────┴─────────┴─────────────
.}
.{?Internal;(isEquip = 0)
.begin
isEquip:= 1;
end.
 Оборудование:                                                Количество: Ед. нормирования:
.}
.fields
  Наименование_оборудования
  Наименование_группы_оборудования
  Норма_обслуживания_оборудования
  Единица_нормирования_оборудования
  Единица_измерения_единицы_нормирования
.endfields
   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@   &&&&&.&&&&  &&&&&&&.&&&& @@@@@@@@
.}
.}
.{?Internal;(isFirst = 0)
────────────┴───────┴───────┴─────────────────────┴────────┴─────────┴─────────────┴─────────┴─────────────
.}
.EndForm

.LINKFORM 'TechMK04' PROTOTYPE IS TechMK
.NameInList "трудовые ресурсы и оборудование"
.group 'Маршрутная карта изготовления изделия'
.fields
  Тип_изделия
  Наименование_изделия
  Обозначение_изделия
  Ном_номер_изделия
  Наименование_тех_процесса
  Шифр_тех_процесса
  Дата_отчета
.endfields
.var
isEquip,       // = 1 - вышли из оборудования
isJob,         // = 1 - вышли из трудовых
isFirst: comp; // = 2 - выводится первая операция и главная шапка,
               // = 1 - вышли из ресурсов
               // = 0 - вышли из операции
CurNum, OperNum : string;
.endvar
.begin
isFirst:= 2;
isEquip:= 0;
isJob  := 0;
CurNum := '';
OperNum:= '';
end.

 МАРШРУТНАЯ КАРТА ИЗГОТОВЛЕНИЯ ИЗДЕЛИЯ

 Изделие (^):
   наименование  : ^
   обозначение   : ^
   номенкл. номер: ^
 Документ (МаршКарт):
   наименование  : ^
   код           : ^
 Параметры расчета:
   на дату       : ^
────────────┬───────┬───────┬─────────────────────┬────────┬─────────┬─────────────┬─────────┬─────────────
    Цех     │ Номер │  Код  │     Наименование    │ Разряд │  Норма  │    Единица  │ Единица │   Процент
            │       │       │       операции      │        │времени,ч│ нормирования│измерения│использования
────────────┼───────┼───────┼─────────────────────┼────────┼─────────┼─────────────┼─────────┼─────────────
.{TechMK_ByOp CheckEnter
.{?Internal;(CurNum <> номер_записи_пп) and (OperNum <> номер_операции_пп)
.{?Internal;(isFirst=1)
────────────┬───────┬───────┬─────────────────────┬────────┬─────────┬─────────────┬─────────┬─────────────
.}
.begin
isFirst:= 0;
isEquip:= 0;
isJob  := 0;
end.
.fields
  номер_цеха
  номер_операции_пп
  код_операции
  название_операции
  Разряд_операции
  Норма_времени_на_операцию
  Единица_нормирования
  Единица_измерения_ед_нормирования
  Процент_использования_операции
.endfields
 @~@@@@@@@@@│@~@@@@@│@~@@@@@│ @@@@@@@@@@@@@@@@@@@@│ @~@@@@ │&~&&&.&&&│ &~&&&&&.&&& │&~&&&&&&&│    &&&.&&
.}
.{ Asup_ByOp CheckEnter
.fields
  Пояснения_к_тех_операции
.endfields
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.}
.{?Internal;(CurNum <> номер_записи_пп) and (OperNum <> номер_операции_пп)
.begin
CurNum := номер_записи_пп;
OperNum:= номер_операции_пп;
end.
.}
.{?Internal;(тип_нормы = 'Job')
.{?Internal;(isFirst = 0)
.begin
isFirst:= 1;
end.
────────────┴───────┴───────┴─────────────────────┴────────┴─────────┴─────────────┴─────────┴─────────────
.}
.{?Internal;(isJob = 0)
.begin
isJob:= 1;
end.
 Трудовые ресурсы:                                            Количество: Ед. нормирования:
.}
.fields
  Код_профессии
  Наименование_профессии
  Количество_исполнителей
  Единица_нормирования_труда
  Единица_измерения_нормирования_труда
.endfields
   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@   &&&&&.&&&&  &&&&&&&.&&&& @@@@@@@@
.}
.{?Internal;(тип_нормы = 'Equip')
.{?Internal;(isFirst = 0)
.begin
isFirst:= 1;
end.
────────────┴───────┴───────┴─────────────────────┴────────┴─────────┴─────────────┴─────────┴─────────────
.}
.{?Internal;(isEquip = 0)
.begin
isEquip:= 1;
end.
 Оборудование:                                                Количество: Ед. нормирования:
.}
.fields
  Наименование_оборудования
  Наименование_группы_оборудования
  Норма_обслуживания_оборудования
  Единица_нормирования_оборудования
  Единица_измерения_единицы_нормирования
.endfields
   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@   &&&&&.&&&&  &&&&&&&.&&&& @@@@@@@@
.}
.}
.{?Internal;(isFirst = 0)
────────────┴───────┴───────┴─────────────────────┴────────┴─────────┴─────────────┴─────────┴─────────────
.}
.EndForm
