/*
//******************************************************************************
//                                                      (с) корпорация Галактика
// Галактика 8.10 - Заработная плата
// Реестр застрахованных лиц, 
// за которых перечислены дополнительные страховые взносы 
// Форма XML 
//******************************************************************************
*/
#doc
Реестр застрахованных лиц, за которых перечислены взносы на ДСВ
#end
.form ReeDSV_MN
.hide    
.fields  
 NameOrg
 NameOrgS
 INN
 KPP
 KodIP
 KodUL
 Forma
 NomPF
 NomPach
 DataSost
 MonForm
 YearForm
 DataPlPor
 NomerPlPor
 DatObPlPor
 SumUdAll  
 SumOplAll 
 SummaAll  
 NaimPFR
 Kol

 Fam     
 Ima     
 Otch    
 NomLsch 
 SumUd   
 SumOpl  
 
 EndPach  
.endfields
.{ DSV3_PachCycle CheckEnter
^ 
^ 
^ ^ 
^ ^ 
^
^ 
^ ^ 
^ ^
^ ^
^ ^ ^
^  ^
^
.{ DSV3_SpecCycle CheckEnter
^ ^ ^ ^ ^ ^
.}
^
.}
.endform

.linkform 'DSV_3_XML' prototype is 'ReeDSV_MN'
.F 'IS_DSV-3.XML'
.nameinlist 'Реестр ДСВ на МН'
.var 
  NomerVPach : integer;
.endvar
.fields
  INN
  KPP
  KodIP
  KodUL
  Upcase(Trim(Forma))
  Upcase(Trim(Replace(NameOrg , '"', '''' )))
  Upcase(Trim(Replace(NameOrgS, '"', '''' )))
  NomPF
  NomPach
  Kol     
  DataSost 
  DataPlPor
  NomerPlPor
  DatObPlPor
  YearForm
  Kol
  SumUdAll  
  SumOplAll 
  SummaAll  
  NomerVPach
  TRIM(NomLsch)
  TRIM(UPCASE(Fam))
  TRIM(UPCASE(Ima))
  TRIM(UPCASE(Otch))
  INN
  KPP
  KodIP
  KodUL
  Upcase(Trim(Forma))
  Upcase(Trim(Replace(NameOrg , '"', '''' )))
  Upcase(Trim(Replace(NameOrgS, '"', '''' )))
  NomPF
  SumUd 
  SumOpl
  NomPach  
.endfields
.{ DSV3_PachCycle CheckEnter
<?xml version="1.0" encoding="Windows-1251" ?>
<ФайлПФР>
  <ИмяФайла></ИмяФайла> 
  <ЗаголовокФайла>
    <ВерсияФормата>07.00</ВерсияФормата>
    <ТипФайла>ВНЕШНИЙ</ТипФайла>
    <ПрограммаПодготовкиДанных>
       <НазваниеПрограммы>ГАЛАКТИКА</НазваниеПрограммы>
       <Версия>8.10</Версия>
    </ПрограммаПодготовкиДанных>
    <ИсточникДанных>СТРАХОВАТЕЛЬ</ИсточникДанных>
  </ЗаголовокФайла>
  <ПачкаВходящихДокументов Стадия = "До обработки" Окружение = "В составе файла" ДобровольныеПравоотношения = "ДСВ">
  <ВХОДЯЩАЯ_ОПИСЬ_РЕЕСТРА>
    <НомерВпачке>1</НомерВпачке>
    <ТипВходящейОписи>ОПИСЬ ПАЧКИ</ТипВходящейОписи>
    <СоставительПачки>
      <НалоговыйНомер>
        <ИНН>^</ИНН>
        <КПП>^</КПП>
      </НалоговыйНомер>
      <КодЕГРИП>^</КодЕГРИП>
      <КодЕГРЮЛ>^</КодЕГРЮЛ>
      <Форма>^</Форма>
      <НаименованиеОрганизации>^</НаименованиеОрганизации>
      <НаименованиеКраткое>^</НаименованиеКраткое>
      <РегистрационныйНомер>^</РегистрационныйНомер>
    </СоставительПачки>
    <НомерПачки>
      <Основной>^</Основной>
    </НомерПачки>
    <СоставДокументов>
      <Количество>1</Количество>
      <НаличиеДокументов>
        <ТипДокумента>РЕЕСТР_ДСВ_РАБОТОДАТЕЛЬ</ТипДокумента>
        <Количество>^</Количество>
      </НаличиеДокументов>
    </СоставДокументов>
    <ДатаСоставления>^</ДатаСоставления>
    <РеестрДСВ>
      <ПлатежноеПоручение>
        <ДатаПоручения>^</ДатаПоручения>
        <НомерПоручения>^</НомерПоручения>
        <ДатаИсполненияПоручения>^</ДатаИсполненияПоручения>
      </ПлатежноеПоручение>
      <Год>^</Год>
      <КоличествоСтрок>^</КоличествоСтрок>
      <СуммаДСВРаботника>^</СуммаДСВРаботника>
      <СуммаДСВРаботодателя>^</СуммаДСВРаботодателя>
      <СуммаДСВОбщая>^</СуммаДСВОбщая>
    </РеестрДСВ>
  </ВХОДЯЩАЯ_ОПИСЬ_РЕЕСТРА>
.begin
NomerVPach := 1;
end.
.{ DSV3_SpecCycle CheckEnter
.begin
  NomerVPach := NomerVPach + 1;
end.
    <РЕЕСТР_ДСВ_РАБОТОДАТЕЛЬ>
      <НомерВпачке>^</НомерВпачке>
      <СтраховойНомер>^</СтраховойНомер>
      <ФИО>
        <Фамилия>^</Фамилия>
        <Имя>^</Имя>
        <Отчество>^</Отчество>
      </ФИО>
      <Работодатель>
       <НалоговыйНомер>
         <ИНН>^</ИНН>
         <КПП>^</КПП>
       </НалоговыйНомер>
       <КодЕГРИП>^</КодЕГРИП>
       <КодЕГРЮЛ>^</КодЕГРЮЛ>
       <Форма>^</Форма>
       <НаименованиеОрганизации>^</НаименованиеОрганизации>
       <НаименованиеКраткое>^</НаименованиеКраткое>
       <РегистрационныйНомер>^</РегистрационныйНомер>
     </Работодатель>
     <СуммаДСВРаботника>^</СуммаДСВРаботника>
     <СуммаДСВРаботодателя>^</СуммаДСВРаботодателя>
    </РЕЕСТР_ДСВ_РАБОТОДАТЕЛЬ>
.}
.{?internal; EndPach = 1
  </ПачкаВходящихДокументов>
</ФайлПФР>
___КОНЕЦ ^ ПАЧКИ!!!_Разрежьте_здесь!
.}
.}
  </ПачкаВходящихДокументов>
</ФайлПФР>
.endform
