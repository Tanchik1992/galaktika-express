//******************************************************************************
//                                                     (c) корпорация Галактика
// Галактика 8.10 - Заработная плата
// Режим: Документы персонифицированного учета
//******************************************************************************
.set name = 'DPENS7'
.hide
.{ AllPachLoop70 CheckEnter
.fields
FormatedDate
CodeOKPO
РегНомер
Наименование
НаименованиеКраткое
INN
KPP
CodeOGRUL
FormSobs
НомерПачки ДатаСостав: date
ЧислоДок
.endfields
^^
"ЗГЛВ","02.50"
"РБТД","РБТД","^","^"
"ПАПЧК",^,"^",1
"ТИПД","АНКТ",^
^ ^ ^ ^ ^
.{ NexpPersLoop70 CheckEnter
.fields
НомерДок
ДатаЗаполнения: date СтрахНомер ДатаПоступления: date
ТабНом
Фамилия Имя Отчество
Фамилия_нов Имя_нов Отчество_нов
Пол
ПолИзмен
ДатаРожд: date
ДатаРождИзмен: date
// ----   прописка -----
АдрПрописки_Страна
АдрПрописки_Страна_сокр

АдрПрописки_Регион
АдрПрописки_Регион_сокр

АдрПрописки_Район
АдрПрописки_Район_сокр

АдрПрописки_Город
АдрПрописки_Город_сокр

АдрПрописки_НасПункт
АдрПрописки_НасПункт_сокр

АдрПрописки_Улица
АдрПрописки_Улица_сокр

АдрПрописки_Дом
АдрПрописки_Дом_сокр

АдрПрописки_Корпус
АдрПрописки_Корпус_сокр

АдрПрописки_Квартира
АдрПрописки_Квартира_сокр
// ----   проживание -----
АдрПроживания_Страна
АдрПроживания_Страна_сокр

АдрПроживания_Регион
АдрПроживания_Регион_сокр

АдрПроживания_Район
АдрПроживания_Район_сокр

АдрПроживания_Город
АдрПроживания_Город_сокр

АдрПроживания_НасПункт
АдрПроживания_НасПункт_сокр

АдрПроживания_Улица
АдрПроживания_Улица_сокр

АдрПроживания_Дом
АдрПроживания_Дом_сокр

АдрПроживания_Корпус
АдрПроживания_Корпус_сокр

АдрПроживания_Квартира
АдрПроживания_Квартира_сокр
// ----   проживание -----
НасПункт Район Обл Страна
НасПунктИзмен РайонИзмен ОблИзмен СтранаИзмен
ДатРожд_измен
Гражданство
ТипДок ТипДок4 НаимДок Серия СерияРим СерияРус НомерПасс Датавыдачи:date КемВыдан
!------- свидетельство о смерти
НомерЗаписиАкта
ДатаЗаписиАкта
ДатаСмерти:date
ВыданоСвидСмерт
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Адр1Индекс Адр1Адр АдрПрописки_магнит
Адр2Индекс Адр2Адр АдрПроживания_магнит
Телефоны
.endfields
^ ^ ^ ^
^ ^ ^
!
^^
^^^^^^^^^
^^^^^^^^^
^^^^^^^^^
^^^^^^^^^
^^^^
!
^
"АНКТ",^,"^","^","^","^","^","^","^","СТАНДАРТ","^",0,0,0,"СТАНДАРТ","^","^","^","^","^","^","^","^",^,"^","^",^,"^",^,"^","^" ^^
^^^^
.fields
ДатаОтчета : date
РуководФИО
РуководДОЛЖ
ИсполнительФИО
.endfields
^^^^
.}
.if DEndPach7
.{ ADV61_70 CheckEnter
.fields
EndPriz:word
PeriodKv:word
YearAdv:word
.endfields
^^^
.}
.fields
НомТекПачки
.endfields
___КОНЕЦ ^ ПАЧКИ
.end
.}
.endform
!
.linkform 'DPENS7_MAGNIT_1' prototype is 'DPENS7'
.nameinlist'Файл анкетных данных для застрахованных лиц(вер. 7.0)'
.F 'ANKETA_ZL.XML'
.var
 EndPach: boolean;
 PachCnt : longint;
 DocCnt  : longint;
 sex10: string[10]
 my_pred, my_pred2 : string[100];
 tmpstr: string[30];
 AdrStr: string;
.endvar
.group 'Анкетные данные'
.begin
  PachCnt :=0
  DocCnt  :=0
end.
.{ AllPachLoop70 CheckEnter
<?xml version="1.0" encoding="cp866"?>
<ФайлПФР>
<ИмяФайла></ИмяФайла>
  <ЗаголовокФайла>
    <ВерсияФормата>07.00</ВерсияФормата>
    <ТипФайла>ВНЕШНИЙ</ТипФайла>
    <ПрограммаПодготовкиДанных>
       <НазваниеПрограммы>ГАЛАКТИКА</НазваниеПрограммы>
       <Версия>8.10</Версия>
    </ПрограммаПодготовкиДанных>
    <ИсточникДанных>СТРАХОВАТЕЛЬ</ИсточникДанных>
  </ЗаголовокФайла>
.begin
  my_pred := Upcase(Trim(Replace(Наименование, '"', '"' )));
  my_pred2:= Upcase(Trim(Replace(НаименованиеКраткое, '"', '"' )));
  AdrStr  := '';
  EndPach := false;
end.
.fields
! (Word(НомерДок) + DocCnt)
  INN
  KPP
  CodeOGRUL
  FormSobs
  my_pred
  my_pred2
  РегНомер
.endfields
  <ПачкаВходящихДокументов Стадия = "До обработки" Окружение = "В составе файла">
    <ВХОДЯЩАЯ_ОПИСЬ>
      <НомерВпачке>1</НомерВпачке>
      <ТипВходящейОписи>ОПИСЬ ПАЧКИ</ТипВходящейОписи>
      <СоставительПачки>
        <НалоговыйНомер>
          <ИНН>^</ИНН>
          <КПП>^</КПП>
        </НалоговыйНомер>
        <КодЕГРИП></КодЕГРИП>
        <КодЕГРЮЛ>^</КодЕГРЮЛ>
        <Форма>^</Форма>
        <НаименованиеОрганизации>^</НаименованиеОрганизации>
        <НаименованиеКраткое>^</НаименованиеКраткое>
        <РегистрационныйНомер>^</РегистрационныйНомер>
!        <Подразделение>
!          <НаименованиеПодразделения> </НаименованиеПодразделения>
!          <НомерПодразделения> </НомерПодразделения>
!        </Подразделение>
!        <НомерЛицензии></НомерЛицензии>
!        <ДатаВыдачиЛицензии></ДатаВыдачиЛицензии>
      </СоставительПачки>
.fields
  (longint(НомерПачки) + PachCnt)
!  (Word(НомерПачки) + PachCnt)
! ЧислоДок
  ЧислоДок
  ДатаСостав
.endfields
      <НомерПачки>
        <Основной>^</Основной>
!        <ПоПодразделению>^</ПоПодразделению>
      </НомерПачки>
      <СоставДокументов>
        <Количество>1</Количество>
        <НаличиеДокументов>
          <ТипДокумента>АНКЕТА_ЗЛ</ТипДокумента>
          <Количество>^</Количество>
        </НаличиеДокументов>
      </СоставДокументов>
      <ДатаСоставления>^</ДатаСоставления>
    </ВХОДЯЩАЯ_ОПИСЬ>
.begin
  PachCnt := PachCnt + 1
  DocCnt  := 1;
end.
.fields
  (longint(НомерДок) + DocCnt)
  Trim(UpCase(Фамилия)) Trim(UpCase(Имя)) Trim(UpCase(Отчество))
  if(Пол = chr(0),Trim(''), UpCase(sex10))
  ДатаРожд
  Trim(UpCase(НасПункт))
  Trim(UpCase(Район))
  Trim(UpCase(Обл))
  Trim(UpCase(Страна))
  Гражданство

  AdrStr
  Адр1Индекс
.endfields
.{ NexpPersLoop70 CheckEnter
    <АНКЕТА_ЗЛ>
      <НомерВпачке>^</НомерВпачке>
!      <СистемныйНомер></СистемныйНомер>
!      <Состояние></Состояние>
!      <ВсеОшибки>
!        <Количество></Количество>
!        <Ошибка>
!        </Ошибка>
!      </ВсеОшибки>
!      <ЗаверениеДокумента>ПФР</ЗаверениеДокумента>
!      <ДокументОснование>???</ДокументОснование>
      <АнкетныеДанные>
        <ФИО>
          <Фамилия>^</Фамилия>
          <Имя>^</Имя>
          <Отчество>^</Отчество>
        </ФИО>
.begin
  sex10 := '';
  if пол = 'Ж'
    sex10 := 'ЖЕНСКИЙ'
  else
    sex10 := 'МУЖСКОЙ'

  AdrStr := '';
  if trim(АдрПрописки_Страна_сокр) = ''
    AdrStr := 'РОССИЙСКИЙ'
  else
    AdrStr := 'ИНОСТРАННЫЙ';
end.
        <Пол>^</Пол>
        <ДатаРождения>^</ДатаРождения>
        <МестоРождения>
          <ТипМестаРождения>СТАНДАРТНОЕ</ТипМестаРождения>
          <ГородРождения>^</ГородРождения>
          <РайонРождения>^</РайонРождения>
          <РегионРождения>^</РегионРождения>
          <СтранаРождения>^</СтранаРождения>
        </МестоРождения>
        <Гражданство>^</Гражданство>
        <АдресРегистрации>
          <ТипАдреса>^</ТипАдреса>
          <Индекс>^</Индекс>
.fields

  АдрПрописки_Страна_сокр
  АдрПрописки_Страна
  Адр1Адр


  АдрПрописки_Регион
  АдрПрописки_Регион_сокр

  АдрПрописки_Район
  АдрПрописки_Район_сокр

  АдрПрописки_Город
  АдрПрописки_Город_сокр

  АдрПрописки_НасПункт
  АдрПрописки_НасПункт_сокр

  АдрПрописки_Улица
  АдрПрописки_Улица_сокр

  АдрПрописки_Дом_сокр
  АдрПрописки_Дом

  АдрПрописки_Корпус_сокр
  АдрПрописки_Корпус

  АдрПрописки_Квартира_сокр
  UpCase(АдрПрописки_Квартира)
.endfields
.{?internal;trim(АдрПрописки_Страна_сокр) <> ''
          <ИностранныйАдрес>
            <КодСтраны>^</КодСтраны>
            <НазваниеСтраны>^</НазваниеСтраны>
            <Адрес>^</Адрес>
          </ИностранныйАдрес>
.}
.{?internal;trim(АдрПрописки_Страна_сокр) = ''
          <РоссийскийАдрес>
          <Регион>
            <ГеографическоеНазвание>^</ГеографическоеНазвание>
            <Сокращение>^</Сокращение>
          </Регион>
          <Район>
            <ГеографическоеНазвание>^</ГеографическоеНазвание>
            <Сокращение>^</Сокращение>
          </Район>
          <Город>
            <ГеографическоеНазвание>^</ГеографическоеНазвание>
            <Сокращение>^</Сокращение>
          </Город>
          <НаселенныйПункт>
            <ГеографическоеНазвание>^</ГеографическоеНазвание>
            <Сокращение>^</Сокращение>
          </НаселенныйПункт>
          <Улица>
            <ГеографическоеНазвание>^</ГеографическоеНазвание>
            <Сокращение>^</Сокращение>
          </Улица>
          <Дом>
            <Сокращение>^</Сокращение>
            <Номер>^</Номер>
          </Дом>
          <Корпус>
            <Сокращение>^</Сокращение>
            <Номер>^</Номер>
          </Корпус>
          <Квартира>
            <Сокращение>^</Сокращение>
            <Номер>^</Номер>
          </Квартира>
          </РоссийскийАдрес>
.}
        </АдресРегистрации>
.fields
// ----   проживание -----
  AdrStr
  Адр2Индекс
.endfields
        <АдресФактический>
.begin
  AdrStr := '';
  if trim(АдрПроживания_Страна_сокр) = ''
    AdrStr := 'РОССИЙСКИЙ'
  else
    AdrStr := 'ИНОСТРАННЫЙ';
end.
          <ТипАдреса>^</ТипАдреса>
          <Индекс>^</Индекс>
.fields
  АдрПроживания_Страна_сокр
  АдрПроживания_Страна
  Адр2Адр
.endfields
.{?internal;trim(АдрПроживания_Страна_сокр) <> ''
          <ИностранныйАдрес>
            <КодСтраны>^</КодСтраны>
            <НазваниеСтраны>^</НазваниеСтраны>
            <Адрес>^</Адрес>
          </ИностранныйАдрес>
.}
.fields
  АдрПроживания_Регион
  АдрПроживания_Регион_сокр

  АдрПроживания_Район
  АдрПроживания_Район_сокр

  АдрПроживания_Город
  АдрПроживания_Город_сокр

  АдрПроживания_НасПункт
  АдрПроживания_НасПункт_сокр

  АдрПроживания_Улица
  АдрПроживания_Улица_сокр

  АдрПроживания_Дом_сокр
  АдрПроживания_Дом

  АдрПроживания_Корпус_сокр
  АдрПроживания_Корпус

  АдрПроживания_Квартира_сокр
  UpCase(АдрПроживания_Квартира)
  Телефоны
.endfields
.{?internal;trim(АдрПроживания_Страна_сокр) = ''
          <РоссийскийАдрес>
          <Регион>
            <ГеографическоеНазвание>^</ГеографическоеНазвание>
            <Сокращение>^</Сокращение>
          </Регион>
          <Район>
            <ГеографическоеНазвание>^</ГеографическоеНазвание>
            <Сокращение>^</Сокращение>
          </Район>
          <Город>
            <ГеографическоеНазвание>^</ГеографическоеНазвание>
            <Сокращение>^</Сокращение>
          </Город>
          <НаселенныйПункт>
            <ГеографическоеНазвание>^</ГеографическоеНазвание>
            <Сокращение>^</Сокращение>
          </НаселенныйПункт>
          <Улица>
            <ГеографическоеНазвание>^</ГеографическоеНазвание>
            <Сокращение>^</Сокращение>
          </Улица>
          <Дом>
            <Сокращение>^</Сокращение>
            <Номер>^</Номер>
          </Дом>
          <Корпус>
            <Сокращение>^</Сокращение>
            <Номер>^</Номер>
          </Корпус>
          <Квартира>
            <Сокращение>^</Сокращение>
            <Номер>^</Номер>
          </Квартира>
          </РоссийскийАдрес>
.}
        </АдресФактический>
        <Телефон>^</Телефон>
      </АнкетныеДанные>
.fields
  Trim(UpCase(ТипДок))
  Trim(UpCase(НаимДок))
  UpCase(СерияРим) UpCase(СерияРус) НомерПасс
  Датавыдачи
  Trim(UpCase(КемВыдан))
  ДатаЗаполнения
.endfields
      <УдостоверяющийДокумент>
        <ТипУдостоверяющего>^</ТипУдостоверяющего>
        <Документ>
          <НаименованиеУдостоверяющего>^</НаименованиеУдостоверяющего>
          <СерияРимскиеЦифры>^</СерияРимскиеЦифры>
          <СерияРусскиеБуквы>^</СерияРусскиеБуквы>
          <НомерУдостоверяющего>^</НомерУдостоверяющего>
          <ДатаВыдачи>^</ДатаВыдачи>
          <КемВыдан>^</КемВыдан>
        </Документ>
      </УдостоверяющийДокумент>
      <ДатаЗаполнения>^</ДатаЗаполнения>
    </АНКЕТА_ЗЛ>
.begin
  DocCnt := DocCnt + 1
end.
.}
.if DEndPach7
.begin EndPach := true;
end.
.{ ADV61_70 CheckEnter
.}
  </ПачкаВходящихДокументов>
</ФайлПФР>
.fields
НомТекПачки
.endfields
___КОНЕЦ ^ ПАЧКИ
.end
.{?internal;not EndPach
  </ПачкаВходящихДокументов>
</ФайлПФР>
.}
.}
.endform
!
.linkform 'DPENS7_MAGNIT_2' prototype is 'DPENS7'
.nameinlist'Файл заявление об обмене страхового свидетельства(вер. 7.0)'
.F 'ZAYAVLENIE_OB_OBMENE.XML'
.var
 EndPach: boolean;
 PachCnt : longint;
 DocCnt  : longint;
 sex10: string[10]
 AdrStr:String;
 my_pred,my_pred2 : string[100];
 tmpstr: string[30];
 FioNew1, FioNew2,FioNew3: string[40];
.endvar
.group 'Заявление об обмене'
.begin
  PachCnt :=0
  DocCnt  :=0
end.
.{ AllPachLoop70 CheckEnter
<?xml version="1.0" encoding="cp866"?>
<ФайлПФР>
<ИмяФайла></ИмяФайла>
  <ЗаголовокФайла>
    <ВерсияФормата>07.00</ВерсияФормата>
    <ТипФайла>ВНЕШНИЙ</ТипФайла>
    <ПрограммаПодготовкиДанных>
       <НазваниеПрограммы>ГАЛАКТИКА</НазваниеПрограммы>
       <Версия>8.10</Версия>
    </ПрограммаПодготовкиДанных>
    <ИсточникДанных>СТРАХОВАТЕЛЬ</ИсточникДанных>
  </ЗаголовокФайла>
.begin
  my_pred := Upcase(Trim(Replace(Наименование, '"', '"' )));
  my_pred2:= Upcase(Trim(Replace(НаименованиеКраткое, '"', '"' )));
  EndPach := false;
end.
.fields
!  (Word(НомерДок) + DocCnt)
  INN
  KPP
  CodeOGRUL
  FormSobs
  my_pred
  my_pred2
  РегНомер
.endfields
  <ПачкаВходящихДокументов Стадия = "До обработки" Окружение = "В составе файла">
    <ВХОДЯЩАЯ_ОПИСЬ>
      <НомерВпачке>1</НомерВпачке>
      <ТипВходящейОписи>ОПИСЬ ПАЧКИ</ТипВходящейОписи>
      <СоставительПачки>
        <НалоговыйНомер>
          <ИНН>^</ИНН>
          <КПП>^</КПП>
        </НалоговыйНомер>
        <КодЕГРИП></КодЕГРИП>
        <КодЕГРЮЛ>^</КодЕГРЮЛ>
        <Форма>^</Форма>
        <НаименованиеОрганизации>^</НаименованиеОрганизации>
        <НаименованиеКраткое>^</НаименованиеКраткое>
        <РегистрационныйНомер>^</РегистрационныйНомер>
!        <Подразделение>
!          <НаименованиеПодразделения> </НаименованиеПодразделения>
!          <НомерПодразделения> </НомерПодразделения>
!        </Подразделение>
!        <НомерЛицензии></НомерЛицензии>
!        <ДатаВыдачиЛицензии></ДатаВыдачиЛицензии>
      </СоставительПачки>
.fields
(longint(НомерПачки) + PachCnt)
!  (Word(НомерПачки) + PachCnt)
!  ЧислоДок
  ЧислоДок
  ДатаСостав
.endfields
      <НомерПачки>
        <Основной>^</Основной>
!        <ПоПодразделению>^</ПоПодразделению>
      </НомерПачки>
      <СоставДокументов>
        <Количество>1</Количество>
        <НаличиеДокументов>
          <ТипДокумента>ЗАЯВЛЕНИЕ_ОБ_ОБМЕНЕ</ТипДокумента>
          <Количество>^</Количество>
        </НаличиеДокументов>
      </СоставДокументов>
      <ДатаСоставления>^</ДатаСоставления>
    </ВХОДЯЩАЯ_ОПИСЬ>
.begin
  PachCnt := PachCnt + 1
  DocCnt  :=1;
end.
.{ NexpPersLoop70 CheckEnter
.fields
  (longint(НомерДок) + DocCnt)
  СтрахНомер
  Trim(UpCase(Фамилия)) Trim(UpCase(Имя)) Trim(UpCase(Отчество))
.endfields
    <ЗАЯВЛЕНИЕ_ОБ_ОБМЕНЕ>
      <НомерВпачке>^</НомерВпачке>
      <СтраховойНомер>^</СтраховойНомер>
      <ФИОизСтрахового>
        <Фамилия>^</Фамилия>
        <Имя>^</Имя>
        <Отчество>^</Отчество>
      </ФИОизСтрахового>
.fields
  FioNew1
  FioNew2
  FioNew3
  if(ПолИзмен = '','', UpCase(sex10))
  if(Day(ДатаРождИзмен) = 0,'', DatetoStr(ДатаРождИзмен, FormatedDate))
  Trim(UpCase(НасПунктИзмен))
  Trim(UpCase(РайонИзмен))
  Trim(UpCase(ОблИзмен))
  Trim(UpCase(СтранаИзмен))
  Гражданство
.endfields
.begin
  FioNew1 := '';
  FioNew2 := '';
  FioNew3 := '';
  FioNew1 := Trim(UpCase(Фамилия_нов));
  FioNew2 := Trim(UpCase(Имя_нов));
  FioNew3 := Trim(UpCase(Отчество_нов));
end.
      <ИзменившиесяДанные>
.{?internal;(Trim(UpCase(FioNew1))  <> '')or(Trim(UpCase(FioNew2))  <> '')or(Trim(UpCase(FioNew3))  <> '')
        <ФИО>
.{?internal;Trim(UpCase(FioNew1))  <> ''
          <Фамилия>^</Фамилия>
.}
.{?internal;Trim(UpCase(FioNew2))  <> ''
          <Имя>^</Имя>
.}
.{?internal;Trim(UpCase(FioNew3))  <> '' and UpCase(FioNew3) <> 'ОТМЕНЕНО'
          <Отчество>^</Отчество>
.}
.{?internal;UpCase(FioNew3) = 'ОТМЕНЕНО'
          <Отчество></Отчество>
.}
        </ФИО>
.}
.begin
  sex10 := '';
  if ПолИзмен = 'Ж'
    sex10 := 'ЖЕНСКИЙ'
  if ПолИзмен = 'М'
    sex10 := 'МУЖСКОЙ'
end.
.{?internal;ПолИзмен <> ''
        <Пол>^</Пол>
.}
.{?internal;Day(ДатаРождИзмен) <> 0
        <ДатаРождения>^</ДатаРождения>
.}
.{?internal;(Trim(UpCase(НасПункт)) <> '')or(Trim(UpCase(Район)) <> '')or(Trim(UpCase(Обл)) <> '')or(Trim(UpCase(Страна)) <> '')
        <МестоРождения>
        <ТипМестаРождения>СТАНДАРТНОЕ</ТипМестаРождения>
          <ГородРождения>^</ГородРождения>
          <РайонРождения>^</РайонРождения>
          <РегионРождения>^</РегионРождения>
          <СтранаРождения>^</СтранаРождения>
        </МестоРождения>
.}
.{?internal;trim(Гражданство) <> ''
        <Гражданство>^</Гражданство>
.}
.fields
  AdrStr
  Адр1Индекс
.endfields
.{?internal;(АдрПрописки_магнит <> '')
        <АдресРегистрации>
.begin
  AdrStr := '';
  if trim(АдрПрописки_Страна_сокр) = ''
    AdrStr := 'РОССИЙСКИЙ'
  else
    AdrStr := 'ИНОСТРАННЫЙ';
end.
          <ТипАдреса>^</ТипАдреса>
          <Индекс>^</Индекс>
.fields
  АдрПрописки_Страна_сокр
  АдрПрописки_Страна
  Адр1Адр
.endfields
.{?internal;trim(АдрПрописки_Страна_сокр) <> ''
          <ИностранныйАдрес>
            <КодСтраны>^</КодСтраны>
            <НазваниеСтраны>^</НазваниеСтраны>
            <Адрес>^</Адрес>
          </ИностранныйАдрес>
.}
.fields
  АдрПрописки_Регион
  АдрПрописки_Регион_сокр

  АдрПрописки_Район
  АдрПрописки_Район_сокр

  АдрПрописки_Город
  АдрПрописки_Город_сокр

  АдрПрописки_НасПункт
  АдрПрописки_НасПункт_сокр

  АдрПрописки_Улица
  АдрПрописки_Улица_сокр

  АдрПрописки_Дом_сокр
  АдрПрописки_Дом

  АдрПрописки_Корпус_сокр
  АдрПрописки_Корпус

  АдрПрописки_Квартира_сокр
  UpCase(АдрПрописки_Квартира)
.endfields
.{?internal;trim(АдрПрописки_Страна_сокр) = ''
          <РоссийскийАдрес>
          <Регион>
            <ГеографическоеНазвание>^</ГеографическоеНазвание>
            <Сокращение>^</Сокращение>
          </Регион>
          <Район>
            <ГеографическоеНазвание>^</ГеографическоеНазвание>
            <Сокращение>^</Сокращение>
          </Район>
          <Город>
            <ГеографическоеНазвание>^</ГеографическоеНазвание>
            <Сокращение>^</Сокращение>
          </Город>
          <НаселенныйПункт>
            <ГеографическоеНазвание>^</ГеографическоеНазвание>
            <Сокращение>^</Сокращение>
          </НаселенныйПункт>
          <Улица>
            <ГеографическоеНазвание>^</ГеографическоеНазвание>
            <Сокращение>^</Сокращение>
          </Улица>
          <Дом>
            <Сокращение>^</Сокращение>
            <Номер>^</Номер>
          </Дом>
          <Корпус>
            <Сокращение>^</Сокращение>
            <Номер>^</Номер>
          </Корпус>
          <Квартира>
            <Сокращение>^</Сокращение>
            <Номер>^</Номер>
          </Квартира>
          </РоссийскийАдрес>
.}
.fields
  AdrStr
  Адр2Индекс
.endfields
        </АдресРегистрации>
.}
.{?internal;trim(Адр2Адр) <> trim(Адр1Адр) and АдрПроживания_магнит <> ''
        <АдресФактический>
.begin
  AdrStr := '';
  if trim(АдрПроживания_Страна_сокр) = ''
    AdrStr := 'РОССИЙСКИЙ'
  else
    AdrStr := 'ИНОСТРАННЫЙ';
end.
          <ТипАдреса>^</ТипАдреса>
          <Индекс>^</Индекс>
.fields
  АдрПроживания_Страна_сокр
  АдрПроживания_Страна
  Адр2Адр
.endfields
.{?internal;trim(АдрПроживания_Страна_сокр) <> ''
          <ИностранныйАдрес>
            <КодСтраны>^</КодСтраны>
            <НазваниеСтраны>^</НазваниеСтраны>
            <Адрес>^</Адрес>
          </ИностранныйАдрес>
.}
.fields
  АдрПроживания_Регион
  АдрПроживания_Регион_сокр

  АдрПроживания_Район
  АдрПроживания_Район_сокр

  АдрПроживания_Город
  АдрПроживания_Город_сокр

  АдрПроживания_НасПункт
  АдрПроживания_НасПункт_сокр

  АдрПроживания_Улица
  АдрПроживания_Улица_сокр

  АдрПроживания_Дом_сокр
  АдрПроживания_Дом

  АдрПроживания_Корпус_сокр
  АдрПроживания_Корпус

  АдрПроживания_Квартира_сокр
  UpCase(АдрПроживания_Квартира)
  Телефоны
.endfields
.{?internal;trim(АдрПроживания_Страна_сокр) = ''
          <РоссийскийАдрес>
          <Регион>
            <ГеографическоеНазвание>^</ГеографическоеНазвание>
            <Сокращение>^</Сокращение>
          </Регион>
          <Район>
            <ГеографическоеНазвание>^</ГеографическоеНазвание>
            <Сокращение>^</Сокращение>
          </Район>
          <Город>
            <ГеографическоеНазвание>^</ГеографическоеНазвание>
            <Сокращение>^</Сокращение>
          </Город>
          <НаселенныйПункт>
            <ГеографическоеНазвание>^</ГеографическоеНазвание>
            <Сокращение>^</Сокращение>
          </НаселенныйПункт>
          <Улица>
            <ГеографическоеНазвание>^</ГеографическоеНазвание>
            <Сокращение>^</Сокращение>
          </Улица>
          <Дом>
            <Сокращение>^</Сокращение>
            <Номер>^</Номер>
          </Дом>
          <Корпус>
            <Сокращение>^</Сокращение>
            <Номер>^</Номер>
          </Корпус>
          <Квартира>
            <Сокращение>^</Сокращение>
            <Номер>^</Номер>
          </Квартира>
          </РоссийскийАдрес>
.}
        </АдресФактический>
.}
        <Телефон>^</Телефон>
      </ИзменившиесяДанные>
.{?internal;Trim(UpCase(Отчество_нов)) = 'ОТМЕНЕНО'
      <ПризнакОтменыОтчества>ОТМЕНЕНО</ПризнакОтменыОтчества>
.}
.{?internal;ДатРожд_измен  = 1
     <ПризнакОтменыМестаРождения>ОТМЕНЕНО</ПризнакОтменыМестаРождения>
.}
.fields
  Trim(UpCase(ТипДок))
  Trim(UpCase(НаимДок))
  UpCase(СерияРим) UpCase(СерияРус) НомерПасс
  if(Day(Датавыдачи) = 0,'', DatetoStr(Датавыдачи, FormatedDate))
  Trim(UpCase(КемВыдан))
  if(Day(ДатаЗаполнения) = 0,'', DatetoStr(ДатаЗаполнения, FormatedDate))
.endfields
      <УдостоверяющийДокумент>
        <ТипУдостоверяющего>^</ТипУдостоверяющего>
        <Документ>
          <НаименованиеУдостоверяющего>^</НаименованиеУдостоверяющего>
          <СерияРимскиеЦифры>^</СерияРимскиеЦифры>
          <СерияРусскиеБуквы>^</СерияРусскиеБуквы>
          <НомерУдостоверяющего>^</НомерУдостоверяющего>
          <ДатаВыдачи>^</ДатаВыдачи>
          <КемВыдан>^</КемВыдан>
        </Документ>
      </УдостоверяющийДокумент>
      <ДатаЗаполнения>^</ДатаЗаполнения>
    </ЗАЯВЛЕНИЕ_ОБ_ОБМЕНЕ>
.begin  DocCnt := DocCnt + 1 end.
.}
.if DEndPach7
.begin EndPach := true; end.
.{ ADV61_70 CheckEnter
.}
  </ПачкаВходящихДокументов>
</ФайлПФР>
.fields
НомТекПачки
.endfields
___КОНЕЦ ^ ПАЧКИ
.end
.{?internal;not EndPach
  </ПачкаВходящихДокументов>
</ФайлПФР>
.}
.}
.endform
!
.linkform 'DPENS7_MAGNIT_3' prototype is 'DPENS7'
.nameinlist'Файл заявление о выдаче дубликата страхового свидетельства(вер. 7.0)'
.F 'ZAYAVLENIE_O_DUBLIKATE.XML'
.var
 EndPach: boolean;
 PachCnt : longint;
 DocCnt  : longint;
 sex10: string[10]
 my_pred, my_pred2 : string[100];
 tmpstr: string[30];
 AdrStr: string;
.endvar
.group 'Заявление о выдаче дубликата'
.begin
  PachCnt :=0
  DocCnt  :=0
end.
.{ AllPachLoop70 CheckEnter
<?xml version="1.0" encoding="cp866"?>
<ФайлПФР>
<ИмяФайла></ИмяФайла>
  <ЗаголовокФайла>
    <ВерсияФормата>07.00</ВерсияФормата>
    <ТипФайла>ВНЕШНИЙ</ТипФайла>
    <ПрограммаПодготовкиДанных>
       <НазваниеПрограммы>ГАЛАКТИКА</НазваниеПрограммы>
       <Версия>8.10</Версия>
    </ПрограммаПодготовкиДанных>
    <ИсточникДанных>СТРАХОВАТЕЛЬ</ИсточникДанных>
  </ЗаголовокФайла>
.begin
  my_pred := Upcase(Trim(Replace(Наименование, '"', '"' )));
  my_pred2:= Upcase(Trim(Replace(НаименованиеКраткое, '"', '"' )));
  DocCnt  :=1;
  EndPach := false;
end.
.fields
!  (longint(НомерДок) + DocCnt)
  INN
  KPP
  CodeOGRUL
  FormSobs
  my_pred
  my_pred2
  РегНомер
.endfields
  <ПачкаВходящихДокументов Стадия = "До обработки" Окружение = "В составе файла">
    <ВХОДЯЩАЯ_ОПИСЬ>
      <НомерВпачке>1</НомерВпачке>
      <ТипВходящейОписи>ОПИСЬ ПАЧКИ</ТипВходящейОписи>
      <СоставительПачки>
        <НалоговыйНомер>
          <ИНН>^</ИНН>
          <КПП>^</КПП>
        </НалоговыйНомер>
        <КодЕГРИП></КодЕГРИП>
        <КодЕГРЮЛ>^</КодЕГРЮЛ>
        <Форма>^</Форма>
        <НаименованиеОрганизации>^</НаименованиеОрганизации>
        <НаименованиеКраткое>^</НаименованиеКраткое>
        <РегистрационныйНомер>^</РегистрационныйНомер>
!        <Подразделение>
!          <НаименованиеПодразделения> </НаименованиеПодразделения>
!          <НомерПодразделения> </НомерПодразделения>
!        </Подразделение>
!        <НомерЛицензии></НомерЛицензии>
!        <ДатаВыдачиЛицензии></ДатаВыдачиЛицензии>
      </СоставительПачки>
.fields
  (longint(НомерПачки) + PachCnt)
!  (Word(НомерПачки) + PachCnt)
!  ЧислоДок
  ЧислоДок
  ДатаСостав
.endfields
      <НомерПачки>
        <Основной>^</Основной>
!        <ПоПодразделению>^</ПоПодразделению>
      </НомерПачки>
      <СоставДокументов>
        <Количество>1</Количество>
        <НаличиеДокументов>
          <ТипДокумента>ЗАЯВЛЕНИЕ_О_ДУБЛИКАТЕ</ТипДокумента>
          <Количество>^</Количество>
        </НаличиеДокументов>
      </СоставДокументов>
      <ДатаСоставления>^</ДатаСоставления>
    </ВХОДЯЩАЯ_ОПИСЬ>
.begin
  PachCnt := PachCnt + 1
  DocCnt  :=1;
end.
.{ NexpPersLoop70 CheckEnter
.fields
  (longint(НомерДок) + DocCnt)
  СтрахНомер
  Trim(UpCase(Фамилия)) Trim(UpCase(Имя)) Trim(UpCase(Отчество))
.endfields
    <ЗАЯВЛЕНИЕ_О_ДУБЛИКАТЕ>
      <НомерВпачке>^</НомерВпачке>
!      <СистемныйНомер></СистемныйНомер>
!      <Состояние></Состояние>
!      <ВсеОшибки></ВсеОшибки>
!      <ЗаверениеДокумента>ПФР</ЗаверениеДокумента>
!      <ДокументОснование>???</ДокументОснование>
      <СтраховойНомер>^</СтраховойНомер>
      <ОтметкаОпредставленииСведений>БУДУТ ПРЕДСТАВЛЕНЫ</ОтметкаОпредставленииСведений>
      <ФИОизСтрахового>
        <Фамилия>^</Фамилия>
        <Имя>^</Имя>
        <Отчество>^</Отчество>
      </ФИОизСтрахового>
.fields
  if(Пол = '',Trim(''), UpCase(sex10))
  ДатаРожд
  Trim(UpCase(НасПункт))
  Trim(UpCase(Район))
  Trim(UpCase(Обл))
  Trim(UpCase(Страна))
.endfields
.begin
  sex10 := '';
  if Пол = 'Ж'
    sex10 := 'ЖЕНСКИЙ'
  else
    sex10 := 'МУЖСКОЙ'
end.
      <ПолИзСтрахового>^</ПолИзСтрахового>
      <ДатаРожденияИзСтрахового>^</ДатаРожденияИзСтрахового>
      <МестоРожденияИзСтрахового>
        <ТипМестаРождения>СТАНДАРТНОЕ</ТипМестаРождения>
        <ГородРождения>^</ГородРождения>
        <РайонРождения>^</РайонРождения>
        <РегионРождения>^</РегионРождения>
        <СтранаРождения>^</СтранаРождения>
      </МестоРожденияИзСтрахового>
.fields
  Trim(UpCase(Фамилия_нов)) Trim(UpCase(Имя_нов)) Trim(UpCase(Отчество_нов))
  if(ПолИзмен = '','', UpCase(sex10))
!  if(Day(ДатаРождИзмен) = 0,'', DatetoStr(ДатаРождИзмен, FormatedDate))
  Trim(UpCase(НасПунктИзмен))
  Trim(UpCase(РайонИзмен))
  Trim(UpCase(ОблИзмен))
  Trim(UpCase(СтранаИзмен))
  Гражданство
.endfields
      <ИзменившиесяДанные>
        <ФИО>
          <Фамилия>^</Фамилия>
          <Имя>^</Имя>
          <Отчество>^</Отчество>
        </ФИО>
.begin
  sex10 := '';
  if ПолИзмен = 'Ж'
    sex10 := 'ЖЕНСКИЙ'
  if ПолИзмен = 'М'
    sex10 := 'МУЖСКОЙ'
end.
.{?internal;ПолИзмен <> ''
        <Пол>^</Пол>
.}
!.{?internal;Day(ДатаРождИзмен) <> 0
!        <ДатаРождения>^</ДатаРождения>
!.}
        <МестоРождения>
          <ТипМестаРождения>СТАНДАРТНОЕ</ТипМестаРождения>
          <ГородРождения>^</ГородРождения>
          <РайонРождения>^</РайонРождения>
          <РегионРождения>^</РегионРождения>
          <СтранаРождения>^</СтранаРождения>
        </МестоРождения>
        <Гражданство>^</Гражданство>
.fields
  AdrStr
  Адр1Индекс
  АдрПрописки_Страна_сокр
  АдрПрописки_Страна
  Адр1Адр
  АдрПрописки_Регион
  АдрПрописки_Регион_сокр

  АдрПрописки_Район
  АдрПрописки_Район_сокр

  АдрПрописки_Город
  АдрПрописки_Город_сокр

  АдрПрописки_НасПункт
  АдрПрописки_НасПункт_сокр

  АдрПрописки_Улица
  АдрПрописки_Улица_сокр

  АдрПрописки_Дом_сокр
  АдрПрописки_Дом

  АдрПрописки_Корпус_сокр
  АдрПрописки_Корпус

  АдрПрописки_Квартира_сокр
  UpCase(АдрПрописки_Квартира)
.endfields
.begin
  AdrStr := '';
  if trim(АдрПрописки_Страна_сокр) = ''
    AdrStr := 'РОССИЙСКИЙ'
  else
    AdrStr := 'ИНОСТРАННЫЙ';
end.
.{?internal;(trim(Адр1Индекс) <> '' or trim(АдрПрописки_Страна_сокр) <> '' or trim(АдрПрописки_Страна) <> '' or trim(Адр1Адр) <> '' or trim(АдрПрописки_Регион) <> '' or trim(АдрПрописки_Регион_сокр) <> '' or trim(АдрПрописки_Район) <> '' or trim(АдрПрописки_Район_сокр) <> '' or trim(АдрПрописки_Город) <> '' or trim(АдрПрописки_Город_сокр) <> '' or trim(АдрПрописки_НасПункт) <> '' or trim(АдрПрописки_НасПункт_сокр) <> '' or trim(АдрПрописки_Улица) <> '' or trim(АдрПрописки_Улица_сокр) <> '' or trim(АдрПрописки_Дом_сокр) <> '' or trim(АдрПрописки_Дом) <> '' or trim(АдрПрописки_Корпус_сокр) <> '' or trim(АдрПрописки_Корпус) <> '' or trim(АдрПрописки_Квартира_сокр) <> '' or trim(UpCase(АдрПрописки_Квартира)) <> '')
        <АдресРегистрации>
          <ТипАдреса>^</ТипАдреса>
          <Индекс>^</Индекс>
.{?internal;trim(АдрПрописки_Страна_сокр) <> ''
          <ИностранныйАдрес>
            <КодСтраны>^</КодСтраны>
            <НазваниеСтраны>^</НазваниеСтраны>
            <Адрес>^</Адрес>
          </ИностранныйАдрес>
.}
.{?internal;trim(АдрПрописки_Страна_сокр) = ''
          <РоссийскийАдрес>
          <Регион>
            <ГеографическоеНазвание>^</ГеографическоеНазвание>
            <Сокращение>^</Сокращение>
          </Регион>
          <Район>
            <ГеографическоеНазвание>^</ГеографическоеНазвание>
            <Сокращение>^</Сокращение>
          </Район>
          <Город>
            <ГеографическоеНазвание>^</ГеографическоеНазвание>
            <Сокращение>^</Сокращение>
          </Город>
          <НаселенныйПункт>
            <ГеографическоеНазвание>^</ГеографическоеНазвание>
            <Сокращение>^</Сокращение>
          </НаселенныйПункт>
          <Улица>
            <ГеографическоеНазвание>^</ГеографическоеНазвание>
            <Сокращение>^</Сокращение>
          </Улица>
          <Дом>
            <Сокращение>^</Сокращение>
            <Номер>^</Номер>
          </Дом>
          <Корпус>
            <Сокращение>^</Сокращение>
            <Номер>^</Номер>
          </Корпус>
          <Квартира>
            <Сокращение>^</Сокращение>
            <Номер>^</Номер>
          </Квартира>
          </РоссийскийАдрес>
.}
        </АдресРегистрации>
.}
.fields
  AdrStr
  Адр2Индекс
  АдрПроживания_Страна_сокр
  АдрПроживания_Страна
  Адр2Адр
  АдрПроживания_Регион
  АдрПроживания_Регион_сокр

  АдрПроживания_Район
  АдрПроживания_Район_сокр

  АдрПроживания_Город
  АдрПроживания_Город_сокр

  АдрПроживания_НасПункт
  АдрПроживания_НасПункт_сокр

  АдрПроживания_Улица
  АдрПроживания_Улица_сокр

  АдрПроживания_Дом_сокр
  АдрПроживания_Дом

  АдрПроживания_Корпус_сокр
  АдрПроживания_Корпус

  АдрПроживания_Квартира_сокр
  UpCase(АдрПроживания_Квартира)
  Телефоны
.endfields
.begin
  AdrStr := '';
  if trim(АдрПроживания_Страна_сокр) = ''
    AdrStr := 'РОССИЙСКИЙ'
  else
    AdrStr := 'ИНОСТРАННЫЙ';
end.
.{?internal;trim(Адр2Индекс) <> '' or trim(АдрПроживания_Страна_сокр) <> '' or trim(АдрПроживания_Страна) <> '' or trim(Адр2Адр) <> '' or trim(АдрПроживания_Регион) <> '' or trim(АдрПроживания_Регион_сокр) <> '' or trim(АдрПроживания_Район) <> '' or trim(АдрПроживания_Район_сокр) <> '' or trim(АдрПроживания_Город) <> '' or trim(АдрПроживания_Город_сокр) <> '' or trim(АдрПроживания_НасПункт) <> '' or trim(АдрПроживания_НасПункт_сокр) <> '' or trim(АдрПроживания_Улица) <> '' or trim(АдрПроживания_Улица_сокр) <> '' or trim(АдрПроживания_Дом_сокр) <> '' or trim(АдрПроживания_Дом) <> '' or trim(АдрПроживания_Корпус_сокр) <> '' or trim(АдрПроживания_Корпус) <> '' or trim(АдрПроживания_Квартира_сокр) <> '' or trim(UpCase(АдрПроживания_Квартира)) <> ''
         <АдресФактический>
          <ТипАдреса>^</ТипАдреса>
          <Индекс>^</Индекс>
.{?internal;trim(АдрПроживания_Страна_сокр) <> ''
          <ИностранныйАдрес>
            <КодСтраны>^</КодСтраны>
            <НазваниеСтраны>^</НазваниеСтраны>
            <Адрес>^</Адрес>
          </ИностранныйАдрес>
.}
.{?internal;trim(АдрПроживания_Страна_сокр) = ''
          <РоссийскийАдрес>
          <Регион>
            <ГеографическоеНазвание>^</ГеографическоеНазвание>
            <Сокращение>^</Сокращение>
          </Регион>
          <Район>
            <ГеографическоеНазвание>^</ГеографическоеНазвание>
            <Сокращение>^</Сокращение>
          </Район>
          <Город>
            <ГеографическоеНазвание>^</ГеографическоеНазвание>
            <Сокращение>^</Сокращение>
          </Город>
          <НаселенныйПункт>
            <ГеографическоеНазвание>^</ГеографическоеНазвание>
            <Сокращение>^</Сокращение>
          </НаселенныйПункт>
          <Улица>
            <ГеографическоеНазвание>^</ГеографическоеНазвание>
            <Сокращение>^</Сокращение>
          </Улица>
          <Дом>
            <Сокращение>^</Сокращение>
            <Номер>^</Номер>
          </Дом>
          <Корпус>
            <Сокращение>^</Сокращение>
            <Номер>^</Номер>
          </Корпус>
          <Квартира>
            <Сокращение>^</Сокращение>
            <Номер>^</Номер>
          </Квартира>
          </РоссийскийАдрес>
.}
        </АдресФактический>
.}
        <Телефон>^</Телефон>
      </ИзменившиесяДанные>
.fields
  Trim(UpCase(ТипДок))
  Trim(UpCase(НаимДок))
  UpCase(СерияРим) UpCase(СерияРус) НомерПасс
  Датавыдачи
  Trim(UpCase(КемВыдан))
  ДатаЗаполнения
.endfields
      <УдостоверяющийДокумент>
        <ТипУдостоверяющего>^</ТипУдостоверяющего>
        <Документ>
          <НаименованиеУдостоверяющего>^</НаименованиеУдостоверяющего>
          <СерияРимскиеЦифры>^</СерияРимскиеЦифры>
          <СерияРусскиеБуквы>^</СерияРусскиеБуквы>
          <НомерУдостоверяющего>^</НомерУдостоверяющего>
          <ДатаВыдачи>^</ДатаВыдачи>
          <КемВыдан>^</КемВыдан>
        </Документ>
      </УдостоверяющийДокумент>
      <ДатаЗаполнения>^</ДатаЗаполнения>
    </ЗАЯВЛЕНИЕ_О_ДУБЛИКАТЕ>
.begin
  DocCnt := DocCnt + 1
end.
.}
.if DEndPach7
.begin EndPach := true; end.
.{ ADV61_70 CheckEnter
.}
  </ПачкаВходящихДокументов>
</ФайлПФР>
.fields
НомТекПачки
.endfields
___КОНЕЦ ^ ПАЧКИ
.end
.{?internal;not EndPach
  </ПачкаВходящихДокументов>
</ФайлПФР>
.}
.}
.endform
!
.linkform 'DPENS7_MAGNIT_4' prototype is 'DPENS7'
.nameinlist'Файл сведения о смерти застрахованного лица(вер. 7.0)'
.F 'SVEDENIYA_O_SMERTI.XML'
.var
 EndPach: boolean;
 PachCnt : longint;
 DocCnt  : longint;
 sex10: string[10]
 my_pred, my_pred2 : string[100];
 tmpstr: string[30];
 AdrStr: string;
.endvar
.group 'Справка о смерти'
.begin
  PachCnt :=0
  DocCnt  :=0
end.
.{ AllPachLoop70 CheckEnter
<?xml version="1.0" encoding="cp866"?>
<ФайлПФР>
<ИмяФайла></ИмяФайла>
  <ЗаголовокФайла>
    <ВерсияФормата>07.00</ВерсияФормата>
    <ТипФайла>ВНЕШНИЙ</ТипФайла>
    <ПрограммаПодготовкиДанных>
       <НазваниеПрограммы>ГАЛАКТИКА</НазваниеПрограммы>
       <Версия>8.10</Версия>
    </ПрограммаПодготовкиДанных>
    <ИсточникДанных>СТРАХОВАТЕЛЬ</ИсточникДанных>
  </ЗаголовокФайла>
.begin
  my_pred := Upcase(Trim(Replace(Наименование, '"', '"' )));
  my_pred2:= Upcase(Trim(Replace(НаименованиеКраткое, '"', '"' )));
  DocCnt  :=1
  EndPach := false;
end.
.fields
!  (Word(НомерДок) + DocCnt)
  INN
  KPP
  CodeOGRUL
  FormSobs
  my_pred
  my_pred2
  РегНомер
.endfields
  <ПачкаВходящихДокументов Стадия = "До обработки" Окружение = "В составе файла">
    <ВХОДЯЩАЯ_ОПИСЬ>
      <НомерВпачке>1</НомерВпачке>
      <ТипВходящейОписи>ОПИСЬ ПАЧКИ</ТипВходящейОписи>
      <СоставительПачки>
        <НалоговыйНомер>
          <ИНН>^</ИНН>
          <КПП>^</КПП>
        </НалоговыйНомер>
        <КодЕГРИП></КодЕГРИП>
        <КодЕГРЮЛ>^</КодЕГРЮЛ>
        <Форма>^</Форма>
        <НаименованиеОрганизации>^</НаименованиеОрганизации>
        <НаименованиеКраткое>^</НаименованиеКраткое>
        <РегистрационныйНомер>^</РегистрационныйНомер>
!        <Подразделение>
!          <НаименованиеПодразделения> </НаименованиеПодразделения>
!          <НомерПодразделения> </НомерПодразделения>
!        </Подразделение>
!        <НомерЛицензии></НомерЛицензии>
!        <ДатаВыдачиЛицензии></ДатаВыдачиЛицензии>
      </СоставительПачки>
.fields
  (longint(НомерПачки) + PachCnt)
!  (Word(НомерПачки) + PachCnt)
!  ЧислоДок
  ЧислоДок
  ДатаСостав
.endfields
      <НомерПачки>
        <Основной>^</Основной>
!        <ПоПодразделению></ПоПодразделению>
      </НомерПачки>
      <СоставДокументов>
        <Количество>1</Количество>
        <НаличиеДокументов>
          <ТипДокумента>СВЕДЕНИЯ_О_СМЕРТИ</ТипДокумента>
          <Количество>^</Количество>
        </НаличиеДокументов>
      </СоставДокументов>
      <ДатаСоставления>^</ДатаСоставления>
    </ВХОДЯЩАЯ_ОПИСЬ>
.begin
  PachCnt := PachCnt + 1
  DocCnt  :=1
end.
.{ NexpPersLoop70 CheckEnter
.fields
  (longint(НомерДок) + DocCnt)
  ВыданоСвидСмерт
  Trim(UpCase(Фамилия)) Trim(UpCase(Имя)) Trim(UpCase(Отчество))
.endfields
    <СВЕДЕНИЯ_О_СМЕРТИ>
      <НомерВпачке>^</НомерВпачке>
      <ОрганЗАГС>
        <НаименованиеОрганизации>^</НаименованиеОрганизации>
      </ОрганЗАГС>
      <ФИО>
        <Фамилия>^</Фамилия>
        <Имя>^</Имя>
        <Отчество>^</Отчество>
      </ФИО>
.fields
  if(Пол = chr(0),Trim(''), UpCase(sex10))
  Trim(UpCase(НасПункт))
  Trim(UpCase(Район))
  Trim(UpCase(Обл))
  Trim(UpCase(Страна))
  ДатаРожд
  ДатаСмерти
  Trim(UpCase(НомерЗаписиАкта))
  ДатаЗаписиАкта
.endfields
.begin
  sex10 := '';
  if пол = 'Ж'
    sex10 := 'ЖЕНСКИЙ'
  else
    sex10 := 'МУЖСКОЙ'
end.
      <Пол>^</Пол>
      <МестоРождения>
        <ТипМестаРождения>СТАНДАРТНОЕ</ТипМестаРождения>
        <ГородРождения>^</ГородРождения>
        <РайонРождения>^</РайонРождения>
        <РегионРождения>^</РегионРождения>
        <СтранаРождения>^</СтранаРождения>
      </МестоРождения>
      <ДатаРождения>^</ДатаРождения>
      <ДатаСмерти>^</ДатаСмерти>
      <НомерЗаписиАкта>^</НомерЗаписиАкта>
      <ДатаЗаписиАкта>^</ДатаЗаписиАкта>
.fields
  Trim(UpCase(ТипДок))
  Trim(UpCase(НаимДок))
  UpCase(СерияРим)
  UpCase(СерияРус)
  НомерПасс
  Датавыдачи
  Trim(UpCase(КемВыдан))
.endfields
      <УдостоверяющийДокумент>
        <ТипУдостоверяющего>^</ТипУдостоверяющего>
        <Документ>
          <НаименованиеУдостоверяющего>^</НаименованиеУдостоверяющего>
          <СерияРимскиеЦифры>^</СерияРимскиеЦифры>
          <СерияРусскиеБуквы>^</СерияРусскиеБуквы>
          <НомерУдостоверяющего>^</НомерУдостоверяющего>
          <ДатаВыдачи>^</ДатаВыдачи>
          <КемВыдан>^</КемВыдан>
        </Документ>
      </УдостоверяющийДокумент>
.fields
// ----   проживание -----
  AdrStr
  Адр2Индекс
.endfields
        <ПоследнееМестоЖительства>
.begin
  AdrStr := '';
  if trim(АдрПроживания_Страна_сокр) = ''
    AdrStr := 'РОССИЙСКИЙ'
  else
    AdrStr := 'ИНОСТРАННЫЙ';
end.
          <ТипАдреса>^</ТипАдреса>
          <Индекс>^</Индекс>
.fields
  АдрПроживания_Страна_сокр
  АдрПроживания_Страна
  Адр2Адр
.endfields
.{?internal;trim(АдрПроживания_Страна_сокр) <> ''
          <ИностранныйАдрес>
            <КодСтраны>^</КодСтраны>
            <НазваниеСтраны>^</НазваниеСтраны>
            <Адрес>^</Адрес>
          </ИностранныйАдрес>
.}
.fields
  АдрПроживания_Регион
  АдрПроживания_Регион_сокр

  АдрПроживания_Район
  АдрПроживания_Район_сокр

  АдрПроживания_Город
  АдрПроживания_Город_сокр

  АдрПроживания_НасПункт
  АдрПроживания_НасПункт_сокр

  АдрПроживания_Улица
  АдрПроживания_Улица_сокр

  АдрПроживания_Дом_сокр
  АдрПроживания_Дом

  АдрПроживания_Корпус_сокр
  АдрПроживания_Корпус

  АдрПроживания_Квартира_сокр
  UpCase(АдрПроживания_Квартира)
.endfields
.{?internal;trim(АдрПроживания_Страна_сокр) = ''
          <РоссийскийАдрес>
          <Регион>
            <ГеографическоеНазвание>^</ГеографическоеНазвание>
            <Сокращение>^</Сокращение>
          </Регион>
          <Район>
            <ГеографическоеНазвание>^</ГеографическоеНазвание>
            <Сокращение>^</Сокращение>
          </Район>
          <Город>
            <ГеографическоеНазвание>^</ГеографическоеНазвание>
            <Сокращение>^</Сокращение>
          </Город>
          <НаселенныйПункт>
            <ГеографическоеНазвание>^</ГеографическоеНазвание>
            <Сокращение>^</Сокращение>
          </НаселенныйПункт>
          <Улица>
            <ГеографическоеНазвание>^</ГеографическоеНазвание>
            <Сокращение>^</Сокращение>
          </Улица>
          <Дом>
            <Сокращение>^</Сокращение>
            <Номер>^</Номер>
          </Дом>
          <Корпус>
            <Сокращение>^</Сокращение>
            <Номер>^</Номер>
          </Корпус>
          <Квартира>
            <Сокращение>^</Сокращение>
            <Номер>^</Номер>
          </Квартира>
          </РоссийскийАдрес>
.}
      </ПоследнееМестоЖительства>
.fields
  СтрахНомер
.endfields
      <СтраховойНомер>^</СтраховойНомер>
.fields
  ДатаЗаполнения
.endfields
      <ДатаЗаполнения>^</ДатаЗаполнения>
    </СВЕДЕНИЯ_О_СМЕРТИ>
.begin
  DocCnt := DocCnt + 1
end.
.}
.if DEndPach7
.begin EndPach := true; end.
.{ ADV61_70 CheckEnter
.}
  </ПачкаВходящихДокументов>
</ФайлПФР>
.fields
НомТекПачки
.endfields
___КОНЕЦ ^ ПАЧКИ
.end
.{?internal;not EndPach
  </ПачкаВходящихДокументов>
</ФайлПФР>
.}
.}
.endform
