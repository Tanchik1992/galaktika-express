//------------------------------------------------------------------------------
//                                                      (c) корпорация ГАЛАКТИКА
// ГАЛАКТИКА 7.11 - Производственное планирование
// Сводные потребности
//------------------------------------------------------------------------------

#doc
Базовая форма сводных потребностей</brief>
#end

.form Rep1006
.hide
.defo landscape
.fields
RType
DAddInfo

DOType
DOName
DOCode
DONNom

DType
DName
DCode

DDate
DOQnt: double
DOEIzm
DLevel
DEIzm
DVariant

! 0 - в часах 1 - в единицах документа
wPREITime: word

GroupName

PRType
PRName
PRCode
PRNNom
PRQnt  : double
PRTime : double
PRSum  : double
PREIzm
PRPrice: double
.endfields
 ^ ^
 ^ ^ ^ ^
 ^ ^ ^
 ^ ^ ^ ^ ^ ^
 ^
.if NotGroup
.end // if
.{
 ^ ^ ^ ^ ^ ^ ^ ^ ^ ^
.}
.if NotGroup1
.end // if
.endform
//******************************************************************************
.linkform 'PotrNorm' prototype is Rep1006
.nameinlist 'СВОДНЫЕ ПОТРЕБНОСТИ В НОРМАХ'
.group 'Norm'
.var
  CurGroupName: string
.endvar
.fields
RType
DAddInfo

DOType
DOName
DOCode
DONNom

DType
DName
DCode

DDate
DOQnt
DOEIzm
DLevel
DEIzm

.endfields
.begin
CurGroupName:= '';
end.

 СВОДНЫЕ ПОТРЕБНОСТИ В ^ ^

 Изделие (^):
   наименование  : ^
   обозначение   : ^
   номенкл. номер: ^
 Документ (^):
   наименование  : ^
   код           : ^
 Параметры расчета:
   на дату       : ^
   объем         : ^ ^
   уровень       : ^
   в единицах    : ^
───────────────────────────────────┬──────────────────────┬──────────────────────┬───────────────────────────
   Наименование                    │ Номенкл. номер       │ Обозначение          │ Потребность
.if NotGroup
───────────────────────────────────┼──────────────────────┼──────────────────────┼───────────────────────────
.end // if
.{
.{ ?Internal;(GroupName <> CurGroupName)
.fields
GroupName
.endfields
───────────────────────────────────┴──────────────────────┴──────────────────────┴───────────────────────────
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
───────────────────────────────────┬──────────────────────┬──────────────────────┬───────────────────────────
.begin
CurGroupName:= GroupName;
end.
.} //end of ?Internal
.fields
PRName
PRNNom
PRCode
PRQnt
PREIzm
.endfields
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ │ @@@@@@@@@@@@@@@@@@@@ │ @@@@@@@@@@@@@@@@@@@@ │ &&&&&&&&&&.&&&&&&& @@@@@@
.}
.if NotGroup1
.end // if
───────────────────────────────────┴──────────────────────┴──────────────────────┴───────────────────────────
.endform
//******************************************************************************
.linkform 'InsNorm' prototype is Rep1006
.nameinlist 'СВОДНЫЕ ПОТРЕБНОСТИ В ИНСТРУМЕНТЕ'
.group 'InsNorm'
.var
  CurGroupName: string
.endvar
.fields
RType
DAddInfo

DOType
DOName
DOCode
DONNom

DType
DName
DCode

DDate
DOQnt
DOEIzm
DLevel
DEIzm

.endfields
.begin
CurGroupName:= '';
end.

 СВОДНЫЕ ПОТРЕБНОСТИ В ^ ^

 Изделие (^):
   наименование  : ^
   обозначение   : ^
   номенкл. номер: ^
 Документ (^):
   наименование  : ^
   код           : ^
 Параметры расчета:
   на дату       : ^
   объем         : ^ ^
   уровень       : ^
   в единицах    : ^
────────────────────────────────┬──────────────────────┬──────────────────────┬───────┬───────────┬──────────
   Наименование                 │ Номенкл. номер       │ Обозначение          │ Ед.   │ Требуется │ с учетом
                                │                      │                      │ изм.  │           │ износа
.if NotGroup
────────────────────────────────┼──────────────────────┼──────────────────────┼───────┼───────────┼──────────
.end // if
.{
.{ ?Internal;(GroupName <> CurGroupName)
.fields
GroupName
.endfields
────────────────────────────────┴──────────────────────┴──────────────────────┴───────┴───────────┴──────────
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
────────────────────────────────┬──────────────────────┬──────────────────────┬───────┬───────────┬──────────
.begin
CurGroupName:= GroupName;
end.
.} //end of ?Internal
.fields
PRName
PRNNom
PRCode
PREIzm
PRQnt
PRSum
.endfields
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ │ @@@@@@@@@@@@@@@@@@@@ │ @@@@@@@@@@@@@@@@@@@@ │ @@@@@ │ &&&&&.&&& │ &&&&&.&&&
.}
.if NotGroup1
.end // if
────────────────────────────────┴──────────────────────┴──────────────────────┴───────┴───────────┴──────────
.endform

//******************************************************************************
.linkform 'EquipNorm01' prototype is Rep1006
.nameinlist 'СВОДНЫЕ ПОТРЕБНОСТИ В ОБОРУДОВАНИИ'
.group 'Equip'
.var
  CurGroupName: string
  dTotalTime  : double
.endvar
.fields
RType

DOType
DOName
DOCode
DONNom

DType
DName
DCode

DDate
DOQnt
DOEIzm
DLevel

.endfields
.begin
CurGroupName:= '';
end.
.{ ?Internal;(wPREITime = 0)
.begin
  dTotalTime := 0;
end.
.} //end of ?Internal

 СВОДНЫЕ ПОТРЕБНОСТИ В ^

 Изделие (^):
   наименование  : ^
   обозначение   : ^
   номенкл. номер: ^
 Документ (^):
   наименование  : ^
   код           : ^
 Параметры расчета:
   на дату       : ^
   объем         : ^ ^
   уровень       : ^
───────────────────────────────────┬─────────────────┬───────────────────────────────┬───────────────────────────
   Наименование                    │ Серийный номер  │ Группа                        │ Потребность,
                                   │                 │                               │ машино-...
.if NotGroup
───────────────────────────────────┼─────────────────┼───────────────────────────────┼───────────────────────────
.end // if
.{
.{ ?Internal;(GroupName <> CurGroupName)
.fields
GroupName
.endfields
───────────────────────────────────┴─────────────────┴───────────────────────────────┴───────────────────────────
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
───────────────────────────────────┬─────────────────┬───────────────────────────────┬───────────────────────────
.begin
CurGroupName:= GroupName;
end.
.} //end of ?Internal
.fields
PRName
PRNNom
PRCode
PRTime
PREIzm
.endfields
.{ ?Internal;(wPREITime = 0)
.begin
  dTotalTime := dTotalTime + PRTime;
end.
.} //end of ?Internal
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ │ @@@@@@@@@@@@@@@ │ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@ │ &&&&&&&&.&&&&&&&&& @@@@@@
.}
.if NotGroup1
.end // if
───────────────────────────────────┴─────────────────┴───────────────────────────────┴───────────────────────────
.{ ?Internal;(wPREITime = 0)
.fields
  dTotalTime
  PREIzm
.endfields
                                                                     ИТОГО ПО ИЗДЕЛИЮ: &&&&&&&&.&&&&&&&&& @@@@@@
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════
.} //end of ?Internal
.endform
//******************************************************************************
.linkform 'EquipNorm02' prototype is Rep1006
.nameinlist 'СВОДНЫЕ ПОТРЕБНОСТИ В ОБОРУДОВАНИИ /по группам/'
.defo portrait
.group 'EquipGroup'
.var
  CurGroupName: string
  dTotalTime  : double
.endvar
.fields
RType

DOType
DOName
DOCode
DONNom

DType
DName
DCode

DDate
DOQnt
DOEIzm
DLevel

.endfields
.begin
CurGroupName:= '';
end.
.{ ?Internal;(wPREITime = 0)
.begin
  dTotalTime := 0;
end.
.} //end of ?Internal

 СВОДНЫЕ ПОТРЕБНОСТИ В ^

 Изделие (^):
   наименование  : ^
   обозначение   : ^
   номенкл. номер: ^
 Документ (^):
   наименование  : ^
   код           : ^
 Параметры расчета:
   на дату       : ^
   объем         : ^ ^
   уровень       : ^
───────────────────────────────────┬────────────────┬───────────────────────────
   Наименование                    │ Серийный номер │ Потребность,
                                   │                │ машино-...
.if NotGroup
───────────────────────────────────┼────────────────┼───────────────────────────
.end // if
.{
.{ ?Internal;(GroupName <> CurGroupName)
.fields
GroupName
.endfields
───────────────────────────────────┴────────────────┴───────────────────────────
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
───────────────────────────────────┬────────────────┬───────────────────────────
.begin
CurGroupName:= GroupName;
end.
.} //end of ?Internal
.fields
PRName
PRNNom
PRTime
PREIzm
.endfields
.{ ?Internal;(wPREITime = 0)
.begin
  dTotalTime := dTotalTime + PRTime;
end.
.} //end of ?Internal
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ │ @@@@@@@@@@@@@@ │ &&&&&&&&.&&&&&&&&& @@@@@@
.}
.if NotGroup1
.end // if
───────────────────────────────────┴────────────────┴───────────────────────────
.{ ?Internal;(wPREITime = 0)
.fields
  dTotalTime
  PREIzm
.endfields
                                    ИТОГО ПО ИЗДЕЛИЮ: &&&&&&&&.&&&&&&&&& @@@@@@
════════════════════════════════════════════════════════════════════════════════
.} //end of ?Internal
.endform
//******************************************************************************
.linkform 'JobNorm01' prototype is Rep1006
.nameinlist 'СВОДНЫЕ ПОТРЕБНОСТИ В ТРУДОЗАТРАТАХ'
.group 'Job'
.var
  CurGroupName: string
  dGrTime: double
  dGrSum : double
  dTotalTime: double
  dTotalSum : double
.endvar
.fields
RType

DOType
DOName
DOCode
DONNom

DType
DName
DCode

DDate
DOQnt
DOEIzm
DLevel
//DAddInfo

.endfields
.begin
CurGroupName:= GroupName;
// dTotalTime:= 0;
dTotalSum := 0;
end.
.{ ?Internal;(wPREITime = 0)
.begin
  dTotalTime := 0;
end.
.} //end of ?Internal

 СВОДНЫЕ ПОТРЕБНОСТИ В ^

 Изделие (^):
   наименование  : ^
   обозначение   : ^
   номенкл. номер: ^
 Документ (^):
   наименование  : ^
   код           : ^
 Параметры расчета:
   на дату       : ^
   объем         : ^ ^
   уровень       : ^
.{ ?Internal;(DEIzm <> '1')
.fields
DAddInfo
.endfields
───────────────────────────────────┬───────────────────────────────────┬─────────────────────────────────────────
   Наименование операции           │ Вид работ                         │ Потребность,
                                   │                                   │ человеко-...          │ ^
.} //end of ?Internal  (DEIzm <> '1')
.{ ?Internal;(DEIzm = '1')
.fields
DAddInfo
.endfields
────────────────────────┬──────────────────────────┬──────────────────────────┬─────────────────────────────────────────
 Наименование профессии │   Наименование операции  │         Вид работ        │ Потребность,
                        │                          │                          │ человеко-...          │ ^
.} //end of ?Internal  (DEIzm = '1')
.if NotGroup
.{ ?Internal;(DEIzm <> '1')
───────────────────────────────────┼───────────────────────────────────┼───────────────────────┼─────────────────
.} //end of ?Internal  (DEIzm <> '1')
.{ ?Internal;(DEIzm = '1')
────────────────────────┼──────────────────────────┼──────────────────────────┼───────────────────────┼─────────────────
.} //end of ?Internal  (DEIzm = '1')
.else
.{ ?Internal;(DEIzm <> '1')
───────────────────────────────────┴───────────────────────────────────┴───────────────────────┴─────────────────
.fields
GroupName
.endfields
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
───────────────────────────────────┬───────────────────────────────────┬───────────────────────┬─────────────────
.} //end of ?Internal  (DEIzm <> '1')
.{ ?Internal;(DEIzm = '1')
────────────────────────┴──────────────────────────┴──────────────────────────┴───────────────────────┴─────────────────
.fields
GroupName
.endfields
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
────────────────────────┬──────────────────────────┬──────────────────────────┬───────────────────────┬─────────────────
.} //end of ?Internal  (DEIzm = '1')
.begin
// dGrTime:= 0;
dGrSum := 0;
end.
.{ ?Internal;(wPREITime = 0)
.begin
  dGrTime := 0;
end.
.} //end of ?Internal
.end // if
.{
.{ ?Internal;(GroupName <> CurGroupName) and (wPREITime = 0)
.fields
dGrTime
PREIzm
dGrSum
GroupName
.endfields
───────────────────────────────────┴───────────────────────────────────┼───────────────────────┼─────────────────
                                                      ИТОГО ПО ГРУППЕ: │ &&&&&&.&&&&&&& @@@@@@ │ &&&&&&&&&&&&.&&
───────────────────────────────────────────────────────────────────────┴───────────────────────┴─────────────────
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
───────────────────────────────────┬───────────────────────────────────┬───────────────────────┬─────────────────
.begin
  CurGroupName := GroupName;
  dGrTime      := 0;
  dGrSum       := 0;
end.
.} //end of ?Internal
.{ ?Internal;(GroupName <> CurGroupName) and (wPREITime <> 0)
.fields
// dGrTime
dGrSum
GroupName
.endfields
───────────────────────────────────┴───────────────────────────────────┼───────────────────────┼─────────────────
                                                      ИТОГО ПО ГРУППЕ: │                       │ &&&&&&&&&&&&.&&
───────────────────────────────────────────────────────────────────────┴───────────────────────┴─────────────────
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
───────────────────────────────────┬───────────────────────────────────┬───────────────────────┬─────────────────
.begin
CurGroupName:= GroupName;
// dGrTime:= 0;
dGrSum := 0;
end.
.} //end of ?Internal
.{ ?Internal;(DEIzm = '1')
.fields
PRCode
PRName
PRNNom
PRTime
PREIzm
PRSum
.endfields
 @@@@@@@@@@@@@@@@@@@@@@ │ @@@@@@@@@@@@@@@@@@@@@@@@ │ @@@@@@@@@@@@@@@@@@@@@@@@ │ &&&&&&.&&&&&&& @@@@@@ │ &&&&&&&&&&&&.&&
.} //end of ?Internal  (DEIzm = '1')
.{ ?Internal;(DEIzm <> '1')
.fields
PRName
PRNNom
PRTime
PREIzm
PRSum
.endfields
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ │ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ │ &&&&&&.&&&&&&& @@@@@@ │ &&&&&&&&&&&&.&&
.} //end of ?Internal  (DEIzm <> '1')
.begin
// dGrTime:= dGrTime + PRTime;
dGrSum := dGrSum + PRSum;
// dTotalTime:= dTotalTime + PRTime;
dTotalSum := dTotalSum + PRSum;
end.
.{ ?Internal;(wPREITime = 0)
.begin
  dGrTime    := dGrTime + PRTime;
  dTotalTime := dTotalTime + PRTime;
end.
.} //end of ?Internal
.}
.if NotGroup1
.{ ?Internal;(DEIzm = '1')
════════════════════════╧══════════════════════════╧══════════════════════════╪═══════════════════════╪═════════════════
.} //end of ?Internal  (DEIzm = '1')
.{ ?Internal;(DEIzm <> '1')
═══════════════════════════════════╧═══════════════════════════════════╪═══════════════════════╪═════════════════
.} //end of ?Internal  (DEIzm <> '1')
.else
.{ ?Internal;(wPREITime = 0)
.fields
dGrTime
PREIzm
dGrSum
.endfields
───────────────────────────────────┴───────────────────────────────────┼───────────────────────┼─────────────────
                                                      ИТОГО ПО ГРУППЕ: │ &&&&&&.&&&&&&& @@@@@@ │ &&&&&&&&&&&&.&&
═══════════════════════════════════════════════════════════════════════╪═══════════════════════╪═════════════════
.} //end of ?Internal
.{ ?Internal;(wPREITime <> 0)
.fields
// dGrTime
dGrSum
.endfields
───────────────────────────────────┴───────────────────────────────────┼───────────────────────┼─────────────────
                                                      ИТОГО ПО ГРУППЕ: │                       │ &&&&&&&&&&&&.&&
═══════════════════════════════════════════════════════════════════════╪═══════════════════════╪═════════════════
.} //end of ?Internal
.end // if
.{ ?Internal;(wPREITime = 0) and (DEIzm = '1')
.fields
dTotalTime
PREIzm
dTotalSum
.endfields
                                                            ИТОГО ПО ИЗДЕЛИЮ: │ &&&&&&.&&&&&&& @@@@@@ │ &&&&&&&&&&&&.&&
══════════════════════════════════════════════════════════════════════════════╧═══════════════════════╧═════════════════
.} //end of ?Internal  (DEIzm = '1')
.{ ?Internal;(wPREITime = 0) and (DEIzm <> '1')
.fields
dTotalTime
PREIzm
dTotalSum
.endfields
                                                     ИТОГО ПО ИЗДЕЛИЮ: │ &&&&&&.&&&&&&& @@@@@@ │ &&&&&&&&&&&&.&&
═══════════════════════════════════════════════════════════════════════╧═══════════════════════╧═════════════════
.} //end of ?Internal  (DEIzm <> '1')
.{ ?Internal;(wPREITime <> 0) and (DEIzm = '1')
.fields
// dTotalTime
dTotalSum
.endfields
                                                            ИТОГО ПО ИЗДЕЛИЮ: │                       │ &&&&&&&&&&&&.&&
══════════════════════════════════════════════════════════════════════════════╧═══════════════════════╧═════════════════
.} //end of ?Internal  (DEIzm = '1')
.{ ?Internal;(wPREITime <> 0) and (DEIzm <> '1')
.fields
// dTotalTime
dTotalSum
.endfields
                                                     ИТОГО ПО ИЗДЕЛИЮ: │                       │ &&&&&&&&&&&&.&&
═══════════════════════════════════════════════════════════════════════╧═══════════════════════╧═════════════════
.} //end of ?Internal  (DEIzm <> '1')
.endform
//******************************************************************************
.linkform 'JobNorm02' prototype is Rep1006
.nameinlist 'СВОДНЫЕ ПОТРЕБНОСТИ В ТРУДОЗАТРАТАХ /по видам работ/'
.group 'JobGroup'
.var
  CurGroupName: string
  dGrTime: double
  dGrSum : double
  dTotalTime: double
  dTotalSum : double
.endvar
.fields
RType

DOType
DOName
DOCode
DONNom

DType
DName
DCode

DDate
DOQnt
DOEIzm
DLevel
DEIzm
DAddInfo

.endfields
.begin
CurGroupName:= GroupName;
// dTotalTime:= 0;
dTotalSum := 0;
end.
.{ ?Internal;(wPREITime = 0)
.begin
  dTotalTime := 0;
end.
.} //end of ?Internal

 СВОДНЫЕ ПОТРЕБНОСТИ В ^

 Изделие (^):
   наименование  : ^
   обозначение   : ^
   номенкл. номер: ^
 Документ (^):
   наименование  : ^
   код           : ^
 Параметры расчета:
   на дату       : ^
   объем         : ^ ^
   уровень       : ^
────────────────────────────────────────────┬─────────────────────────────────────────
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ │ Потребность,
                                            │ человеко-...          │ ^
.if NotGroup
────────────────────────────────────────────┼───────────────────────┼─────────────────
.else
────────────────────────────────────────────┴───────────────────────┴─────────────────
.fields
GroupName
.endfields
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
────────────────────────────────────────────┬───────────────────────┬─────────────────
.begin
// dGrTime:= 0;
dGrSum := 0;
end.
.{ ?Internal;(wPREITime = 0)
.begin
  dGrTime := 0;
end.
.} //end of ?Internal
.end // if
.{
.{ ?Internal;(GroupName <> CurGroupName) and (wPREITime = 0)
.fields
dGrTime
PREIzm
dGrSum
GroupName
.endfields
────────────────────────────────────────────┼───────────────────────┼─────────────────
                           ИТОГО ПО ГРУППЕ: │ &&&&&&.&&&&&&& @@@@@@ │ &&&&&&&&&&&&.&&
────────────────────────────────────────────┴───────────────────────┴─────────────────
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
────────────────────────────────────────────┬───────────────────────┬─────────────────
.begin
  CurGroupName := GroupName;
  dGrTime      := 0;
  dGrSum       := 0;
end.
.} //end of ?Internal
.{ ?Internal;(GroupName <> CurGroupName) and (wPREITime <> 0)
.fields
// dGrTime
dGrSum
GroupName
.endfields
────────────────────────────────────────────┼───────────────────────┼─────────────────
                           ИТОГО ПО ГРУППЕ: │                       │ &&&&&&&&&&&&.&&
────────────────────────────────────────────┴───────────────────────┴─────────────────
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
────────────────────────────────────────────┬───────────────────────┬─────────────────
.begin
CurGroupName:= GroupName;
// dGrTime:= 0;
dGrSum := 0;
end.
.} //end of ?Internal
.fields
PRName
PRTime
PREIzm
PRSum
.endfields
.begin
// dGrTime:= dGrTime + PRTime;
dGrSum := dGrSum + PRSum;
// dTotalTime:= dTotalTime + PRTime;
dTotalSum := dTotalSum + PRSum;
end.
.{ ?Internal;(wPREITime = 0)
.begin
  dGrTime    := dGrTime + PRTime;
  dTotalTime := dTotalTime + PRTime;
end.
.} //end of ?Internal
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ │ &&&&&&.&&&&&&& @@@@@@ │ &&&&&&&&&&&&.&&
.}
.if NotGroup1
════════════════════════════════════════════╪═══════════════════════╪═════════════════
.else
.{ ?Internal;(wPREITime = 0)
.fields
dGrTime
PREIzm
dGrSum
.endfields
────────────────────────────────────────────┼───────────────────────┼─────────────────
                           ИТОГО ПО ГРУППЕ: │ &&&&&&.&&&&&&& @@@@@@ │ &&&&&&&&&&&&.&&
════════════════════════════════════════════╪═══════════════════════╪═════════════════
.} //end of ?Internal
.{ ?Internal;(wPREITime <> 0)
.fields
// dGrTime
dGrSum
.endfields
────────────────────────────────────────────┼───────────────────────┼─────────────────
                           ИТОГО ПО ГРУППЕ: │                       │ &&&&&&&&&&&&.&&
════════════════════════════════════════════╪═══════════════════════╪═════════════════
.} //end of ?Internal
.end // if
.{ ?Internal;(wPREITime = 0)
.fields
dTotalTime
PREIzm
dTotalSum
.endfields
                          ИТОГО ПО ИЗДЕЛИЮ: │ &&&&&&.&&&&&&& @@@@@@ │ &&&&&&&&&&&&.&&
════════════════════════════════════════════╧═══════════════════════╧═════════════════
.} //end of ?Internal
.{ ?Internal;(wPREITime <> 0)
.fields
// dTotalTime
dTotalSum
.endfields
                          ИТОГО ПО ИЗДЕЛИЮ: │                       │ &&&&&&&&&&&&.&&
════════════════════════════════════════════╧═══════════════════════╧═════════════════
.} //end of ?Internal
.endform
//******************************************************************************
.linkform 'PrfNorm' prototype is Rep1006
.nameinlist 'СВОДНЫЕ ПОТРЕБНОСТИ В СПЕЦИАЛИСТАХ'
.group 'Prof'
.var
  CurGroupName: string
  dGrTime: double
  dGrSum : double
  dTotalTime: double
  dTotalSum : double
.endvar
.fields
RType

DOType
DOName
DOCode
DONNom

DType
DName
DCode

DDate
DOQnt
DOEIzm
DLevel
DAddInfo

.endfields
.begin
CurGroupName:= GroupName;
// dTotalTime:= 0;
dTotalSum := 0;
end.
.{ ?Internal;(wPREITime = 0)
.begin
  dTotalTime := 0;
end.
.} //end of ?Internal

 СВОДНЫЕ ПОТРЕБНОСТИ В ^

 Изделие (^):
   наименование  : ^
   обозначение   : ^
   номенкл. номер: ^
 Документ (^):
   наименование  : ^
   код           : ^
 Параметры расчета:
   на дату       : ^
   объем         : ^ ^
   уровень       : ^
────────────────────────────────────────┬────────────────────┬─────────┬─────────────────────────────────────────
   Наименование                         │ Код                │ Разряд  │ Потребность,
                                        │                    │         │ человеко-...          │ ^
.if NotGroup
────────────────────────────────────────┼────────────────────┼─────────┼───────────────────────┼─────────────────
.else
────────────────────────────────────────┴────────────────────┴─────────┴───────────────────────┴─────────────────
.fields
GroupName
.endfields
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
────────────────────────────────────────┬────────────────────┬─────────┬───────────────────────┬─────────────────
.begin
// dGrTime:= 0;
dGrSum := 0;
end.
.{ ?Internal;(wPREITime = 0)
.begin
  dGrTime := 0;
end.
.} //end of ?Internal
.end // if
.{
.{ ?Internal;(GroupName <> CurGroupName) and (wPREITime = 0)
.fields
dGrTime
PREIzm
dGrSum
GroupName
.endfields
────────────────────────────────────────┴────────────────────┴─────────┼───────────────────────┼─────────────────
                                                      ИТОГО ПО ГРУППЕ: │ &&&&&&.&&&&&&& @@@@@@ │ &&&&&&&&&&&&.&&
───────────────────────────────────────────────────────────────────────┴───────────────────────┴─────────────────
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
────────────────────────────────────────┬────────────────────┬─────────┬───────────────────────┬─────────────────
.begin
  CurGroupName := GroupName;
  dGrTime      := 0;
  dGrSum       := 0;
end.

.} //end of ?Internal
.{ ?Internal;(GroupName <> CurGroupName) and (wPREITime <> 0)
.fields
// dGrTime
dGrSum
GroupName
.endfields
────────────────────────────────────────┴────────────────────┴─────────┼───────────────────────┼─────────────────
                                                      ИТОГО ПО ГРУППЕ: │                       │ &&&&&&&&&&&&.&&
───────────────────────────────────────────────────────────────────────┴───────────────────────┴─────────────────
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
────────────────────────────────────────┬────────────────────┬─────────┬───────────────────────┬─────────────────
.begin
CurGroupName:= GroupName;
// dGrTime:= 0;
dGrSum := 0;
end.
.} //end of ?Internal
.fields
PRName
PRNNom
PRCode
PRTime
PREIzm
PRSum
.endfields
.begin
// dGrTime:= dGrTime + PRTime;
dGrSum := dGrSum + PRSum;
// dTotalTime:= dTotalTime + PRTime;
dTotalSum := dTotalSum + PRSum;
end.
.{ ?Internal;(wPREITime = 0)
.begin
  dGrTime    := dGrTime + PRTime;
  dTotalTime := dTotalTime + PRTime;
end.
.} //end of ?Internal
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ │ @@@@@@@@@@@@@@@@@@ │ @@@@@@@ │ &&&&&&.&&&&&&& @@@@@@ │ &&&&&&&&&&&&.&&
.}
.if NotGroup1
════════════════════════════════════════╧════════════════════╧═════════╪═══════════════════════╪═════════════════
.else
.{ ?Internal;(wPREITime = 0)
.fields
dGrTime
PREIzm
dGrSum
.endfields
────────────────────────────────────────┴────────────────────┴─────────┼───────────────────────┼─────────────────
                                                      ИТОГО ПО ГРУППЕ: │ &&&&&&.&&&&&&& @@@@@@ │ &&&&&&&&&&&&.&&
═══════════════════════════════════════════════════════════════════════╪═══════════════════════╪═════════════════
.} //end of ?Internal
.{ ?Internal;(wPREITime <> 0)
.fields
// dGrTime
dGrSum
.endfields
────────────────────────────────────────┴────────────────────┴─────────┼───────────────────────┼─────────────────
                                                      ИТОГО ПО ГРУППЕ: │                       │ &&&&&&&&&&&&.&&
═══════════════════════════════════════════════════════════════════════╪═══════════════════════╪═════════════════
.} //end of ?Internal
.end // if
.{ ?Internal;(wPREITime = 0)
.fields
dTotalTime
PREIzm
dTotalSum
.endfields
                                                     ИТОГО ПО ИЗДЕЛИЮ: │ &&&&&&.&&&&&&& @@@@@@ │ &&&&&&&&&&&&.&&
═══════════════════════════════════════════════════════════════════════╧═══════════════════════╧═════════════════
.} //end of ?Internal
.{ ?Internal;(wPREITime <> 0)
.fields
// dTotalTime
dTotalSum
.endfields
                                                     ИТОГО ПО ИЗДЕЛИЮ: │                       │ &&&&&&&&&&&&.&&
═══════════════════════════════════════════════════════════════════════╧═══════════════════════╧═════════════════
.} //end of ?Internal
.endform

//******************************************************************************
.linkform 'PriceNorm' prototype is Rep1006
.nameinlist 'СВОДНЫЕ ПОТРЕБНОСТИ В НОРМАХ (ЦЕНЫ В НДЕ)'
.group 'PriceNorm'
.var
  CurGroupName: string
  GroupSumm   : double
  TotalSumm   : double
.endvar
.fields
RType

DOType
DOName
DOCode
DONNom

DType
DName
DCode

DDate
DOQnt
DOEIzm
DLevel
DEIzm
DVariant
DAddInfo
DAddInfo
.endfields
.begin
CurGroupName:= GroupName;
GroupSumm:= 0;
TotalSumm:= 0;
end.

 СВОДНЫЕ ПОТРЕБНОСТИ В ^

 Изделие (^):
   наименование  : ^
   обозначение   : ^
   номенкл. номер: ^
 Документ (^):
   наименование  : ^
   код           : ^
 Параметры расчета:
   на дату       : ^
   объем         : ^ ^
   уровень       : ^
   в единицах    : ^
   вариант цен   : ^
──────────────────────────────┬─────────────────────┬─────────────────────┬──────────────────┬─────────┬──────────
   Наименование               │ Номенкл. номер      │ Обозначение         │ Потребность      │ Цена    │ Сумма
                              │                     │                     │                  │ @@@@@@@ │ ^
.if NotGroup
──────────────────────────────┼─────────────────────┼─────────────────────┼──────────────────┼─────────┼──────────
.else
──────────────────────────────┴─────────────────────┴─────────────────────┴──────────────────┴─────────┴──────────
.fields
GroupName
.endfields
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
──────────────────────────────┬─────────────────────┬─────────────────────┬──────────────────┬─────────┬──────────
.end // if
.{
.{ ?Internal;(GroupName <> CurGroupName)
.fields
GroupSumm
GroupName
.endfields
──────────────────────────────┴─────────────────────┴─────────────────────┴──────────────────┼─────────┴──────────
                                                                            ИТОГО ПО ГРУППЕ: │ &&&&&&&&&&&&&&&.&&
─────────────────────────────────────────────────────────────────────────────────────────────┴────────────────────
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
──────────────────────────────┬─────────────────────┬─────────────────────┬──────────────────┬─────────┬──────────
.begin
CurGroupName:= GroupName;
TotalSumm   := TotalSumm + GroupSumm;
GroupSumm   := 0;
end.
.} //end of ?Internal
.begin
GroupSumm:= GroupSumm + PRSum;
end.
.fields
PRName
PRNNom
PRCode
PRQnt
PREIzm
PRPrice
PRSum
.endfields
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@ │ @@@@@@@@@@@@@@@@@@@ │ @@@@@@@@@@@@@@@@@@@ │ &&&&&&.&&&& @@@@@│&&&&&.&& │&&&&&&.&&
.}
.if NotGroup1
══════════════════════════════╧═════════════════════╧═════════════════════╧══════════════════╪═════════╧══════════
.else
.fields
GroupSumm
.endfields
──────────────────────────────┴─────────────────────┴─────────────────────┴──────────────────┼─────────┴──────────
                                                                            ИТОГО ПО ГРУППЕ: │ &&&&&&&&&&&&&&&.&&
═════════════════════════════════════════════════════════════════════════════════════════════╪════════════════════
.end // if
.begin
TotalSumm:= TotalSumm + GroupSumm;
end.
.fields
TotalSumm
.endfields
                                                                           ИТОГО ПО ИЗДЕЛИЮ: │ &&&&&&&&&&&&&&&.&&
═════════════════════════════════════════════════════════════════════════════════════════════╧════════════════════
.endform
//******************************************************************************
