//******************************************************************************
//                                                      (c) корпорация Галактика
// Галактика 7.12 - Логистика - ДО
// Установка фильтров для ДО
//******************************************************************************

cmFilterSave:
 {
   var _IsProtectDO : boolean;

   if ( wSortField <> 0 )
     {
       if ( message( 'При сортировке по номеру документа'#13
                   + '    установка фильтров невозможна!'#13
                   + '              Изменить сортировку?', Information + YesNo) <> cmYes )
         Exit;

       wSortField := 0;

       if ( BoundActive(tbMainBoundONoDoc) )
         {
           PopBounds(tbMainBoundONoDoc);
           PushBounds(tbMainBoundOdDoc);
         }

       SetColSort;
     }

   _IsProtectDO := IsProtected(#BaseDoc);

   if _IsProtectDO
     ProtectRecord(#BaseDoc, false);

   RunWindowModal(winFilterDO);

   if _IsProtectDO
     ProtectRecord(#BaseDoc, true);

   SetFltStatusContext;
 }
