! ╔════════════════════════════════════════════════════════════════════════════╗
! ║                     (c) Корпорация ГАЛАКТИКА, 1997-2000                    ║
! ║ Проект        : ГАЛАКТИКА                                                  ║
! ║ Система       : Отдел разработки контура логистики                         ║
! ║ Версия        : 5.71                                                       ║
! ║ Назначение    : VIP код для получения реквизитов CФ "Страна происх-я" и    ║
! ║               : "Номер ГТД"                                                ║
! ║ Ответственный : Сорока Валерий Васильевич (ValeraS)                        ║
! ╚════════════════════════════════════════════════════════════════════════════╝
! var ExAttrFun  : iExAttr; 
! var ExClassFun : iExClass;
 var sRet: string;

 sRet := '';
/*
 if GetVIPInterface( ExClassFun ) {
   wClassCode := ExClassFun.GetCode( coKatParty, 'Страна происхождения' );
   sRet := ExClassFun.GetSegName( coKatParty, wClassCode, vSpStep.KatParty.nRec );
   SrcCountry := if(sRet = '', '-', sRet);
   FreeVIPInterface( ExClassFun );
 }
 if GetVIPInterface( ExAttrFun ) {
   if ExAttrFun.GetAttr( coKatParty, 'ГТД', cAttr, wTypAttr ) = 0 {
      sRet := ExAttrFun.GetValue( coKatParty, cAttr, vSpStep.KatParty.nRec, wTypAttr );
      GTDNumber := if(sRet = '', '-', sRet);
    }
    else GTDNumber := '-';
   FreeVIPInterface( ExAttrFun );
  }
*/
#ifndef GAL7_11
//  только через внешние атрибуты и классификацию
 var ExAttrFun  : iExtAttr;
 var ExClassFun : iExtClass;
 var cAttr      : comp;
 var wTypAttr, wClassCode : word;
 wClassCode := ExClassFun.GetClassCode( coKatParty, 'Страна происхождения' );
 sRet       := ExClassFun.GetSegName(wClassCode, vSpStep.KatParty.nRec );
 SrcCountry := if(sRet = '', '-', sRet);
 sRet := '';
 sRet := ExAttrFun.sGetAttr( coKatParty, vSpStep.KatParty.nRec, 'ГТД');
 GTDNumber := if(sRet = '', '-', sRet);
#else
 var iCountry : MCOriginCountry;
 if (vSpStep.SpStep.PrMC = 1) 
  {
    SrcCountry := #f_(iCountry.getCountryName(vSpStep.SpStep.cMCUsl, vSpStep.SpStep.cParty));
    GTDNumber  := #f_(iCountry.getGTDNumber(vSpStep.SpStep.cParty));
  } 
 else 
  {
    SrcCountry := '-';
    GTDNumber  := '-';
  }
#end
