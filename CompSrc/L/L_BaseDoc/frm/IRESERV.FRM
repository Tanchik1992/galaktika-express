! ╔══════════════════════════════════════════════════════════════════════════╗
! ║                     (c) Корпорация ГАЛАКТИКА, 1996,97                    ║
! ║ Проект        : ГАЛАКТИКА                                                ║
! ║ Система       : Оперативный контур                                       ║
! ║ Версия        : 5.50                                                     ║
! ║ Назначение    : Отчет о резерве на ДО                                    ║
! ║ Ответственный : Скороход Димтрий Владимирович (SDV)                      ║
! ╚══════════════════════════════════════════════════════════════════════════╝
// Общая форма
#doc
Отчет о резерве на ДО
#end
.set name='iReserv_Common'
.hide
.fields
  Заголовок
  Группировка

  DoResNRec
  SpStepNRec
  BaseDocNRec
  НомерДокумента
  ДатаДокумента
  Контрагент
  ОтпускнаяЕдиница
  Склад
  МОЛ
  Партия
  КоличествоЗарезервированного
  СредняяЦенаДляДанногоРазреза
  ЦенаМЦ
  ОкончаниеРезерва

  Группировка_Итого
  Группировка_Кол_Итого
.endfields
^ // Заголовок
.{
.{ CheckEnter iReserv_Common_Grouping
^ // Группировка
.}
.{ CheckEnter iReserv_Common_Do_Loop
^^^  // NRec'и
^^^^ // НомерДокумента ДатаДокумента Контрагент ОтпускнаяЕдиница
^^^  // Склад, МОЛ, Партия
^^^^   // КоличествоЗарезервированного  СредняяЦенаДляДанногоРазреза ЦенаМЦ ОкончаниеРезерва
.} // ДО
.{ CheckEnter iReserv_Common_Itog_Grouping
^^
.}
.}
.endform

#doc
Резерв по ДО
#end
.linkform 'iReserv_Common_1' prototype is iReserv_Common
.nameinlist 'Резерв по ДО'
.defo landscape
.fields
  CommonFormHeader
  Заголовок
  Группировка
  НомерДокумента
  ДатаДокумента
  Контрагент
  ОтпускнаяЕдиница
  Склад
  МОЛ
  Партия
  КоличествоЗарезервированного
  СредняяЦенаДляДанногоРазреза
  ЦенаМЦ
  ОкончаниеРезерва
  Группировка_Итого
  Группировка_Кол_Итого
.endfields
^
                        Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
 Р──────────┬──────────────┬────────────────────────────┬───────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬─────────────
   Дата   │   Документ   │         Контрагент         │  Ед.Изм.  │    Склад     │      МОЛ     │    Партия    │  Количество  │ Средняя цена │   Цена МЦ    │Оконч.резерва
──────────┴──────────────┴────────────────────────────┴───────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴───────────── Р
.{
.{ CheckEnter iReserv_Common_Grouping
 С^ С
.}
.{ CheckEnter iReserv_Common_Do_Loop
 Р@@@@@@@@@@ @@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@ @@@@@@@@@@@@@@ @@@@@@@@@@@@@@ @@@@@@@@@@@@@@ &&&&&&&&&&.&&& &&&&&&&&&&&.&& &&&&&&&&&&&.&& @@@@@@@@@@@@@ Р
.}
.{ CheckEnter iReserv_Common_Itog_Grouping
 С@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &&&&&&&&&&&&.&&& С
.}

.}
.endform

#doc
Специальная форма
Используется только при группировках по группе МЦ и МЦ
#end
.set name='iReserv_Spec'
.hide
.fields
  Заголовок
  Группа_МЦ

  KatMCNRec
  МЦ
  УчетнаяЕдиница
  Резерв_ДО
  Резерв_МЦ
  Всего_по_МЦ
  Процент

  Группа_Наименование
  Группа_Резерв_ДО
  Группа_Резерв_МЦ
  Группа_Всего_по_МЦ
  Группа_Процент

  Итого_Резерв_ДО
.endfields
^ // Заголовок
.{
.{ CheckEnter iReserv_Spec_Grouping
^
.}
.{ CheckEnter iReserv_Spec_Do_Loop
^^^^^^^
.}
.{ CheckEnter iReserv_Spec_Itog_Grouping
^^^^^
.}
.if iReserv_Itog_Rep
^
.end
.}
.endform

#doc
С процентным соотношение резерва по группам МЦ и МЦ
#end
.linkform 'iReserv_Spec_1' prototype is iReserv_Spec
.nameinlist 'С процентным соотношение резерва по группам МЦ и МЦ'
.fields
  CommonFormHeader
  Заголовок
  Группа_МЦ
  МЦ
  УчетнаяЕдиница
  Резерв_ДО
  Резерв_МЦ
  Всего_по_МЦ
  Процент
  Группа_Наименование
  Группа_Резерв_ДО
  Группа_Резерв_МЦ
  Группа_Всего_по_МЦ
  Группа_Процент
  Итого_Резерв_ДО
.endfields
^
              Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
 Р───────────────────────────────┬───────────┬──────────────┬──────────────┬──────────────┬──────────────
         Наименование          │  Ед.Изм.  │  Резерв ДО   │ Резерв по МЦ │ Всего по  МЦ │   Процент
───────────────────────────────┴───────────┴──────────────┴──────────────┴──────────────┴────────────── Р
.{
.{ CheckEnter iReserv_Spec_Grouping
 С^ С
.}
.{ CheckEnter iReserv_Spec_Do_Loop
 Р @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@ &&&&&&&&&&.&&& &&&&&&&&&&.&&& &&&&&&&&&&.&&& &&&&&&&&&&.&&& Р
.}
.{ CheckEnter iReserv_Spec_Itog_Grouping
 СИтого по группе @@@@@@@@@@@@@@@@@@@@@@@@@@@ &&&&&&&&&&.&&& &&&&&&&&&&.&&& &&&&&&&&&&.&&& &&&&&&&&&&.&&& С
.}

.if iReserv_Itog_Rep
 С───────────────────────────────────────────────────────────────────────────────────────────────────────
Итого по отчету                           &&&&&&&&&&&&.&&& С
.end
.}
.endform
