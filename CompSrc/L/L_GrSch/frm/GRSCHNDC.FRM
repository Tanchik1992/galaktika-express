! ╔═════════════════════════════════════════════════════════════════════════╗
! ║  Разработал:  Сенькевич И.К.                                            ║
! ║  Исправления: Сорока В.В.                                               ║
! ║  Назначение:  Карточка групп ДО                                         ║
! ╚═════════════════════════════════════════════════════════════════════════╝
#doc
Карточка групп ДО
#end
.set name = 'grschndc'
.hide
.fields
Вид               //1
Шапка_отгр        //2
strValNat: string //3
Валюта_отчета     //4
.endfields
Вид ^ ^ ^ ^
.{ // on Pick's
.fields
Группа              //5
TotalGrpNDE: double //6 - Сумма по группе ДО в НДЕ
СумГрБв: double     //7
ГрDat               //8
.endfields
Группа ^ ^ ^ ^
.{ //on SpGrSch's
.{ //on BaseDoc's
.fields
Дата               //9
Номер_счета        //10
Контрагент         //10_1
Сумма              //11
Сумма_бв           //12
Тариф              //13
Тариф_бв           //14
Отгружено          //15
Отгружено_бв       //16
Отгружено_у        //17
Отгружено_бв_у     //18

МЦ10               //19
МЦ10_бв            //20
МЦ10_у             //21
МЦ10_бв_у          //22
МЦ20               //23
МЦ20_бв            //24
МЦ20_у             //25
МЦ20_бв_у          //26
Остальные          //27
Остальные_бв       //28
Остальные_у        //29
Остальные_бв_у     //30

Оплата             //31
Оплата_бв          //32
Остаток            //33
Остаток_бв         //34
.endfields
  Дата ^ Номер ^ Контрагент ^ Сумма  ^ Сумма_бв ^ Тариф  ^  Тариф_бв  ^
  Отгружено ^ ^ ^ ^  МЦ 10% ^ ^ ^ ^ МЦ 20% ^ ^ ^ ^
  Остальные ^ ^ ^ ^  Оплата ^ ^  Остаток ^ ^
.fields
 Внутр_Номер           //35
 DateFrom              //36
 DateTo                //37
 Статус : string       //38
 ТипПоВалюте : string  //39
.endfields
Внутр_Номер     ^
ДатаС           ^
ДатаПо          ^
Статус          ^
ТипПоВалюте     ^
.} //BaseDoc's
.fields
сИтог            //40
ИСумма:double    //41
ИСумма_бв        //42
ИТариф           //43
ИТариф_бв        //44

ИОтгружено       //45
ИОтгружено_бв    //46
ИОтгружено_у     //47
ИОтгружено_бв_у  //48

ИМЦ10            //49
ИМЦ10_бв         //50
ИМЦ10_у          //51
ИМЦ10_бв_у       //52

ИМЦ20            //53
ИМЦ20_бв         //54
ИМЦ20_у          //55
ИМЦ20_бв_у       //56

ИОстальные       //57
ИОстальные_бв    //58
ИОстальные_у     //59
ИОстальные_бв_у  //60

ИОплата          //61
ИОплата_бв       //62

ИОстаток         //63
ИОстаток_бв      //64
.endfields
  ИТОГО за период ^ Сумма  ^ Сумма_бв ^ Тариф  ^  Тариф_бв  ^
  Отгружено ^ ^ ^ ^ МЦ 10% ^ ^ ^ ^ МЦ 20% ^ ^ ^ ^
  Остальные ^ ^ ^ ^  Оплата ^ ^  Остаток ^ ^
.} //SpGrSch's
.} //Pick's
.endform
!----------------------------------------------------------------------------------------------------------------------------------
#doc
Карточка групп ДО в разрезе документов-оснований c учетом  НДС
#end
.linkform 'grschndc_01' prototype is 'grschndc'
.group 'Карточки групп ДО в разрезе документов-оcнований'
.NameInList 'Карточка групп ДО в разрезе документов-оснований c учетом  НДС'
.ORIENT LANDSCAPE
.var strTotalGrpNDE  : string .endvar
.fields
CommonFormHeader
.endfields
 ^
.{
.begin
  if ( abs( TotalGrpNDE ) > 0.0000001 )
    strTotalGrpNDE := 'Сумма по группе: ';
  else
    strTotalGrpNDE := '';
end.
.fields
 Вид
 strValNat
 Группа
 strTotalGrpNDE
 TotalGrpNDE
 doGetTune('NALOG.STAV2')
 doGetTune('NALOG.STAV1')
.endfields
 Б Карточка групп ДО в разрезе документов-оснований Щ  Ш( Cчета  Б^ Б ) Ш  В( сформирована в ^ ) В
 ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 Группа:  Б ^  Б  ^ &'&&&&&&&&&&&&&.&&
 ──────────┬─────────────┬────────────────────────┬──────────────────┬────────────────┬─────────────────┬─────────────────┬─────────────────┬─────────────────┬────────────────
  Дата     │ Номер счета │       Контрагент       │       Сумма      │Стоимость услуг │     МЦ(&&%)     │    МЦ(&&%)      │   Остальные     │     Оплата      │   Остаток
 ──────────┴─────────────┴────────────────────────┴──────────────────┴────────────────┴─────────────────┴─────────────────┴─────────────────┴─────────────────┴────────────────
.{
.fields
Дата Номер_счета Контрагент Сумма Тариф  МЦ10 МЦ20  Остальные Оплата Остаток
.endfields
.{
 @@@@@@@@@@ @@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&&&.&& &'&&&&&&&&&&&.&& &'&&&&&&&&&&&&.&& &'&&&&&&&&&&&&.&& &'&&&&&&&&&&&&.&&  &'&&&&&&&&&&&.&& &'&&&&&&&&&&&.&&
.}
.fields
  сИтог          ИСумма ИТариф  ИМЦ10 ИМЦ20 ИОстальные ИОплата ИОстаток
.endfields

    Б@@@@@@@@@@@@@@@@@@@@@@                          &'&&&&&&&&&&&&&.&& &'&&&&&&&&&&&.&& &'&&&&&&&&&&&&.&& &'&&&&&&&&&&&&.&& &'&&&&&&&&&&&&.&&  &'&&&&&&&&&&&.&& &'&&&&&&&&&&&.&& Б
.}
.fields
  TotalGrpNDE-ИСумма
.endfields
 ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
    БОстаток                                         &'&&&&&&&&&&&&&.&& Б
 ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── Ш

.}
.endform
!
!
!
#doc
Карточка групп ДО в разрезе документов-оснований c учетом ставок НДС ( с учетной стоимостью )
#end
.linkform 'grschndc_02' prototype is 'grschndc'
.group 'Карточки групп ДО в разрезе документов-оcнований'
.NameInList 'Карточка групп ДО в разрезе документов-оснований c учетом ставок НДС ( с учетной стоимостью )'
.ORIENT LANDSCAPE
.var strTotalGrpNDE  : string .endvar
.fields
CommonFormHeader
.endfields
^
.{
.begin
  if ( abs( TotalGrpNDE ) > 0.0000001 )
    strTotalGrpNDE := 'Сумма по группе: ';
  else
    strTotalGrpNDE := '';
end.
.fields
Вид
strValNat
Группа
strTotalGrpNDE
TotalGrpNDE
doGetTune('NALOG.STAV2')
doGetTune('NALOG.STAV1')
.endfields
  БКарточка групп ДО в разрезе документов-оснований (  БCчета Б ^ ) Щ   В ( сформирована в ^ ) В
 ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 Группа:  Б ^  Б ^ &'&&&&&&&&&&&&&.&&
 ──────────┬─────────────┬────────────────────────┬──────────────────┬────────────────┬───────────────────────────────────┬───────────────────────────────────┬───────────────────────────────────┬─────────────────┬────────────────
  Дата     │ Номер счета │      Контрагент        │     Сумма        │   Стоимость    │              МЦ(&&%)              │               МЦ(&&%)             │              Остальные            │     Оплата      │   Остаток
           │             │                        │                  │     услуг      ├─────────────────┬─────────────────┼─────────────────┬─────────────────┼─────────────────┬─────────────────┤                 │
           │             │                        │                  │                │     Сумма       │Учетная стоимость│    Сумма        │Учетная стоимость│    Сумма        │Учетная стоимость│                 │
 ──────────┴─────────────┴────────────────────────┴──────────────────┴────────────────┴─────────────────┴─────────────────┴─────────────────┴─────────────────┴─────────────────┴─────────────────┴─────────────────┴────────────────
.{
.fields
Дата Номер_счета Контрагент Сумма Тариф  МЦ10 МЦ10_у МЦ20 МЦ20_у Остальные Остальные_у Оплата Остаток
.endfields
.{
 @@@@@@@@@@ @@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&&&.&& &'&&&&&&&&&&&.&& &'&&&&&&&&&&&&.&& &'&&&&&&&&&&&&.&& &'&&&&&&&&&&&&.&& &'&&&&&&&&&&&&.&& &'&&&&&&&&&&&&.&& &'&&&&&&&&&&&&.&&  &'&&&&&&&&&&&.&& &'&&&&&&&&&&&.&&
.}
.fields
  сИтог          ИСумма ИТариф  ИМЦ10 ИМЦ10_у ИМЦ20 ИМЦ20_у  ИОстальные ИОстальные_у ИОплата ИОстаток
.endfields

    Б@@@@@@@@@@@@@@@@@@@@@@                          &'&&&&&&&&&&&&&.&& &'&&&&&&&&&&&.&& &'&&&&&&&&&&&&.&& &'&&&&&&&&&&&&.&& &'&&&&&&&&&&&&.&& &'&&&&&&&&&&&&.&& &'&&&&&&&&&&&&.&& &'&&&&&&&&&&&&.&&  &'&&&&&&&&&&&.&& &'&&&&&&&&&&&.&& Б
.}
.fields
  TotalGrpNDE-ИСумма
.endfields
 ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   Б Остаток                                         &'&&&&&&&&&&&&&.&& Б
 ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── Ш
.}
.endform
!
!
!
#doc
Карточка групп ДО в разрезе договоров
#end
.linkform 'grschndc_03' prototype is 'grschndc'
.group 'Карточки групп ДО в разрезе договоров'
.NameInList 'Карточка групп ДО в разрезе договоров'
.var strTotalGrpNDE  : string .endvar
.fields CommonFormHeader .endfields
^
.{
.begin
  if ( abs( TotalGrpNDE ) > 0.0000001 )
    strTotalGrpNDE := 'Сумма по группе: ';
  else
    strTotalGrpNDE := '';
end.
.fields Группа strTotalGrpNDE TotalGrpNDE strValNat .endfields
  БКарточка групп ДО в разрезе договоров Б
 ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 Группа: Б ^ Б ^ &'&&&&&&&&&&&&&.&&
 ──────────┬──────────┬──────────┬───────────────────┬──────────────────┬─────────────────────┬───────────┬────────────
   Дата    │ Входящий │   Номер  │     Контрагент    │       Сумма      │    Срок действия    │   Статус  │Тип договора
 заключения│   номер  │          │                   │    в @@@@@@@@    ├──────────┬──────────┤  договора │по отношению
  договора │          │          │                   │                  │     c    │    по    │           │  к валюте
 ──────────┴──────────┴──────────┴───────────────────┴──────────────────┴──────────┴──────────┴───────────┴────────────
.{
.fields
!      9           10          А          11              Б           В        Г           Д
    Дата     Номер_счета   Внутр_Номер  Контрагент  Сумма        DateFrom      DateTo  Статус    ТипПоВалюте
.endfields
.{
 @@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&&&.&& @@@@@@@@@@ @@@@@@@@@@ @~@@@@@@@@@@ @~@@@@@@@@@
.}
.fields сИтог ИСумма .endfields
 Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                     &'&&&&&&&&&&&&&.&& Б
.}
.fields TotalGrpNDE-ИСумма .endfields
 ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 Б Остаток:                                             &'&&&&&&&&&&&&&.&& Б
 ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────

.}
.endform