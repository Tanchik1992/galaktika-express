!формирование спецификации с сортировкой по "номеру по порядку" (коме базисных цен)
.begin
  if (isBasePrice)
    EXIT;
  //заполнение полей
  Спец_НПП          := string(KolSpSopr.SpSopr.Npp);
  Спец_Поз_По_Смете := string(word(KolSpSopr.SpSopr.Netto));

  Спец_Название     := '';
  if (KolSpSopr.SpSOpr.PrMC = 1)
  {
    if KolSpSopr.GetFirst KatMc = tsOk
      Спец_Название := KolSpSopr.KatMc.Name
  }
  else
  {
    if KolSpSopr.GetFirst KatUsl = tsOk
      Спец_Название := KolSpSopr.KatUsl.Name
  }

  Спец_Номер_Расц   := string(word(KolSpSopr.SpSopr.MTara));

  Спец_Един_Изм     := '';
  if (KolSpSopr.SpSopr.cOtpEd = 0) 
  {
    if KolSpSopr.GetFirst KatEd = tsOk
      Спец_Един_Изм := KolSpSopr.KatEd.Name;
  }
  else
  {
    if KolSpSopr.GetFirst KatOtpEd = tsOk
      Спец_Един_Изм := KolSpSopr.KatOtpEd.Name;
  } 

  Спец_Колич        := KolSpSopr.SpSopr.KolOpl;

  //цена и стоимость
  var tPrice, tVPrice: double;

  tPrice := KolSpSopr.SpSopr.Price;
  
  if (KolSpSopr.KatSopr.VhodNal = 1)
    tPrice := tPrice - if (isNalogs, 0, KolSpSopr.SpSopr.SumNDS / KolSpSopr.SpSopr.KolOpl)
  else
    tPrice := tPrice + if (isNalogs, KolSpSopr.SpSopr.SumNDS / KolSpSopr.SpSopr.KolOpl, 0);
  
  tVPrice := KolSpSopr.SpSopr.VPrice;
  
  if (KatSopr.VhodNal = 1)
    tVPrice := tVPrice - if (isNalogs, 0, KolSpSopr.SpSopr.SumVNDS / KolSpSopr.SpSopr.KolOpl)
  else
    tVPrice := tVPrice + if (isNalogs, KolSpSopr.SpSopr.SumVNDS / KolSpSopr.SpSopr.KolOpl, 0);
  
  if (KolSpSopr.KatSopr.cVal = 0)
  {
    Спец_Цена    := tPrice;
    Спец_Стоим   := tPrice * KolSpSopr.SpSopr.KolOpl;
  }
  else
  {
    Спец_Цена    := tVPrice;
    Спец_Стоим   := tVPrice * KolSpSopr.SpSopr.KolOpl;
  }

  Спец_Цена_НДЕ  := tPrice;
  Спец_Цена_Вал  := tVPrice;
  Спец_Стоим_НДЕ := tPrice * KolSpSopr.SpSopr.KolOpl;
  Спец_Стоим_Вал := tVPrice * KolSpSopr.SpSopr.KolOpl;

  //позиционирование на сл. запись
  if KolSpSopr.GetNext SpSopr <> tsOk 
  {
    KolSpSopr.wPrMc := 1;//выводим матценности
    if KolSpSopr.GetFirst SpSopr = tsOk {}
  }

end.