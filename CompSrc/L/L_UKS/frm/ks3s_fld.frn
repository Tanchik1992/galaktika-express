.fields
!Шапка
  strHeader
  #OrgOnlyNoUNN (Инвестор)
  Инвестор_ОКПО
  #OrgOnlyNoUNN (Заказчик)
  Заказчик_ОКПО
  #OrgOnlyNoUNN (Подрядчик)
  Подрядчик_ОКПО
  Стройка + if(Стройка_Адрес <> '', ' Адрес: ' + Стройка_Адрес, '')
  Заказчик_ОКДП

  Договор_Номер
  if (Договор_Дата = Date(0, 0, 0), '', DateToStr(Договор_Дата, 'DD'))
  if (Договор_Дата = Date(0, 0, 0), '', DateToStr(Договор_Дата, 'MM'))
  if (Договор_Дата = Date(0, 0, 0), '', DateToStr(Договор_Дата, 'YYYY'))
  НакНомер if(НакДата = Date(0, 0, 0), '', DateToStr(НакДата,'DD.MM.YYYY'))
  if (ДатаНач = Date(0, 0, 0), '', DateToStr(ДатаНач, 'DD.MM.YYYY'))
  if (ДатаКон = Date(0, 0, 0), '', DateToStr(ДатаКон, 'DD.MM.YYYY'))

  Цена_Валюта

!Название работы
  StrNN  Цена_Валюта
  trim(РазделНазв + '. '+ РаботаНазв)

!новая страница
  StrNN  Цена_Валюта
!итого по странице
  DoubleToStr(Sum1Itog, Cena_Pr)
  DoubleToStr(Sum1ItogNDS, Cena_Pr)
  DoubleToStr(Sum1Itog + if (isNalogs, 0, Sum1ItogNal), Cena_Pr)
  DoubleToStr(Sum1Itog_Base, Cena_Pr)

!новая страница
  StrNN  Цена_Валюта

!спецификация документа
  iNpp Наименование  КодСмет2
  if (IsBasePrice, DoubleToStr(СтБМ0 + СтБМ1 + СтБМ2, Cena_Pr),
                   DoubleToStr(СтМ0  + СтМ1  + СтМ2,  Cena_Pr))
  if (IsBasePrice, DoubleToStr(СтБМ1 + СтБМ2, Cena_Pr),
                   DoubleToStr(СтМ1  + СтМ2,  Cena_Pr))
  if (IsBasePrice, DoubleToStr(СтБМ2, Cena_Pr),
                   DoubleToStr(СтМ2,  Cena_Pr))

!итого по странице
  DoubleToStr(Sum1Itog, Cena_Pr)
  DoubleToStr(Sum1ItogNDS, Cena_Pr)
  DoubleToStr(Sum1Itog + if (isNalogs, 0, Sum1ItogNal), Cena_Pr)
  DoubleToStr(Sum1Itog_Base, Cena_Pr)

!новая страница
  StrNN  Цена_Валюта
!итого по работе
  DoubleToStr(SumJob, Cena_Pr)       DoubleToStr(SumJobY, Cena_Pr)       DoubleToStr(SumJobP, Cena_Pr)
  РаботаНазв
  DoubleToStr(SumJob_Base, Cena_Pr)  DoubleToStr(SumJobY_Base, Cena_Pr)  DoubleToStr(SumJobP_Base, Cena_Pr)
!итого по странице
  DoubleToStr(Sum1Itog, Cena_Pr)
  DoubleToStr(Sum1ItogNDS, Cena_Pr)
  DoubleToStr(Sum1Itog + if (isNalogs, 0, Sum1ItogNal), Cena_Pr)
  DoubleToStr(Sum1Itog_Base, Cena_Pr)

!новая страница
  StrNN  Цена_Валюта
!Итого по налогам
  DoubleToStr(SumJob_NDS, Cena_Pr)  DoubleToStr(SumJobY_NDS, Cena_Pr)  DoubleToStr(SumJobP_NDS, Cena_Pr)
!Итого по работе (с налогами)
  РаботаНазв
  DoubleToStr(SumJob  + if (isNalogs, 0, SumJob_Nal),  Cena_Pr)
  DoubleToStr(SumJobY + if (isNalogs, 0, SumJobY_Nal), Cena_Pr)
  DoubleToStr(SumJobP + if (isNalogs, 0, SumJobP_Nal), Cena_Pr)
!итого по странице
  DoubleToStr(Sum1Itog, Cena_Pr)
  DoubleToStr(Sum1ItogNDS, Cena_Pr)
  DoubleToStr(Sum1Itog + if (isNalogs, 0, Sum1ItogNal), Cena_Pr)
  DoubleToStr(Sum1Itog_Base, Cena_Pr)

!итого по странице
  DoubleToStr(Sum1Itog, Cena_Pr)
  DoubleToStr(Sum1ItogNDS, Cena_Pr)
  DoubleToStr(Sum1Itog + if (isNalogs, 0, Sum1ItogNal), Cena_Pr)
  DoubleToStr(Sum1Itog_Base, Cena_Pr)

!итого по документу
  DoubleToStr(ItogJobP, Cena_Pr)
  DoubleToStr(ItogJobP_NDS, Cena_Pr)
  DoubleToStr(ItogJobP + if (isNalogs, 0, ItogJob_Nal), Cena_Pr)
  DoubleToStr(ItogJobP_Base, Cena_Pr)

  if (IsBasePrice, DoubleToStr(ItogJob_Base, Cena_Pr),  DoubleToStr(ItogJob, Cena_Pr))
  if (IsBasePrice, DoubleToStr(ItogJobY_Base, Cena_Pr), DoubleToStr(ItogJobY, Cena_Pr))
  if (IsBasePrice, DoubleToStr(ItogJobP_Base, Cena_Pr), DoubleToStr(ItogJobP, Cena_Pr))

  DoubleToStr(ItogJobP, Cena_Pr)
  DoubleToStr(ItogJobP_NDS, Cena_Pr)
  DoubleToStr(ItogJobP + if (isNalogs, 0, ItogJob_Nal), Cena_Pr)

.endfields
