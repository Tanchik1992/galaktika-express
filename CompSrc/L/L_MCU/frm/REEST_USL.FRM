/*
 ╔════════════════════════════════════════════════════════════════════════════╗
 ║                     (c) Корпорация ГАЛАКТИКА, 1996,97                      ║
 ║ Проект        : ГАЛАКТИКА                                                  ║
 ║ Система       :                                                            ║
 ║ Версия        :                                                            ║
 ║ Назначение    :                                                            ║
 ║ Ответственный :                                                            ║
 ╚════════════════════════════════════════════════════════════════════════════╝
*/
#doc
Карточка/реестр упоминаний услуг
#end
.Form 'Reestr_USL'
.NameInList 'базовая форма'
.Hide
.var
   nPP, nPP1 : longint;
   Kol1 : double;
   USLNameBarKod : string;
.endvar
.begin
 nPP1:=0
end.
.fields
  dDate1 : string
  dDate2 : string
.endfields
с ^ по ^
.{CheckEnter CicleUsl1 // цикл по услуге
.begin
 nPP1:=nPP1+1;
end.
.fields
  USLNRec : comp
  USLName : string
  USLBarKod : string
  EDNrec : comp
  EDName : string
.endfields
  ^^^^^
.begin
 nPP:=0;
 Kol1:=0;
 USLNameBarKod:=USLNAme+', бар-код '+USLBarKod
end.

.{CheckEnter CicleUsl2   // цикл по документам
.begin
 nPP:=nPP+1;
end.
.fields
  dDoc    : string
  NDoc    : string
  VidDoc  : string
  OrgNRec : comp
  OrgName : string
  OtpEDNRec : comp
  OtpEDName : string
  Kol     : double
  UchEdKol: double
  Sum     : double
.endfields

  ^^^^^^^^^^
.begin
 Kol1:=Kol1+UchEdKol;
end.

.} // по документам
.}
.endform
!
!
#doc
Карточка упоминаний услуг
#end
.linkform 'Reest_USL_01' prototype is 'Reestr_USL'
.NameInList 'Карточка упоминаний услуг'
.DEFO LANDSCAPE
.P 40
.{CheckEnter CicleUsl1
.fields
  CommonFormHeader
  dDate1
  dDate2
  USLNameBarKod
.endfields
 В^ В

 Г                                 Карточка упоминаний услуг
                          за период c @@@@@@@@@@ по @@@@@@@@@@ Г
 Б     @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
 Р─────┬──────────┬─────────┬────────────────────────────────┬──────────────────────────────┬──────────┬──────────────┬────────────────────────
  N  │   Дата   │  Номер  │               Вид              │          Контрагент,         │  Единица │  Количество  │      С у м м а
 п/п │ документа│документа│            документа           │         подразделение        │ измерения│              │
─────┼──────────┼─────────┼────────────────────────────────┼──────────────────────────────┼──────────┼──────────────┼──────────────────────── Р
.{CheckEnter CicleUsl2 //цикл по документам
.[H
 Р (1) │    (2)   │   (3)   │               (4)              │              (5)             │    (6)   │      (7)     │            (8)
─────┴──────────┴─────────┴────────────────────────────────┴──────────────────────────────┴──────────┴──────────────┴──────────────────────── Р
.]H
.fields
  Npp
  dDoc
  NDoc
  VidDoc
  OrgName
  OtpEDName
  Kol
  Sum
.endfields
 Р&~&&& @@@@@@@@@@  &~&&&&&& @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @~@@@@@@@@ &&&&&&&&&&.&&&  &#'&&&&&&&&&&&&&&&&&.&& Р
.[F
 Р───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── Р
.]F
.}
.fields
 'true' : 's'
.endfields
^
.}
.endform
!
!
#doc
Реестр упоминаний услуги
#end
.linkform 'Reest_USL_02' prototype is 'Reestr_USL'
.NameInList 'Реестр упоминаний услуги'
.fields
  CommonFormHeader
  dDate1
  dDate2
.endfields
.P 60
 В^ В
 Г
                    Реестр упоминаний услуги
                 c @@@@@@@@@@ по @@@@@@@@@@ Г
.{CheckEnter CicleUsl1 //цикл по улугам
.fields
  nPP1
  USLName
  USLBarkod
  EDName
  Kol1
.endfields
.[H OverWrite
                                                           Й@Np@ Й
 Р─────┬───────────────────────────────────────────────┬─────────────────┬───────────┬───────────────
N п/п│             Наименование услуги               │     Бар-код     │ Един.изм. │  Количество
─────┴───────────────────────────────────────────────┴─────────────────┴───────────┴─────────────── Р
.]H
.{CheckEnter CicleUsl2 //
.}
 Р&~&&& @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@ @~@@@@@@@@@ &&&&&&&&&&&.&&& Р
.}
.[F
 Р─────────────────────────────────────────────────────────────────────────────────────────────────── Р
.]F
.endform
