/*
 ╔════════════════════════════════════════════════════════════════════════════╗
 ║                     (c) Корпорация ГАЛАКТИКА, 1996,97                      ║
 ║ Проект        : ГАЛАКТИКА                                                  ║
 ║ Система       :                                                            ║
 ║ Версия        :                                                            ║
 ║ Назначение    :                                                            ║
 ║ Ответственный :                                                            ║
 ╚════════════════════════════════════════════════════════════════════════════╝
*/
#doc
Карточка/реестр упоминаний ТМЦ
#end
.Form 'Reestr_MC'
.NameInList 'базовая форма'
.Hide
.var
   nPP, nPP1 : longint;
   Kol1 : double;
   MCNameBarKod : string;
.endvar
.begin
 nPP1:=0
end.
.fields
  dDate1 : string
  dDate2 : string
.endfields
с ^ по ^
.{CheckEnter Cicle1 // цикл по ТМЦ
.begin
 nPP1:=nPP1+1;
end.
.fields
  MCNRec : comp
  MCName : string
  MCBarKod : string
  EDNrec : comp
  EDName : string
.endfields
  ^^^^^
.begin
 nPP:=0;
 Kol1:=0;
 MCNameBarKod:=MCNAme+', бар-код '+MCBarKod
end.

.{CheckEnter Cicle2   // цикл по документам
.begin
 nPP:=nPP+1;
end.
.fields
  dDoc    : string
  NDoc    : string
  VidDoc  : string
  OrgNRec : comp
  OrgName : string
  OtpEDNRec : comp
  OtpEDName : string
  Kol     : double
  UchEdKol: double
  Sum     : double
.endfields

  ^^^^^^^^^^
.begin
 Kol1:=Kol1+UchEdKol;
end.

.} // по документам
.}
.endform
!
!
#doc
Карточка упоминаний ТМЦ
#end
.linkform 'Reest_MC_01' prototype is 'Reestr_MC'
.NameInList 'Карточка упоминаний ТМЦ'
.DEFO LANDSCAPE
.P 40
.{CheckEnter Cicle1 // цикл по ТМЦ
.fields
  CommonFormHeader
  dDate1
  dDate2
  MCNameBarKod
.endfields
 В^ В

 Г                                 Карточка упоминаний ТМЦ
                          за период c @@@@@@@@@@ по @@@@@@@@@@ Г
 Б     @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
 Р─────┬──────────┬─────────┬────────────────────────────────┬──────────────────────────────┬──────────┬──────────────┬────────────────────────
  N  │   Дата   │  Номер  │               Вид              │          Контрагент,         │  Единица │  Количество  │      С у м м а
 п/п │ документа│документа│            документа           │         подразделение        │ измерения│              │
─────┼──────────┼─────────┼────────────────────────────────┼──────────────────────────────┼──────────┼──────────────┼──────────────────────── Р
.{CheckEnter Cicle2 //цикл по документам
.[H
 Р (1) │    (2)   │   (3)   │               (4)              │              (5)             │    (6)   │      (7)     │            (8)
─────┴──────────┴─────────┴────────────────────────────────┴──────────────────────────────┴──────────┴──────────────┴──────────────────────── Р
.]H
.fields
  Npp
  dDoc
  NDoc
  VidDoc
  OrgName
  OtpEDName
  Kol
  Sum
.endfields
 Р&~&&& @@@@@@@@@@  &~&&&&&& @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @~@@@@@@@@ &&&&&&&&&&.&&&  &#'&&&&&&&&&&&&&&&&&.&& Р
.[F
 Р───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── Р
.]F
.}
.fields
 'true' : 's'
.endfields
^
.}
.endform
!
!
#doc
Реестр упоминаний ТМЦ
#end
.linkform 'Reest_MC_02' prototype is 'Reestr_MC'
.NameInList 'Реестр упоминаний ТМЦ'
.fields
  CommonFormHeader
  dDate1
  dDate2
.endfields
.P 60
 В^ В
 Г
                    Реестр упоминаний ТМЦ
                 c @@@@@@@@@@ по @@@@@@@@@@ Г
.{CheckEnter Cicle1 //цикл по ТМЦ
.fields
  nPP1
  MCName
  MCBarkod
  EDName
  Kol1
.endfields
.[H OverWrite
                                                           Й@Np@ Й
 Р─────┬───────────────────────────────────────────────┬─────────────────┬───────────┬───────────────
N п/п│               Наименование ТМЦ                │     Бар-код     │ Един.изм. │  Количество
─────┴───────────────────────────────────────────────┴─────────────────┴───────────┴─────────────── Р
.]H
.{CheckEnter Cicle2 //
.}
 Р&~&&& @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@ @~@@@@@@@@@ &&&&&&&&&&&.&&& Р
.}
.[F
 Р─────────────────────────────────────────────────────────────────────────────────────────────────── Р
.]F
.endform
