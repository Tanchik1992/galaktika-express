! ╔═════════════════════════════════════════════════════════════════════════╗
! ║  Разработал:  Володько А.В. (Anatoly)                                   ║
! ║  Назначение:  Печать планов поставок / реализации                       ║
! ╚═════════════════════════════════════════════════════════════════════════╝
#doc
Печать планов поставок / реализации
#end
.Set Name = 'PrPlan'
.hide
.fields
  КакиеПланы:word       //-4  0-текущий 1-того же уровня
  КакиеПодпланы:word    //-3  0-сам 1-1уров. 2-1уров.+сам 3-все подпланы
  КакиеПериоды:word     //-2  0-не печатать 1-выбранн 2-0уров. 3-1уров+выб. 4-выб.и подпер 5-все пер.
  КакиеЭлементы:word    //-1  0-не печатать 1-печатать

  КодОснПлана:string                                   //1
  ИмяОснПлана:string                                   //2
  Алг0ОснПлана:string                                  //3
  Алг1ОснПлана:string                                  //4
  Алг2ОснПлана:string                                  //5
  Алг3ОснПлана:string                                  //6
  PrPlan_Alg:longint                                   //7
  PrPlan_cPar1                                         //8
  PrPlan_cPar2                                         //9
  PrPlan_cPar3                                         //10
  PrPlan_cPar4                                         //11
  PrPlan_lPar5:longint                                 //12

  КодПодПлана:string                                   //13
  ИмяПодПлана:string                                   //14
  Алг0ПодПлана:string                                  //15
  Алг1ПодПлана:string                                  //16
  Алг2ПодПлана:string                                  //17
  Алг3ПодПлана:string                                  //18
  PrPlan1_Alg:longint                                  //19
  PrPlan1_cPar1                                        //20
  PrPlan1_cPar2                                        //21
  PrPlan1_cPar3                                        //22
  PrPlan1_cPar4                                        //23
  PrPlan1_lPar5:longint                                //24

  КодПериода:string                                    //25
  ИмяПериода:string                                    //26
  НачалоПериода:date                                   //27
  КонецПериода:date                                    //28
  РассчитанПериода:date                                 //29
  ПлнКолПериода:Double                                 //30
  ПланСумВалПериода:Double                             //31
  ПланСумПериода:Double                                //32
  ФактКолПериода:Double                                //33
  ФактСумВалПериода:Double                             //34
  ФактСумПериода:Double                                //35
  ПроцПоКоличПериода:Double                            //36
  ПроцПоСумВалПериода:Double                           //37
  ПроцПоСумПериода:Double                              //38
  ПроцЛучшийПериода:Double                             //39
  НаимЕдПериода:string                                 //40
  НаимВалютыПериода:string                             //41
  АлгПериода:string                                    //42
  СостПериода:string                                   //42a
  PrSpPlan_Ready:word                                  //43
  PrSpPlan_Pr1:word                                    //44
  PrSpPlan_cEd                                         //45
  PrSpPlan_cVal                                        //46
  PrSpPlan_tProc:word                                  //47

  КодПодПер:string                                     //48
  ИмяПодПер:string                                     //49
  НачалоПодПер:date                                    //50
  КонецПодПер:date                                     //51
  РассчитанПодПер:date                                  //52
  ПланКолПодПер:Double                                 //53
  ПланСумВалПодПер:Double                              //54
  ПланСумПодПер:Double                                 //55
  ФактКолПодПер:Double                                 //56
  ФактСумВалПодПер:Double                              //57
  ФактСумПодПер:Double                                 //58
  ПроцПоКоличПодПер:Double                             //59
  ПроцПоСумВалПодПер:Double                            //60
  ПроцПоСумПодПер:Double                               //61
  ПроцЛучшийПодПер:Double                              //62
  НаимЕдПодПер:string                                  //63
  НаимВалютыПодПер:string                              //64
  АлгПодПер:string                                     //65
  СостПодПер:string                                    //65a
  PrSpPlan1_Ready:word                                 //66
  PrSpPlan1_Pr1:word                                   //67
  PrSpPlan1_cEd                                        //68
  PrSpPlan1_cVal                                       //69
  PrSpPlan1_tProc:word                                 //70

  НомерЭлем:word                                       //71
  ТУЭлем:string                                        //72
  ТоварУслугаЭлем:string                               //73
  НаимЭлем:string                                      //74
  ПланКолЭлем:Double                                   //75
  ПланСумВалЭлем:Double                                //76
  ПланСумЭлем:Double                                   //77
  ФактКолЭлем:Double                                   //78
  ФактСумВалЭлем:Double                                //79
  ФактСумЭлем:Double                                   //80
  ПроцПоКоличЭлем:Double                               //81
  ПроцПоСумВалЭлем:Double                              //82
  ПроцПоСумЭлем:Double                                 //83
  ПроцЛучшийЭлем:Double                                //84
  НаимОтпЕдЭлем:string                                 //85
  НаимВалютыЭлем:string                                //86
  PlanItem_Tip:word                                    //87
  PlanItem_cItem                                       //88
  PlanItem_cEd                                         //89
  PlanItem_cVal                                        //90
  PlanItem_tProc:word                                  //91

.endfields
^^^^
.{Plans
        Основной план(-ы)
123456789012    1-12
^^^^^^^^^^^^
.IF PechPodPlan
.{PodPlans
        Подпланы
(Все. Основной будет первым или последним или его не будет вообще)
(чтобы узнать достаточно сверить КодОснПлана=КодПодПлана)
345678901234    13-24
^^^^^^^^^^^^
.IF PechPeriod
        Выбранный период (или первый для всех)
56789012345678901234567    25-47 42a
^^^^^^^^^^^^^^^^^^^^^^^^
.{Periods
        Подпериоды/период
(все, выбранный будет первым или последним или его не будет вообще)
(чтобы узнать достаточно сверить КодПериода=КодПодПер)
89012345678901234567890    48-70 65a
^^^^^^^^^^^^^^^^^^^^^^^^
.IF PechItems
.{Items
        Элементы
123456789012345678901     71-91
^^^^^^^^^^^^^^^^^^^^^
.}
        Итого по элементам:
.ELSE
        Если элементы не печатаются или их нет.
.END
.}
        Итого по подпериодам:
.ELSE
        Если подпериоды не печатаются или их нет.
.END
.}
        Итого по подпланам:
.ELSE
        Если подпланы не печатаются или их нет.
.END
.}
.endform

!*******************************************************************************

#doc
Печать планов поставок / реализации
По количеству
#end
.linkform 'PrPlan01' prototype is 'PrPlan'
.nameinlist 'По количеству.'
.fields
  CommonFormHeader

  ИмяПодПлана

  ИмяПодПер
  НачалоПодПер
  КонецПодПер
  РассчитанПодПер

  НаимЭлем
  НаимОтпЕдЭлем
  ПланКолЭлем
  ФактКолЭлем
  ПроцПоКоличЭлем

  IF(word(КакиеЭлементы)=0,'','Элементов нет.')

  IF(Word(КакиеПериоды)=0,'','Периодов/подпериодов нет.')

.endfields
 ^
.{Plans
                              ОТЧЕТ ПО ПЛАНУ

.IF PechPodPlan
.{PodPlans
        @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.IF PechPeriod
.{Periods
    за период: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    с ^ по ^ (рассчитан до ^)

.IF PechItems
┌───────────────────────────┬────────┬──────────────┬──────────────┬─────────┐
│Наименование МЦ/Услуги     │Единица │ Запланировано│    Фактически│% Выполн.│
├───────────────────────────┼────────┼──────────────┼──────────────┼─────────┤
.{Items
│@@@@@@@@@@@@@@@@@@@@@@@@@@@│@~@@@@@@│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&.&& %│
.}
└───────────────────────────┴────────┴──────────────┴──────────────┴─────────┘

.ELSE
  ^

.END
.}
.ELSE
  ^

.END

.}
.ELSE
  Подпланов нет.

.END

.}

.endform

!*******************************************************************************

#doc
Печать планов поставок / реализации
По количеству без нулевых строк
#end
.linkform 'PrPlan01a' prototype is 'PrPlan'
.nameinlist 'По количеству без нулевых строк.'
.fields
  CommonFormHeader

  ИмяПодПлана

  ИмяПодПер
  НачалоПодПер
  КонецПодПер
  РассчитанПодПер

  НаимЭлем
  НаимОтпЕдЭлем
  ПланКолЭлем
  ФактКолЭлем
  ПроцПоКоличЭлем

  IF(word(КакиеЭлементы)=0,'','Элементов нет.')

  IF(Word(КакиеПериоды)=0,'','Периодов/подпериодов нет.')

.endfields
 ^
.{Plans
                              ОТЧЕТ ПО ПЛАНУ

.IF PechPodPlan
.{PodPlans
        @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.IF PechPeriod
.{Periods
    за период: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    с ^ по ^ (рассчитан до ^)

.IF PechItems
┌───────────────────────────┬────────┬──────────────┬──────────────┬─────────┐
│Наименование МЦ/Услуги     │Единица │ Запланировано│    Фактически│% Выполн.│
├───────────────────────────┼────────┼──────────────┼──────────────┼─────────┤
.{Items;((ПланКолЭлем<>0.0)OR(ФактКолЭлем<>0.0))
│@@@@@@@@@@@@@@@@@@@@@@@@@@@│@~@@@@@@│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&.&& %│
.}
└───────────────────────────┴────────┴──────────────┴──────────────┴─────────┘

.ELSE
  ^

.END
.}
.ELSE
  ^

.END

.}
.ELSE
  Подпланов нет.

.END

.}

.endform

!*******************************************************************************

#doc
Печать планов поставок / реализации
Фактическое количество без нулевых строк
#end
.linkform 'PrPlan01b' prototype is 'PrPlan'
.nameinlist 'Фактическое количество без нулевых строк.'
.fields
  CommonFormHeader

  ИмяПодПлана

  ИмяПодПер
  НачалоПодПер
  КонецПодПер
  РассчитанПодПер

  НомерЭлем
  НаимЭлем
  НаимОтпЕдЭлем
  ФактКолЭлем

  IF(word(КакиеЭлементы)=0,'','Элементов нет.')

  IF(Word(КакиеПериоды)=0,'','Периодов/подпериодов нет.')

.endfields
 ^
.{Plans

.IF PechPodPlan
.{PodPlans
        @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.IF PechPeriod
.{Periods
    за период: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    с ^ по ^ (рассчитан до ^)

.IF PechItems
┌────┬──────────────────────────────────────────┬──────────┬─────────────────┐
│  N │Наименование МЦ/Услуги                    │  Единица │ Факт.количество │
├────┼──────────────────────────────────────────┼──────────┼─────────────────┤
.{Items;(ФактКолЭлем<>0)
│&&& │@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@~@@@@@@@@│&&&&&&&&&&&&.&&&&│
.}
└────┴──────────────────────────────────────────┴──────────┴─────────────────┘

.ELSE
  ^

.END
.}
.ELSE
  ^

.END

.}
.ELSE
  Подпланов нет.

.END

.}

.endform

!*******************************************************************************

#doc
Печать планов поставок / реализации
По сумме в валюте
#end
.linkform 'PrPlan02' prototype is 'PrPlan'
.nameinlist 'По сумме в валюте.'
.fields
  CommonFormHeader

  ИмяПодПлана

  ИмяПодПер
  НачалоПодПер
  КонецПодПер
  РассчитанПодПер

  НаимЭлем
  НаимВалютыЭлем
  ПланСумВалЭлем
  ФактСумВалЭлем
  ПроцПоСумВалЭлем

  НаимВалютыПодПер
  ПланСумВалПодПер
  ФактСумВалПодПер
  ПроцПоСумВалПодПер

  IF(word(КакиеЭлементы)=0,'','Элементов нет.')

  IF(Word(КакиеПериоды)=0,'','Периодов/подпериодов нет.')

.endfields
 ^
.{Plans
                              ОТЧЕТ ПО ПЛАНУ

.IF PechPodPlan
.{PodPlans
        @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.IF PechPeriod
.{Periods
    за период: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    с ^ по ^ (рассчитан до ^)

.IF PechItems
┌───────────────────────────┬────────┬──────────────┬──────────────┬─────────┐
│Наименование МЦ/Услуги     │ Валюта │ Запланировано│    Фактически│% Выполн.│
├───────────────────────────┼────────┼──────────────┼──────────────┼─────────┤
.{Items
│@@@@@@@@@@@@@@@@@@@@@@@@@@@│@~@@@@@@│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&.&& %│
.}
├───────────────────────────┼────────┼──────────────┼──────────────┼─────────┤
│ Итого:                    │@~@@@@@@│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&.&& %│
└───────────────────────────┴────────┴──────────────┴──────────────┴─────────┘

.ELSE
  ^

.END
.}
.ELSE
  ^

.END

.}
.ELSE
  Подпланов нет.

.END

.}

.endform

!*******************************************************************************

#doc
Печать планов поставок / реализации
По сумме в валюте без нулевых строк
#end
.linkform 'PrPlan02a' prototype is 'PrPlan'
.nameinlist 'По сумме в валюте без нулевых строк.'
.fields
  CommonFormHeader

  ИмяПодПлана

  ИмяПодПер
  НачалоПодПер
  КонецПодПер
  РассчитанПодПер

  НаимЭлем
  НаимВалютыЭлем
  ПланСумВалЭлем
  ФактСумВалЭлем
  ПроцПоСумВалЭлем

  НаимВалютыПодПер
  ПланСумВалПодПер
  ФактСумВалПодПер
  ПроцПоСумВалПодПер

  IF(word(КакиеЭлементы)=0,'','Элементов нет.')

  IF(Word(КакиеПериоды)=0,'','Периодов/подпериодов нет.')

.endfields
 ^
.{Plans
                              ОТЧЕТ ПО ПЛАНУ

.IF PechPodPlan
.{PodPlans
        @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.IF PechPeriod
.{Periods
    за период: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    с ^ по ^ (рассчитан до ^)

.IF PechItems
┌───────────────────────────┬────────┬──────────────┬──────────────┬─────────┐
│Наименование МЦ/Услуги     │ Валюта │ Запланировано│    Фактически│% Выполн.│
├───────────────────────────┼────────┼──────────────┼──────────────┼─────────┤
.{Items;((ПланСумВалЭлем<>0)OR(ФактСумВалЭлем<>0))
│@@@@@@@@@@@@@@@@@@@@@@@@@@@│@~@@@@@@│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&.&& %│
.}
├───────────────────────────┼────────┼──────────────┼──────────────┼─────────┤
│ Итого:                    │@~@@@@@@│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&.&& %│
└───────────────────────────┴────────┴──────────────┴──────────────┴─────────┘

.ELSE
  ^

.END
.}
.ELSE
  ^

.END

.}
.ELSE
  Подпланов нет.

.END

.}

.endform

!*******************************************************************************

#doc
Печать планов поставок / реализации
Фактические суммы в валюте без нулевых строк
#end
.linkform 'PrPlan02b' prototype is 'PrPlan'
.nameinlist 'Фактические суммы в валюте без нулевых строк.'
.fields
  CommonFormHeader

  ИмяПодПлана

  ИмяПодПер
  НачалоПодПер
  КонецПодПер
  РассчитанПодПер

  НомерЭлем
  НаимЭлем
  НаимВалютыЭлем
  ФактСумВалЭлем

  НаимВалютыПодПер
  ФактСумВалПодПер

  IF(word(КакиеЭлементы)=0,'','Элементов нет.')

  IF(Word(КакиеПериоды)=0,'','Периодов/подпериодов нет.')

.endfields
 ^
.{Plans

.IF PechPodPlan
.{PodPlans
        @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.IF PechPeriod
.{Periods
    за период: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    с ^ по ^ (рассчитан до ^)

.IF PechItems
┌────┬─────────────────────────────────────────────┬─────────┬───────────────┐
│  N │Наименование МЦ/Услуги                       │  Валюта │   Фактически  │
├────┼─────────────────────────────────────────────┼─────────┼───────────────┤
.{Items;(ФактСумВалЭлем<>0)
│&&& │@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@~@@@@@@@│&&&&&&&&&&&&.&&│
.}
├────┴─────────────────────────────────────────────┼─────────┼───────────────┤
│     Итого:                                       │@~@@@@@@@│&&&&&&&&&&&&.&&│
└──────────────────────────────────────────────────┴─────────┴───────────────┘

.ELSE
  ^

.END
.}
.ELSE
  ^

.END

.}
.ELSE
  Подпланов нет.

.END

.}

.endform

!*******************************************************************************
#doc
Печать планов поставок / реализации
По сумме
#end
.linkform 'PrPlan03' prototype is 'PrPlan'
.nameinlist 'По сумме.'
.fields
  CommonFormHeader

  ИмяПодПлана

  ИмяПодПер
  НачалоПодПер
  КонецПодПер
  РассчитанПодПер

  НомерЭлем
  НаимЭлем
  ПланСумЭлем
  ФактСумЭлем
  ПроцПоСумЭлем

  ПланСумПодПер
  ФактСумПодПер
  ПроцПоСумПодПер

  IF(word(КакиеЭлементы)=0,'','Элементов нет.')

  IF(Word(КакиеПериоды)=0,'','Периодов/подпериодов нет.')

.endfields
 ^
.{Plans
                              ОТЧЕТ ПО ПЛАНУ

.IF PechPodPlan
.{PodPlans
        @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.IF PechPeriod
.{Periods
    за период: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    с ^ по ^ (рассчитан до ^)

.IF PechItems
┌────┬───────────────────────────┬────────────────┬────────────────┬─────────┐
│  N │Наименование МЦ/Услуги     │ Запланировано  │   Фактически   │% Выполн.│
├────┼───────────────────────────┼────────────────┼────────────────┼─────────┤
.{Items
│&&& │@@@@@@@@@@@@@@@@@@@@@@@@@@@│&&&&&&&&&&&&&.&&│&&&&&&&&&&&&&.&&│&&&&.&& %│
.}
├────┴───────────────────────────┼────────────────┼────────────────┼─────────┤
│     Итого:                     │&&&&&&&&&&&&&.&&│&&&&&&&&&&&&&.&&│&&&&.&& %│
└────────────────────────────────┴────────────────┴────────────────┴─────────┘

.ELSE
  ^

.END
.}
.ELSE
  ^

.END

.}
.ELSE
  Подпланов нет.

.END

.}

.endform

!*******************************************************************************
#doc
Печать планов поставок / реализации
По сумме без нулевых строк
#end
.linkform 'PrPlan03a' prototype is 'PrPlan'
.nameinlist 'По сумме без нулевых строк.'
.fields
  CommonFormHeader

  ИмяПодПлана

  ИмяПодПер
  НачалоПодПер
  КонецПодПер
  РассчитанПодПер

  НомерЭлем
  НаимЭлем
  ПланСумЭлем
  ФактСумЭлем
  ПроцПоСумЭлем

  ПланСумПодПер
  ФактСумПодПер
  ПроцПоСумПодПер

  IF(word(КакиеЭлементы)=0,'','Элементов нет.')

  IF(Word(КакиеПериоды)=0,'','Периодов/подпериодов нет.')

.endfields
 ^
.{Plans
                              ОТЧЕТ ПО ПЛАНУ

.IF PechPodPlan
.{PodPlans
        @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.IF PechPeriod
.{Periods
    за период: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    с ^ по ^ (рассчитан до ^)

.IF PechItems
┌────┬───────────────────────────┬────────────────┬────────────────┬─────────┐
│  N │Наименование МЦ/Услуги     │  Запланировано │   Фактически   │% Выполн.│
├────┼───────────────────────────┼────────────────┼────────────────┼─────────┤
.{Items;((ПланСумЭлем<>0)OR(ФактСумЭлем<>0))
│&&& │@@@@@@@@@@@@@@@@@@@@@@@@@@@│&&&&&&&&&&&&&.&&│&&&&&&&&&&&&&.&&│&&&&.&& %│
.}
├────┴───────────────────────────┼────────────────┼────────────────┼─────────┤
│     Итого:                     │&&&&&&&&&&&&&.&&│&&&&&&&&&&&&&.&&│&&&&.&& %│
└────────────────────────────────┴────────────────┴────────────────┴─────────┘

.ELSE
  ^

.END
.}
.ELSE
  ^

.END

.}
.ELSE
  Подпланов нет.

.END

.}

.endform

!*******************************************************************************
#doc
Печать планов поставок / реализации
Фактические суммы без нулевых строк
#end
.linkform 'PrPlan03b' prototype is 'PrPlan'
.nameinlist 'Фактические суммы без нулевых строк.'
.fields
  CommonFormHeader

  ИмяПодПлана

  ИмяПодПер
  НачалоПодПер
  КонецПодПер
  РассчитанПодПер

  НомерЭлем
  НаимЭлем
  ФактСумЭлем

  ФактСумПодПер

  IF(word(КакиеЭлементы)=0,'','Элементов нет.')

  IF(Word(КакиеПериоды)=0,'','Периодов/подпериодов нет.')

.endfields
 ^
.{Plans

.IF PechPodPlan
.{PodPlans
        @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.IF PechPeriod
.{Periods
    за период: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    с ^ по ^ (рассчитан до ^)

.IF PechItems
┌────┬─────────────────────────────────────────────────┬─────────────────────┐
│  N │Наименование МЦ/Услуги                           │       Фактически    │
├────┼─────────────────────────────────────────────────┼─────────────────────┤
.{Items;(ФактСумЭлем<>0)
│&&& │@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│&&&&&&&&&&&&&&&&&.&& │
.}
├────┴─────────────────────────────────────────────────┼─────────────────────┤
│     Итого:                                           │&&&&&&&&&&&&&&&&&.&& │
└──────────────────────────────────────────────────────┴─────────────────────┘

.ELSE
  ^

.END
.}
.ELSE
  ^

.END

.}
.ELSE
  Подпланов нет.

.END

.}

.endform

!*******************************************************************************

#doc
Печать планов поставок / реализации
по количеству c алгоритмом
#end
.linkform 'PrPlan04' prototype is 'PrPlan'
.nameinlist 'по количеству c алгоритмом'
.fields
  CommonFormHeader

  ИмяПодПлана

  ИмяПодПер
  НачалоПодПер
  КонецПодПер
  РассчитанПодПер

  Алг0ПодПлана
  Алг1ПодПлана
  Алг2ПодПлана

  АлгПодПер

  НаимЭлем
  НаимОтпЕдЭлем
  ПланКолЭлем
  ФактКолЭлем
  ПроцПоКоличЭлем

  IF(word(КакиеЭлементы)=0,'','Элементов нет.')

  Алг0ПодПлана
  Алг1ПодПлана
  Алг2ПодПлана

  IF(Word(КакиеПериоды)=0,'','Периодов/подпериодов нет.')

.endfields
 ^
.{Plans
                              ОТЧЕТ ПО ПЛАНУ

.IF PechPodPlan
.{PodPlans
        @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.IF PechPeriod
.{Periods
    за период: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    с ^ по ^ (рассчитан до ^)
 Алгоритм плана:
  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 Период рассчитан @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

.IF PechItems
┌───────────────────────────┬────────┬──────────────┬──────────────┬─────────┐
│Наименование МЦ/Услуги     │Единица │ Запланировано│   Фактически │% Выполн.│
├───────────────────────────┼────────┼──────────────┼──────────────┼─────────┤
.{Items
│@@@@@@@@@@@@@@@@@@@@@@@@@@@│@~@@@@@@│&&&&&&&&&&&.&&│&&&&&&&&&&&.&&│&&&&.&& %│
.}
└───────────────────────────┴────────┴──────────────┴──────────────┴─────────┘

.ELSE
  ^

.END
.}
.ELSE
 Алгоритм плана:
  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  ^

.END

.}
.ELSE
  Подпланов нет.

.END

.}

.endform

!*******************************************************************************

#doc
Печать планов поставок / реализации
полная информация о плане(-ах)
#end
.linkform 'PrPlan05' prototype is 'PrPlan'
.nameinlist 'полная информация о плане(-ах)'
.fields
  CommonFormHeader

  ИмяОснПлана
  КодОснПлана
  Алг0ОснПлана
  Алг1ОснПлана
  Алг2ОснПлана

  ИмяПодПлана
  КодПодПлана
  Алг0ПодПлана
  Алг1ПодПлана
  Алг2ПодПлана

  ИмяПериода
  НачалоПериода
  КонецПериода
  РассчитанПериода
  АлгПериода
  СостПериода

  ИмяПодПер
  НачалоПодПер
  КонецПодПер
  РассчитанПодПер
  АлгПодПер
  СостПодПер

  НомерЭлем
  НаимЭлем
  ПроцЛучшийЭлем

  IF(word(КакиеЭлементы)=0,'','Элементов нет.')

  IF(Word(КакиеПериоды)=0,'','Периодов/подпериодов нет.')

.endfields
 ^
.{Plans

                              ОТЧЕТ ПО ПЛАНУ
        @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

 Код плана: @@@@@@@@@@@@@@@@@@@@@@@@@@@@
 Алгоритм плана:
  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.IF PechPodPlan
.{PodPlans

Подплан: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
Код подплана: @@@@@@@@@@@@@@@@@@@@@@@@@@@
Алгоритм подплана:
  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.IF PechPeriod

Выбран период: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
C ^ по ^ (рассчитан до ^ ^)
Состояние: ^
.{Periods

Подпериод: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
C ^ по ^ (рассчитан до ^ ^)
Состояние: ^
.IF PechItems

┌────┬─────────────────────────────────────────────────────────────┬─────────┐
│  N │Наименование МЦ/Услуги                                       │% Выполн.│
├────┼─────────────────────────────────────────────────────────────┼─────────┤
.{Items
│&&& │@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│&&&&.&& %│
.}
└────┴─────────────────────────────────────────────────────────────┴─────────┘

.ELSE
  ^
.END
.}
.ELSE
  ^
.END

.}
.ELSE
  Подпланов нет.

.END

.}

.endform

!*******************************************************************************
