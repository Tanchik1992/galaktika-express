/*
 ╔═══════════════════════════════════════════════════════════════════════════╗
 ║                     (c) 1994,97 корпорация ГАЛАКТИКА                      ║
 ║ Проект        : ГАЛАКТИКА                                                 ║
 ║ Система       : Оперативный Контур                                        ║
 ║ Версия        : 5.00                                                      ║
 ║ Назначение    : Ведомость наличия товара по предприятию                   ║
 ║ Ответственный : Бартош Евгений Анатольевич                                ║
 ╚═══════════════════════════════════════════════════════════════════════════╝
*/

#doc
Ведомость наличия товара по предприятию
#end
.set name='nal_all'
.hide
.var
  TNPv:string;
  TGPv:string;
  VNTarv:string;
  VNBasev:string;
  VNPrv:string;
.endvar
.fields
  // procedure MyInit
  dDate : date  // Дата
  FilterInfo
  TNP     // служебное
  TGP     // служебное
  VNTar   // Наименование вал. для отчетов
  VNBase  // Наименование базовой валюты
  VNPr    // наименование валюты прайс-листа

  // function HandleOneMC
  nRecMC: comp // nRec МЦ
  NameMC  // Наименование товара
  CodeMC  // Бар-код товара
  NameEd  // Учетная ед. измерения
  Podr    // Наименование подразделения
  Mol     // Наименование МОЛ
  nRecParty : comp
  Party   // Наименование партии
  nRecDogovor NDogovor NDogovor_Ext
  DDogovor DInput
  Kol:double     // Количество
  Price1:double  // Цена
  Price2:double  // Цена в валюте
  ValMC   // Валюта учета товара
  Summa1:double  // Сумма
  Summa2:double  // Сумма в валюте
  PriceLS:double  // Цена по прайс-листу
  PriceLSV:double // Цена по прайс-листу в валюте
  SummaLS:double  // Сумма по прайс-листу
  SummaLSV:double // Сумма по прайс-листу в валюте
  Reserve:double  // Резерв товара
  Massa:double    // Масса товара
  Volume:double   // Объем товара
  SizeX:double    // Габариты по ширине
  SizeY:double    // Габариты по длине
  SizeZ:double    // Габариты по высоте

  skipped  // служебное

  Itogo1:double   // Итого по учетным ценам в валюте отчетов
  Itogo2:double   // Итого по учетным ценам в баз.вал.
  ValItogo:double // Валюта итоговой суммы
  ItogoPr:double  // Итого по продажным ценам в валюте отчетов
  ItogoPrV:double // Итого по продажным ценам в баз.вал.
.endfields
Дата : ^
.{
  ^
.}
 ^
 ^
валюта для отчетов : ^
базовая валюта : ^
валюта прайс-листа : ^

.{
.begin
  TNPv    := TNP;
  TGPv    := TGP;
  VNTarV  := VNTar;
  VNBaseV := VNBase;
  VNPrV   := VNPr;
 end.

.{ CheckEnter
nRec товара ^
наименование товара : ^
код товара : ^
учетная единица измерения : ^
Наименование подразделения : ^
Наименование МОЛ : ^
nRecParty : ^
Наименование партии : ^
Договор : ^ ^ ^ ^ ^
Количество : ^
Цена : ^
Цена в валюте : ^
Валюта учета МЦ : ^
Сумма : ^
Сумма в валюте : ^
Цена по прайс-листу : ^
Цена по прайс-листу в валюте : ^
Сумма по прайс-листу : ^
Сумма по прайс-листу в валюте : ^
Резерв товара : ^
Масса товара : ^
Объем товара : ^
Габариты X : ^
Габариты Y : ^
Габариты Z : ^
.}

служебное поле : ^
.}

Итого по учетным ценам в валюте отчетов   : ^
Итого по учетным ценам в баз.вал.         : ^
Валюта итоговой суммы                     : ^
Итого по продажным ценам в валюте отчетов : ^
Итого по продажным ценам в баз.вал.       : ^
.endform


#doc
ВЕДОМОСТЬ НАЛИЧИЯ (ЦЕНЫ В НАЦ. И БАЗ. ВАЛЮТЕ)
#end
.linkform 'nal_all_nde_val' prototype is 'nal_all'
.nameinlist 'ВЕДОМОСТЬ НАЛИЧИЯ (ЦЕНЫ В НАЦ. И БАЗ. ВАЛЮТЕ)'
.group '011'
.p 60
.fields
  CommonFormHeader
  DateToStr(dDate,'DD mon YYYY')
  FilterInfo
  TNPv TGPv
  VNTarv VNBasev
  VNTarv VNBasev
  NameMC
  CodeMC
  NameEd
  Kol
  Price1
  Price2
  ValMC
  Summa1
  Summa2
  ValMC
  Itogo1
  Itogo2
  //ValItogo
.endfields
^
 Й                     В Е Д О М О С Т Ь   Н А Л И Ч И Я   Т О В А Р А
                      по предприятию на ^г. Й

 Ш
Фильтры
.{
  ^
.}
.{
.[h OverWrite

──────────────────────────────────────┬───────────────┬──────────┬────────────┬────────────────────────────────┬────────────────────────────────────
        Наименование товара           │Номенклатурный │  Единица │ Количество │        Учетная цена            │   Стоимость в учетных ценах
                                      │    номер      │ измерения│            ├──────────────┬─────────────────┼────────────────┬───────────────────
       @@@@@@@@@@@@@@@@@@@@@@@        │@@@@@@@@@@@@@@@│          │            │в @@@@@@@@@@@@│ в @@@@@@@@@@@@  │в @@@@@@@@@@@@@@│ в @@@@@@@@@@@@@@
──────────────────────────────────────┴───────────────┴──────────┴────────────┴──────────────┴─────────────────┴────────────────┴───────────────────
.]h
.{ CheckEnter
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@ @@@@@@@@@@ &'&&&&&&&&&& &'&&&&&&&&&&&& &'&&&&&&&&&&& @@@ &'&&&&&&&&&&&&&& &'&&&&&&&&&&&&& @@@
.}
.}


 Б                ИТОГО ПО ПРЕДПРИЯТИЮ                                                                &'&&&&&&&&&&&&&&&&&&&&  &'&&&&&&&&&&&&&&&&&& Щ
 А
 А
.endform

#doc
ВЕДОМОСТЬ НАЛИЧИЯ (ЦЕНЫ В НАЦ. ВАЛЮТЕ)
#end
.linkform 'nal_all_nde' prototype is 'nal_all'
.nameinlist 'ВЕДОМОСТЬ НАЛИЧИЯ (ЦЕНЫ В НАЦ. ВАЛЮТЕ)'
.p 60
.group '010'
.fields
  CommonFormHeader
 А  DateToStr(dDate,'DD mon YYYY') А
  FilterInfo

  TNPv TGPv

  NameMC
  CodeMC
  NameEd
  Kol
  Price1
  Summa1

  skipped

  Itogo1
.endfields
^
 Й                     В Е Д О М О С Т Ь   Н А Л И Ч И Я   Т О В А Р А
                      по предприятию на ^г. Й

 Р
Фильтры
.{
  ^
.}
.{
.[h OverWrite

──────────────────────────────────────┬───────────────┬──────────┬────────────┬──────────────┬────────────────
        Наименование товара           │  Ном. номер   │  Единица │ Количество │ Учетная цена │   Стоимость
       @@@@@@@@@@@@@@@@@@@@@@@@       │@@@@@@@@@@@@@@@│ измерения│            │              │в учетных ценах
──────────────────────────────────────┴───────────────┴──────────┴────────────┴──────────────┴────────────────
.]h
.{ CheckEnter
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@ @@@@@@@@@@ &'#&&&&&&&&& &'#&&&&&&&&&&& &'#&&&&&&&&&&&&&
.}
 ^
.}

 Б                ИТОГО ПО ПРЕДПРИЯТИЮ                                                    &'#&&&&&&&&&&&&&&&&&&& С
 А
.endform


#doc
ВЕДОМОСТЬ НАЛИЧИЯ ЦЕНЫ В НАЦ. И БАЗ. ВАЛЮТЕ
#end
.linkform 'nal_all_spec_nde_val' prototype is 'nal_all'
.nameinlist 'ВЕДОМОСТЬ НАЛИЧИЯ ЦЕНЫ В НАЦ. И БАЗ. ВАЛЮТЕ'
.group '001'
.p 60
.fields
  CommonFormHeader
 А  DateToStr(dDate,'DD mon YYYY') А
  FilterInfo

  VNTarv VNBasev
  VNTarv VNBasev

  NameMC  CodeMC  NameEd
  Podr  Mol  Party
  Kol  Price1  Price2  ValMC Summa1  Summa2 ValMC
  Itogo1 Itogo2 //ValItogo
.endfields
^
 Й                     В Е Д О М О С Т Ь   Н А Л И Ч И Я   Т О В А Р А
                      по предприятию на ^г. Й

 Ш
Фильтры
.{
  ^
.}
.{
.[h OverWrite

──────────────────────────────────────┬───────────────┬─────────┬───────────────┬───────────────┬───────────────┬────────────┬────────────────────────────────┬────────────────────────────────────
        Наименование товара           │Номенклатурный │ Единица │ Подразделение │      МОЛ      │    Партия     │ Количество │        Учетная цена            │   Стоимость в учетных ценах
                                      │    номер      │измерения│               │               │               │            ├──────────────┬─────────────────┼────────────────┬───────────────────
                                      │               │         │               │               │               │            │в @@@@@@@@@@@@│ в @@@@@@@@@@@@  │в @@@@@@@@@@@@@@│ в @@@@@@@@@@@@@@
──────────────────────────────────────┴───────────────┴─────────┴───────────────┴───────────────┴───────────────┴────────────┴──────────────┴─────────────────┴────────────────┴───────────────────
.]h
.{ CheckEnter
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@ @@@@@@@@@ @@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@ &'#&&&&&&&&& &'&&&&&&&&&&&& &'&&&&&&&&&&& @@@ &'&&&&&&&&&&&&&& &'&&&&&&&&&&&&& @@@
.}
.}


 Б               ИТОГО ПО ПРЕДПРИЯТИЮ                                                                                                                &'&&&&&&&&&&&&&&&&&&&&  &'&&&&&&&&&&&&&&&&&& Щ
 А
 А
.endform

#doc
ВЕДОМОСТЬ НАЛИЧИЯ ЦЕНЫ В НАЦ. ВАЛЮТЕ
#end
.linkform 'nal_all_spec_nde' prototype is 'nal_all'
.nameinlist 'ВЕДОМОСТЬ НАЛИЧИЯ ЦЕНЫ В НАЦ. ВАЛЮТЕ'
.p 60
.group '000'
.fields
  CommonFormHeader
  DateToStr(dDate,'DD mon YYYY')
  FilterInfo

  NameMC CodeMC NameEd
  Podr Mol Party
  Kol Price1 Summa1

  skipped

  Itogo1
.endfields
^
 Й                     В Е Д О М О С Т Ь   Н А Л И Ч И Я   Т О В А Р А
                      по предприятию на ^г. Й

 Ш
Фильтры
.{
  ^
.}
.{
.[h OverWrite

──────────────────────────────────────┬───────────────┬─────────┬───────────────┬───────────────┬───────────────┬─────────────┬──────────────┬────────────────
        Наименование товара           │Номенклатурный │ Единица │ Подразделение │      МОЛ      │     Партия    │  Количество │ Учетная цена │   Стоимость
                                      │    номер      │измерения│               │               │               │             │              │в учетных ценах
──────────────────────────────────────┴───────────────┴─────────┴───────────────┴───────────────┴───────────────┴─────────────┴──────────────┴────────────────
.]h
.{ CheckEnter
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@ @@@@@@@@@ @@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@ &'&&&&&&&&&&& &'&&&&&&&&&&&& &'&&&&&&&&&&&&&&
.}
 ^
.}

 Б                ИТОГО ПО ПРЕДПРИЯТИЮ                                                                                                    &'&&&&&&&&&&&&&&&&&&&& Щ
 А
 А
.endform

#doc
ВЕДОМОСТЬ НАЛИЧИЯ (ЦЕНЫ В НАЦ., БАЗ. ВАЛЮТЕ И ПРОДАЖНЫЕ)
#end
.linkform 'nal_all_nde_price' prototype is 'nal_all'
.nameinlist 'ВЕДОМОСТЬ НАЛИЧИЯ (ЦЕНЫ В НАЦ., БАЗ. ВАЛЮТЕ И ПРОДАЖНЫЕ)'
.group '011PR'
.p 60
.fields
  CommonFormHeader
 А  DateToStr(dDate,'DD mon YYYY') А
  FilterInfo

  TNPv TGPv
  VNTarv VNBasev
  VNTarv VNBasev
  VNTarv VNPrv
  VNTarv VNPrv

  NameMC CodeMC NameEd Kol Price1 Price2 ValMC Summa1 Summa2 ValMC
  PriceLS PriceLSV
  SummaLS SummaLSV

  Itogo1 Itogo2 //ValItogo
  ItogoPr ItogoPrV
.endfields
^
 Й                     В Е Д О М О С Т Ь   Н А Л И Ч И Я   Т О В А Р А
                      по предприятию на ^г. Й

 Ш
Фильтры
.{
  ^
.}
.{
.[h OverWrite

──────────────────────────────────────┬───────────────┬──────────┬────────────┬────────────────────────────────┬────────────────────────────────────┬─────────────────────────────┬─────────────────────────────────
        Наименование товара           │Номенклатурный │  Единица │ Количество │        Учетная цена            │   Стоимость в учетных ценах        │        Продажная цена       │   Стоимость в продажных ценах
                                      │    номер      │ измерения│            ├──────────────┬─────────────────┼────────────────┬───────────────────┼──────────────┬──────────────┼────────────────┬────────────────
       @@@@@@@@@@@@@@@@@@@@@@@@       │@@@@@@@@@@@@@@@│          │            │в @@@@@@@@@@@@│ в @@@@@@@@@@@@  │в @@@@@@@@@@@@@@│ в @@@@@@@@@@@@@@  │в @@@@@@@@@@@@│в @@@@@@@@@@@@│в @@@@@@@@@@@@@@│в @@@@@@@@@@@@@@
──────────────────────────────────────┴───────────────┴──────────┴────────────┴──────────────┴─────────────────┴────────────────┴───────────────────┴──────────────┴──────────────┴────────────────┴────────────────
.]h
.{ CheckEnter
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@ @@@@@@@@@@ &'&&&&&&&&&& &'&&&&&&&&&&&& &'&&&&&&&&&&& @@@ &'&&&&&&&&&&&&&& &'&&&&&&&&&&&&& @@@ &'&&&&&&&&&&&& &'&&&&&&&&&&&& &'&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&
.}
.}


 Б                ИТОГО ПО ПРЕДПРИЯТИЮ                                                                &'&&&&&&&&&&&&&&&&&&&&  &'&&&&&&&&&&&&&&&&&&                      &'&&&&&&&&&&&&&&&&&&&&  &'&&&&&&&&&&&&&&&&&&&& Щ
 А
 А
.endform

#doc
ВЕДОМОСТЬ НАЛИЧИЯ (ЦЕНЫ В НАЦ. ВАЛЮТЕ И ПРОДАЖНЫЕ)
#end
.linkform 'nal_all_nde_price' prototype is 'nal_all'
.nameinlist 'ВЕДОМОСТЬ НАЛИЧИЯ (ЦЕНЫ В НАЦ. ВАЛЮТЕ И ПРОДАЖНЫЕ)'
.p 60
.group '010PR'
.fields
  CommonFormHeader
  DateToStr(dDate,'DD mon YYYY')
  FilterInfo

  TNPv TGPv

  NameMC CodeMC NameEd Kol Price1 Summa1
  PriceLS SummaLS

  skipped

  Itogo1
  ItogoPr
.endfields
^
 Й                     В Е Д О М О С Т Ь   Н А Л И Ч И Я   Т О В А Р А
                      по предприятию на ^г. Й

 Ш
Фильтры
.{
  ^
.}
.{
.[h OverWrite

──────────────────────────────────────┬───────────────┬──────────┬────────────┬──────────────┬────────────────┬──────────────┬─────────────────
        Наименование товара           │  Ном. номер   │  Единица │ Количество │ Учетная цена │   Стоимость    │Продажная цена│   Стоимость
       @@@@@@@@@@@@@@@@@@@@@@@@       │@@@@@@@@@@@@@@@│ измерения│            │              │в учетных ценах │              │в продажных ценах
──────────────────────────────────────┴───────────────┴──────────┴────────────┴──────────────┴────────────────┴──────────────┴─────────────────
.]h
.{ CheckEnter
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@ @@@@@@@@@@ &'&&&&&&&&&& &'&&&&&&&&&&&& &'&&&&&&&&&&&&&& &'&&&&&&&&&&&& &'&&&&&&&&&&&&&&&
.}
 ^
.}

 Б                ИТОГО ПО ПРЕДПРИЯТИЮ                                                    &'&&&&&&&&&&&&&&&&&&&&           &'&&&&&&&&&&&&&&&&&&&& Щ
 А.endform
