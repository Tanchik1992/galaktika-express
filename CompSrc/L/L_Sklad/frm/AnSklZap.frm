!╔════════════════════════════════════════════════════════════════════════════╗
!║                     (c) Корпорация ГАЛАКТИКА, 1996, 2001                   ║
!║ Проект        : ГАЛАКТИКА                                                  ║
!║ Система       : Оперативный контур - Складской учет                        ║
!║ Версия        : 5.8                                                        ║
!║ Назначение    : Анализ складских запасов                                   ║
!║ Разработал    : Макс Голдин                                                ║
!╚════════════════════════════════════════════════════════════════════════════╝


#doc
Анализ складских запасов
#end
.Set Name = 'AnSklZap'
.Hide
.fields
 Вид_Группировки :Byte

 Sf            //шрифт

 Строка_шапки1
 Строка_шапки2
 Строка_шапки3
 Строка_шапки4
 Строка_шапки5
 Строка_шапки6
 Строка_шапки7

 Sf1           //шрифт

 Строка_шапки11
 Строка_шапки12
 Строка_шапки13
 Строка_шапки14

!.{
   Склад
   МОЛ
   Партия

   Наименование_группы_МЦ
   Наименование_МЦ
   Бар_Код

   Единицы_Измерения

   Строка_данных

   Итого_по_группе_МЦ
   Итого_по_группе_МЦ1
   Итого_по_МОЛ
   Итого_по_МОЛ1
   Итого_по_Складу
   Итого_по_Складу1
!.}
 Итого_по_Отчету
 Итого_по_Отчету1
.endfields

Вид_Группировки ^

шрифт ^
! Шапка
^
^
^
^
^
^
^

шрифт ^
! Шапка
^
^
^
^

.{
===============================================================================
  Склад                  ^
  МОЛ                    ^
  Партия                 ^

  Наименование_группы_МЦ ^
  Наименование_МЦ        ^
  Бар_Код                ^
!  Количество &#'&&&&&&&&&.&&&
!  Стоимость  &#'&&&&&&&&&.&&
  Единицы_Измерения      ^

Данные
^
Итого_по_группе_МЦ
^
Итого_по_группе_МЦ1
^
Итого_по_МОЛ
^
Итого_по_МОЛ1
^
Итого_по_Складу
^
Итого_по_Складу1
^
.}
Итого_по_Отчету
^
Итого_по_Отчету1
^
.endform


#doc
С детализацией по МЦ
#end
.LinkForm 'AnSklZap_01' prototype is 'AnSklZap'
.NameInlist '1. С детализацией по МЦ'
.Defo Landscape
.p 55
.var
  sPodr, sMOL, sGrMC : String[30];
.endvar
 Б                                          Возраст складских запасов Б
.{
.[h
.fields
Sf Строка_шапки1 Sf
Sf Строка_шапки2 Sf
Sf Строка_шапки3 Sf
Sf Строка_шапки4 Sf
Sf Строка_шапки5 Sf
Sf Строка_шапки6 Sf
Sf Строка_шапки7 Sf
.endfields
^^^
^^^
^^^
^^^
^^^
^^^
^^^
.]h
!******************************************************************************
!*********************** Склад + МОЛ + ТМЦ + Партия ***************************
!******************************************************************************
.{?Internal; (Вид_Группировки = 0)
.{?Internal; (Склад <> '1')
.begin
  sPodr := Склад;
end.
.fields
  Sf
  Склад
  Sf
.endfields
^ БСклад: ^ Б^
.}
.{?Internal; (МОЛ <> '1')
.begin
  sMOL := МОЛ;
end.
.fields
 Sf
 if(МОЛ = '', 'без МОЛ', МОЛ)
 Sf
.endfields
^  БМОЛ: ^ Б^
.}
.{?Internal; (Наименование_МЦ <> '1')
.fields
  Sf
  Наименование_МЦ
  Бар_Код
  Единицы_Измерения
  Sf
.endfields
^  Матценность:  Г^ Г, номенклатурный номер:  Г^ Г, единица измерения:  Г^ Г^
.}
.{?Internal; (Партия <> '1') and (Партия <> '')
.fields
  Sf
  Партия
  Sf
.endfields
^    БПартия: ^ Б^
.}
.}
!******************************************************************************
!Склад + МОЛ + Партия + ТМЦ
!******************************************************************************
.{?Internal; (Вид_Группировки = 1)
.{?Internal; (Склад <> '1')
.begin
  sPodr := Склад;
end.
.fields
  Sf
  Склад
  Sf
.endfields
^ БСклад: ^ Б^
.}
.{?Internal; (МОЛ <> '1')
.begin
  sMOL := МОЛ;
end.
.fields
  Sf
  if(МОЛ = '', 'без МОЛ', МОЛ)
  Sf
.endfields
^  БМОЛ: ^ Б^
.}
.{?Internal; (Партия <> '1') and (Партия <> '')
.fields
  Sf
  Партия
  Sf
.endfields
^   БПартия: ^ Б^
.}
.{?Internal; (Наименование_МЦ <> '1')
.fields
  Sf
  Наименование_МЦ
  Бар_Код
  Единицы_Измерения
  Sf
.endfields
^   Матценность:  Г^ Г, номенклатурный номер:  Г^ Г, единица измерения:  Г^ Г^
.}
.}
!******************************************************************************
!Группа ТМЦ + ТМЦ
!******************************************************************************
.{?Internal; (Вид_Группировки = 2)
.{?Internal; (Наименование_группы_МЦ <> '1')
.begin
  sGrMC := Наименование_группы_МЦ;
end.
.fields
  Sf
  if(Наименование_группы_МЦ ='', 'без группы', Наименование_группы_МЦ)
  Sf
.endfields
^ БГруппа МЦ: ^ Б^
.}
.{?Internal; (Наименование_МЦ <> '1')
.fields
  Sf
  Наименование_МЦ
  Бар_Код
  Единицы_Измерения
  Sf
.endfields
^ Матценность:  Г^ Г, номенклатурный номер:  Г^ Г, единица измерения:  Г^ Г^
.}
.}
!******************************************************************************
.fields
  Sf
  Строка_данных
  Sf
.endfields
^^^
!******************************************************************************
!******************************** Итоги ***************************************
!******************************************************************************
.{?Internal; (Вид_Группировки = 2)
.{?Internal; (Итого_по_группе_МЦ <> '1')
.fields
  Sf
  if(sGrMC ='', 'без группы', sGrMC)
  Sf
  Sf
  Итого_по_группе_МЦ
  Sf
.endfields
^ ГИтого по группе МЦ (^) Г^
^ Г^ Г^
.}
.}
.{?Internal; (Вид_Группировки <> 2)
.{?Internal; (Итого_по_МОЛ <> '1')
.fields
  Sf
  if(sMOL = '', 'без МОЛ', sMOL)
  Sf
  Sf
  Итого_по_МОЛ
  Sf
.endfields
^  ГИтого по МОЛ (^) Г^
^ Г^ Г^
.}
.{?Internal; (Итого_по_Складу <> '1')
.fields
  Sf
  sPodr
  Sf
  Sf
  Итого_по_Складу
  Sf
.endfields
^ ГИтого по Складу (^) Г^
^ Г^ Г^
.}
.}
.}
.fields
  Sf
  Sf
  Sf
  Итого_по_Отчету
  Sf
.endfields
^ ГИтого по отчету Г^
^ Г^ Г^
.endform


#doc
Только итоги
#end
.LinkForm 'AnSklZap_02' prototype is 'AnSklZap'
.NameInlist '2. Только итоги'
.Defo Landscape
.p 55
.var
  sPodr, sMOL, sGrMC : String[30];
.endvar
 Б                                          Возраст складских запасов Б
.{
.[h
.fields
Sf1 Строка_шапки11 Sf1
Sf1 Строка_шапки12 Sf1
Sf1 Строка_шапки13 Sf1
Sf1 Строка_шапки14 Sf1
.endfields
^^^
^^^
^^^
^^^
.]h
!******************************************************************************
!******************************************************************************
.{?Internal; (Вид_Группировки = 2)
.{?Internal; (Наименование_группы_МЦ <> '1')
.begin
  sGrMC := Наименование_группы_МЦ;
end.
.}
.{?Internal; (Итого_по_группе_МЦ1 <> '1')
.fields
  Sf1
  if(sGrMC ='', 'без группы', sGrMC)
  Sf1
  Sf1
  Итого_по_группе_МЦ1
  Sf1
.endfields
^по группе МЦ (^)^
^^^
.}
.}
!******************************************************************************
.{?Internal; (Вид_Группировки <> 2)
.{?Internal; (Склад <> '1')
.begin
  sPodr := Склад;
end.
.}
.{?Internal; (МОЛ <> '1')
.begin
  sMOL := МОЛ;
end.
.}
!******************************************************************************
.{?Internal; (Итого_по_МОЛ1 <> '1')
.fields
  Sf1
  if(sMOL = '', 'без МОЛ', sMOL)
  Sf1
  Sf1
  Итого_по_МОЛ1
  Sf1
.endfields
^ по МОЛ (^)^
^^^
.}
!******************************************************************************
.{?Internal; (Итого_по_Складу1 <> '1')
.fields
  Sf1
  sPodr
  Sf1
  Sf1
  Итого_по_Складу1
  Sf1
.endfields
^ Гпо Складу (^) Г^
^ Г^ Г^
.}
.}
.}
.fields
  Sf1
  Sf1
  Sf1
  Итого_по_Отчету1
  Sf1
.endfields
^ ГИтого по отчету Г^
^ Г^ Г^
.endform
