! ╔═════════════════════════════════════════════════════════════════════════╗
! ║  Разработал:  Александр Крахотко                                        ║
! ║  Назначение:  печать акта инвентаризации                                ║
! ║  Дополнения:  Голец Дмитрий Иванович для розничной торговли             ║
! ║                                                                         ║
! ║              Используется на Складе и в Розничной Торговле !!!          ║
! ╚═════════════════════════════════════════════════════════════════════════╝


#doc
Печать акта инвентаризации
#end
.Set Name = 'inventar'
.hide
.fields
Вид_акта // 611 - излишок 612 - недостаток; 904 - излишок 914 - недостаток (розница) 910 - недостаток (розница)
nRec_Doc
номер_акта
дескриптор
дата_акта:date:'m:"DD" mon YYYY г.'
примечание
дата_оприходования:date:'m:"DD" mon YYYY г.'
склад
мол
назначение
сумма_нац:double
сумма_вал:double
валюта_1_код//:comp
валюта_2_код//:comp
наименование_валюты
типовая_хозяйственная_операция
символ_валюты
символ_баз_валюты
!.{
  nRec_SpDoc
  название
  номенклатурный_номер
  количество:double
  цена:double
  цена_в_валюте:double
  стоимость_МЦ:double
  единица_изм
  nRecParty : comp
  название_партии
!.}
сумма_баз_округл // Cумма в валюте документа, округленная до 2 знаков после запятой
.endfields
вид_акта // 611 - излишок 612 - недостаток  ^
nRec_Doc                                    ^
номер_акта                                  ^
Дескриптор                                  ^
дата_акта                                   ^
Примечание                                  ^
дата_оприходования                          ^
склад                                       ^
мол                                         ^
назначение                                  ^
сумма_нац                                   ^
сумма_вал                                   ^
валюта_1_код                                ^
валюта_2_код                                ^
наименование_валюты                         ^
Типовая_хозяйственная_операция              ^
символ_валюты                               ^
символ_баз_валюты                           ^
.{
  nRec_SpDoc                                ^
  Название                                  ^
  Номенклатурный номер                      ^
  Количество                                ^
  Цена                                      ^
  Цена в валюта                             ^
  стоимость_МЦ                              ^
  ед изм                                    ^
  nRecParty                                 ^
  Название партии                           ^
.}
сумма_баз_округл                            ^
.endform

#doc
Акт инвентаризации о недостаче МЦ
#end
.linkform 'inventar_01' prototype is 'inventar'
.nameInList 'Акт инвентаризации о недостаче МЦ'
.group '612'
.fields
  CommonFormHeader
.endfields
^
.fields
PrintNumber(дескриптор,номер_акта)
дата_акта
примечание
дата_оприходования
склад
мол
назначение
типовая_хозяйственная_операция
символ_валюты : 'd:r'
символ_баз_валюты : 'd:r'
!.{
  название
  номенклатурный_номер
  единица_изм
  количество
  цена
  цена_в_валюте
  стоимость_МЦ
  название_партии
!.}
сумма_баз_округл
сумма_нац
!наименование_валюты
DoubleToString(0, Round(сумма_нац, 2))
.endfields

 Б               АКТ ИНВЕНТАРИЗАЦИИ О НЕДОСТАЧЕ МЦ НА СКЛАДЕ
                              N° ^   от  ^ Б
 Р  БПримечание : Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  БДата списания со склада : Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  БСклад : Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  БМОЛ   : Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  БНазначение : Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  БТиповая хозяйственная операция : Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Р
.{
.[h OverWrite
 Р──────────────────────────┬─────────────┬───────┬──────────────┬──────────────┬─────────────┬──────────────────┬────────────────────────
      Наименование        │Номенкл.номер│Уч.ед. │  Количество  │     Цена     │  Цена в @@@@│ Стоимость в @@@@@│        Партия
──────────────────────────┴─────────────┴───────┴──────────────┴──────────────┴─────────────┴──────────────────┴──────────────────────── Р
.]h
 Р @@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@  @@@@@@ &'&&&&&&&&.&&& &'&&&&&&&&&.&& &'&&&&&&&&.&& &'&&&&&&&&&&&&&.&& @@@@@@@@@@@@@@@@@@@@@@@ Р
.}
 Р────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 Б                                                                                      Итого: &'&&&&&&&&&&&&&.&&

 Сумма по акту &'&&&&&&&&&&&&&.&&  С
 Р Прописью : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Р
.endform

#doc
Акт инвентаризации об излишке МЦ
#end
.linkform 'inventar_02' prototype is 'inventar'
.nameInList 'Акт инвентаризации об излишке МЦ'
.group '611'
.fields
  CommonFormHeader
.endfields
^
.fields
PrintNumber(дескриптор,номер_акта)
дата_акта
примечание
дата_оприходования
склад
мол
назначение
типовая_хозяйственная_операция
символ_валюты : 'd:r'
символ_баз_валюты : 'd:r'
!.{
  название
  номенклатурный_номер
  единица_изм
  количество
  цена
  цена_в_валюте
  стоимость_МЦ
  название_партии
!.}
сумма_баз_округл
сумма_нац
!наименование_валюты
DoubleToString(0, Round(сумма_нац, 2))
.endfields

 Б                  АКТ ИНВЕНТАРИЗАЦИИ ОБ ИЗЛИШКАХ МЦ НА СКЛАДЕ
                                N° ^ от ^ Б
 Р  БПримечание : Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  БДата оприходования на склад : Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  БСклад : Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  БМОЛ   : Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  БНазначение : Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  БТиповая хозяйственная операция : Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Р
.{
.[h OverWrite
 Р──────────────────────────┬─────────────┬───────┬──────────────┬──────────────┬─────────────┬──────────────────┬────────────────────────
      Наименование        │Номенкл.номер│Уч.ед. │  Количество  │     Цена     │  Цена в @@@@│ Стоимость в @@@@@│        Партия
──────────────────────────┴─────────────┴───────┴──────────────┴──────────────┴─────────────┴──────────────────┴──────────────────────── Р
.]h
 Р @@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@  @@@@@@ &'&&&&&&&&.&&& &'&&&&&&&&&.&& &'&&&&&&&&.&& &'&&&&&&&&&&&&&.&& @@@@@@@@@@@@@@@@@@@@@@@ Р
.}
 Р──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 Б                                                                                      Итого: &'&&&&&&&&&&&&&.&&

 Сумма по акту &'&&&&&&&&&&&&&.&&  С
 Р Прописью : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Р
.endform




!****************************************************************************************
!***   Розничная торговля
!****************************************************************************************

#doc
Акт инвентаризации о недостаче МЦ (Розничная торговля)
#end
.linkform 'inventar_03' prototype is 'inventar'
.nameInList 'Акт инвентаризации о недостаче МЦ (Розничная торговля)'
.group '914'
.fields
  CommonFormHeader
.endfields
^
.fields
НОМЕР_АКТА
дата_акта
дата_оприходования
склад
мол

!.{
  название
  номенклатурный_номер
  единица_изм
  количество
  цена
  цена * количество
  название_партии
!.}
сумма_нац
DoubleToString(0, Round(сумма_нац, 2))
.endfields

 Б  АКТ ИНВЕНТАРИЗАЦИИ О НЕДОСТАЧЕ МЦ В ПОДРАЗДЕЛЕНИЯХ РОЗНИЧНОЙ ТОРГОВЛИ Б
                         N° ^ от ^

 СДата списания со склада : Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 БСклад : Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 БМол   : Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Р

 Ш──────────────────────────┬─────────────┬───────┬──────────────┬───────────────┬─────────────────┬───────────────────────────────────────────────── Ш
 Ш  Название                │Ном.номер    │ ЕдИзм │Количество    │Цена           │Сумма            │Партия                                            Ш
 Ш──────────────────────────┴─────────────┴───────┴──────────────┴───────────────┴─────────────────┴───────────────────────────────────────────────── Ш
.{
 Ш@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@ @@@@@@@ &'&&&&&&&&.&&& &&&&&&&&&&&&.&& &&&&&&&&&&&&&&.&& @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Ш
.}

 ИСумма по акту &&&&&&&&&&&&.&& руб. И
 Р  Прописью : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Р
.endform

#doc
Акт инвентаризации об излишках МЦ (Розничная торговля)
#end
.linkform 'inventar_04' prototype is 'inventar'
.nameInList 'Акт инвентаризации об излишках МЦ (Розничная торговля)'
.group '904'
.fields
  CommonFormHeader
.endfields
^
.fields
номер_акта
дата_акта
дата_оприходования
склад
мол
!.{
  название
  номенклатурный_номер
  единица_изм
  количество
  цена
  цена * количество
  название_партии
!.}
сумма_нац
DoubleToString(0, Round(сумма_нац, 2))
.endfields

 Б       АКТ ИНВЕНТАРИЗАЦИИ ОБ ИЗЛИШКАХ МЦ
      В ПОДРАЗДЕЛЕНИЯХ РОЗНИЧНОЙ ТОРГОВЛИ Б
               N° ^ от ^

 СДата оприходования на склад : Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 БСклад : Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 БМол   : Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Р

 Ш──────────────────────────┬─────────────┬───────┬──────────────┬───────────────┬─────────────────┬───────────────────────────────────────────────── Ш
 Ш  Название                │Ном.номер    │ ЕдИзм │Количество    │Цена           │Сумма            │Партия                                            Ш
 Ш──────────────────────────┴─────────────┴───────┴──────────────┴───────────────┴─────────────────┴───────────────────────────────────────────────── Ш
.{
 Ш@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@ @@@@@@@ &'&&&&&&&&.&&& &&&&&&&&&&&&.&& &&&&&&&&&&&&&&.&& @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Ш
.}

 ИСумма по акту &&&&&&&&&&&&.&& руб. И
 Р  Прописью : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Р
.endform



!*** Для стоимостной инвентаризации
#doc
Документ по результатам стоимостной инвентаризации о недостаче МЦ (Розничная торговля)
#end
.linkform 'inventar_05' prototype is 'inventar'
.nameInList 'Документ по результатам стоимостной инвентаризации о недостаче МЦ (Розничная торговля)'
.group '910'
.create view rzDoc_view
        as select rzDoc.SumSale, rzDoc.SumEU,rzDoc.SumLack, rzDoc.LastInv, rzDoc.Price
        from rzDoc(readonly) ,rzspdoc
        where ((
        comp(nRec_Doc)   == rzDoc.nRec
        ))
;
.create view rzSpDoc_view
        as select rzSpDoc.kol, rzSpDoc.ostatok, rzSpDoc.PercentEU
        from rzSpDoc(readonly)
        where ((
        comp(nRec_SpDoc) == rzSpDoc.nRec
        ))
;
.fields
  CommonFormHeader
.endfields
^
.fields
НОМЕР_АКТА
if (rzDoc_view.getfirst = 0, if (rzDoc_view.rzDoc.LastInv = date(0,0,0), '', 'с '+ datetostr(rzDoc_view.rzDoc.LastInv,'DD/MM/YYYY')), '')
дата_акта
дата_оприходования
склад
мол

!.{
  название
  номенклатурный_номер
  единица_изм
  количество
  if (rzSpDoc_view.getfirst = 0, rzSpDoc_view.rzSpDoc.ostatok, 0)
  цена
!.}
rzDoc_view.rzDoc.Price
rzDoc_view.rzDoc.SumSale
rzDoc_view.rzDoc.SumEU
rzDoc_view.rzDoc.SumLack
!DoubleToString(0, Round(сумма_нац, 2))
.endfields

 Б  ДОКУМЕНТ ПО ИТОГАМ ИНВЕНТАРИЗАЦИИ О НЕДОСТАЧЕ МЦ
  В ПОДРАЗДЕЛЕНИЯХ РОЗНИЧНОЙ ТОРГОВЛИ С СТОИМОСТНОЙ
                     СХЕМОЙ УЧЕТА Б

            N° ^ за период ^ по ^

 СДата списания со склада : Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Р
 ССклад : Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Р
 СМол   : Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Р

 И──────────────────────────┬─────────────┬───────┬──────────────┬──────────┬───────────────
  Название                │Ном.номер    │ ЕдИзм │Количество    │Колво факт│Сумма недостачи
──────────────────────────┴─────────────┴───────┴──────────────┴──────────┴─────────────── И
 И.{ И
 И@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@ @@@@@@@ &'&&&&&&&&.&&& &&&&&&&.&& &&&&&&&&&&&&.&& И
 И.} И

 ИСумма недостачи по спецификации             &&&&&&&&&&&&.&& руб. И
 ИСумма по кассовым лентам                    &&&&&&&&&&&&.&& руб. И
 ИСумма естественной убыли                    &&&&&&&&&&&&.&& руб.
Сумма недостачи                             &&&&&&&&&&&&.&& руб.
 И

 Р!  Прописью : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Р
 И.endform И
