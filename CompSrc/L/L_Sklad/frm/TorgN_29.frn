!╔═════════════════════════════════════════════════════════════════════════╗
!║  Разработал:  Макс Голдин                                               ║
!║  Назначение:  форма №ТОРГ-29 "Товарный отчет"                           ║
!╚═════════════════════════════════════════════════════════════════════════╝

#doc
Товарный отчет (форма № ТОРГ-29)
#end

.linkform '3.Товарный отчет (форма № ТОРГ-29)' prototype is rzTovRp
.DEFO PORTRAIT
.DEFO LANDSCAPE
.p 74
!.O1 8
.Set Filler ='-'
.fields
  CommonFormHeader
.endfields
^
.var
  NomPp :Word;
  ItogP1, ItogP2, ItogR1, ItogR2 :Double;
.endvar
.fields
  Организация
  Организация_ОКПО
  Подразделение
  Организация_ОКДП

  Номер_накладной
  DateToStr(Cur_date, 'DD/MM/YYYY')
  Дата_начала
  Дата_окончания

  МОЛ_должность + if(МОЛ_должность <> '', ', ', '') + МОЛ_ФИО
  МОЛ_табельный_номер

  'Сумма, '+СимВалюты

  Дата_начала
  Остаток_на_начало_МЦ   - Остаток_на_начало_ЕУ_МЦ
  Остаток_на_начало_Тара - Остаток_на_начало_ЕУ_Тара

!.{ CheckEnter rzTovRp01
   String(NomPp) + '.' + Оппонент_прихода
   DateToStr(Дата_документа_прихода,'DD/MM/YYYY')
   Номер_документа_прихода
   Сумма_прихода_МЦ
   Сумма_прихода_Тары
   Отметка_бухгалтерии
!.}
  ItogP1
  ItogP2
  ItogP1 + Остаток_на_начало_МЦ   - Остаток_на_начало_ЕУ_МЦ
  ItogP2 + Остаток_на_начало_Тара - Остаток_на_начало_ЕУ_Тара
.endfields
 Р                                                                                       Унифицированная форма №  ТОРГ-29 Р
 Р                                                                                       Утверждена постановлением Госкомстата Р
 Р                                                                                       России от 25.12.1998 г. № 132 Р
 Р                                                                                                        ┌──────────────────┐ Р
 Р                                                                                                        │        Код       │ Р
 Р                                                                                                        ├──────────────────┤ Р
 Р                                                                                          Форма по ОКУД │      0330229     │ Р
 Р                                                                                                        ├──────────────────┤ Р
 РОрганизация:    Г@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Г  по ОКПО │@~@@@@@@@@@@@@@@@@│ Р
 Р               ─────────────────────────────────────────────────────────────────────────────────────────┼──────────────────┤ Р
 РПодразделение:  Г@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Г  │                  │ Р
 Р               ─────────────────────────────────────────────────────────────────────────────────────────┼──────────────────┤ Р
 Р                                                                               Вид деятельности по ОКДП │@~@@@@@@@@@@@@@@@@│ Р
 Р                                                                                                        ├──────────────────┤ Р
 Р                                                                                           Вид операции │                  │ Р
 Р                                                                                                        └──────────────────┘ Р
                      ┌───────────────┬───────────┬─────────────────────┐
                      │     Номер     │   Дата     Д│   Отчетный период   │ Д
                      │   документа   │составления│     c    │    по    │
                      ├───────────────┼───────────┼──────────┼──────────┤
       ТОВАРНЫЙ ОТЧЕТ │@~@@@@@@@@@@@@@│ @@@@@@@@@@│@@@@@@@@@@│@@@@@@@@@@│
                      └───────────────┴───────────┴──────────┴──────────┘
 Р                                                                                                         ┌─────────────────┐ Р
 Р                                                                                                         │ Табельный номер │ Р
 Р                                                                                                         ├─────────────────┤ Р
 РМатериально-ответственное лицо:  З @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ З     │@~@@@@@@@@@@@@@@@│ Р
 Р                                                                                                         └─────────────────┘ Р
 Ш┌──────────────────────────────────────────────────┬────────────────────────────┬─────────────────────────────────────┬─────────────────────────┐ Ш
 Ш│                                                  │          Документ          │@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│                         │ Ш
 Ш│                  Наименование                    ├────────────┬───────────────┼──────────────────┬──────────────────┤   Отметки бухгалтерии   │ Ш
 Ш│                                                  │    дата    │     номер     │      товара      │       тары       │                         │ Ш
 Ш├──────────────────────────────────────────────────┼────────────┼───────────────┼──────────────────┼──────────────────┼────────────┬────────────┤ Ш
 Ш│                       1                          │     2      │       3       │        4         │        5         │     6      │     7      │ Ш
.{while NomPp = 0
 Ш├──────────────────────────────────────────────────┼────────────┼───────────────┼──────────────────┼──────────────────┼────────────┼────────────┤ Ш
 Ш│              Остаток на @@@@@@@@@@               │            │               │&#'&&&&&&&&&&&&.&&│&#'&&&&&&&&&&&&.&&│            │            │ Ш
.begin
  NomPp  :=1;
end.
.}
 Ш├──────────────────────────────────────────────────┼────────────┼───────────────┼──────────────────┼──────────────────┼────────────┼────────────┤ Ш
 Ш│                     ПРИХОД                       │            │               │                  │                  │            │            │ Ш
.{ CheckEnter rzTovRp01
 Ш├──────────────────────────────────────────────────┼────────────┼───────────────┼──────────────────┼──────────────────┼────────────┼────────────┤ Ш
 Ш│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@~@@@@@@@@@@│&&&&&&&&&&&&&&&│&#'&&&&&&&&&&&&.&&│&#'&&&&&&&&&&&&.&&│            │@@@@@@@@@@@@│ Ш
.begin
  NomPp  :=NomPp + 1;

  ItogP1 :=ItogP1 + Сумма_прихода_МЦ;
  ItogP2 :=ItogP2 + Сумма_прихода_Тары;
end.
.}
 Ш├──────────────────────────────────────────────────┼────────────┼───────────────┼──────────────────┼──────────────────┼────────────┼────────────┤ Ш
 Ш│                                 Итого по приходу │            │               │&#'&&&&&&&&&&&&.&&│&#'&&&&&&&&&&&&.&&│            │            │ Ш
 Ш├──────────────────────────────────────────────────┼────────────┼───────────────┼──────────────────┼──────────────────┼────────────┼────────────┤ Ш
 Ш│                                 Итого с остатком │            │               │&#'&&&&&&&&&&&&.&&│&#'&&&&&&&&&&&&.&&│            │            │ Ш
 Ш└──────────────────────────────────────────────────┴────────────┴───────────────┴──────────────────┴──────────────────┴────────────┴────────────┘ Ш
!-----------------------------------------------------------------------------
!-----------------------------------------------------------------------------
!-----------------------------------------------------------------------------
.fields
  'true' : 's'

  'Сумма, '+СимВалюты

!.{ CheckEnter rzTovRp02
   String(NomPp) + '.' + Оппонент_расхода
   DateToStr(Дата_документа_расхода, 'DD/MM/YYYY')
   Номер_документа_расхода
   Сумма_расхода_МЦ
   Сумма_расхода_Тары
   Отметка_бухгалтерии_расх
!.}
  ItogR1
  ItogR2
.endfields
^
.begin
  NomPp :=0;
end.
 Ш┌──────────────────────────────────────────────────┬────────────────────────────┬─────────────────────────────────────┬─────────────────────────┐ Ш
 Ш│                                                  │          Документ          │@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│                         │ Ш
 Ш│                  Наименование                    ├────────────┬───────────────┼──────────────────┬──────────────────┤   Отметки бухгалтерии   │ Ш
 Ш│                                                  │    дата    │     номер     │      товара      │       тары       │                         │ Ш
 Ш├──────────────────────────────────────────────────┼────────────┼───────────────┼──────────────────┼──────────────────┼────────────┬────────────┤ Ш
 Ш│                       1                          │     2      │       3       │        4         │        5         │     6      │     7      │ Ш
 Ш├──────────────────────────────────────────────────┼────────────┼───────────────┼──────────────────┼──────────────────┼────────────┼────────────┤ Ш
 Ш│                     РАСХОД                       │            │               │                  │                  │            │            │ Ш
.{ CheckEnter rzTovRp02
.begin
  NomPp  :=NomPp + 1;

  ItogR1 :=ItogR1 + Сумма_расхода_МЦ;
  ItogR2 :=ItogR2 + Сумма_расхода_Тары;
end.
 Ш├──────────────────────────────────────────────────┼────────────┼───────────────┼──────────────────┼──────────────────┼────────────┼────────────┤ Ш
 Ш│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@~@@@@@@@@@@│&&&&&&&&&&&&&&&│&#'&&&&&&&&&&&&.&&│&#'&&&&&&&&&&&&.&&│            │@@@@@@@@@@@@│ Ш
.}
 Ш├──────────────────────────────────────────────────┼────────────┼───────────────┼──────────────────┼──────────────────┼────────────┼────────────┤ Ш
 Ш│                                 Итого по расходу │            │               │&#'&&&&&&&&&&&&.&&│&#'&&&&&&&&&&&&.&&│            │            │ Ш
.{?INTERNAL;(Стоимостной_учет) and PrRash;
.fields
  Итог_расхода_ЕУ_МЦ
  Итог_расхода_ЕУ_Тары
.endfields
 Ш├──────────────────────────────────────────────────┼────────────┼───────────────┼──────────────────┼──────────────────┼────────────┼────────────┤ Ш
 Ш│Естественная убыль                                │            │               │&#'&&&&&&&&&&&&.&&│&#'&&&&&&&&&&&&.&&│            │            │ Ш
.}
.{?INTERNAL;PrPrih or PrRash;
.fields
  DateToStr(Add_Day(Дата_окончания,1),'DD/MM/YYYY')
  Остаток_на_начало_МЦ - Остаток_на_начало_ЕУ_МЦ +
   ItogP1 - ItogR1 - Итог_расхода_ЕУ_МЦ
  Остаток_на_начало_Тара - Остаток_на_начало_ЕУ_Тара +
   ItogP2 - ItogR2 - Итог_расхода_ЕУ_Тары
.endfields
 Ш├──────────────────────────────────────────────────┼────────────┼───────────────┼──────────────────┼──────────────────┼────────────┼────────────┤ Ш
 Ш│              Остаток на @@@@@@@@@@@@             │            │               │&#'&&&&&&&&&&&&.&&│&#'&&&&&&&&&&&&.&&│            │            │ Ш
 Ш└──────────────────────────────────────────────────┴────────────┴───────────────┴──────────────────┴──────────────────┴────────────┴────────────┘ Ш
.}
.{?INTERNAL;(not PrPrih) and (not PrRash);
.fields
  Дата_окончания
  Остаток_на_начало_МЦ   - Остаток_на_начало_ЕУ_МЦ
  Остаток_на_начало_Тара - Остаток_на_начало_ЕУ_Тара
.endfields
 Ш├──────────────────────────────────────────────────┼────────────┼───────────────┼──────────────────┼──────────────────┼────────────┼────────────┤ Ш
 Ш│             Остаток на @@@@@@@@@@                │            │               │&#'&&&&&&&&&&&&.&&│&#'&&&&&&&&&&&&.&&│            │            │ Ш
 Ш└──────────────────────────────────────────────────┴────────────┴───────────────┴──────────────────┴──────────────────┴────────────┴────────────┘ Ш
.}
.fields
  DoubleToStr(Общее_количество_документов, '4\m')

  МОЛ_должность
  МОЛ_ФИО
.endfields

Приложение  З ^ З документа(ов)

на ________________________________________________________________ листах
                          количество прописью

 РОтчет с документами принял и проверил ________________________________  ___________________  _______________________________ Р
 Р                                                  должность                    подпись             расшифровка подписи Р

 РМатериально ответственное лицо         З@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ З  ___________________   З@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ З Р
 Р                                                  должность                    подпись             расшифровка подписи Р
.{ CheckEnter RZTOVRP03
.}

.endform
