#doc
Закупка
Паспорт импортной сделки для Казахстана
#end
.LinkForm 'DogovorReport_03' Prototype is 'DogPrn2'
.NameInList 'Паспорт импортной сделки для Казахстана'
.group 'Закупка'
.create view loBD
var
  cDogovor: comp;
  PosrName: string;
from
    Dogovor  
  , SpDocs   
  , KatMC    
  , KatUsl   
  , KlVal    
  , Persons  
  , Appointments 
  , Passports    
  , AttrDog
  , synonym KatOrg Pol 
  , synonym KatOrg Post 
  , synonym KatOrg Posr 
  , synonym KatCity CityPol 
  , synonym KatCity CityPost 
  , synonym KatCity CityPosr 
  , synonym KatState StatePost 
  , synonym KatBank BankPlat 
  , synonym KatBank BankPol 
  , synonym KatBank BankPosr 
  , synonym KlVal KlValRas 
where
((
                cDogovor == Dogovor.NRec
and         Dogovor.TiDk == SpDocs.TiDk
and         Dogovor.NRec == SpDocs.cDoc
and        SpDocs.cMCUsl == KatMC.NRec
and        SpDocs.cMCUsl == KatUsl.NRec
and         Dogovor.nRec == AttrDog.cDogovor
and    coGetTune('Boss') == Persons.nRec
and     Persons.PasspRus == Passports.nRec
and         Dogovor.cVal == KlVal.NRec
and      Dogovor.cValRas == KlValRas.NRec
and         Dogovor.cOrg == Post.NRec
and       Dogovor.cMyOrg == Pol.NRec
and           Post.cCity == CityPost.NRec
and            Pol.cCity == CityPol.NRec
and             PosrName == Posr.Name
and          Post.cState == StatePost.NRec
and           Posr.cCity == CityPosr.NRec
and    Dogovor.cBankPlat == BankPlat.NRec
and     Dogovor.cBankPol == BankPol.NRec
))
;
.var
  PSINum: string
  PSIDate: date
  Tovar, FormRasc: string
  BankPlatRNN, BankPlatOKPO: string
  OplTov: string
  NalOrgAddrImp: string
  NalOrgAddr3: string
  SrokOpl: string
  ValOgovorka: string
  BankNotes: string
.endvar
.begin
  loBD.cDogovor := Comp(nRecД_С);
  if (loBD.GetFirst Post = 0) then {}
  if (loBD.GetFirst Pol = 0) then {}
  if (loBD.GetFirst Persons = 0) then {}
  if (loBD.GetFirst Dogovor = 0) then {
    var ExtAttr: IExtAttr;
    var ExClass: IExtClass;
    var cAttrNam: comp;
    var wTypeAttr: word;

    BankPlatRNN   := ExtAttr.sGetAttr(coKatBank, loBD.Dogovor.cBankPlat, 'РНН'                    );
    BankPlatOKPO  := ExtAttr.sGetAttr(coKatBank, loBD.Dogovor.cBankPlat, 'ОКПО'                   );
    NalOrgAddrImp := ExtAttr.sGetAttr(coKatOrg , loBD.Dogovor.cMyOrg   , 'Адрес налогового органа');
    PosrName      := ExtAttr.sGetAttr(coDogovor, Comp(nRecД_С)         , 'Третье лицо'            );
    if (loBD.GetFirst Posr = 0)
    {
      NalOrgAddr3 := ExtAttr.sGetAttr(coKatOrg, loBD.Posr.NRec, 'Адрес налогового органа');
      if (loBD.GetFirst BankPosr where (( loBD.Posr.NRec == BankPosr.cOrg and
                                                 word(1) == BankPosr.Aktiv )) <> 0)
        if (loBD.GetFirst BankPosr
                    where (( loBD.Posr.NRec == BankPosr.cOrg )) = 0) then {}
    }
    // ПС
    Tovar := '';
    loBD._loop SpDocs
     {
      if ((loBD.SpDocs.PrMc = 2) or (loBD.SpDocs.PrMc = 3))
        Tovar := Tovar + if(Tovar = '', '', ',') + KatUsl.Name
      else
        Tovar := Tovar + if(Tovar = '', '', ',') + KatMC.Name;
     }
    PSINum := ExtAttr.sGetAttr(coDogovor, Comp(nRecД_С), 'Паспорт сделки (ПС)');
    // Валютная оговорка
    ValOgovorka := ExtAttr.sGetAttr(coDogovor, Comp(nRecД_С), 'Валютная оговорка');
    // Особые отметки Банка, Таможенного органа
    BankNotes := ExtAttr.sGetAttr(coDogovor, Comp(nRecД_С), 'Особые отметки Банка, Таможенного органа');
    // дата регистрации ПС
    PSIDate := ExtAttr.dGetAttr(coDogovor, Comp(nRecД_С), 'Дата регистрации ПС');

    //форма расчетов
    wTypeAttr:=ExClass.GetClassCode(coDogovor,'Форма расчетов');
    if (wTypeAttr<>0)
     {
       FormRasc:=ExClass.GetSegName(wTypeAttr,Comp(nRecД_С));
     }
    else
     FormRasc:='';

    //оплата товара
    wTypeAttr:=ExClass.GetClassCode(coDogovor,'Оплата товара');
    if (wTypeAttr<>0)
     {
       OplTov:=ExClass.GetSegName(wTypeAttr,Comp(nRecД_С));
     }
    else
     OplTov:='';
  };
end.
.fields
!  ПАСПОРТ СДЕЛКИ ПО ИМПОРТУ N  Б^ Б от  Б^ Б
  PSINum
  if (longint(PSIDate) = 0, '', DateToStr(PSIDate, 'DD/MM/YYYY г.'))

!  Реквизиты банка:
!  Наименование -                    Б^ Б
!  Филиал -
!  Адрес -                           Б^ Б
!  РНН -                             Б^ Б
!  Код ОКПО банка (филиала банка) -  Б^ Б
  loBD.BankPlat.Name
  loBD.BankPlat.Addr
  BankPlatRNN
  BankPlatOKPO

!  Реквизиты импортера:
!  Наименование -                    Б^ Б
!  Код ОКПО -                        Б^ Б
!  Адрес -                           Б^ Б
!  Номер банковского счета -         Б^ Б
!  РНН -                             Б^ Б
!  Адрес налогового органа -         Б^ Б
  loBD.Pol.Name
  loBD.Pol.OKPO
  loBD.Pol.Addr+', '+loBD.CityPol.Name
  loBD.BankPlat.Schet1
  loBD.Pol.UNN
  NalOrgAddrImp

!  Реквизиты третьего лица:
!  Наименование -                    Б^ Б
!  Код ОКПО -                        Б^ Б
!  Адрес -                           Б^ Б
!  Номер банковского счета -         Б^ Б
!  РНН -                             Б^ Б
!  Адрес налогового органа -         Б^ Б
  loBD.Posr.Name
  loBD.Posr.OKPO
  loBD.Posr.Addr+', '+loBD.CityPosr.Name
  loBD.BankPosr.Schet1
  loBD.Posr.UNN
  NalOrgAddr3

!  Реквизиты инопартнера:
!  Наименование -                    Б^ Б
!  Страна -                          Б^ Б
!  Адрес -                           Б^ Б
!  Реквизиты банка инопартнера -     Б^ Б
  loBD.Post.Name
  loBD.StatePost.Name
  loBD.Post.Addr+', '+loBD.CityPost.Name
  loBD.BankPol.Name+
    if(loBD.BankPol.Addr = '', '', ', '+loBD.BankPol.Addr)+
    if(loBD.BankPol.Schet1 = '', '', ', р/с'+loBD.BankPol.Schet1)

!  Реквизиты и условия контракта:
!  Номер -                    Б@@@@@@@@@@@@@@@@@@ Б   Последняя дата -      Б^ Б
!  Дата -                     Б@@@@@@@@@@@@@@@@@@ Б   Валюта платежа -      Б^ Б
!  Сумма контракта -          Б&'&&&&&&&&&&&&&.&& Б   Код валюты платежа -  Б^ Б
!  Товар -                    Б@@@@@@@@@@@@@@@@@@ Б   Форма расчетов -      Б^ Б
!  Валюта по контракту -      Б@@@@@@@@@@@@@@@@@@ Б
!  Код валюты по контракту -  Б@@@@@@@@@@@@@@@@@@ Б
!  Валютная оговорка -        Б^ Б
  loBD.Dogovor.NoDoc DateToStr(loBD.Dogovor.dEnd, 'DD/MM/YYYY')
  loBD.Dogovor.dDoc  if(loBD.Dogovor.cValRas = 0, sGetTune('NDE.SimvRub'), loBD.KlValRas.Dollar)
  loBD.Dogovor.Summa if(loBD.Dogovor.cValRas = 0, sGetTune('NDE.RublISO'), loBD.KlValRas.ISO)
  Tovar FormRasc
  if(loBD.Dogovor.cVal = 0, sGetTune('NDE.SimvRub'), loBD.KlVal.Dollar) 
  if(loBD.Dogovor.cVal = 0, sGetTune('NDE.RublISO'), loBD.KlVal.ISO)
  ValOgovorka

  ''  AttrDog.Sign_My_Post  ''
  ''  AttrDog.Sign_My_Fio   ''
  ''  ''
  ''  ''
  BankNotes
.endfields

.{ CheckEnter DogGroup
.}


  ПАСПОРТ СДЕЛКИ ПО ИМПОРТУ N  Б^ Б
                           от  Б^ Б

  Реквизиты банка:
  Наименование -                    Б^ Б
  Филиал -
  Адрес -                           Б^ Б
  РНН -                             Б^ Б
  Код ОКПО банка (филиала банка) -  Б^ Б

  Реквизиты импортера:
  Наименование -                    Б^ Б
  Код ОКПО -                        Б^ Б
  Адрес -                           Б^ Б
  Номер банковского счета -         Б^ Б
  РНН -                             Б^ Б
  Адрес налогового органа -         Б^ Б

  Реквизиты третьего лица:
  Наименование -                    Б^ Б
  Код ОКПО -                        Б^ Б
  Адрес -                           Б^ Б
  Номер банковского счета -         Б^ Б
  РНН -                             Б^ Б
  Адрес налогового органа -         Б^ Б

  Реквизиты инопартнера:
  Наименование -                    Б^ Б
  Страна -                          Б^ Б
  Адрес -                           Б^ Б
  Реквизиты банка инопартнера -     Б^ Б

  Реквизиты и условия контракта:
  Номер -                    Б@@@@@@@@@@@@@@@@@@ Б   Последняя дата -      Б^ Б
  Дата -                     Б@@@@@@@@@@@@@@@@@@ Б   Валюта платежа -      Б^ Б
  Сумма контракта -          Б&'&&&&&&&&&&&&&.&& Б   Код валюты платежа -  Б^ Б
  Товар -                    Б@@@@@@@@@@@@@@@@@@ Б   Форма расчетов -      Б^ Б
  Валюта по контракту -      Б@@@@@@@@@@@@@@@@@@ Б
  Код валюты по контракту -  Б@@@@@@@@@@@@@@@@@@ Б
  Валютная оговорка -        Б^ Б

  Лицензия Национального банка Республики Казахстан:
  Номер лицензии                                 Дата
  Регистрационное свидетельство Национального Банка Республики Казахстан
  Номер регистрационного свидетельства                  Дата

  Подписи уполномоченных лиц:
  От Банка                                  От Импортера                              От тамож. органа
  Должность  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б    Должность  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б    Должность  Б^ Б
  Фамилия И.О.  Б@@@@@@@@@@@@@@@@@@@@@@@@@ Б    Фамилия И.О.  Б@@@@@@@@@@@@@@@@@@@@@@@@@ Б    Фамилия И.О.  Б^ Б




      М.П.          Дата                        М.П.          Дата                        М.П.          Дата




  От третьего лица                          От банка третьего лица
  Должность  Б^ Б                           Должность  Б^ Б
  Фамилия И.О.  Б^ Б                        Фамилия И.О.  Б^ Б




      М.П.          Дата                        М.П.          Дата
                                                                              
                                       
                                       
  
  Особые отметки банка, таможенного органа:
  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@



.{ CheckEnter Spec
.}
.EndForm

#doc
Продажа
Паспорт импортной сделки для Казахстана
#end
.LinkForm 'DogovorReport_04' Prototype is 'DogPrn2'
.NameInList 'Паспорт экспортной сделки для Казахстана'
.group 'Продажа'
.create view loBD
var
  cDogovor: comp;
  PosrName: string;
from
    Dogovor  
  , SpDocs   
  , KatMC    
  , KatUsl   
  , KlVal    
  , Persons  
  , Appointments 
  , Passports    
  , AttrDog
  , synonym KatOrg Pol 
  , synonym KatOrg Post 
  , synonym KatOrg Posr 
  , synonym KatCity CityPol 
  , synonym KatCity CityPost 
  , synonym KatCity CityPosr 
  , synonym KatState StatePost 
  , synonym KatBank BankPlat 
  , synonym KatBank BankPol 
  , synonym KatBank BankPosr 
  , synonym KlVal KlValRas 
where
((
                cDogovor == Dogovor.NRec
and         Dogovor.nRec == AttrDog.cDogovor
and         Dogovor.TiDk == SpDocs.TiDk
and         Dogovor.NRec == SpDocs.cDoc
and        SpDocs.cMCUsl == KatMC.NRec
and        SpDocs.cMCUsl == KatUsl.NRec
and    coGetTune('Boss') == Persons.nRec
and     Persons.PasspRus == Passports.nRec
and         Dogovor.cVal == KlVal.NRec
and      Dogovor.cValRas == KlValRas.NRec
and         Dogovor.cOrg == Post.NRec
and       Dogovor.cMyOrg == Pol.NRec
and             PosrName == Posr.Name
and           Post.cCity == CityPost.NRec
and            Pol.cCity == CityPol.NRec
and           Posr.cCity == CityPosr.NRec
and          Post.cState == StatePost.NRec
and    Dogovor.cBankPlat == BankPlat.NRec
and     Dogovor.cBankPol == BankPol.NRec
))
;
.var
  PSINum: string
  PSIDate: date
  Tovar, FormRasc: string
  OplTov: string
  BankPolRNN, BankPolOKPO: string
  NalOrgAddrImp: string
  NalOrgAddr3: string
  SrokOpl: string
  ValOgovorka: string
  BankNotes: string
.endvar
.begin
  loBD.cDogovor := Comp(nRecД_С);
  if (loBD.GetFirst Post = 0) then {}
  if (loBD.GetFirst Pol = 0) then {}
  if (loBD.GetFirst Persons = 0) then {}
  if (loBD.GetFirst Dogovor = 0) then {
    var ExtAttr: IExtAttr;
    var ExClass: IExtClass;
    var cAttrNam : comp;
    var wTypeAttr: word;

    BankPolRNN    := ExtAttr.sGetAttr(coKatBank, loBD.Dogovor.cBankPol, 'РНН'                    );
    BankPolOKPO   := ExtAttr.sGetAttr(coKatBank, loBD.Dogovor.cBankPol, 'ОКПО'                   );
    NalOrgAddrImp := ExtAttr.sGetAttr(coKatOrg , loBD.Dogovor.cMyOrg  , 'Адрес налогового органа');
    PosrName      := ExtAttr.sGetAttr(coDogovor, Comp(nRecД_С)        , 'Третье лицо'            );
    if (loBD.GetFirst Posr = 0)
    {
      NalOrgAddr3 := ExtAttr.sGetAttr(coKatOrg, loBD.Posr.NRec, 'Адрес налогового органа');
      if (loBD.GetFirst BankPosr where (( loBD.Posr.NRec == BankPosr.cOrg and
                                                 word(1) == BankPosr.Aktiv )) <> 0)
        if (loBD.GetFirst BankPosr
                    where (( loBD.Posr.NRec == BankPosr.cOrg )) = 0) then {}
    }
    Tovar := '';
    loBD._loop SpDocs
     {
      if ((loBD.SpDocs.PrMc = 2) or (loBD.SpDocs.PrMc = 3))
        Tovar := Tovar + if(Tovar = '', '', ',') + KatUsl.Name
      else
        Tovar := Tovar + if(Tovar = '', '', ',') + KatMC.Name;
     }
    PSINum := ExtAttr.sGetAttr(coDogovor, Comp(nRecД_С), 'Паспорт сделки (ПС)');
    // Валютная оговорка
    ValOgovorka := ExtAttr.sGetAttr(coDogovor, Comp(nRecД_С), 'Валютная оговорка');
    // Особые отметки Банка, Таможенного органа
    BankNotes := ExtAttr.sGetAttr(coDogovor, Comp(nRecД_С), 'Особые отметки Банка, Таможенного органа');
    // дата регистрации ПС
    PSIDate := ExtAttr.dGetAttr(coDogovor, Comp(nRecД_С), 'Дата регистрации ПС');

    //форма расчетов
    wTypeAttr:=ExClass.GetClassCode(coDogovor,'Форма расчетов');
    if (wTypeAttr<>0)
     {
       FormRasc:=ExClass.GetSegName(wTypeAttr,Comp(nRecД_С));
     }
    else
     FormRasc:='';

    //оплата товара
    wTypeAttr:=ExClass.GetClassCode(coDogovor,'Оплата товара');
    if (wTypeAttr<>0)
     {
       OplTov:=ExClass.GetSegName(wTypeAttr,Comp(nRecД_С));
     }
    else
     OplTov:='';
  };
end.
.fields
!  ПАСПОРТ СДЕЛКИ ПО ЭКСПОРТУ N  Б^ Б от  Б^ Б
  PSINum
  if (longint(PSIDate) = 0, '', DateToStr(PSIDate, 'DD/MM/YYYY г.'))

!  Реквизиты банка экспортера:
!  Наименование -                    Б^ Б
!  Филиал -
!  Адрес -                           Б^ Б
!  РНН -                             Б^ Б
!  Код ОКПО банка (филиала банка) -  Б^ Б
  loBD.BankPol.Name
  loBD.BankPol.Addr
  BankPolRNN
  BankPolOKPO

!  Реквизиты экспортера:
!  Наименование -                    Б^ Б
!  Код ОКПО -                        Б^ Б
!  Адрес -                           Б^ Б
!  Номер банковского счета -         Б^ Б
!  РНН -                             Б^ Б
!  Адрес налогового органа -         Б^ Б
  loBD.Pol.Name
  loBD.Pol.OKPO
  loBD.Pol.Addr+', '+loBD.CityPol.Name
  loBD.BankPol.Schet1
  loBD.Pol.UNN
  NalOrgAddrImp

!  Реквизиты третьего лица:
!  Наименование -                    Б^ Б
!  Код ОКПО -                        Б^ Б
!  Адрес -                           Б^ Б
!  Номер банковского счета -         Б^ Б
!  РНН -                             Б^ Б
!  Адрес налогового органа -         Б^ Б
  loBD.Posr.Name
  loBD.Posr.OKPO
  loBD.Posr.Addr+', '+loBD.CityPosr.Name
  loBD.BankPosr.Schet1
  loBD.Posr.UNN
  NalOrgAddr3

!  Реквизиты иностранного покупателя:
!  Наименование -                    Б^ Б
!  Страна -                          Б^ Б
!  Адрес -                           Б^ Б
!  Реквизиты банка покупателя -      Б^ Б
  loBD.Post.Name
  loBD.StatePost.Name
  loBD.Post.Addr+', '+loBD.CityPost.Name
  loBD.BankPlat.Name+
    if(loBD.BankPlat.Addr = '', '', ', '+loBD.BankPlat.Addr)+
    if(loBD.BankPlat.Schet1 = '', '', ', р/с'+loBD.BankPlat.Schet1)

!  Номер -                    Б@@@@@@@@@@@@@@@@@@ Б   Последняя дата -       Б^ Б
!  Дата -                     Б@@@@@@@@@@@@@@@@@@ Б   Валюта платежа -       Б^ Б
!  Сумма контракта -          Б&'&&&&&&&&&&&&&.&& Б   Код валюты платежа -   Б^ Б
!  Товар -                    Б@@@@@@@@@@@@@@@@@@ Б   Форма расчетов -       Б^ Б
!  Валюта по контракту -      Б@@@@@@@@@@@@@@@@@@ Б
!  Код валюты по контракту -  Б^ Б
!  Валютная оговорка -        Б^ Б
  loBD.Dogovor.NoDoc DateToStr(loBD.Dogovor.dEnd, 'DD/MM/YYYY')
  loBD.Dogovor.dDoc  if(loBD.Dogovor.cValRas = 0, sGetTune('NDE.SimvRub'), loBD.KlValRas.Dollar)
  loBD.Dogovor.Summa if(loBD.Dogovor.cValRas = 0, sGetTune('NDE.RublISO'), loBD.KlValRas.ISO)
  Tovar FormRasc
  if(loBD.Dogovor.cVal = 0, sGetTune('NDE.SimvRub'), loBD.KlVal.Dollar) 
  if(loBD.Dogovor.cVal = 0, sGetTune('NDE.RublISO'), loBD.KlVal.ISO)

  ValOgovorka

  ''  AttrDog.Sign_My_Post  ''
  ''  AttrDog.Sign_My_Fio   ''
  BankNotes
.endfields

.{ CheckEnter DogGroup
.}


  ПАСПОРТ СДЕЛКИ ПО ЭКСПОРТУ N  Б^ Б
                            от  Б^ Б

  Реквизиты банка экспортера:
  Наименование -                    Б^ Б
  Филиал -
  Адрес -                           Б^ Б
  РНН -                             Б^ Б
  Код ОКПО банка (филиала банка) -  Б^ Б

  Реквизиты экспортера:
  Наименование -                    Б^ Б
  Код ОКПО -                        Б^ Б
  Адрес -                           Б^ Б
  Номер банковского счета -         Б^ Б
  РНН -                             Б^ Б
  Адрес налогового органа -         Б^ Б

  Реквизиты третьего лица:
  Наименование -                    Б^ Б
  Код ОКПО -                        Б^ Б
  Адрес -                           Б^ Б
  Номер банковского счета -         Б^ Б
  РНН -                             Б^ Б
  Адрес налогового органа -         Б^ Б

  Реквизиты иностранного покупателя:
  Наименование -                    Б^ Б
  Страна -                          Б^ Б
  Адрес -                           Б^ Б
  Реквизиты банка покупателя -      Б^ Б

  Реквизиты и условия контракта:
  Номер -                    Б@@@@@@@@@@@@@@@@@@ Б   Последняя дата -       Б^ Б
  Дата -                     Б@@@@@@@@@@@@@@@@@@ Б   Валюта платежа -       Б^ Б
  Сумма контракта -          Б&'&&&&&&&&&&&&&.&& Б   Код валюты платежа -   Б^ Б
  Товар -                    Б@@@@@@@@@@@@@@@@@@ Б   Форма расчетов -       Б^ Б
  Валюта по контракту -      Б@@@@@@@@@@@@@@@@@@ Б
  Код валюты по контракту -  Б^ Б

  Валютная оговорка -        Б^ Б

  Лицензия Национального банка Республики Казахстан:
  Номер лицензии                                 Дата

  Регистрационное свидетельство Национального Банка Республики Казахстан

  Номер регистрационного свидетельства                  Дата

  Подписи уполномоченных лиц:
  От Банка                                  От Экспортера                             От тамож. органа
  Должность  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б    Должность  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б    Должность  Б^ Б
  Фамилия И.О.  Б@@@@@@@@@@@@@@@@@@@@@@@@@ Б    Фамилия И.О.  Б@@@@@@@@@@@@@@@@@@@@@@@@@ Б    Фамилия И.О.  Б^ Б




      М.П.          Дата                        М.П.          Дата                        М.П.          Дата




  Особые отметки банка, таможенного органа:
  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@



.{ CheckEnter Spec
.}
.EndForm
