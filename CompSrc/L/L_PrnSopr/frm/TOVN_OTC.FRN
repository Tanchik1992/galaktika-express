!╔═════════════════════════════════════════════════════════════════════╗
!║      Проект ГАЛАКТИКА (c) 1994,95 TOP SOFT Ltd., АО НОВЫЙ АТЛАНТ    ║
!║  Версия :     4.30                                                  ║
!║  Разработал:  Журавлев Э.И.                                         ║
!║  Назначение: Присоединенная форма отчета по накладной на отпуск     ║
!║  Изменения:                                                         ║
!╚═════════════════════════════════════════════════════════════════════╝
#doc
Накладные на продажу
Отчет по накладной с наценками
#end
.LinkForm 'tovn_12' prototype is 'tovn'
.NameInList 'Отчет по накладной с наценками'
.group 'Накладные на продажу'
#include summa.frn
#include format.frn
.fields
  CommonFormHeader
  Номер_с_дескриптором Дата
  if (Longint(Дата_отгрузки) <> 0,'произведен','не произведен')
  if (Length(Склад) = 0,'',': '+ Склад)
!.if tovn01
  Основание ДатаОснования
!.end // - if tovn01
  Получатель
!.if tovn02
  Назначение
!.end // - if tovn02

  if (Longint(Дата_отгрузки) <> 0,'отпущены','не отпущены')
  '('+НакСимвол+')' '('+НакСимвол+')' '('+НакСимвол+')'
.endfields
.{
#include sum_calc.frn
 ^

 И ОТЧЕТ ПО НАКЛАДНОЙ №  ^ ОТ ^
 Отпуск ^ со склада ^
.if tovn01
 Накладная составлена по счету №  ^ от ^
.end
  Получатель : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.if tovn02
  Назначение : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.end

По накладной ^ следующие материальные ценности : И
 Ш────┬───────────────────────────────┬─────────────┬───────────┬────────┬─────────────┬────────────────────┬────────────────┬─────────┬──────────────
Nп/п│      Название матценности     │  Шифр       │  Единица  │ Кол-во │     Цена    │     Стоимость      │ Заводская цена │ Наценка │ Предельная
    │                               │             │ измерения │        │  @~@@@@@@@@ │    @~@@@@@@@@@@    │@~@@@@@@@@@@@@@@│   (%)   │ наценка (%)
────┴───────────────────────────────┴─────────────┴───────────┴────────┴─────────────┴────────────────────┴────────────────┴─────────┴──────────────
.fields
 Номер_пп Название КодМЦ
 if (ОтпЕд = '',УчЕд,ОтпЕд)
 КолФ Цнак СтНак
 DoubleToStr(Цена_изготовителяВалНак, Cena_Pr)
 if (Цена_изготовителяВалНак <> 0,(ЦНак / Цена_изготовителяВалНак - 1) * 100, 0)
 МаксПроцНаценки
 .endfields
.{
@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@ @@@@@@@@@@@ @@@@@@@@ &&&&&&&&&&&&&& &&&&&&&&&&&&&&&&&&& &&&&&&&&&&&&&&&& &&&&&&.&& &&&&&&&&&&&.&&
.}
.{ CHECKENTER TOVNUSL
.}
.fields
  DoubleToStr(Summa, Cena_Pr)
  СпецСимвол
.endfields
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 БИтого по накладной :                                                                   &&&&&&&&&&&&&&&&&&& Щ

.{
.}
#ifdef __SKYSHOP__
#include sky.inc
#end
   ^
.}
.endform

#doc
Накладные на продажу
Накладная на отпуск товаров на сторону (вал-руб) с услугами
#end
.linkform 'tovn_13' prototype is tovn
.NameInList 'Накладная на отпуск товаров на сторону (вал-руб) с услугами'
.group 'Накладные на продажу'
#include summa.frn
.var
 s1,s2,sv1,sv2:double
 АСтНацСН:double
 АСтВалСН:double
 sumusl:double
 vsumusl:double
 firstusl:boolean
 npp: word;
.endvar
#include format.frn
.fields
 CommonFormHeader
 Поставщик
 Номер_с_дескриптором
 Дата Склад
 Основание ДатаОснования
 Назначение
 Получатель ДовЛицо
 НацСимвол ВалСимвол НацСимвол ВалСимвол
 npp
 КодМЦ Название ОтпЕд КолДО КолФ ЦНац ЦВал СтНац СтВал
!.{ CHECKENTER TOVUSL
 npp
  КодУслуги НазваниеУслуги ОтпЕдИзмУслуги
  КолДУслуги КолФУслуги
  ЦенаУслуги ЦенаВалУслуги
  DoubleToStr(КолФУслуги * ЦенаУслуги, Cena_PrR)
  DoubleToStr(КолФУслуги * ЦенаВалУслуги, Cena_PrV)
!.}
 DoubleToStr(s1+s2, Cena_PrR)
 DoubleToStr(sv1+sv2, Cena_PrV)
 стр_АНаименований
 DoubleToStr(АСтНацСН+sumusl, Cena_PrR)  НацСимвол
 DoubleToStr(АСтВалСН+vsumusl, Cena_PrV) ВалСимвол
 Главный_Бухгалтер
 СпецСимвол
.endfields
.{
.begin
 АСтНацСН := 0;
 АСтВалСН := 0;
 sumusl   := 0;
 vsumusl  := 0;
 s1       := 0;
 s2       := 0;
 sv1      := 0;
 sv2      := 0;
 npp      := 1;
end.
#include sum_calc.frn
 ^

 Организация : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

              НАКЛАДНАЯ №  ^  НА ОТПУСК МАТЕРИАЛОВ НА СТОРОНУ
                        от ^

 Склад       : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.if tovn01
 Основание   : №  ^ от ^
.end
.if tovn02
 Назначение  : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.end
 Получатель  : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 Через       : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

 Ш ───┬──────────────┬─────────────────────────┬─────────┬─────────────────────────┬───────────────────────────┬──────────────────────────────
  № │Номенклатурный│       Наименование      │ Единица │       Количество        │           Цена            │ Стоимость
 п/п│    номер     │            МЦ           │измерения├────────────┬────────────┼─────────────┬─────────────┼───────────────┬──────────────
    │              │                         │         │по документу│ фактически │ в @~@@@@@@  │ в @~@@@@@@  │  в @~@@@@@@   │ в @~@@@@@@
 ───┴──────────────┴─────────────────────────┴─────────┴────────────┴────────────┴─────────────┴─────────────┴───────────────┴──────────────
.{
.{?Internal; Признак_МЦ = 1
 @@@ @@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@ &&&&&&&&&&&& &&&&&&&&&&&& &&&&&&&&&&&&& &&&&&&&&&&&&& &&&&&&&&&&&&&&& &&&&&&&&&&&&&&
.begin
 s1       := s1  + СтНац;
 sv1      := sv1 + СтВал;
 АСтНацСН := АСтНацСН + СтНацСН0;
 АСтВалСН := АСтВалСН + СтВалСН;
 npp      := npp + 1;
end.
.}
.}
.begin
 firstusl:=true
end.
.{ CHECKENTER TOVNUSL
.{?Internal;firstusl=true
   ВУслуги по накладной : В
.}
.begin
 firstusl:=false
end.
 @@@ @@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@ &&&&&&&&&&&& &&&&&&&&&&&& &&&&&&&&&&&&& &&&&&&&&&&&&& &&&&&&&&&&&&&&& &&&&&&&&&&&&&&
.begin
 s2      := s2  + (КолФУслуги * ЦенаУслуги);
 sv2     := sv2 + (КолФУслуги * ЦенаВалУслуги);
 sumusl  := sumusl  + У_СтНацСН;
 vsumusl := vsumusl + У_СтВалСН;
 npp     := npp + 1;
end.
.}
                                                                                                       БИтого : &&&&&&&&&&&&&&& &&&&&&&&&&&&&& Б

 БВсего отпущено наименований : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 на сумму : &&&&&&&&&&&&&& @@@@@@@@@@
          : &&&&&&&&&&&&&& @@@@@@@@@@ Щ
 Ш

  Отпуск разрешил _____________________                                Гл.(старший) бухгалтер _____________________@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

  Отпустил ____________________________                                Получил ____________________________________ Ш

.{
.}
#ifdef __SKYSHOP__
#include sky.inc
#end
   ^
.}
.endform

#doc
Накладные на продажу
Накладная на отпуск товаров на сторону (н.д.е.) с услугами
#end
.linkform 'tovn_14' prototype is tovn
.NameInList 'Накладная на отпуск товаров на сторону (н.д.е.) с услугами'
.group 'Накладные на продажу'
#include summa.frn
.var
 s1,s2:double
 sumusl:double
 АСтНацСН : double
 firstusl:boolean
 npp: word;
.endvar
#include format.frn
.fields
 CommonFormHeader
 Поставщик
 Номер_с_дескриптором
 Дата Склад
 Основание ДатаОснования
 Назначение
 Получатель ДовЛицо
 НацСимвол НацСимвол
 npp
 КодМЦ Название ОтпЕд КолДО КолФ ЦНац СтНац
!.{ CHECKENTER TOVUSL
 npp
  КодУслуги НазваниеУслуги ОтпЕдИзмУслуги
  КолДУслуги КолФУслуги
  ЦенаУслуги
  DoubleToStr(КолФУслуги * ЦенаУслуги, Cena_Pr)
!.}
 DoubleToStr(s1+s2, Cena_PrR) стр_АНаименований
 DoubleToStr(АСтНацСН+sumusl, Cena_PrR) НацСимвол
 Главный_Бухгалтер
 СпецСимвол
.endfields
.{
.begin
 АСтНацСН := 0;
 sumusl   := 0;
 s1       := 0;
 s2       := 0;
 npp      := 1;
end.
#include sum_calc.frn
 ^

 Организация : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

              НАКЛАДНАЯ №  ^  НА ОТПУСК МАТЕРИАЛОВ НА СТОРОНУ
                        от ^

 Склад       : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.if tovn01
 Основание   : №  ^ от ^
.end
.if tovn02
 Назначение  : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.end
 Получатель  : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 Через       : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

 Ш ───┬──────────────┬─────────────────────────┬─────────┬─────────────────────────┬─────────────┬───────────────
  № │Номенклатурный│       Наименование      │ Единица │       Количество        │     Цена    │  Стоимость
 п/п│    номер     │            МЦ           │измерения├────────────┬────────────┼─────────────┼───────────────
    │              │                         │         │по документу│ фактически │ в @~@@@@@@  │  в @~@@@@@@
 ───┴──────────────┴─────────────────────────┴─────────┴────────────┴────────────┴─────────────┴───────────────
.{
.{?Internal; Признак_МЦ = 1
 @@@ @@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@ &&&&&&&&&&&& &&&&&&&&&&&& &&&&&&&&&&&&& &&&&&&&&&&&&&&&
.begin
 s1       := s1 + СтНац;
 АСтНацСН := АСтНацСН + СтНацСН0;
 npp      := npp + 1;
end.
.}
.}
.begin
 firstusl:=true
 sumusl:=0;
end.
.{ CHECKENTER TOVNUSL
.{?Internal;firstusl=true
 В  Услуги по накладной : В
.}
.begin
 firstusl:=false
end.
 @@@ @@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@ &&&&&&&&&&&& &&&&&&&&&&&& &&&&&&&&&&&&& &&&&&&&&&&&&&&&
.begin
 s2     := s2 + (КолФУслуги * ЦенаУслуги);
 sumusl := sumusl + У_СтНацСН;
 npp    := npp + 1;
end.
.}
                                                                                         БИтого : &&&&&&&&&&&&&&& Б

 БВсего отпущено наименований : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                   на сумму : &&&&&&&&&&&&& @@@@@@@@@ Щ
 Ш

 Отпуск разрешил ___________________                             Гл.(старший) бухгалтер __________________@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

 Отпустил __________________________                             Получил _________________________________ Ш

.{
.}
#ifdef __SKYSHOP__
#include sky.inc
#end
   ^
.}
.endform
