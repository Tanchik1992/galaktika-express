/*
 ╔═══════════════════════════════════════════════════════════════════════════╗
 ║                     (c) 1994,97 корпорация ГАЛАКТИКА                      ║
 ║ Проект        : ГАЛАКТИКА                                                 ║
 ║ Система       : Приходные накладные                                       ║
 ║ Версия        : 5.8х                                                      ║
 ║ Назначение    : Приходные накладные в бизнес-тексте                       ║
 ╚═══════════════════════════════════════════════════════════════════════════╝
*/

!Общие формы накладных
#include ttn_comm.frn

!===============================================================================
!
#doc
Учетная карточка импортируемых товаров
#end
.linkform 'ttn_prih02' prototype is 'tovn'
.NameInList 'Учетная карточка импортируемых товаров'
.group 'Приходные накладные'
.create view loKS
var
  cKatSopr     : comp;
  cBaseDocNRec : comp;
from
    KatSopr
  , SpSopr
  , BaseDoc
  , KlVal
  , synonym KatOrg Pol
  , synonym KatBank BankPol
  , KatOtpEd
where
((
  cKatSopr           == KatSopr.NRec    and
  KatSopr.cValut     == KlVal.NRec      and
  KatSopr.Nrec       == SpSopr.cSopr    and
  SpSopr.cSpStep     == SpStep.NRec     and
  SpStep.cStepDoc    == StepDoc.NRec    and
  StepDoc.cBaseDoc   == BaseDoc.NRec    and
  coGetTune('MyOrg') == Pol.NRec        and
  BaseDoc.cMyBank    == BankPol.NRec    and
  SpSopr.cOtpEd      == KatOtpEd.NRec

))
;
.var
  PSINum: string
  FormRasc: string
  NomerDO: string;
  DateDO : Date;
.endvar
.begin
  loKS.cKatSopr := накладная_нрек;
  if (loKS.GetFirst KatSopr = 0) then {
    var ExAttr : iExtAttr;
    var ExClass: iExtClass;
    var wTypeAttr: word;
    cBaseDocNRec:=loKS.BaseDoc.NRec

    // ПС
    PSINum := ExAttr.sGetAttr(coBaseDoc, cBaseDocNRec, 'Паспорт сделки (ПС)');

    //форма расчетов
    wTypeAttr:=ExClass.GetClassCode(coBaseDoc,'Форма расчетов');
    if (wTypeAttr<>0)
     {
       FormRasc:=ExClass.GetSegName(wTypeAttr,cBaseDocNRec);
       if (Length(FormRasc) > 2) then FormRasc:=SubStr(FormRasc,1,2);
     }
    else
     FormRasc:='';
  };
end.
.fields
  CommonFormHeader
  '' PSINum ''
  loKS.BankPol.Schet1 loKS.Pol.Name
  loKS.Pol.OKPO
  NomerDO if(DateDO = date(0,0,0), '', DateToStr(DateDO, 'DD.MM.YYYY'))
  Номер loKS.SpSopr.dOprTTN
  КодМЦ Номер_пп СтВалСН
  loKS.KlVal.ISO FormRasc КолФ loKS.KatOtpEd.bKod
  СпецСимвол
.endfields
.{
^
.if tovn01
.end
.if tovn02
.end
.{
.begin
  if (loKS.GetFirst SpSopr where ((спецификацияМЦ_нрек==SpSopr.NRec))=0) {}
  NomerDO := Основание;
  DateDO  := ДатаОснования;
end.
                        БУЧЕТНАЯ КАРТОЧКА ИМПОРТИРУЕМЫХ ТОВАРОВ Б
 И┌──────────┬───┬────────────────────────────────────────────────┬────┬───────────────────┐
│ №  Б@@@@@@ Б │   │ ПСи- Б@@@@@@@@@@@@@@@@@@@@@@@@@ Б                  │    │ КС -  Б@@@@@@@@@@ Б   │
├──────────┴───┴─────────────────┬──────────────────────────────┴────┴───────────────────┤
│ В.сч. -  Б@@@@@@@@@@@@ Б           │ Импортер -  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б │
├──────────────────────┬─────────┴───────────────────────────────────────────────────────┤
│ ОКПО -  Б@@@@@@@@ Б      │ Контракт №  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б                      │
├──────────────────────┼─────────────────────────────────────────┬───────────────────────┤
│ Дата -  Б@@@@@@@@@@ Б    │ ГТД -  Б@@@@@@@@@@@@@@@@@@@ Б               │ Дата В. -  Б@@@@@@@@@@ Б  │
├───┬──────────────────┴──────────┬──────────────────┬───────────┴────────────┬──────────┤
│   │ Товар -  Б@@@@@@@@@ Б           │                  │                        │          │
├───┼──┬──┬──┬──┬──┬──┬──┬──┬──┬──┤Номер товара -  Б@@ Б │Сумма Т -  Б&&&&&&&&&&&&&& Б├──────────┤
│   │  │  │  │  │  │  │  │  │  │  │                  │                        │          │
├───┴──┴──┴┬─┴──┴──┼──┴──┼──┴──┴──┴──────────────────┴───────┬────────────────┴──────────┤
│Информация│  КВ   │  ФР │ Количество товара                 │ Единица измерения         │
│          ├───────┼─────┼───────────────────────────────────┼───────────────────────────┤
│ о товаре │  Б@@@ Б   │   Б@@ Б │  Б&&&&&&&&&&&&&&&& Б                  │  Б@@@@@@@@@@ Б                │
├──────────┴───────┴─────┴───────────────────────────────────┴───────────────────────────┤
│ Особые отметки _______________________________________________________________________ │
│ ______________________________________________________________________________________ │
└────────────────────────────────────────────────────────────────────────────────────────┘
                                                            М.П.             И.О.Фамилия И






.}
.{ CHECKENTER TOVNUSL
.}
.{
.}
#ifdef __SKYSHOP__
#include sky.inc
#end
 ^
.}
.endform
