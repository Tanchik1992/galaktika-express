/*
 ╔═══════════════════════════════════════════════════════════════════════════╗
 ║                       (c) 2002 корпорация ГАЛАКТИКА                       ║
 ║ Проект        : ГАЛАКТИКА                                                 ║
 ║ Система       : Оперативный контур                                        ║
 ║ Версия        : 5.83 (ArtDesign)                                          ║
 ║ Назначение    : Форма парной накладной на отпуск МЦ пачками и россыпью    ║
 ║ Ответственный : Двинский Сергей Леонидович                                ║
 ╚═══════════════════════════════════════════════════════════════════════════╝
*/

#include predefs.inc

#doc
Форма парной накладной на отпуск МЦ пачками и россыпью
#end
.form 'TTNdouble'
.hide
.var
  Counter : word
  MCNum : double
  PacksNum : double
  MCWholeNum : double
  PacksWholeNum : double
  xx : boolean
  ii : integer
  NeedBottom : boolean
.endvar
.{
.fields
   is_double : boolean
   nakl_mode : byte
   номер_накладной : string
!   тип_комплектации : string
   склад : string
   получатель : string
   договор    : string

   время_печати : time
   примечание : string
   способ_отгрузки : string
   форма_расчета : string
   менеджер : string
   адрес_получателя : string
.endfields
 ^^^^^^
 ^^^^^^
.{
.fields
   Стеллаж : string
   Артикул : string
   Количество : double
   МЦ : string
   КоличествоПачек : double
   Конверт : string
   LastRecord : boolean

   OtkrWholeNum : double
   KonvWholeNum : double
.endfields
^^^^^^ ^ ^^
.}
.fields
  WholeSum : string
!  Ender : string
.endfields
^
.}
.endform


#doc
Форма парной накладной на отпуск МЦ пачками и россыпью
#end
.linkform 'TTNdoubleR' prototype is 'TTNdouble'
.DEFP PA4
.DEFO PORTRAIT
.PAPER PA4
.ORIENT PORTRAIT
.LL 80
.LM 12
.TM 10
.BM 10
.RM 1
.P 59
.{
.fields
   if (is_double, 'Парная накладная','       Накладная')
   номер_накладной
!   тип_комплектации
   if (nakl_mode = 0,'пачками','россыпью')
   склад
   получатель
   договор

   время_печати

   if (is_double, 'Парная накладная','       Накладная')
   номер_накладной
!   тип_комплектации
   if (nakl_mode = 0,'пачками','россыпью')
   примечание
   способ_отгрузки
   форма_расчета
   склад
   менеджер
   получатель
   договор
   адрес_получателя
.endfields
.[H SKIP

 И                   Б@@@@@@@@@@@@@@@@ № @@@@@@@@@@@@@@@@@@@@@@@@@@@ Комплектация @@@@@@@@@@ Б
 Склад     :  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
 Кому      :  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
 Основание :  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б Лист @NP@ И
.{?INTERNAL; nakl_mode = 0
 Й┌───┬────────────┬─────────────────┬────────┬─────────────────────────────────────┬─────┐
│ № │  Стеллаж   │     Артикул     │ Кол-во │            Наименование             │Пачки│
│   │            │                 │   шт.  │              Нагрузка               │     │ Й
.}
.{?INTERNAL; nakl_mode > 0
 Й┌───┬────────────┬─────────────────┬────────┬───────────────────────────────────────────┐
│ № │   Ячейка   │     Артикул     │ Кол-во │                 Наименование              │
│   │            │                 │   шт.  │                   Нагрузка                │ Й
.}
.begin
  MCNum := 0;
  PacksNum := 0;
end.
.]H
 И Всего мест __________________________________________________       Время печати  Б@@@@@ Б

                   Б@@@@@@@@@@@@@@@@ № @@@@@@@@@@@@@@@@@@@@@@@@@@@@ Комплектация @@@@@@@@@ Б
 Р┌──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│ ВСтрока примечаний В @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ │
└──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘ Ш
 И Способ отгрузки:  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б Форма расчета:  Б@@@@@@@@@@@@@@@ Б
 Склад     :  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б Менеджер:  Б@@@@@@@@@@@@@@@ Б
 Кому      :  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
 Основание :  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
 Адрес грузополучателя:  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б Лист@NP@
.{?INTERNAL; nakl_mode = 0
 Б┌───┬────────────┬─────────────────┬────────┬─────────────────────────────────────┬─────┐
│ № │  Стеллаж   │     Артикул     │ Кол-во │            Наименование             │Пачки│
│   │            │                 │   шт.  │              Нагрузка               │     │ Й
.}
.{?INTERNAL; nakl_mode > 0
 Й┌───┬────────────┬─────────────────┬────────┬───────────────────────────────────────────┐
│ № │   Ячейка   │     Артикул     │ Кол-во │                 Наименование              │
│   │            │                 │   шт.  │                   Нагрузка                │ Й
.}
.begin
  Counter := 0;
  MCNum := 0;
  PacksNum := 0;
  MCWholeNum := 0;
  PacksWholeNum := 0;
end.
.{
.begin
  Counter := Counter + 1;
  MCNum := MCNum + Количество;
  PacksNum := PacksNum + КоличествоПачек;
  MCWholeNum := MCWholeNum + Количество;
  PacksWholeNum := PacksWholeNum + КоличествоПачек;
  ii := if(Counter < 15, (14 - Counter mod 14)*3, (16 - (Counter-14) mod 16)*3);
  if (ii > 10) ii := 0;
  xx := LastRecord and not (ii > 0);
  NeedBottom := ii > 0;
end.
.{?INTERNAL; nakl_mode = 0
.fields
   Counter   Стеллаж   Артикул   Количество   МЦ   КоличествоПачек   Конверт
.endfields
 Й├───┼────────────┼─────────────────┼────────┼─────────────────────────────────────┼─────┤
│&~&│@~@@@@@@@@@@│@~@@@@@@@@@@@@@@@│&~&&&&&&│ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│&~&&&│
│   │            │                 │        │ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│     │ Й
.}
.{?INTERNAL; nakl_mode > 0
.fields
   Counter   Стеллаж   Артикул   Количество   МЦ   Конверт
.endfields
 Й├───┼────────────┼─────────────────┼────────┼───────────────────────────────────────────┤
│&~&│@~@@@@@@@@@@│@~@@@@@@@@@@@@@@@│&~&&&&&&│ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│
│   │            │                 │        │ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│ Й
.}
.[F
.fields
  if(xx,'┬','─')
  if(nakl_mode = 0,'┼','─')
  if(xx,'ИТОГО','ИТОГО по странице')
  if(xx,string(LongInt(MCWholeNum)), string(LongInt(MCNum)) )
  if(xx,string(LongInt(OtkrWholeNum)),'')
  if(xx,'│',' ')
  if(xx,string(LongInt(KonvWholeNum)),'')
  if(nakl_mode = 0,'│',' ')
  if(nakl_mode = 0, if (xx,string(LongInt(PacksWholeNum)),string(LongInt(PacksNum))),'')
  if(xx,'┴','─')
  if(nakl_mode = 0,'┴','─')
.endfields
 Й├───┴────────────┴─────────────────┼────────┼───────────────────@─────────────────@─────┤
│ @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ │&~&&&&&&│ &~&&&&&&&&&&&&&&& @ &~&&&&&&&&&&&&& @&~&&&│
└──────────────────────────────────┴────────┴───────────────────@─────────────────@─────┘ Й
.]F
.}
.{while(ii > 0)
.begin
  ii := ii - 1;
end.

.}
.{?INTERNAL; NeedBottom
.fields
  '┬'
  if(nakl_mode = 0,'┼','─')
  'ИТОГО'
  MCWholeNum
  if(nakl_mode = 0, MCWholeNum, OtkrWholeNum)
  '│'
  KonvWholeNum
  if(nakl_mode = 0,'│',' ')
  if(nakl_mode = 0, string(LongInt(PacksWholeNum)), '')
  '┴'
  if(nakl_mode = 0,'┴','─')
.endfields
 Й├───┴────────────┴─────────────────┼────────┼───────────────────@─────────────────@─────┤
│ @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ │&~&&&&&&│ &~&&&&&&&&&&&&&&& @ &~&&&&&&&&&&&&& @&~&&&│
└──────────────────────────────────┴────────┴───────────────────@─────────────────@─────┘ Й
.}
.fields
  WholeSum
.endfields

 И  На сумму:  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б

  Диспетчер ________________________________      Сдал   ______________________________

  Собрал    ________________________________

  Упаковщик ________________________________      Принял ______________________________ И


.}
.endform
