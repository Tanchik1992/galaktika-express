!О заполнении колонок:
!11 - цена без каких-либо налогов                          - Цена_нацБН
!12 - сумма без каких-либо налогов                         - Цена_нацБН * Кол_факт
!14 - только НДС ("чистый", без каких-либо других налогов) - суммаНДС
!15 - сумма со ВСЕМИ налогами (цена+НДС+другие налоги)     - Цена_нацСН * Кол_факт
#doc
Товарная накладная(форма №ТОРГ-12)
#end
.LinkForm 'torg_12' prototype is prihnkl
.NameInList 'Товарная накладная(форма №ТОРГ-12)'
.DEFO LANDSCAPE
.p 60
!.O1 8
.Set Filler = '-'
.var
  KolItog, MassaBrItog, MassaNetItog, Sum1Itog, Sum2Itog,Sum3Itog :Double;
  KolItogFull, MassaBrItogFull, MassaNetItogFull,
  Sum1ItogFull, Sum2ItogFull, Sum3ItogFull :Double;

  Nom,NomFull,kol1,fixkol1,kol2,fixkol2 :Word;
  СпСимвол:string
.endvar
#include mfo.frn
#include format.frn
.fields
! CommonFormHeader

Грузоотправитель
  + unn_         + ГрузоотправительУНН
  + ' Адрес:'    + Грузоотправитель_Адрес
  + ' Банк:'     + Грузоотправитель_БАНК_Имя
  + ' р/с '      + Грузоотправитель_БАНК_Счет
  + mfo_         + Грузоотправитель_БАНК_Мфо
  + ' тел.: '    + Грузоотправитель_ТЕЛ
Грузоотправитель_ОКПО
  Склад
  Получатель_ОКОНХ               // KatOrg.OKONH

Грузополучатель
  + unn_         + ГрузополучательУНН
  + ' Адрес:'    + Грузополучатель_Адрес
  + ' Банк:'     + Грузополучатель_БАНК_Имя
  + ' р/с '      + Грузополучатель_БАНК_Счет
  + mfo_         + Грузополучатель_БАНК_Мфо
  + ' тел.: '    + Грузополучатель_ТЕЛ
Грузополучатель_ОКПО
Поставщик
  + unn_         + ПоставщикУНН
  + ' Адрес:'    + Поставщик_Адрес
  + ' Банк:'     + Поставщик_БАНК_Имя
  + ' р/с '      + Поставщик_БАНК_Счет
  + mfo_         + Поставщик_БАНК_Мфо
  + ' тел.: '    + Поставщик_ТЕЛ
Поставщик_ОКПО
Получатель
  + unn_         + ПолучательУНН
  + ' Адрес:'    + Получатель_Адрес
  + ' Банк:'     + Получатель_БАНК_Имя
  + ' р/с '      + Получатель_БАНК_Счет
  + mfo_         + Получатель_БАНК_Мфо
  + ' тел.: '    + Получатель_ТЕЛ
Получатель_ОКПО

 Основание
// DateToStr(ДатаОснования, 'DD/MM/YYYY')
 if (ДатаОснования=date(0,0,0),'',DateToStr(ДатаОснования,'DD/MM/YYYY'))
 Номер_накладной
// DateToStr(Дата_накладной, 'DD/MM/YYYY')
 if (Дата_накладной=date(0,0,0),'',DateToStr(Дата_накладной,'DD/MM/YYYY'))

!.{
 Nom
 Товар
 Код_Товара
 УчЕдиница
! if (УчЕдиница<>Единица, Единица,'')
  Единица
 DoubleToStr((КолУч/Кол_факт), Kol_Pr)
 DoubleToStr(Кол_факт, '666666666666666')
! (Масса+МассаТары)*Кол_факт
!  Масса*Кол_факт
 DoubleToStr((Масса+МассаТары)*Кол_факт*(КолУч/Кол_факт), Massa_Pr)
  DoubleToStr(Масса*Кол_факт*(КолУч/Кол_факт), Massa_Pr)

  Цена_нацБН
  DoubleToStr(Цена_нацБН * Кол_факт, Cena_PrR)

  ставкаНДС
  DoubleToStr(суммаНДС, Cena_PrR)

  DoubleToStr(Цена_нацСН * Кол_факт, Cena_PrR)
!.}
!.[F
  DoubleToStr(KolItog, '666666666666666')
  DoubleToStr(MassaBrItog, Massa_Pr)
  DoubleToStr(MassaNetItog, Massa_Pr)
  DoubleToStr(Sum1Itog, Cena_PrR)
  DoubleToStr(Sum2Itog, Cena_PrR)
  DoubleToStr(Sum3Itog, Cena_PrR)
  СпСимвол
!.]F
!.[F
  DoubleToStr(KolItog, '666666666666666')
  DoubleToStr(MassaBrItog, Massa_Pr)
  DoubleToStr(MassaNetItog, Massa_Pr)
  DoubleToStr(Sum1Itog, Cena_PrR)
  DoubleToStr(Sum2Itog, Cena_PrR)
  DoubleToStr(Sum3Itog, Cena_PrR)
  СпСимвол
!.]F
  DoubleToStr(KolItogFull, '666666666666666')
  DoubleToStr(MassaBrItogFull, Massa_Pr)
  DoubleToStr(MassaNetItogFull, Massa_Pr)
  DoubleToStr(Sum1ItogFull, Cena_PrR)
  DoubleToStr(Sum2ItogFull, Cena_PrR)
  DoubleToStr(Sum3ItogFull, Cena_PrR)

  DoubleToStr(NomFull, '4\m')
  DoubleToStr(MassaNetItogFull, '4\m')
  DoubleToStr(KolItogFull, '4\n')
  DoubleToStr(MassaBrItogFull, '4\m')
  if(номер_доверенности <> '', номер_доверенности, '__________')
  if(LongInt(дата_доверенности) <> LongInt(0),
     DateToStr(дата_доверенности, 'DD mon YYYY'), '__________________')
  DoubleToString(comp(0), Round(Sum3ItogFull,GetPrecisionGroup('brForSopr_Price')))
  доверенность_кому_выдана
  if(МОЛ_Должность <> '', МОЛ_Должность, '______________________')
  if(Мол <> '', Мол, '______________________________')
 СпСимвол
.endfields
.{
! ^
.begin
  СпСимвол:='';
  kol1:=0;fixkol1:=6;kol2:=0;fixkol2:=29;

  NomFull         :=0;
  KolItogFull     :=0;
  MassaBrItogFull  :=0;
  MassaNetItogFull :=0;
  Sum1ItogFull     :=0;
  Sum2ItogFull     :=0;
  Sum3ItogFull     :=0;

  Nom:=0;
  KolItog      :=0;
  MassaBrItog  :=0;
  MassaNetItog :=0;
  Sum1Itog     :=0;
  Sum2Itog     :=0;
  Sum3Itog     :=0;
end.
 Р                                                                                                                                               Унифицированная форма N°ТОРГ-12 Р
 Р                                                                                                                                               Утверждена постановлением Госкомстата Р
 Р                                                                                                                                               России от 25.12.1998  N°132 Р
 Р                                                                                                                                                              _____________________  Р
 Р                                                                                                                                                              Д│         Код         │ Д Р
 Р                                                                                                                                               Форма по ОКУД  Д│       0330212       │ Д Р
 РОрганизация-грузоотправитель  З@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ З по ОКПО  Д│@~@@@@@@@@@@@@@@@@@@@│ Д Р
 РПодразделение  З@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ З Д│                     │ Д Р
 Р                                                                                                                                    Вид деятельности по ОКДП  Д│@~@@@@@@@@@@@@@@@@@@@│ Д Р
 РГрузополучатель   З@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ З по ОКПО  Д│@~@@@@@@@@@@@@@@@@@@@│ Д Р
 РПоставщик         З@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ З по ОКПО  Д│@~@@@@@@@@@@@@@@@@@@@│ Д Р
 РПлательщик        З@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ З  Дпо ОКПО │@~@@@@@@@@@@@@@@@@@@@│ Д Р
 РОснование         З                                                                                                                                    З  Д│ номер │@~@@@@@@@@@@@@@@@@@@@│ Д Р
 Р                                                                                                                                                      Д│  дата │@~@@@@@@@@@@@@@@@@@@@│ Д Р
 Р                                                                     ┌───────────────┬────────────────┐                      Транспортная накладная   Д│ номер │                     │ Д Р
 Р                                                                     │Номер документа│Дата составления│                                               Д│  дата │                     │ Д Р
 Р                                                  ТОВАРНАЯ НАКЛАДНАЯ ├───────────────┼────────────────┤                                         Вид операции  Д│                     │ Д
                                                                     │@~@@@@@@@@@@@@@│@~@@@@@@@@@@@@@@│
                                                                     └───────────────┴────────────────┘ Р
 Ш┌───┬─────────────────────────────────────────────────┬─────────────────┬─────────┬───────────────────────┬─────────────┬─────────────┬───────────────┬──────────────────┬─────────────────────┬──────────────────┐ Ш
 Ш│   │                     Товар                       │ Един. измерения │         │      Количество       │             │             │               │                  │         НДС         │                  │ Ш
 Ш│ N°├───────────────────────────────────┬─────────────┼─────────┬───────┤   Вид   ├───────────┬───────────┤    Масса    │ Количество  │      Цена,    │    Сумма без     ├─────┬───────────────┤  Сумма с учетом  │ Ш
 Ш│п/п│   наименование, характеристика,   │     код     │  наиме- │ код по│упаковки │  в одном  │   мест,   │   брутто    │   (масса    │    руб.коп.   │    учета НДС     │став-│     сумма     │       НДС,       │ Ш
 Ш│   │      сорт, артикул товара         │             │ нование │  ОКЕИ │         │   месте   │   штук    │             │    нетто)   │               │     руб.коп.     │ка, %│    руб.коп.   │     руб.коп.     │ Ш
 Ш├───┼───────────────────────────────────┼─────────────┼─────────┼───────┼─────────┼───────────┼───────────┼─────────────┼─────────────┼───────────────┼──────────────────┼─────┼───────────────┼──────────────────┤ Ш
 Ш│ 1 │               2                   │      3      │    4    │   5   │    6    │     7     │     8     │      9      │     10      │      11       │        12        │ 13  │      14       │        15        │ Ш
 Ш├───┼───────────────────────────────────┼─────────────┼─────────┼───────┼─────────┼───────────┼───────────┼─────────────┼─────────────┼───────────────┼──────────────────┼─────┼───────────────┼──────────────────┤ Ш
.{
!.[h Skip
.{?Internal;kol1=fixkol1 or kol2=fixkol2
.begin
!  Nom          :=0;
  kol2:=0;
  KolItog      :=0;
  MassaBrItog  :=0;
  MassaNetItog :=0;
  Sum1Itog     :=0;
  Sum2Itog     :=0;
  Sum3Itog     :=0;
end.
 Ш                                                                                                                                                                                  Оборотная сторона формы N°ТОРГ-12 Ш
 Ш┌───┬─────────────────────────────────────────────────┬─────────────────┬─────────┬───────────────────────┬─────────────┬─────────────┬───────────────┬──────────────────┬─────────────────────┬──────────────────┐ Ш
 Ш│   │                     Товар                       │ Един. измерения │         │      Количество       │             │             │               │                  │         НДС         │                  │ Ш
 Ш│ N°├───────────────────────────────────┬─────────────┼─────────┬───────┤   Вид   ├───────────┬───────────┤    Масса    │ Количество  │      Цена,    │    Сумма без     ├─────┬───────────────┤  Сумма с учетом  │ Ш
 Ш│п/п│   наименование, характеристика,   │     код     │  наиме- │ код по│упаковки │  в одном  │   мест,   │   брутто    │   (масса    │    руб.коп.   │    учета НДС     │став-│     сумма     │       НДС,       │ Ш
 Ш│   │      сорт, артикул товара         │             │ нование │  ОКЕИ │         │   месте   │   штук    │             │    нетто)   │               │     руб.коп.     │ка, %│    руб.коп.   │     руб.коп.     │ Ш
 Ш├───┼───────────────────────────────────┼─────────────┼─────────┼───────┼─────────┼───────────┼───────────┼─────────────┼─────────────┼───────────────┼──────────────────┼─────┼───────────────┼──────────────────┤ Ш
 Ш│ 1 │               2                   │      3      │    4    │   5   │    6    │     7     │     8     │      9      │     10      │      11       │        12        │ 13  │      14       │        15        │ Ш
 Ш├───┼───────────────────────────────────┼─────────────┼─────────┼───────┼─────────┼───────────┼───────────┼─────────────┼─────────────┼───────────────┼──────────────────┼─────┼───────────────┼──────────────────┤ Ш
.}
!.]h
.begin
  inc(kol1); inc(kol2);
  inc(Nom);
  Стоим_нацБН:=Стоим_нацСН-суммаНДС;
  KolItog      :=KolItog + Кол_факт;

  MassaBrItog  :=MassaBrItog + (Масса+МассаТары)*Кол_факт*(КолУч/Кол_факт);
  MassaNetItog :=MassaNetItog + Масса*Кол_факт*(КолУч/Кол_факт);
  Sum1Itog     :=Sum1Itog + Цена_нацБН * Кол_факт;
  Sum2Itog     :=Sum2Itog + суммаНДС;
  Sum3Itog     :=Sum3Itog + Цена_нацБН * Кол_факт + суммаНДС;

  inc(NomFull);
  KolItogFull      :=KolItogFull + Кол_факт;
  MassaBrItogFull  :=MassaBrItogFull + (Масса+МассаТары)*Кол_факт*(КолУч/Кол_факт);
  MassaNetItogFull :=MassaNetItogFull + Масса*Кол_факт*(КолУч/Кол_факт);
  Sum1ItogFull     :=Sum1ItogFull + Цена_нацБН * Кол_факт;
  Sum2ItogFull     :=Sum2ItogFull + суммаНДС;
  Sum3ItogFull     :=Sum3ItogFull + Цена_нацСН * Кол_факт;
end.
 Ш│@@@│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@│@~@@@@@@@│       │@~@@@@@@@│&#'&&&&&&&&│&#'&&&&&&&&│&#'&&&&&&&&&&│&#'&&&&&&&&&&│&#'&&&&&&&&&&&&│&#'&&&&&&&&&&&&&&&│&&.&&│&#'&&&&&&&&&&&&│&#'&&&&&&&&&&&&&&&│ Ш
!.[f
.{?Internal;kol1=fixKol1 or kol2=fixkol2
 Ш└───┴───────────────────────────────────┴─────────────┴─────────┴───────┴─────────┴───────────┼───────────┼─────────────┼─────────────┼───────────────┼──────────────────┼─────┼───────────────┼──────────────────┤ Ш
 Ш                                                                                        Итого │&#'&&&&&&&&│&#'&&&&&&&&&&│&#'&&&&&&&&&&│               │&#'&&&&&&&&&&&&&&&│     │&#'&&&&&&&&&&&&│&#'&&&&&&&&&&&&&&&│ Ш
 Ш                                                                                              └───────────┴─────────────┴─────────────┴───────────────┴──────────────────┴─────┴───────────────┴──────────────────┘ Ш
.{?Internal;kol1<количество_МЦ
 ^
.}
.}
!.]f
.}
.{?Internal;kol1>fixKol1 and kol2<fixkol2
 Ш└───┴───────────────────────────────────┴─────────────┴─────────┴───────┴─────────┴───────────┼───────────┼─────────────┼─────────────┼───────────────┼──────────────────┼─────┼───────────────┼──────────────────┤ Ш
 Ш                                                                                        Итого │&#'&&&&&&&&│&#'&&&&&&&&&&│&#'&&&&&&&&&&│               │&#'&&&&&&&&&&&&&&&│     │&#'&&&&&&&&&&&&│&#'&&&&&&&&&&&&&&&│ Ш
 Ш                                                                                              └───────────┴─────────────┴─────────────┴───────────────┴──────────────────┴─────┴───────────────┴──────────────────┘ Ш
.}
.{?Internal;kol1>fixKol1 and kol2<fixkol2 and kol1<количество_МЦ
 ^
.}
.{?Internal;kol1<fixKol1 and kol1=количество_МЦ
 Ш└───┴───────────────────────────────────┴─────────────┴─────────┴───────┴─────────┴───────────┴───────────┴─────────────┴─────────────┴───────────────┴──────────────────┴─────┴───────────────┴──────────────────┘ Ш
.}
 Ш                                                                                              ┌───────────┬─────────────┬─────────────┬───────────────┬──────────────────┬─────┬───────────────┬──────────────────┐ Ш
 Ш                                                                           Всего по накладной │&#'&&&&&&&&│&#'&&&&&&&&&&│&#'&&&&&&&&&&│               │&#'&&&&&&&&&&&&&&&│     │&#'&&&&&&&&&&&&│&#'&&&&&&&&&&&&&&&│ Ш
 Ш                                                                                              └───────────┴─────────────┴─────────────┴───────────────┴──────────────────┴─────┴───────────────┴──────────────────┘ Ш
 Товарная накладная имеет приложение на ____________ листах
 и содержит  З@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ З порядковых номеров записей
 Р                                                                                                                                                           ┌───────────────────────┐ Р
 Р                                                                     Масса груза (нетто)   З@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ З │                       │ Р
 Р                                                                                                                                                           ├───────────────────────┤ Р
 Р                                                                                                                                                           │                       │ Р
 РВсего мест  З@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ З Масса груза (брутто)  З@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ З └───────────────────────┘ Р
 РПриложение (паспорта, сертификаты и т.п.) на __________________________ листах      │ По доверенности N° З^ З от  З^ З г. Р
 РВсего отпущено на сумму  З@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ З │ выданной  З@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ З Р
 РОтпуск разрешил       _________________ __________ ________________________________ │ ______________________________________________________________________________________________ Р
 Р                           должность     подпись          расшифровка подписи       │ Груз принял                  З@~@@@@@@@@@@@@@@@@@@@@ З  __________ Р  Ч@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Ч
! РГлавный(старший)бухгалтер __________ З@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ З│                                    должность          подпись        расшифровка подписи Р
 РГлавный(старший)бухгалтер               __________ ________________________________ │                                    должность          подпись        расшифровка подписи Р
 Р                                         подпись          расшифровка подписи       │ Р
 РОтпуск груза произвел _________________ __________ ________________________________ │ Груз получил грузополучатель ______________________ __________ _______________________________ Р
 Р                           должность     подпись          расшифровка подписи       │                                    должность          подпись        расшифровка подписи Р
 Р                                                                                    │ Р
 Р                          М.П.<<   >>_________________ года                         │ М.П. Р
.{ PrihNkl_SopUsl CHECKENTER
.}
  ^
.}
.endform