//********************************************************************************
//                                                        (c) ชฎเฏฎเๆจ๏ ซชโจช
// ซชโจช 7.12 - _
// _
//********************************************************************************

//ษอออออออออออออออออออออออออออออออออออป
//บ  ฎกเกฎโช SoprHoz คซ๏ PrSpPlan   บ
//ศอออออออออออออออออออออออออออออออออออผ

#ifdef __UKS_PLANNING__
Create view Plan
Var pNrec: comp
From  SoprHoz
Where
((
  word(119)   == SoprHoz.TipDoc    AND
  pNrec       == SoprHoz.cSoprDoc
));

var iSHoz: SHmanager;     // จญโฅเไฅฉแ คซ๏ เกฎโ๋ แ SoprHoz

Procedure PutBufferPrSpPlanSoprHoz;
{
  Plan.SoprHoz.TipDoc   := word(119);
  Plan.SoprHoz.TiDkGal  := word(119);
  Plan.SoprHoz.cSoprDoc := PrSpPlan.nRec;
  Plan.SoprHoz.DatOb    := PrSpPlan.d1;
  Plan.SoprHoz.NoDoc    := PrSpPlan.Code;
  Plan.SoprHoz.NameSHO  := PRSpPlan.Name; //ญจฌฅญฎขญจฅ ฏซญ
  Plan.SoprHoz.Direct   := word(1);       //แญกฆฅญจฅ
  Plan.SoprHoz.FilialNo := lGetTune('Konsolid.FilialNo');
  Plan.SoprHoz.DesGr    := sGetTune('User.DesGr');
  Plan.SoprHoz.Descr    := sGetTune('User.Descr');
  Plan.SoprHoz.Summa    := PrSpPlan.fSum; //ไชโจ็ฅแช๏ แใฌฌ ข 
}

Function InsertPrSpPlanSoprHoz: boolean;
{
  ClearBuffer(Plan.tnSoprHoz);
  PutBufferPrSpPlanSoprHoz;
  InsertPrSpPlanSoprHoz := iSHoz.InsertRecord(TSoprHoz(Plan.SoprHoz.Buffer));
}

Function UpDatePrSpPlanSoprHoz: boolean;
{
  PutBufferPrSpPlanSoprHoz;
  UpDatePrSpPlanSoprHoz := iSHoz.UpdateRecord(TSoprHoz(Plan.SoprHoz.Buffer));
}

Function MakeSoprHozOnPrSpPlan: boolean;
{
  Plan.pNrec := PrSpPlan.nRec;
  if Plan.GetFirst SoprHoz = tsOk
    MakeSoprHozOnPrSpPlan := UpDatePrSpPlanSoprHoz
  else
    MakeSoprHozOnPrSpPlan := InsertPrSpPlanSoprHoz
}

Function DeletePrSpPlanSoprHoz: boolean;
{
  DeletePrSpPlanSoprHoz := iSHoz.DeleteDoc(PrSpPlan.nRec, word(119));
}
#end
