//********************************************************************************
//                                                        (c) корпорация Галактика
// Галактика 7.12 - _
// _
//********************************************************************************

!╔══════════════════════════════════════════════════════════════╗
!║  процедуры/функции для работы в сопроводительных документах  ║
!╚══════════════════════════════════════════════════════════════╝

Procedure CheckSumma(full: boolean);
var
  _result: boolean;
  _Method: word;
{
  if (CurTable <> #KatSopr)
    Update Current KatSopr;

  UpdateTable;

  _Method := CheckPriceMethod(CurField);

  RunInterface(
     iChkSum,                 //chkSum.vip
     KatSopr.NRec,            //сопроводительный документ
     if(full, 0, SpSopr.NRec),  //позиция спецификации,
                              //если 0 - пересчет по всему документу
     FALSE,                   //выполнить только пересчет позиции (true)
     _Method,                 //метод пересчета суммы в валюте по текущему курсу
     _result                  //резутьтат выполнения (был ли пересчет) [возвращаемый]
   );

  if (_result)
    {
      RereadRecord(#SpSopr);
      RereadRecord(#KatSopr);
      if (not full)
        if boGetTune('Oper.NalUch')
          set sumNalUch := SpSopr.priceN*SpSopr.kolFact;//перерисовать поле "Сумма для НУ"
      if (KatSopr.cSchFact <> 0)
        SchFactFlag := TRUE; //была модификация запрос на пересмотр счет-фактуры
      set KatSopr.NRec := KatSopr.NRec; //для того, чтоб сработал ChekRecord
    }
}

#include soprc20.vpp
