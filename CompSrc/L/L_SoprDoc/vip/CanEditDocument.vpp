#ifndef _CanEditDocument_VPP
#define _CanEditDocument_VPP

function CanEditDocument: boolean;
{
  CanEditDocument := false;

  if  not boGetTune('Doc.ModSopr')
    {
      Message(''#3'Документ доступен только для просмотра.'+
              ''#13#3+GetTuneName('Doc.ModSopr'));
      Exit;
    }


  Case DscVisible of
    cgDocVisible_All :    // 'все права'
      {}
    cgDocVisible_MySelf,           // 'только со своим дескриптором'
    cgDocVisible_OwnModifAllRead : // 'свои-изменение, все - чтение'
      If KatSopr.Descr<>DscName
        {
          Message(''#3'Документ доступен только для просмотра.'+
                ''#13#3+GetTuneName('Doc.Visible')+'-"'+sGetTune('Doc.Visible')+'".');
          Exit;
        }
    cgDocVisible_GrRead : // 'свои-изменение, по группе - чтение'
      If (KatSopr.Descr<>DscName) or (KatSopr.DesGr<>DesGroup)
        {
          Message(''#3'Документ доступен только для просмотра.'+
                ''#13#3+GetTuneName('Doc.Visible')+'-"'+sGetTune('Doc.Visible')+'".');
          Exit;
        }
    cgDocVisible_GrAll,             // 'все права в рамках группы'
    cgDocVisible_GrpModifAllRead :  // 'все права в рамках группы, все - чтение'
      If  KatSopr.DesGr<>DesGroup
        {
          Message(''#3'Документ доступен только для просмотра.'+
                ''#13#3+GetTuneName('Doc.Visible')+'-"'+sGetTune('Doc.Visible')+'".');
          Exit;
        }
  end;

#ifdef __SOPRDOC102__
  if KatSopr.VidSopr = word(102)
    if IsValid(#StepDoc)
      {
        var LL: SkyModificatorObj;
        GetVipRef(LL, 'SkyModificator');
        if not LL.CanEditKatSopr102(StepDoc.nRec)
          Message(''#3'Документ доступен только для просмотра.'#13+
                      'Соответствующая накладная на отпуск на консигнацию находится в статусе "закрыт".');
          Exit;
      }
#end //__SOPRDOC102__

  If  (isProtectedKatSopr)
    {
// надо писать причину, по которой нельзя редактировать документ
//      Message(''#3'Документ доступен только для просмотра.');
      Exit;
    }

  CanEditDocument := true;
}

#end