!ษอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
!บ งญ็ฅญจฅ    : HandleEvent จง soprdocb.vip                               บ
!ศอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ

#include SOPRC13.VPP

cmPick :
  Case CurField of
    #suPrNalogs :
      {
        If KatSopr.cStepDoc <> 0
          if (Message(''#3'๋ แฎฃซแญ๋ ขญฅแโจ ญฅแฎฎโขฅโแโขจฅ'#13#3+
                        'ฌฅฆคใ ญซฎฃฌจ ญชซคญฎฉ จ  ?',YesNo) <> cmYes)
            {
              rereadrecord(CurTable);
              Exit;
            }

        set SpSopUsl.ManualTax := if (SpSopUsl.ManualTax = 0,1,0);
        update current SpSopUsl;

        if SpSopUsl.ManualTax=0
          Delete NoVisual SpDocNalSopUsl
                   where ((SpSopUsl.NRec == SpDocNalSopUsl.cSpDoc and
                                TypeSopr == SpDocNalSopUsl.TipDoc));

        CheckSumma(true);

        RunWindowModal(SpSopUslNalogs);
      }
  end; 