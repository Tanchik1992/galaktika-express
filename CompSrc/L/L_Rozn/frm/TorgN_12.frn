!╔════════════════════════════════════════════════════════════════════════════╗
!║                     (c) Корпорация ГАЛАКТИКА, 1996,99                      ║
!║ Проект        : ГАЛАКТИКА                                                  ║
!║ Система       : Оперативный контур - Розничная торговля                    ║
!║ Версия        : 5.71                                                       ║
!║ Назначение    : Товарная накладная(форма №ТОРГ-12 России)                  ║
!║ Разработал    : Макс Голдин                                                ║
!╚════════════════════════════════════════════════════════════════════════════╝

#doc
Товарная накладная(форма №ТОРГ-12 России)
#end
.LinkForm 'tip_nakl_TH2_RZ_2' prototype is 'tip_nakl_TH2_RZ'
.NameInList '6. Товарная накладная(форма №ТОРГ-12 России)'
.Group 'TN'
.DEFO LANDSCAPE
.p 60
!.O1 8
.Set Filler = '-'
.var
  Nom :Word;
  KolItog, MassaBrItog, MassaNetItog, Sum1Itog, Sum2Itog :Double;
  KolItog0, MassaBrItog0, MassaNetItog0, Sum1Itog0, Sum2Itog0 :Double;

  kol1,fixkol1,kol2,fixkol2 :Word;
  СпСимвол:string
.endvar
.fields
  отправитель + if(отправитель_Банк <> '',
                   '; ' + отправитель_Банк, '')
  отправитель_ОКПО

  Подразделение_отправитель

  организация_ОКДП

  получатель + if(получатель_Банк <> '',
                   '; ' + получатель_Банк, '')
  получатель_ОКПО

  организация
  организация_ОКПО

  плательщик + if(плательщик_Банк <> '',
                  '; ' + плательщик_Банк, '')
  плательщик_ОКПО

  наименование_договора
  номер_договора
  if(LongInt(дата_договора) <> LongInt(0),
     DateToStr(дата_договора, 'DD/MM/YYYY'), '')

  номер_накладной
  DateToStr(дата_накладной, 'DD/MM/YYYY')
.endfields
.begin
  СпСимвол:='';
  kol1:=0;fixkol1:=6;kol2:=0;fixkol2:=29;

  Nom           :=0
  KolItog0      :=0;
  MassaBrItog0  :=0;
  MassaNetItog0 :=0;
  Sum1Itog0     :=0;
  Sum2Itog0     :=0;

  KolItog       :=0;
  MassaBrItog   :=0;
  MassaNetItog  :=0;
  Sum1Itog      :=0;
  Sum2Itog      :=0;
end.
 Р
 Р
 Р                                                                                                                                               Унифицированная форма N°ТОРГ-12 Р
 Р                                                                                                                                               Утверждена постановлением Госкомстата Р
 Р                                                                                                                                               России от 25.12.1998  N°132 Р
 Р                                                                                                                                                              _____________________  Р
 Р                                                                                                                                                              Д│         Код         │ Ф
 Р                                                                                                                                               Форма по ОКУД  Д│       0330212       │ Ф
 РОрганизация-грузоотправитель  З@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ З по ОКПО  Д│@~@@@@@@@@@@@@@@@@@@@│ Ф
 РПодразделение  З@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Г│                     │ Ф
 Р                                                                                                                                    Вид деятельности по ОКДП  Д│@~@@@@@@@@@@@@@@@@@@@│ Ф
 РГрузополучатель   З@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ З по ОКПО  Д│@~@@@@@@@@@@@@@@@@@@@│ Ф
 РПоставщик         З@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ З по ОКПО  Д│@~@@@@@@@@@@@@@@@@@@@│ Ф
 РПлательщик        З@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ З  Дпо ОКПО │@~@@@@@@@@@@@@@@@@@@@│ Ф
 РОснование         З@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ З  Д│ номер │@~@@@@@@@@@@@@@@@@@@@│ Ф
 Р                                                                                                                                                      Д│  дата │@~@@@@@@@@@@@@@@@@@@@│ Ф
 Р                                                                     ┌───────────────┬────────────────┐                      Транспортная накладная   Д│ номер │                     │ Ф
 Р                                                                     │Номер документа│Дата составления│                                               Д│  дата │                     │ Ф
 Р                                                  ТОВАРНАЯ НАКЛАДНАЯ ├───────────────┼────────────────┤                                         Вид операции  Д│                     │ Ф
 Р                                                                     │@~@@@@@@@@@@@@@│@~@@@@@@@@@@@@@@│
                                                                     └───────────────┴────────────────┘ Р
 Ш┌───┬─────────────────────────────────────────────────┬─────────────────┬─────────┬───────────────────────┬─────────────┬─────────────┬───────────────┬──────────────────┬─────────────────────┬──────────────────┐ Ш
 Ш│   │                     Товар                       │ Един. измерения │         │      Количество       │             │             │               │                  │         НДС         │                  │ Ш
 Ш│ N°├───────────────────────────────────┬─────────────┼─────────┬───────┤   Вид   ├───────────┬───────────┤    Масса    │ Количество  │     Цена,     │    Сумма без     ├─────┬───────────────┤  Сумма с учетом  │ Ш
 Ш│п/п│   наименование, характеристика,   │     код     │  наиме- │ код по│упаковки │  в одном  │   мест,   │   брутто    │  (масса     │   руб. коп.   │    учета НДС,    │став-│    сумма,     │       НДС,       │ Ш
 Ш│   │      сорт, артикул товара         │             │ нование │  ОКЕИ │         │   месте   │   штук    │             │   нетто)    │               │    руб. коп.     │ка, %│   руб. коп.   │     руб. коп.    │ Ш
 Ш├───┼───────────────────────────────────┼─────────────┼─────────┼───────┼─────────┼───────────┼───────────┼─────────────┼─────────────┼───────────────┼──────────────────┼─────┼───────────────┼──────────────────┤ Ш
 Ш│ 1 │               2                   │      3      │    4    │   5   │    6    │     7     │     8     │      9      │     10      │      11       │        12        │ 13  │      14       │        15        │ Ш
 Ш├───┼───────────────────────────────────┼─────────────┼─────────┼───────┼─────────┼───────────┼───────────┼─────────────┼─────────────┼───────────────┼──────────────────┼─────┼───────────────┼──────────────────┤ Ш
.{
.{?Internal;kol1=fixkol1 or kol2=fixkol2
.begin
  kol2:=0;
  KolItog      :=0;
  MassaBrItog  :=0;
  MassaNetItog :=0;
  Sum1Itog     :=0;
  Sum2Itog     :=0;
end.
 Ш                                                                                                                                                                                  Оборотная сторона формы N°ТОРГ-12 Ш
 Ш┌───┬─────────────────────────────────────────────────┬─────────────────┬─────────┬───────────────────────┬─────────────┬─────────────┬───────────────┬──────────────────┬─────────────────────┬──────────────────┐ Ш
 Ш│   │                     Товар                       │ Един. измерения │         │      Количество       │             │             │               │                  │         НДС         │                  │ Ш
 Ш│ N°├───────────────────────────────────┬─────────────┼─────────┬───────┤   Вид   ├───────────┬───────────┤    Масса    │ Количество  │     Цена,     │    Сумма без     ├─────┬───────────────┤  Сумма с учетом  │ Ш
 Ш│п/п│   наименование, характеристика,   │     код     │  наиме- │ код по│упаковки │  в одном  │   мест,   │   брутто    │  (масса     │   руб. коп.   │    учета НДС,    │став-│    сумма,     │       НДС,       │ Ш
 Ш│   │      сорт, артикул товара         │             │ нование │  ОКЕИ │         │   месте   │   штук    │             │   нетто)    │               │    руб. коп.     │ка, %│   руб. коп.   │     руб. коп.    │ Ш
 Ш├───┼───────────────────────────────────┼─────────────┼─────────┼───────┼─────────┼───────────┼───────────┼─────────────┼─────────────┼───────────────┼──────────────────┼─────┼───────────────┼──────────────────┤ Ш
 Ш│ 1 │               2                   │      3      │    4    │   5   │    6    │     7     │     8     │      9      │     10      │      11       │        12        │ 13  │      14       │        15        │ Ш
 Ш├───┼───────────────────────────────────┼─────────────┼─────────┼───────┼─────────┼───────────┼───────────┼─────────────┼─────────────┼───────────────┼──────────────────┼─────┼───────────────┼──────────────────┤ Ш
.}
.fields
   Nom
   наименование_мц
   баркод
   учет_ед

   if(упаковка <> учет_ед, упаковка, '-')
   DoubleToStr(кол_в_одной_упаковке, Kol_Pr)
   DoubleToStr(кол_упаковок, Kol_Pr)

   DoubleToStr(масса_брутто_единицы * кол_общее, Massa_Pr)
   DoubleToStr(масса_нетто_единицы * кол_общее, Massa_Pr)

   DoubleToStr(цена_реализации / кол_в_одной_упаковке -
               cумма_исход_НДС / кол_упаковок, Cena_Pr)
   DoubleToStr(стоимость -
               cумма_исход_НДС * кол_в_одной_упаковке, Cena_Pr)

   //DoubleToStr(цена_реализации -
   //            if(НДС_в_цене, cумма_вход_НДС  * кол_в_одной_упаковке /
   //                           кол_упаковок, 0), Cena_Pr)
   //DoubleToStr(стоимость -
   //            if(НДС_в_цене, cумма_вход_НДС * кол_в_одной_упаковке, 0), Cena_Pr)

   cтавка_НДС
   if(cумма_исход_НДС <> 0, DoubleToStr(cумма_исход_НДС  *
                                        кол_в_одной_упаковке, Cena_Pr), '-')
   DoubleToStr(стоимость, Cena_Pr)

   //DoubleToStr(cумма_вход_НДС  * кол_в_одной_упаковке, Cena_Pr)
   //DoubleToStr(стоимость +
   //            if(not НДС_в_цене, cумма_вход_НДС * кол_в_одной_упаковке, 0), Cena_Pr)
.endfields
.begin
  inc(kol1); inc(kol2);
  Nom          :=Nom + 1;

  KolItog      :=KolItog + кол_упаковок;
  MassaBrItog  :=MassaBrItog + масса_брутто_единицы * кол_общее;
  MassaNetItog :=MassaNetItog + масса_нетто_единицы * кол_общее;
  Sum1Itog     :=Sum1Itog + стоимость -
                 cумма_исход_НДС * кол_в_одной_упаковке;
  Sum2Itog     :=Sum2Itog + cумма_исход_НДС * кол_в_одной_упаковке;

  //Sum1Itog     :=Sum1Itog + стоимость -
  //               if(НДС_в_цене, cумма_вход_НДС * кол_в_одной_упаковке, 0);
  //Sum2Itog     :=Sum2Itog + cумма_вход_НДС * кол_в_одной_упаковке;

  KolItog0      :=KolItog0 + кол_упаковок;
  MassaBrItog0  :=MassaBrItog0 + масса_брутто_единицы * кол_общее;
  MassaNetItog0 :=MassaNetItog0 + масса_нетто_единицы * кол_общее;
  Sum1Itog0     :=Sum1Itog0 + стоимость -
                  cумма_исход_НДС * кол_в_одной_упаковке;
  Sum2Itog0     :=Sum2Itog0 + cумма_исход_НДС * кол_в_одной_упаковке;

  //Sum1Itog0     :=Sum1Itog0 + стоимость -
  //                if(НДС_в_цене, cумма_вход_НДС * кол_в_одной_упаковке, 0);
  //Sum2Itog0     :=Sum2Itog0 + cумма_вход_НДС * кол_в_одной_упаковке;
end.
 Ш│@@@│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│&&&&&&&&&&&&&│@~@@@@@@@│       │@~@@@@@@@│&#'&&&&&&&&│&#'&&&&&&&&│&#'&&&&&&&&&&│&#'&&&&&&&&&&│&#'&&&&&&&&&&&&│&#'&&&&&&&&&&&&&&&│&#.&&│&#'&&&&&&&&&&&&│&#'&&&&&&&&&&&&&&&│ Ш
.{?Internal;kol1=fixKol1 or kol2=fixkol2
.fields
  DoubleToStr(KolItog, Kol_Pr)
  DoubleToStr(MassaBrItog, Massa_Pr)
  DoubleToStr(MassaNetItog, Massa_Pr)
  DoubleToStr(Sum1Itog, Cena_Pr)
  if(cумма_исход_НДС <> 0, DoubleToStr(Sum2Itog, Cena_Pr), '')
  DoubleToStr(Sum1Itog + Sum2Itog, Cena_Pr)
.endfields
 Ш└───┴───────────────────────────────────┴─────────────┴─────────┴───────┴─────────┴───────────┼───────────┼─────────────┼─────────────┼───────────────┼──────────────────┼─────┼───────────────┼──────────────────┤ Ш
 Ш                                                                                        Итого │&#'&&&&&&&&│&#'&&&&&&&&&&│&#'&&&&&&&&&&│               │&#'&&&&&&&&&&&&&&&│     │&#'&&&&&&&&&&&&│&#'&&&&&&&&&&&&&&&│ Ш
 Ш                                                                                              └───────────┴─────────────┴─────────────┴───────────────┴──────────────────┴─────┴───────────────┴──────────────────┘ Ш
.{?Internal;kol1<Кол_строк
.fields
  СпСимвол
.endfields
 ^
.}
.}
.}
.{?Internal;kol1>fixKol1 and kol2<fixkol2
.fields
  DoubleToStr(KolItog, Kol_Pr)
  DoubleToStr(MassaBrItog, Massa_Pr)
  DoubleToStr(MassaNetItog, Massa_Pr)
  DoubleToStr(Sum1Itog, Cena_Pr)
  if(cумма_исход_НДС <> 0, DoubleToStr(Sum2Itog, Cena_Pr), '')
  DoubleToStr(Sum1Itog + Sum2Itog, Cena_Pr)
.endfields
 Ш└───┴───────────────────────────────────┴─────────────┴─────────┴───────┴─────────┴───────────┼───────────┼─────────────┼─────────────┼───────────────┼──────────────────┼─────┼───────────────┼──────────────────┤ Ш
 Ш                                                                                        Итого │&#'&&&&&&&&│&#'&&&&&&&&&&│&#'&&&&&&&&&&│               │&#'&&&&&&&&&&&&&&&│     │&#'&&&&&&&&&&&&│&#'&&&&&&&&&&&&&&&│ Ш
 Ш                                                                                              └───────────┴─────────────┴─────────────┴───────────────┴──────────────────┴─────┴───────────────┴──────────────────┘ Ш
.}
.{?Internal;kol1>fixKol1 and kol2<fixkol2 and kol1<Кол_строк
.fields
  СпСимвол
.endfields
 ^
.}
.{?Internal;kol1<fixKol1 and kol1=Кол_строк
 Ш└───┴───────────────────────────────────┴─────────────┴─────────┴───────┴─────────┴───────────┴───────────┴─────────────┴─────────────┴───────────────┴──────────────────┴─────┴───────────────┴──────────────────┘ Ш
.}
.fields
  DoubleToStr(KolItog0, Kol_Pr)
  DoubleToStr(MassaBrItog0, Massa_Pr)
  DoubleToStr(MassaNetItog0, Massa_Pr)
  DoubleToStr(Sum1Itog0, Cena_Pr)
  if(cумма_исход_НДС <> 0, DoubleToStr(Sum2Itog0, Cena_Pr), '')
  DoubleToStr(Sum1Itog0 + Sum2Itog0, Cena_Pr)
.endfields
 Ш                                                                                              ┌───────────┬─────────────┬─────────────┬───────────────┬──────────────────┬─────┬───────────────┬──────────────────┐ Ш
 Ш                                                                           Всего по накладной │&#'&&&&&&&&│&#'&&&&&&&&&&│&#'&&&&&&&&&&│               │&#'&&&&&&&&&&&&&&&│     │&#'&&&&&&&&&&&&│&#'&&&&&&&&&&&&&&&│ Ш
 Ш                                                                                              └───────────┴─────────────┴─────────────┴───────────────┴──────────────────┴─────┴───────────────┴──────────────────┘ Ш
.fields
  всего_наименований
.endfields
 Товарная накладная имеет приложение на ____________ листах
 и содержит  З   ^    З порядковых номеров записей
.fields
  if(MassaNetItog0 <> 0, DoubleToStr(MassaNetItog0, '4\m'), '')
  DoubleToStr(KolItog0, '4\n')
  if(MassaBrItog0 <> 0, DoubleToStr(MassaBrItog0, '4\m'), '')
.endfields
 Р                                                                                                                                                           ┌───────────────────────┐ Р
 Р                                                                     Масса груза (нетто)   З@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ З │                       │ Р
 Р                                                                                                                                                           ├───────────────────────┤ Р
 Р                                                                                                                                                           │                       │ Р
 РВсего мест  З@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ З Масса груза (брутто)  З@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ З └───────────────────────┘ Р
.fields
  if(номер_доверенности <> '', номер_доверенности, '          ')
  if(LongInt(дата_доверенности) <> LongInt(0),
     DateToStr(дата_доверенности, 'DD mon YYYY'), '                  ')
  DoubleToString(comp(0), FRoundRub5(Sum1Itog0 + Sum2Itog0))
  кому_выдана
  МОЛ_отправитель_должность
  МОЛ_отправитель
  МОЛ_получатель_должность
  МОЛ_получатель

.endfields
 РПриложение (паспорта, сертификаты и т.п.) на ________________________________листах │ по доверенности №  З@@@@@@@@@@@@@@@@@@@@@@ Ж от  Д@@@@@@@@@@@  Дг. С
 РВсего отпущено на сумму  З@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ З │ выданной  З@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ З Р
 РОтпуск разрешил       _________________ __________ ________________________________ │ ______________________________________________________________________________________________ Р
 Р                           должность     подпись          расшифровка подписи       │ Груз принял                  З@~@@@@@@@@@@@@@@@@@@@@ З  __________ Р  Ч@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Ч
 РГлавный(старший)бухгалтер               __________ ________________________________ │                                    должность          подпись        расшифровка подписи Р
 Р                                         подпись          расшифровка подписи       │ Р
 РОтпуск груза произвел  З@~@@@@@@@@@@@@@@@ З __________  З@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ З │ Груз получил грузополучатель ______________________ __________ _______________________________ Р
 Р                           должность     подпись          расшифровка подписи       │                                    должность          подпись        расшифровка подписи Р
 Р                                                                                    │ Р
 Р                          М.П.<<   >>_________________ года                         │ Р  РМ.П.<<   >>_________________ года Р
.fields
  СпСимвол
.endfields
 ^
.endform