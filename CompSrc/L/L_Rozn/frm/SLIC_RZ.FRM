! ╔═════════════════════════════════════════════════════════════════════════╗
! ║  Разработал:  Голец Дмитрий                                             ║
! ║  Назначение:  Сличительная ведомость по итогам инвентаризации           ║
! ║               в розничной торговле                                      ║
! ╚═════════════════════════════════════════════════════════════════════════╝


#include PreDefs.inc

#doc
Сличительная ведомость по итогам инвентаризации
в розничной торговле
#end
.set name='SLIC_RZ'
.hide
.var
  KolZnak   :String;
  itogoALL  :Double;
  itogo_ALL :Double;
.endvar
.fields
    склад:string:'t:a'
    мол:string:'t:a'
    дата_инвентаризации:date:'m:"DD" mon YYYY г.'

    Кол_число_знаков :word
!.{
      мц_код:string:'t:a'
      мц_название:string:'t:a'
      партия:string:'t:a'
      ед_измерения:string:'t:a'
      дата_выявления:date:'m:DD/MM/YY'
      кол_инвентаризации:double
      кол_программно:double
      цена_программно:double
!.}
!.if flagoutitogo
!.{
      itogo_kol    : double
      itogo_kolprg : double
      itogo_price  : double
!}.

!.end
.endfields

    В Е Д О М О С Т Ь   П О   И Т О Г А М   И Н В Е Н Т А Р И З А Ц И И

  Склад                          : ^
  Материально-ответственное лицо : ^
  Дата инвентаризации            : ^

  Кол_число_знаков               : ^
.begin
  Case Кол_число_знаков of
    2 : KolZnak := '88';
    3 : KolZnak := '888';
    4 : KolZnak := '8888';
    5 : KolZnak := '88888';
    6 : KolZnak := '888888';
    7 : KolZnak := '8888888';
    8 : KolZnak := '88888888';
    9 : KolZnak := '888888888';
  else
    KolZnak := '8';
  End;
end.
.{
.[h OverWrite
────────────────┬───────────────────────────────────┬────────────────────────────┬─────────┬──────────────┬────────────┬────────────┬───────────────
 Номенклатурный │  Наименование товара              │ Партия товара              │ Единица │Дата выявления│Фактический │ Расчетный  │ Цена
 номер товара   │                                   │                            │измерения│  остатков    │  остаток   │  остаток   │ в НДЕ
────────────────┴───────────────────────────────────┴────────────────────────────┴─────────┴──────────────┴────────────┴────────────┴───────────────
.]h
.begin
  itogoALL:=0;
  itogo_ALL:=0;
end.

.{
@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@ @@@@@@@@@@@@@@ &'#&&&&&&&.& &'#&&&&&&&.& &&&&&&&&&&&&.&&
.begin
 if (кол_инвентаризации<кол_программно) {itogoALL:=itogoALL+цена_программно;} else
 {itogo_ALL:=itogo_ALL+цена_программно};
end.
.if flagoutitogo
.{
....................................................................................................................................................
                      Итого по матценности                                                                 &'#&&&&&&&.& &'#&&&&&&&.& &&&&&&&&&&&&.&&
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.}
.end
.}
.}
.endform


#doc
Количественный учет
Сличительная ведомость по итогам инвентаризации в розничной торговле
#end
.linkform 'SLIC_RZ_1' prototype is 'SLIC_RZ'
.nameInList 'Сличительная ведомость по итогам инвентаризации в розничной торговле'
.Group 'Количественный учет'
#IfDef Property
.Defo Portrait
.p 68
#else
.Defo Landscape
.p 55
#end //Property
.fields
  CommonFormHeader
.endfields
^
.fields
    склад
    if(мол='','не задан',мол)
    дата_инвентаризации
!.{
      мц_код
      мц_название
     #IfDef Property
     #else
      партия
     #end //Property
      ед_измерения
      дата_выявления
      кол_инвентаризации
      кол_программно
      цена_программно
      DoubleToStr(abs(кол_инвентаризации-кол_программно),
                  '\'+String(Кол_число_знаков)+'p[|-]3666`666`666`666.'+KolZnak)
      abs(кол_инвентаризации-кол_программно)*цена_программно
!.if flag
!.{
      itogo_kol
      itogo_kolprg
!      itogo_price
      DoubleToStr(abs(itogo_kol-itogo_kolprg),
                  '\'+String(Кол_число_знаков)+'p[|-]3666`666`666`666.'+KolZnak)
!      abs(itogo_kol-itogo_kolprg)*itogo_price
!.}
!.}
.endfields
.p 60
 И
    В Е Д О М О С Т Ь   П О   И Т О Г А М   И Н В Е Н Т А Р И З А Ц И И

  Склад : ^
  МОЛ   : ^
  Дата инвентаризации : ^ И

.{
.[h OverWrite
#IfDef Property
 Ш─────────────┬───────────────────────────────────┬─────────┬──────────┬────────────┬────────────┬───────────────┬─────────┬─────────────────── Ш
 Ш   Учетный   │       Наименование имущества      │ Единица │   Дата   │Фактический │ Расчетный  │     Сумма     │ Расхож- │ Сумма расхождения  Ш
 Ш    номер    │                                   │измерения│ остатков │  остаток   │  остаток   │     в НДЕ     │  дение  │       в НДЕ        Ш
 Ш─────────────┴───────────────────────────────────┴─────────┴──────────┴────────────┴────────────┴───────────────┴─────────┴─────────────────── Ш
#else
 Р────────────────┬───────────────────────────────────┬────────────────────────────┬─────────┬──────────┬────────────┬────────────┬───────────────┬─────────┬─────────────────── Р
 Р Номенклатурный │  Наименование товара              │ Партия товара              │ Единица │   Дата   │Фактический │ Расчетный  │ Цена          │Расхож-  │ Сумма расхождения  Р
 Р номер товара   │                                   │                            │измерения│ остатков │  остаток   │  остаток   │ в НДЕ         │дение    │ в НДЕ              Р
 Р────────────────┴───────────────────────────────────┴────────────────────────────┴─────────┴──────────┴────────────┴────────────┴───────────────┴─────────┴─────────────────── Р
#end //Property
.]h
.{
#IfDef Property
 Ш@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @~@@@@@@@ @@@@@@@@@@ &'#&&&&&&&.& &'#&&&&&&&&& &&&&&&&&&&&&&&& &'#&&&&&& &&&&&&&&&&&&&&&&.&& Ш
#else
 Р@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@ @@@@@@@@@@ &'#&&&&&&&&& &'#&&&&&&&&& &&&&&&&&&&&&.&& &'#&&&&&& &&&&&&&&&&&&&&&&.&& Р
#end //Property
.if flagoutitogo
.{
#IfDef Property
 Ш.............................................................................................................................................. Ш
 Ш                   Итого по имуществу                               &'#&&&&&&&&&&&& &'#&&&&&&&&&             &'#&&&&&&&&&& Ш
 Ш────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── Ш
#else
 Р.............................................................................................................................................................................. Р
 Р                      Итого по матценности                                                          &'#&&&&&&&&&&&& &'#&&&&&&&&&             &'#&&&&&&&&&&                     Р
 Р────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── Р
#end //Property
.}
.end
.}
.}
.endform


!***********************************
#doc
Стоимостной учет
Сличительная ведомость по итогам инвентаризации в розничной торговле
#end
.linkform 'SLIC_RZ_2' prototype is 'SLIC_RZ'
.nameInList 'Сличительная ведомость по итогам инвентаризации в розничной торговле'
.Group 'Стоимостной учет'
.p 40
.orient landscape
.fields
  CommonFormHeader
.endfields
^
.fields
    склад
    if(мол='','не задан',мол)
    дата_инвентаризации
!.{
      мц_код
      мц_название
      ед_измерения
      дата_выявления
      кол_инвентаризации
      кол_программно
!      цена_программно
      DoubleToStr(abs(кол_инвентаризации-кол_программно),
                  '\'+String(Кол_число_знаков)+'p[|-]3666`666`666`666.'+KolZnak)
      цена_программно
!      abs(кол_инвентаризации-кол_программно)*цена_программно
!.if flag
!.{
      itogo_kol
      itogo_kolprg
!      itogo_price
      DoubleToStr(abs(itogo_kol-itogo_kolprg),
                  '\'+String(Кол_число_знаков)+'p[|-]3666`666`666`666.'+KolZnak)
!      abs(itogo_kol-itogo_kolprg)*itogo_price
!.}
      itogoALL itogo_ALL
!.}
.endfields

 Ш               В Е Д О М О С Т Ь   П О   И Т О Г А М   И Н В Е Н Т А Р И З А Ц И И

  Склад : ^
  МОЛ   : ^
  Дата инвентаризации : ^   Ш
.{
.[h OverWrite
 Р────────────────┬───────────────────────────────────┬─────────┬──────────┬────────────┬────────────┬─────────────┬───────────────────
 Номенклатурный │       Наименование товара         │ Единица │   Дата   │Фактический │ Расчетный  │ Расхождение │Сумма расхождения
 номер товара   │                                   │измерения│ остатков │  остаток   │  остаток   │             │      в НДЕ
────────────────┴───────────────────────────────────┴─────────┴──────────┴────────────┴────────────┴─────────────┴─────────────────── Р
.]h
.{
 Р@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@ @@@@@@@@@@ &'#&&&&&&&&& &'#&&&&&&&&& &'#&&&&&&&&&& &'#&&&&&&&&&&&&&.&& Р
.if flagoutitogo
.{
 Р.....................................................................................................................................
                      Итого по матценности                             &'#&&&&&&&&&&&& &'#&&&&&&&&& &'#&&&&&&&&&&
───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── Р
.}
.end
.}
.}
 Р─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Итого по недостаче                                                                                                &'#&&&&&&&&&&&&&.&&
Итого по избытку                                                                                                  &'#&&&&&&&&&&&&&.&& Р
.endform


#Include Slic_r19.frn