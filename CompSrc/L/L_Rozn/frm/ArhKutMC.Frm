#doc
Отчет по архиву КУТ
#end
.Set Name='ArhKutMC'
.hide
.var
 итого_тов_закуп         : double
 итого_тов_реализ        : double
 итого_закуп             : double
 итого_реализ            : double
.endvar
.procedure FSRoundRub(var s:double);
begin
 s:=FRoundRub5(s);
end.

.procedure FSRoundVal(var s:double);
begin
 s:=FRoundVal5(s);
end.
.fields
 начальная_дата          : date
 конечная_дата           : date

 наименование            : string
 баркод                  : string
 едизм                   : string

 Номер_документа_прихода : string
 Дата_документа_прихода  : date
 контрагент              : string

 Количество_товара       : double
 сумма_закуп             : double
 сумма_реализ            : double
 Надбавка                : double
 Налог_с_продажи         : double
.endfields
.{
период ^^
.begin
 итого_закуп      := 0;
 итого_реализ     := 0;
 end.
.{
 Товар: ^ Код: ^ Единица измерения ^
.begin
 итого_тов_закуп  := 0;
 итого_тов_реализ := 0;
 end.
.{
  ^            ^         ^                              ^           ^                     ^               ^             ^
!@@@@@@@@@│@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│&'&&&&&&.&&&│&'&&&&&&&&&&&.&&│&'&&&&&&&&&&&.&&│&'&&&&&&&&&&&.&&│&'&&&&&&&&&&&.&&│&'&&&&&&.&&│&'&&&&&&.&&│
.begin
 итого_тов_закуп  := итого_тов_закуп + сумма_закуп;
 итого_тов_реализ := итого_тов_реализ + сумма_реализ;
 end.
.}
.begin
 итого_закуп      := итого_закуп + итого_тов_закуп ;
 итого_реализ     := итого_реализ + итого_тов_реализ ;
 end.
.}
.}
.endform

#doc
Отчет по архиву КУТ
#end
.linkform 'ArhKutMC_1' prototype is 'ArhKutMC'
.nameInList 'Отчет по архиву КУТ'
.PAPER PA4
.ORIENT PORTRAIT
.LL 60
.fields
начальная_дата
конечная_дата


 'Товар: '+наименование+' Код: '+баркод+' Единица измерения: '+едизм

!Номер_документа_прихода
Дата_документа_прихода
!контрагент

Надбавка
if(Abs(Налог_с_продажи) < 0.5, 0.0, Налог_с_продажи)
Количество_товара
сумма_закуп
сумма_реализ

наименование

итого_тов_закуп
итого_тов_реализ

итого_закуп
итого_реализ
.endfields

 Б       Отчет по архиву КУТ за период с @@@@@@@@@@ по @@@@@@@@@@  Б

.{
.[h OverWrite
!═══════════════════════════════════════════════════╤════════════╤═════════════════════╤═════════════════════╤═══════════════╤═══════════════
!              Документ прихода                     │            │      Стоимость      │     Стоимость       │   Розничная   │    Налог с
!─────────┬──────────┬──────────────────────────────┤ Количество │ в закупочных ценах  │ в ценах реализации  │    надбавка   │    продажи
! Номер   │   Дата   │         Контрагент           │            │                     │                     │               │
!─────────┴──────────┴──────────────────────────────┴────────────┴─────────────────────┴─────────────────────┴───────────────┴───────────────
 И══════════╤═══════════╤═══════════╤════════════╤══════════════════╤══════════════════ И
 И   Дата   │ Розничная │  Налог с  │            │     Стоимость    │    Стоимость      И
 И создания │  надбавка │  продажи  │ Количество │в закупочных ценах│в ценах реализации И
 И  архива  │           │           │            │                  │                   И
 И──────────┴───────────┴───────────┴────────────┴──────────────────┴────────────────── И
.]h
.{
 И@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ И
.{
 И@@@@@@@@@@ &'&&&&&&.&& &'&&&&&&.&& &'&&&&&&.&&& &'&&&&&&&&&&&&&.&& &'&&&&&&&&&&&&&.&& И
.}
 ИИтого по товару @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@  &'&&&&&&&&&&&&&.&& &'&&&&&&&&&&&&&.&& И
 И───────────────────────────────────────────────────────────────────────────────────── И
.}

 ИВСЕГО ПО ПРЕДПРИЯТИЮ                            &'&&&&&&&&&&&&&.&& &'&&&&&&&&&&&&&.&& И
.}
.[f
.]f
.endform