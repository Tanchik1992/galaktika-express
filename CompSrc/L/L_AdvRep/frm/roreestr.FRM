!╔═════════════════════════════════════════════════════════════════════╗
!║      Проект ГАЛАКТИКА (c) 1994,95 TOP SOFT Ltd., АО НОВЫЙ АТЛАНТ    ║
!║  Версия :     5.70                                                  ║
!║  Разработал: Кратович С.Л.                                          ║
!║  Назначение: Реестр распоряжений на отгрузку                        ║
!║  Изменения:                                                         ║
!╚═════════════════════════════════════════════════════════════════════╝

#doc
Реестр распоряжений на отгрузку
#end
.Form 'ROReestr'
.Hide
.Fields
НП_Дата
КП_Дата
Шапка_Состояние

Ветка

nRecRO
РО_Дескриптор
РО_Номер
РО_Дата
РО_Дата_с
РО_Дата_по
РО_Состояние
РО_Грузотпр_Имя
РО_Контрагент_Имя

Контрагент_Имя
НЗ_Номер
НЗ_Дата
Договор_Номер
Договор_Дата
Договор_Дата_с
Договор_Дата_по
Договор_Тип
Приложение_Номер
Приложение_Дата
Приложение_Дата_с
Приложение_Дата_по

nRecSpRO
НЗСпец_НомПП
НЗСпец_Грузопол_Имя
НЗСпец_СпОтгр
НЗСпец_СпТрансп
НЗСпец_ТУ
НЗСпец_ГрТовУсл_НН
НЗСпец_ГрТовУсл_Имя
НЗСпец_ТовУсл_НН
НЗСпец_ТовУсл_Имя
НЗСпец_ЕдИзм_Имя
РОСпец_Количество
НЗСпец_Ресурс
НЗСпец_ЕдПодвСост_Имя
НЗСпец_ЕдПодвСост_Коэф
НЗСпец_ЕдПодвСост_Кол


МЦ_Имя
МЦ_Кол

ВсеМЦ_Имя
ВсеМЦ_Кол

.EndFields
^ ^ ^
.{ CheckEnter GroupRO
^
.{ CheckEnter ROHead
^ ^ ^ ^ ^ ^ ^ ^ ^
.{ CheckEnter RO
^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^
.{ CheckEnter SpecRO
.if BeginSpecRO
.end
^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^
.}
.if EndSpecRO
.end
.}
.{ CheckEnter ROMCKol
^ ^
.}
.}
.{ CheckEnter ROAllMCKol
^ ^
.}
.}
.EndForm

#doc
Реестр распоряжений на отгрузку со спецификацией
#end
.LinkForm 'ROReestr_01' Prototype is 'ROReestr'
.NameInList 'Реестр распоряжений на отгрузку со спецификацией'
.DEFP PA4
.DEFO LANDSCAPE
.P 55
.Fields

CommonFormHeader
НП_Дата
КП_Дата
Шапка_Состояние

Ветка

РО_Номер
РО_Дата
РО_Дата_с
РО_Дата_по
РО_Состояние
РО_Грузотпр_Имя


Контрагент_Имя
НЗ_Номер
НЗ_Дата
Договор_Номер
Договор_Дата
Договор_Дата_с
Договор_Дата_по
Договор_Тип
Приложение_Номер
Приложение_Дата
Приложение_Дата_с
Приложение_Дата_по

НЗСпец_НомПП
НЗСпец_Грузопол_Имя
НЗСпец_СпОтгр
НЗСпец_СпТрансп
НЗСпец_ТУ
НЗСпец_ГрТовУсл_НН
НЗСпец_ГрТовУсл_Имя
НЗСпец_ТовУсл_НН
НЗСпец_ТовУсл_Имя
НЗСпец_ЕдИзм_Имя
РОСпец_Количество
НЗСпец_Ресурс
НЗСпец_ЕдПодвСост_Имя
НЗСпец_ЕдПодвСост_Кол
.EndFields
 Ш^ Ш
 С                                                                         Реестр распоряжений на отгрузку
                                                                        за период c ^ по ^
                                                                        ^ С
 Ш──────────────────────────────────────────────────────────────────────┬────────────────────┬──────────────────┬────────────────────────────────────────────────┬─────────────────────────────────────────
                             Распоряжение на отгрузку                 │     Контрагент     │    Наряд-заказ   │                    Договор                     │                Приложение
────────┬──────────┬─────────────────────┬───────────┬────────────────┤                    ├───────┬──────────├───────┬──────────┬─────────────────────┬───────├───────┬──────────┬──────────────────────
    N   │   Дата   │   Срок действия     │ Состояние │Грузоотправитель│                    │   N   │   Дата   │   N   │   Дата   │   Срок действия     │  Тип  │   N   │   Дата   │   Срок действия
        │          ├──────────┬──────────┤           │                │                    │       │          │       │          ├──────────┬──────────┤       │       │          ├──────────┬───────────
        │          │     с    │    по    │           │                │                    │       │          │       │          │     с    │    по    │       │       │          │     с    │    по
──────┬─┴──────────┴──┬───────┴─────────┬┴───────────┴────┬───┬───────┴─────┬──────────────┴───────┴┬─────────┴───┬───┴──────────┴──────┬───┴─────┬────┴───────┴──┬────┴────────┬─┴──────────┴───────────
   N  │Грузополучатель│ Способ отгрузки │      Способ     │Т/У│   Номенкл.  │      Наименование     │   Номенкл.  │     Наименование    │ Единица │   Количество  │   Ресурс    │Единица подвижн.состава
      │               │                 │ транспортировки │   │номер группы │  группы товаров/услуг │    номер    │    товара/услуги    │  измер. │               │             ├────────────┬───────────
      │               │                 │                 │   │товаров/услуг│                       │товара/услуги│                     │         │               │             │Наименование│ Количество
──────┴───────────────┴─────────────────┴─────────────────┴───┴─────────────┴───────────────────────┴─────────────┴─────────────────────┴─────────┴───────────────┴─────────────┴────────────┴─────────── Ш
.{ CheckEnter GroupRO
 С^ С
.{ CheckEnter ROHead
 Щ @@@@@@@ @@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@@ @@@@@@@@@@@@@@@@ Щ
.{ CheckEnter RO
 Ш                                                                       @@@@@@@@@@@@@@@@@@@@ @@@@@@@ @@@@@@@@@@ @@@@@@@ @@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@ @@@@@@@ @@@@@@@ @@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@ Ш
.{ CheckEnter SpecRO
.if BeginSpecRO
 Ш ........................................................................................................................................................................................................ Ш
.end
 Ш @@@@@ @@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@ @  @@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@ &'&&&&&&&&&.&&& @@@@@@@@@@@@@ @@@@@@@@@@@ &'&&&&&&.&&& Ш
.}
.if EndSpecRO
 Ш ........................................................................................................................................................................................................ Ш
.end
.}
.{ CheckEnter ROMCKol
.}
.}
.{ CheckEnter ROAllMCKol
.}
.}
.EndForm

#doc
Реестр распоряжений на отгрузку без спецификации
#end
.LinkForm 'ROReestr_02' Prototype is 'ROReestr'
.NameInList 'Реестр распоряжений на отгрузку без спецификации'
.DEFP PA4
.DEFO LANDSCAPE
.P 55
.Fields

CommonFormHeader
НП_Дата
КП_Дата
Шапка_Состояние

Ветка

РО_Номер
РО_Дата
РО_Дата_с
РО_Дата_по
РО_Состояние
РО_Грузотпр_Имя

Контрагент_Имя
НЗ_Номер
НЗ_Дата
Договор_Номер
Договор_Дата
Договор_Дата_с
Договор_Дата_по
Договор_Тип
Приложение_Номер
Приложение_Дата
Приложение_Дата_с
Приложение_Дата_по

.EndFields
 Ш^ Ш
 С                                                                         Реестр распоряжений на отгрузку
                                                                        за период c ^ по ^
                                                                        ^ С
 Ш──────────────────────────────────────────────────────────────────────┬────────────────────┬──────────────────┬────────────────────────────────────────────────┬─────────────────────────────────────────
                             Распоряжение на отгрузку                 │     Контрагент     │    Наряд-заказ   │                    Договор                     │                Приложение
────────┬──────────┬─────────────────────┬───────────┬────────────────┤                    ├───────┬──────────├───────┬──────────┬─────────────────────┬───────├───────┬──────────┬──────────────────────
    N   │   Дата   │   Срок действия     │ Состояние │   Контрагент   │                    │   N   │   Дата   │   N   │   Дата   │   Срок действия     │  Тип  │   N   │   Дата   │   Срок действия
        │          ├──────────┬──────────┤           │                │                    │       │          │       │          ├──────────┬──────────┤       │       │          ├──────────┬───────────
        │          │     с    │    по    │           │                │                    │       │          │       │          │     с    │    по    │       │       │          │     с    │    по
────────┴──────────┴──────────┴──────────┴───────────┴────────────────┴────────────────────┴───────┴──────────┴───────┴──────────┴──────────┴──────────┴───────┴───────┴──────────┴──────────┴─────────── Ш
.{ CheckEnter GroupRO
 С^ С
.{ CheckEnter ROHead
 Щ @@@@@@@ @@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@@ @@@@@@@@@@@@@@@@ Щ
.{ CheckEnter RO
 Ш                                                                       @@@@@@@@@@@@@@@@@@@@ @@@@@@@ @@@@@@@@@@ @@@@@@@ @@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@ @@@@@@@ @@@@@@@ @@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@ Ш
.{ CheckEnter SpecRO
.if BeginSpecRO
.end
.}
.if EndSpecRO
.end
.}
.{ CheckEnter ROMCKol
.}
.}
.{ CheckEnter ROAllMCKol
.}
.}
.EndForm

#doc
Реестр распоряжений на отгрузку с разбивкой по МЦ
#end
.LinkForm 'ROReestr_03' Prototype is 'ROReestr'
.NameInList 'Реестр распоряжений на отгрузку с разбивкой по МЦ'
.DEFP PA4
.DEFO PORTRAIT
.var
HeadStr : string
.endvar
.Fields

CommonFormHeader
НП_Дата
КП_Дата
Шапка_Состояние

substr(Ветка,pos('.',Ветка)+1,length(Ветка)-pos('.',Ветка)+1)

'N '+РО_Номер+' от '+РО_Дата
РО_Контрагент_имя
РО_Дескриптор

МЦ_Имя
МЦ_Кол

HeadStr
ВсеМЦ_Имя
ВсеМЦ_Кол

.EndFields
.begin
HeadStr := 'Разнаряжено с '+НП_Дата+' по '+КП_Дата
 end.
 Ш^ Ш
 Й                                 Реестр распоряжений на отгрузку
                                за период c ^ по ^
                                ^ Й
.{ CheckEnter GroupRO
 С^ С
 С┌────────────────────────────────────────┬─────────────────────────────────────────────────────┬─────────────────┐
│                 Номер                  │                        Контрагент                   │    Дескриптор   │
└────────────────────────────────────────┴─────────────────────────────────────────────────────┴─────────────────┘ С
.{ CheckEnter ROHead
 Р @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@ Р
.{ CheckEnter RO
.{ CheckEnter SpecRO
.if BeginSpecRO
.end
.}
.if EndSpecRO
.end
.}
.{ CheckEnter ROMCKol
 Р                                                                  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&.&&& Р
.}
 Р ─────────────────────────────────────────────────────────────────────────────────────────────────────────────── Р
.}

.{ CheckEnter ROAllMCKol
.[H OverWrite
 С ^  С
 С┌───────────────────────────────────────────────┬────────────────┐
│                   Наименование                │   Количество   │
└───────────────────────────────────────────────┴────────────────┘ С
.]H
 Р @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&.&&& Р
.}

.}
.EndForm
