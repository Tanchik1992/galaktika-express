/*
 ╔════════════════════════════════════════════════════════════════════════════╗
 ║                     (c) Корпорация ГАЛАКТИКА, 1996,98                      ║
 ║ Проект        : ГАЛАКТИКА                                                  ║
 ║ Система       : Оперативный контур                                         ║
 ║ Версия        : 5.50                                                       ║
 ║ Назначение    : Отчеты по исполняемым договорам (новые присоед. формы)     ║
 ║ Ответственный : Шукан Александр Леонидович (SAL)                           ║
 ╚════════════════════════════════════════════════════════════════════════════╝
*/
#doc
Реестр исполняемых ДО с НДС (в национальной валюте)
#end
.linkform 'IspDogov_04' prototype is 'ISPDOGOV'
.nameinlist 'Реестр исполняемых ДО с НДС (в национальной валюте)'
.group 'В национальной валюте'
.DEFO LANDSCAPE
.fields
  CommonFormHeader
   header2
   OtHeader
.endfields
^
              БРеестр документов-оснований, находящихся в состоянии исполнения
@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
 А
.{
════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
.fields
kontrname
.endfields
 Контрагент:  Б^ Б
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.{
.fields
dogname dognumb dogdate dogsum valtar dogNDS valtar v1 v2
dogprim
maxDdate maxKdate
valtar valtar valtar valtar
.endfields
 ^ N ^ от ^ на сумму ^' ^, налоги ^' ^ ^ ^
 ^
 Р
┌────────────────────────────────────────────────────────────────────────────────┐┌────────────────────────────────────────────────────────────────────────────────┐
│          ДЕБЕТ (поступления товаров/денег)     регламентный срок @@@@@@@@@@    ││         КРЕДИТ (наши платежи/поставки товаров)  регламентный срок @@@@@@@@@@   │
├──────────┬─────────────────────────────────┬──────────────────┬────────────────┤├──────────┬─────────────────────────────────┬──────────────────┬────────────────┤
│   Дата   │             Документ            │  Сумма в @~@@@@  │   НДС в @~@@@@ ││   Дата   │             Документ            │  Сумма в @~@@@@  │   НДС в @~@@@@ │
├──────────┴─────────────────────────────────┴──────────────────┴────────────────┤├──────────┴─────────────────────────────────┴──────────────────┴────────────────┤
.{
.fields
  ddate               ddocument                dsumma              dNDS              kdate               kdocument                ksumma              kNDS
.endfields
│@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&││@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&│
.}
└────────────────────────┬───────────────────────────────────────────────────────┤└───────────────────────┬────────────────────────────────────────────────────────┤
.fields
                                               dsummadoc           dNDSdoc                                                        ksummadoc       kNDSdoc
                                               ddolgdoc            ddolgNDS                                                       kdolgdoc        kdolgNDS
                                               dprosdoc            dprosNDS                                                       kprosdoc        kprosNDS
.endfields
                         │ Итого получено:    &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&│                        │ Итого отправлено:   &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&│
                         │ Долг контрагента:  &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&│                        │ Наш долг:           &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&│
                         │ В т.ч.просроченный:&'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&│                        │ В т.ч.просроченный: &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&│
                         └───────────────────────────────────────────────────────┘                        └────────────────────────────────────────────────────────┘
.fields
  remark
.endfields
 ^
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.}

.fields           kontrname
                  dolgkon             valtar   dolgNDSkon           valtar
                  proskon             valtar   prosNDSkon           valtar
                  dolgour             valtar   dolgNDSour           valtar
                  prosour             valtar   prosNDSour           valtar
.endfields
 Б Итого по контрагенту ^ Б
  его долг нам : &'&&&&&&&&&&&&&&&&&& @@@@@@   &'&&&&&&&&&&&&&&&&&& @@@@@@
  просроченный : &'&&&&&&&&&&&&&&&&&& @@@@@@   &'&&&&&&&&&&&&&&&&&& @@@@@@

  наш долг     : &'&&&&&&&&&&&&&&&&&& @@@@@@   &'&&&&&&&&&&&&&&&&&& @@@@@@
  просроченный : &'&&&&&&&&&&&&&&&&&& @@@@@@   &'&&&&&&&&&&&&&&&&&& @@@@@@
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────

.}
════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════

.fields
                              dateot
                   totkon             valtar   totNDSkon            valtar
                   totproskon         valtar   totprosNDSkon        valtar
                   totour             valtar   totNDSour            valtar
                   totprosour         valtar   totprosNDSour        valtar
.endfields
 Б Итого по всем контрагентам на ^ Б
  их долг нам :  &'&&&&&&&&&&&&&&&&&& @@@@@@   &'&&&&&&&&&&&&&&&&&& @@@@@@
  просроченный : &'&&&&&&&&&&&&&&&&&& @@@@@@   &'&&&&&&&&&&&&&&&&&& @@@@@@

  наш долг    :  &'&&&&&&&&&&&&&&&&&& @@@@@@   &'&&&&&&&&&&&&&&&&&& @@@@@@
  просроченный : &'&&&&&&&&&&&&&&&&&& @@@@@@   &'&&&&&&&&&&&&&&&&&& @@@@@@
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 Р
.endform
!
!=============================================================================
!
#doc
Отчет по долгам в разрезе ДО с НДС (в национальной валюте)
#end
.linkform 'IspDogov_05' prototype is 'ISPDOGOV'
.NameInList 'Отчет по долгам в разрезе ДО с НДС (в национальной валюте)'
.group 'В национальной валюте'
.DEFO LANDSCAPE
.var
  dogsum_k
, dsumma_k
, ksumma_k
, dogsum_t
, dsumma_t
, ksumma_t
, dogNDS_k
, dNDSdoc_k
, kNDSdoc_k
, dogNDS_t
, dNDSdoc_t
, kNDSdoc_t
  : double;
.endvar
.begin
  dogsum_t := 0;
  dsumma_t := 0;
  ksumma_t := 0;

  dogNDS_t  := 0;
  dNDSdoc_t := 0;
  kNDSdoc_t := 0;
end.
.fields
  CommonFormHeader
   header2 OtHeader
.endfields
^
           БОтчет по документам-основаниям, находящимся в состоянии исполнения
@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
 Р
──────────────────────────────────┬──────────┬────────────┬──────────────────┬──────────────────┬──────────────────┬──────────────────┬──────────────────┬──────────────────┬──────────────────┬───────────────────────────────
         Наименование ДО          │   Дата   │   Номер    │   Сумма по ДО    │Оплатил контрагент│  Оплачено нами   │ Долг контрагента │в т.ч.просроченный│     Наш долг     │в т.ч.просроченный│  Примечания
──────────────────────────────────┴──────────┴────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┴───────────────────────────────
.{
.begin
  dogsum_k := 0;
  dsumma_k := 0;
  ksumma_k := 0;

  dogNDS_k  := 0;
  dNDSdoc_k := 0;
  kNDSdoc_k := 0;
end.
.fields
kontrname
.endfields
 С Контрагент: ^ С
───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.{
.{
.}
.begin
  dogsum_k := dogsum_k + double(dogsum);
  dsumma_k := dsumma_k + double(dsummadoc);
  ksumma_k := ksumma_k + double(ksummadoc);
  dogsum_t := dogsum_t + double(dogsum);
  dsumma_t := dsumma_t + double(dsummadoc);
  ksumma_t := ksumma_t + double(ksummadoc);

  dogNDS_k  := dogNDS_k  + double(dogNDS);
  dNDSdoc_k := dNDSdoc_k + double(dNDSdoc);
  kNDSdoc_k := kNDSdoc_k + double(kNDSdoc);
  dogNDS_t  := dogNDS_t  + double(dogNDS);
  dNDSdoc_t := dNDSdoc_t + double(dNDSdoc);
  kNDSdoc_t := kNDSdoc_t + double(kNDSdoc);
end.
.fields
            dogname                dogdate    dognumb          dogsum           dsummadoc        ksummadoc           ddolgdoc           dprosdoc           kdolgdoc           kprosdoc        remark
                                                               dogNDS           dNDSdoc          kNDSdoc             ddolgNDS           dprosNDS           kdolgNDS           kprosNDS
.endfields
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@ @~@@@@@@@@@@ &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& ^
                                             в т.ч. НДС:   &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&
.}
.fields
 DoubleToStr(dogsum_k, '[|-]3666`666`666.88')            DoubleToStr(dsumma_k, '[|-]3666`666`666.88')            DoubleToStr(ksumma_k, '[|-]3666`666`666.88')          dolgkon            proskon            dolgour            prosour
 DoubleToStr(dogNDS_k, '[|-]3666`666`666.88')            DoubleToStr(dNDSdoc_k, '[|-]3666`666`666.88')           DoubleToStr(kNDSdoc_k, '[|-]3666`666`666.88')         dolgNDSkon         prosNDSkon         dolgNDSour         prosNDSour
.endfields
 Б           ВСЕГО по контрагенту                          &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& Б
                                             в т.ч. НДС: &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&
───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.}
.fields
 DoubleToStr(dogsum_t, '[|-]3666`666`666.88')            DoubleToStr(dsumma_t, '[|-]3666`666`666.88')            DoubleToStr(ksumma_t, '[|-]3666`666`666.88')          totkon             totproskon         totour             totprosour
 DoubleToStr(dogNDS_t, '[|-]3666`666`666.88')            DoubleToStr(dNDSdoc_t, '[|-]3666`666`666.88')           DoubleToStr(kNDSdoc_t, '[|-]3666`666`666.88')         totNDSkon          totprosNDSkon      totNDSour          totprosNDSour
.endfields
 Б           ИТОГО по контрагентам                         &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& Б
                                             в т.ч. НДС: &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& Р
.endform
!
!=============================================================================
!
#doc
Oтчет по долгам в разрезе Kонтрагентов с НДС (в национальной валюте)
#end
.linkform 'ISPDOGOV_06' prototype is 'ISPDOGOV'
.NameInList 'Oтчет по долгам в разрезе Kонтрагентов с НДС (в национальной валюте)'
.group 'В национальной валюте'
.fields
  CommonFormHeader
  header2 OtHeader
.endfields
^
       БОтчет по долгам контрагентов в рамках исполняемых документов-оснований
@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б

─────────────────────────────────────┬───────────────────┬───────────────────┬───────────────────┬───────────────────
      Наименование контрагента       │ Долг контрагента  │в т.ч.просроченный │     Наш долг      │в т.ч.просроченный
─────────────────────────────────────┴───────────────────┴───────────────────┴───────────────────┴───────────────────

.{
.{
.{
.}
.}
.fields
               KontrName                    dolgkon             proskon             dolgour             prosour
                                            dolgNDSkon          prosNDSkon          dolgNDSour          prosNDSour
.endfields
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&
                          в т.ч. НДС: &'&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&
.}
.fields
                                            totkon              totproskon          totour              totprosour
                                            totNDSkon           totprosNDSkon       totNDSour           totprosNDSour
.endfields

 Б      ИТОГО по всем контрагентам:     &'&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&& Б
                          в т.ч. НДС: &'&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&
.endform
!
!=====================================================================================================================
!
#doc
Реестр исполняемых ДО с НДС (в валюте для отчетов)
#end
.linkform 'IspDogov_04_1' prototype is 'ISPDOGOV'
.nameinlist 'Реестр исполняемых ДО с НДС (в валюте для отчетов)'
.group 'В валюте для отчетов'
.fields
  CommonFormHeader
   header3
   OtHeader
.endfields
^
              БРеестр документов-оснований, находящихся в состоянии исполнения
@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
 А
.{
════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
.fields
kontrname
.endfields
 Контрагент:  Б^ Б
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.{
.fields
dogname dognumb dogdate dogsumv valbas dogNDSv valbas v1 v2
dogprim
maxDdate maxKdate
valbas valbas valbas valbas
.endfields
 ^ N ^ от ^ на сумму ^' ^, налоги ^' ^ ^ ^
 ^ И
 Ш
┌────────────────────────────────────────────────────────────────────────────────┐┌────────────────────────────────────────────────────────────────────────────────┐
│          ДЕБЕТ (поступления товаров/денег)     регламентный срок @@@@@@@@@@    ││         КРЕДИТ (наши платежи/поставки товаров)  регламентный срок @@@@@@@@@@   │
├──────────┬─────────────────────────────────┬──────────────────┬────────────────┤├──────────┬─────────────────────────────────┬──────────────────┬────────────────┤
│   Дата   │             Документ            │  Сумма в @~@@@@  │   НДС в @~@@@@ ││   Дата   │             Документ            │  Сумма в @~@@@@  │   НДС в @~@@@@ │
├──────────┴─────────────────────────────────┴──────────────────┴────────────────┤├──────────┴─────────────────────────────────┴──────────────────┴────────────────┤
.{
.fields
  ddate               ddocument                dsummav             dNDSv             kdate               kdocument                ksummav             kNDSv
.endfields
│@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&││@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&│
.}
└────────────────────────┬───────────────────────────────────────────────────────┤└───────────────────────┬────────────────────────────────────────────────────────┤
.fields
                                               dsummadocv          dNDSdocv                                                       ksummadocv      kNDSdocv
                                               ddolgdocv           ddolgNDSv                                                      kdolgdocv       kdolgNDSv
                                               dprosdocv           dprosNDSv                                                      kprosdocv       kprosNDSv
.endfields
                         │ Итого получено:    &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&│                        │ Итого отправлено:   &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&│
                         │ Долг контрагента:  &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&│                        │ Наш долг:           &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&│
                         │ В т.ч.просроченный:&'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&│                        │ В т.ч.просроченный: &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&│
                         └───────────────────────────────────────────────────────┘                        └────────────────────────────────────────────────────────┘
.fields
  remark
.endfields
 ^
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.}

.fields           kontrname
                  dolgkonv            valbas   dolgNDSkonv          valbas
                  proskonv            valbas   prosNDSkonv          valbas
                  dolgourv            valbas   dolgNDSourv          valbas
                  prosourv            valbas   prosNDSourv          valbas
.endfields
 Б Итого по контрагенту ^ Б
  его долг нам : &'&&&&&&&&&&&&&&&&&& @@@@@@   &'&&&&&&&&&&&&&&&&&& @@@@@@
  просроченный : &'&&&&&&&&&&&&&&&&&& @@@@@@   &'&&&&&&&&&&&&&&&&&& @@@@@@

  наш долг     : &'&&&&&&&&&&&&&&&&&& @@@@@@   &'&&&&&&&&&&&&&&&&&& @@@@@@
  просроченный : &'&&&&&&&&&&&&&&&&&& @@@@@@   &'&&&&&&&&&&&&&&&&&& @@@@@@
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────

.}
════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════

.fields
                              dateot
                   totkonv            valbas   totNDSkonv           valbas
                   totproskonv        valbas   totprosNDSkonv       valbas
                   totourv            valbas   totNDSourv           valbas
                   totprosourv        valbas   totprosNDSourv       valbas
.endfields
 Б Итого по всем контрагентам на ^ Б
  их долг нам :  &'&&&&&&&&&&&&&&&&&& @@@@@@   &'&&&&&&&&&&&&&&&&&& @@@@@@
  просроченный : &'&&&&&&&&&&&&&&&&&& @@@@@@   &'&&&&&&&&&&&&&&&&&& @@@@@@

  наш долг    :  &'&&&&&&&&&&&&&&&&&& @@@@@@   &'&&&&&&&&&&&&&&&&&& @@@@@@
  просроченный : &'&&&&&&&&&&&&&&&&&& @@@@@@   &'&&&&&&&&&&&&&&&&&& @@@@@@
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── Р
.endform
!
!=============================================================================
!
#doc
Отчет по долгам в разрезе ДО с НДС (в валюте для отчетов)
#end
.linkform 'IspDogov_05_1' prototype is 'ISPDOGOV'
.NameInList 'Отчет по долгам в разрезе ДО с НДС (в валюте для отчетов)'
.group 'В валюте для отчетов'
.DEFO LANDSCAPE
.var
  dogsum_k
, dsumma_k
, ksumma_k
, dogsum_t
, dsumma_t
, ksumma_t
, dogNDS_k
, dNDSdoc_k
, kNDSdoc_k
, dogNDS_t
, dNDSdoc_t
, kNDSdoc_t
  : double;
.endvar
.begin
  dogsum_t := 0;
  dsumma_t := 0;
  ksumma_t := 0;

  dogNDS_t  := 0;
  dNDSdoc_t := 0;
  kNDSdoc_t := 0;
end.
.fields
  CommonFormHeader
   header3 OtHeader
.endfields
^
           БОтчет по документам-основаниям, находящимся в состоянии исполнения
@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
 Р
──────────────────────────────────┬──────────┬────────────┬──────────────────┬──────────────────┬──────────────────┬──────────────────┬──────────────────┬──────────────────┬──────────────────┬───────────────────────────────
          Наименование ДО         │   Дата   │   Номер    │    Сумма по ДО   │Оплатил контрагент│  Оплачено нами   │ Долг контрагента │в т.ч.просроченный│     Наш долг     │в т.ч.просроченный│  Примечания
──────────────────────────────────┴──────────┴────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┴───────────────────────────────
.{
.begin
  dogsum_k := 0;
  dsumma_k := 0;
  ksumma_k := 0;

  dogNDS_k  := 0;
  dNDSdoc_k := 0;
  kNDSdoc_k := 0;
end.
.fields
kontrname
.endfields
 С Контрагент: ^ С
───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.{
.{
.}
.begin
  dogsum_k := dogsum_k + double(dogsumv);
  dsumma_k := dsumma_k + double(dsummadocv);
  ksumma_k := ksumma_k + double(ksummadocv);
  dogsum_t := dogsum_t + double(dogsumv);
  dsumma_t := dsumma_t + double(dsummadocv);
  ksumma_t := ksumma_t + double(ksummadocv);

  dogNDS_k  := dogNDS_k  + double(dogNDSv);
  dNDSdoc_k := dNDSdoc_k + double(dNDSdocv);
  kNDSdoc_k := kNDSdoc_k + double(kNDSdocv);
  dogNDS_t  := dogNDS_t  + double(dogNDSv);
  dNDSdoc_t := dNDSdoc_t + double(dNDSdocv);
  kNDSdoc_t := kNDSdoc_t + double(kNDSdocv);
end.
.fields
            dogname                dogdate     dognumb          dogsumv          dsummadocv       ksummadocv          ddolgdocv          dprosdocv          kdolgdocv          kprosdocv       remark
                                                                dogNDSv          dNDSdocv         kNDSdocv            ddolgNDSv          dprosNDSv          kdolgNDSv          kprosNDSv
.endfields
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@ @~@@@@@@@@@@ &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& ^
                                             в т.ч. НДС:   &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&
.}
.fields
 DoubleToStr(dogsum_k, '[|-]3666`666`666.88')            DoubleToStr(dsumma_k, '[|-]3666`666`666.88')            DoubleToStr(ksumma_k, '[|-]3666`666`666.88')          dolgkonv           proskonv           dolgourv           prosourv
 DoubleToStr(dogNDS_k, '[|-]3666`666`666.88')            DoubleToStr(dNDSdoc_k, '[|-]3666`666`666.88')           DoubleToStr(kNDSdoc_k, '[|-]3666`666`666.88')         dolgNDSkonv        prosNDSkonv        dolgNDSourv        prosNDSourv
.endfields
 Б           ВСЕГО по контрагенту                          &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& Б
                                             в т.ч. НДС: &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.}
.fields
 DoubleToStr(dogsum_t, '[|-]3666`666`666.88')            DoubleToStr(dsumma_t, '[|-]3666`666`666.88')            DoubleToStr(ksumma_t, '[|-]3666`666`666.88')          totkonv            totproskonv        totourv            totprosourv
 DoubleToStr(dogNDS_t, '[|-]3666`666`666.88')            DoubleToStr(dNDSdoc_t, '[|-]3666`666`666.88')           DoubleToStr(kNDSdoc_t, '[|-]3666`666`666.88')         totNDSkonv         totprosNDSkonv     totNDSourv         totprosNDSourv
.endfields
 Б           ИТОГО по контрагентам                         &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& Б
                                             в т.ч. НДС: &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& Р
.endform
!
!=============================================================================
!
#doc
Oтчет по долгам в разрезе Kонтрагентов с НДС (в валюте для отчетов)
#end
.linkform 'ISPDOGOV_06_1' prototype is 'ISPDOGOV'
.NameInList 'Oтчет по долгам в разрезе Kонтрагентов с НДС (в валюте для отчетов)'
.group 'В валюте для отчетов'
.fields
  CommonFormHeader
  header3 OtHeader
.endfields
^
       БОтчет по долгам контрагентов в рамках исполняемых документов-оснований
@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б

─────────────────────────────────────┬───────────────────┬───────────────────┬───────────────────┬───────────────────
      Наименование контрагента       │ Долг контрагента  │в т.ч.просроченный │     Наш долг      │в т.ч.просроченный
─────────────────────────────────────┴───────────────────┴───────────────────┴───────────────────┴───────────────────

.{
.{
.{
.}
.}
.fields
               KontrName                    dolgkonv            proskonv            dolgourv            prosourv
                                            dolgNDSkonv         prosNDSkonv         dolgNDSourv         prosNDSourv
.endfields
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&
                          в т.ч. НДС: &'&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&
.}
.fields
                                            totkonv             totproskonv         totourv             totprosourv
                                            totNDSkonv          totprosNDSkonv      totNDSourv          totprosNDSourv
.endfields

 Б      ИТОГО по всем контрагентам:     &'&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&& Б
                          в т.ч. НДС: &'&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&
.endform
!
!=====================================================================================================================
!
#doc
Подробный отчет по долгам в разрезе ДО (в национальной валюте)
#end
.linkform 'IspDogov_07' prototype is 'ISPDOGOV'
.NameInList 'Подробный отчет по долгам в разрезе ДО (в национальной валюте)'
.DEFO LANDSCAPE
.group 'В национальной валюте'
.var
  dogsum_k
, dsumma_k
, ksumma_k
, dogsum_t
, dsumma_t
, ksumma_t
  : double;
.endvar
.begin
  dogsum_t := 0;
  dsumma_t := 0;
  ksumma_t := 0;
end.
.fields
  CommonFormHeader
   header2 OtHeader
.endfields
^
           БОтчет по документам-основаниям, находящимся в состоянии исполнения
@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
 Р
──────────────────────────────────┬──────────┬────────────┬──────────────────────────────────┬─────────────┬──────────────────┬──────────────────┬──────────────────┬────────────────────────────────────────────────────────────
          Документ-основание      │   Дата   │   Номер    │         Наименование ДО          │Срок поставки│   Сумма по ДО    │Оплатил контрагент│  Оплачено нами   │  Примечания
──────────────────────────────────┴──────────┴────────────┴──────────────────────────────────┴─────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────────────────────────────────────────────── Р
.{
.begin
  dogsum_k := 0;
  dsumma_k := 0;
  ksumma_k := 0;
end.
.fields
kontrname
.endfields
 Контрагент:  Б^ Б
 Р─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.{
.{
.}
.begin
  dogsum_k := dogsum_k + double(dogsum);
  dsumma_k := dsumma_k + double(dsummadoc);
  ksumma_k := ksumma_k + double(ksummadoc);
  dogsum_t := dogsum_t + double(dogsum);
  dsumma_t := dsumma_t + double(dsummadoc);
  ksumma_t := ksumma_t + double(ksummadoc);
end.
.fields
            dogname                dogdate    dognumb          dogsoder                       dogpost           dogsum           dsummadoc        ksummadoc       remark
                                                                                                                                 ddolgdoc         kdolgdoc
                                                                                                                                 dprosdoc         kprosdoc
.endfields
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@ @~@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@  @@@@@@@@@@   &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& ^
                                                                                                       долг:                 &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&
                                                                                                       в т.ч.просроченный:   &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&
.}
.fields
 DoubleToStr(dogsum_k, '[|-]3666`666`666.88')            DoubleToStr(dsumma_k, '[|-]3666`666`666.88')         DoubleToStr(ksumma_k, '[|-]3666`666`666.88')
                                                                                                                              dolgkon            dolgour
                                                                                                                              proskon            prosour
.endfields

            БВСЕГО по контрагенту                                                                         &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&
                                                                                                         долг:               &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&
                                                                                                       в т.ч.просроченный: &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& Б
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.}
.fields
 DoubleToStr(dogsum_t, '[|-]3666`666`666.88')            DoubleToStr(dsumma_t, '[|-]3666`666`666.88')         DoubleToStr(ksumma_t, '[|-]3666`666`666.88')
                                                                                                                              totkon             totour
                                                                                                                              totproskon         totprosour
.endfields

            БИТОГО по контрагентам                                                                        &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&
                                                                                                         долг:               &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&
                                                                                                       в т.ч.просроченный: &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& С
.endform
!
!=============================================================================
!
#doc
Подробный отчет по долгам в разрезе ДО (в валюте для отчетов)
#end
.linkform 'ISPDOGOV_07_1' prototype is 'ISPDOGOV'
.NameInList 'Подробный отчет по долгам в разрезе ДО (в валюте для отчетов)'
.group 'В валюте для отчетов'
.DEFO LANDSCAPE
.var
  dogsum_k
, dsumma_k
, ksumma_k
, dogsum_t
, dsumma_t
, ksumma_t
  : double;
.endvar
.begin
  dogsum_t := 0;
  dsumma_t := 0;
  ksumma_t := 0;
end.
.fields
  CommonFormHeader
  header3 OtHeader
.endfields
^
           БОтчет по документам-основаниям, находящимся в состоянии исполнения
@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
 Р
──────────────────────────────────┬──────────┬────────────┬──────────────────────────────────┬─────────────┬──────────────────┬──────────────────┬──────────────────┬────────────────────────────────────────────────────────────
        Документ-основание        │   Дата   │   Номер    │         Наименование ДО          │Срок поставки│   Сумма по ДО    │Оплатил контрагент│  Оплачено нами   │  Примечания
──────────────────────────────────┴──────────┴────────────┴──────────────────────────────────┴─────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────────────────────────────────────────────── Р
.{
.begin
  dogsum_k := 0;
  dsumma_k := 0;
  ksumma_k := 0;
end.
.fields
kontrname
.endfields
 Контрагент:  Б^ Б
 Р─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.{
.{
.}
.begin
  dogsum_k := dogsum_k + double(dogsumv);
  dsumma_k := dsumma_k + double(dsummadocv);
  ksumma_k := ksumma_k + double(ksummadocv);
  dogsum_t := dogsum_t + double(dogsumv);
  dsumma_t := dsumma_t + double(dsummadocv);
  ksumma_t := ksumma_t + double(ksummadocv);
end.
.fields
            dogname                dogdate    dognumb          dogsoder                       dogpost           dogsumv          dsummadocv       ksummadocv      remark
                                                                                                                                 ddolgdocv        kdolgdocv
                                                                                                                                 dprosdocv        kprosdocv
.endfields
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@ @~@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@  @@@@@@@@@@   &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& ^
                                                                                                       долг:                 &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&
                                                                                                       в т.ч.просроченный:   &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&
.}
.fields
 DoubleToStr(dogsum_k, '[|-]3666`666`666.88')            DoubleToStr(dsumma_k, '[|-]3666`666`666.88')         DoubleToStr(ksumma_k, '[|-]3666`666`666.88')
                                                                                                                              dolgkonv           dolgourv
                                                                                                                              proskonv           prosourv
.endfields

            БВСЕГО по контрагенту                                                                         &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&
                                                                                                         долг:               &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&
                                                                                                       в т.ч.просроченный: &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& Б
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.}
.fields
 DoubleToStr(dogsum_t, '[|-]3666`666`666.88')            DoubleToStr(dsumma_t, '[|-]3666`666`666.88')         DoubleToStr(ksumma_t, '[|-]3666`666`666.88')
                                                                                                                              totkonv            totourv
                                                                                                                              totproskonv        totprosourv
.endfields

            БИТОГО по контрагентам                                                                        &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&
                                                                                                         долг:               &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&
                                                                                                       в т.ч.просроченный: &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& С
.endform
!
!=====================================================================================================================
!
#doc
Подробный отчет по долгам в разрезе ДО (в валюте документа)
#end
.linkform 'ISPDOGOV_07_2' prototype is 'ISPDOGOV'
.NameInList 'Подробный отчет по долгам в разрезе ДО (в валюте документа)'
.group 'В валюте документа'
.DEFO LANDSCAPE
.var
  dogsum_k
, dsumma_k
, ksumma_k
, dogsum_t
, dsumma_t
, ksumma_t
  : double;
.endvar
.begin
  dogsum_t := 0;
  dsumma_t := 0;
  ksumma_t := 0;
end.
.fields
  CommonFormHeader
  header1 OtHeader
.endfields
^
           БОтчет по документам-основаниям, находящимся в состоянии исполнения
@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
 Р
──────────────────────────────────┬──────────┬────────────┬──────────────────────────────────┬────────────┬──────┬──────────────────┬──────────────────┬──────────────────┬────────────────────────────────────────────────────
        Документ-основание        │   Дата   │   Номер    │         Наименование ДО          │Срок постаки│Валюта│   Сумма по ДО    │Оплатил контрагент│  Оплачено нами   │  Примечания
──────────────────────────────────┴──────────┴────────────┴──────────────────────────────────┴────────────┴──────┴──────────────────┴──────────────────┴──────────────────┴──────────────────────────────────────────────────── Р
.{
.begin
  dogsum_k := 0;
  dsumma_k := 0;
  ksumma_k := 0;
end.
.fields
kontrname
.endfields
 Контрагент:  Б^ Б
 Р───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.{
.{
.}
.begin
  dogsum_k := dogsum_k + double(dogsumv);
  dsumma_k := dsumma_k + double(dsummadocv);
  ksumma_k := ksumma_k + double(ksummadocv);
  dogsum_t := dogsum_t + double(dogsumv);
  dsumma_t := dsumma_t + double(dsummadocv);
  ksumma_t := ksumma_t + double(ksummadocv);
end.
.fields
            dogname                dogdate    dognumb                dogsoder                dogpost      dogsimval     dogsumo          dsummadoco       ksummadoco      remark
                                                                                                                                         ddolgdoco        kdolgdoco
                                                                                                                                         dprosdoco        kprosdoco
.endfields
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@ @@@@@@ &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& ^
                                                                                                             долг:                 &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&
                                                                                                             в т.ч.просроченный:   &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&
.}
.fields
valbas    DoubleToStr(dogsum_k, '[|-]3666`666`666.88')            DoubleToStr(dsumma_k, '[|-]3666`666`666.88')         DoubleToStr(ksumma_k, '[|-]3666`666`666.88')
                                                                                                                                        dolgkonv          dolgourv
                                                                                                                                        proskonv          prosourv
.endfields

            БВСЕГО по контрагенту в базовой валюте         @@@@@@                                               &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&
                                                                                                               долг:               &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&
                                                                                                             в т.ч.просроченный: &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& Б
───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.}
.fields
valbas    DoubleToStr(dogsum_t, '[|-]3666`666`666.88')            DoubleToStr(dsumma_t, '[|-]3666`666`666.88')         DoubleToStr(ksumma_t, '[|-]3666`666`666.88')
                                                                                                                                  totkonv           totourv
                                                                                                                                  totproskonv       totprosourv
.endfields

            БИТОГО по контрагентам в базовой валюте        @@@@@@                                               &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&
                                                                                                               долг:               &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&
                                                                                                             в т.ч.просроченный: &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& С
.endform
!
!=====================================================================================================================
! И
