/*
 ╔════════════════════════════════════════════════════════════════════════════╗
 ║                     (c) Корпорация ГАЛАКТИКА, 1996,97                      ║
 ║ Проект        : ГАЛАКТИКА                                                  ║
 ║ Система       : Оперативный контур                                         ║
 ║ Версия        : 4.30                                                       ║
 ║ Назначение    : Отчеты по исполняемым договорам                            ║
 ║ Ответственный : Володько Вадим Геннадьевич (VVG)                           ║
 ╚════════════════════════════════════════════════════════════════════════════╝
*/
#doc
Отчеты по исполняемым договорам
#end
.set name='ispdogov'
.hide
.fields  // IspDogov. Поля: Заголовок
    valtar       // символ национальной валюты
    valbas       // символ валюты для отчетов
    otheader     // "отчет по исполняемым ДО" и т.п.
    header1      // "сформирован за период  ..."
    header2      // "сформирован за период  ..." + национальная валюта
    header3      // "сформирован за период  ..." + валюта для отчетов
.endfields
^ ^ ^ ^ ^ ^
.{
.fields   // IspDogov. Поля: Справочная информация о контрагенте
cRecKontr : comp
kontrname kontraddr kontrtel
konbalans konbalansv
.endfields
^ ^ ^ ^ ^ ^
.{
.fields    // IspDogov. Поля: Информация по ДО
cRecBaseDoc : comp
dogname dognumb dogsoder dogdate dogpost maxDdate maxKdate dogprim
dogsum dogsumv
dogsumo           // сумма по ДО
dogsimval         // валюта ДО
v1                // сумма ДО для нерублевых ДО (в скобках)
v2                // процент наценки
dogNDS dogNDSv    // суммы налогов по ДО в нац., валюте для отчетов
dogNDSo
cRecDogovor : comp// nRec договора
Num_Dogovor       // номер договора
Date_Dogovor      // дата договора
Group_DO          // группа(-ы) ДО
Nazna_DO          // назначение из ДО
.endfields
^ // это nRec ДО
^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^
^ ^ ^ ^ ^
.{
.fields  // IspDogov. Поля: Суммы по дебету и кредиту
 _tiDkGalDb : word
 _cRecDb    : comp
 ddate ddocument dsumma dsummav dsumvaldoc dnamvaldoc dsummao dNDS dNDSv dNDSvaldoc dNDSo
 _tiDkGalKr : word
 _cRecKr    : comp
 kdate kdocument ksumma ksummav ksumvaldoc knamvaldoc ksummao kNDS kNDSv kNDSvaldoc kNDSo
.endfields
  ^ ^
  ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^
  ^ ^
  ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^
.}
.fields // IspDogov. Поля: Общие суммы и задолженности по дебету и кредиту
 dsummadoc dsummadocv dsummadoco
 ksummadoc ksummadocv ksummadoco

 dNDSdoc dNDSdocv dNDSdoco
 kNDSdoc kNDSdocv kNDSdoco

 ddolgdoc  ddolgdocv  ddolgdoco
 kdolgdoc  kdolgdocv  kdolgdoco

 ddolgNDS  ddolgNDSv  ddolgNDSo
 kdolgNDS  kdolgNDSv  kdolgNDSo

 dprosdoc  dprosdocv  dprosdoco
 kprosdoc  kprosdocv  kprosdoco

 dprosNDS  dprosNDSv  dprosNDSo
 kprosNDS  kprosNDSv  kprosNDSo
.endfields
  ^ ^ ^
  ^ ^ ^
  ^ ^ ^
  ^ ^ ^
  ^ ^ ^
  ^ ^ ^
  ^ ^ ^
  ^ ^ ^
  ^ ^ ^
  ^ ^ ^
  ^ ^ ^
  ^ ^ ^
.fields
remark
.endfields
^
.}
.fields    // IspDogov. Поля: Общие суммы по контрагенту
 dolgkon dolgkonv dolgour dolgourv
 proskon proskonv prosour prosourv
 dolgNDSkon dolgNDSkonv dolgNDSour dolgNDSourv
 prosNDSkon prosNDSkonv prosNDSour prosNDSourv
.endfields
  ^ ^ ^ ^
  ^ ^ ^ ^
  ^ ^ ^ ^
  ^ ^ ^ ^
.}
.fields  // IspDogov. Поля: Общие суммы по задолженности
 dateot
 totkon totkonv totour totourv
 totproskon totproskonv totprosour totprosourv
 totNDSkon totNDSkonv totNDSour totNDSourv
 totprosNDSkon totprosNDSkonv totprosNDSour totprosNDSourv
.endfields
  ^
  ^ ^ ^ ^
  ^ ^ ^ ^
  ^ ^ ^ ^
  ^ ^ ^ ^
.endform
!
!=============================================================================
!
#doc
Реестр исполняемых ДО
#end
.linkform 'IspDogov_01' prototype is 'ISPDOGOV'
.nameinlist 'Реестр исполняемых ДО'
.group 'В национальной валюте и валюте для отчетов'
.DEFO LANDSCAPE
.fields
  CommonFormHeader
   header1
   OtHeader
.endfields
^
              БРеестр документов-оснований, находящихся в состоянии исполнения
@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б

.{
═══════════════════════════════════════════════════════════════════════════════════════
.fields
kontrname
konbalans konbalansv
.endfields
 Контрагент:  Б^ Б
 Входящее сальдо - в НДЕ: &'&&&&&&&&&&&&&&&&.&&  в валюте отчета: &'&&&&&&&&&&&&&&&&.&&
───────────────────────────────────────────────────────────────────────────────────────
.{
.fields
dogname dognumb dogdate dogsum valtar dogsumv valbas v1 v2
dogprim
Num_Dogovor       // номер договора
Date_Dogovor      // дата договора
Group_DO          // группа(-ы) ДО
Nazna_DO          // назначение из ДО
maxDdate maxKdate
valtar valbas valtar valbas
.endfields
 ^ N ^ от ^ на сумму ^' ^, в валюте отчета: ^' ^ ^ ^
 ^
.{?Internal;Num_Dogovor<>'';
 Договор № ^ от ^
.}
.{?Internal;Group_DO<>'';
 РГруппа(-ы) ДО : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Р
.}
.{?Internal;Nazna_DO<>'';
 РНазначение    : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Р
.}
 Р
┌───────────────────────────────────────────────────────────────────────────────┐┌───────────────────────────────────────────────────────────────────────────────┐
│          ДЕБЕТ (поступления товаров/денег)     регламентный срок @@@@@@@@@@   ││         КРЕДИТ (наши платежи/поставки товаров)  регламентный срок @@@@@@@@@@  │
├──────────┬────────────────────────────────┬──────────────────┬────────────────┤├──────────┬────────────────────────────────┬──────────────────┬────────────────┤
│   Дата   │            Документ            │  Сумма в @~@@@@  │ Сумма в @~@@@@ ││   Дата   │            Документ            │  Сумма в @~@@@@  │ Сумма в @~@@@@ │
├──────────┴────────────────────────────────┴──────────────────┴────────────────┤├──────────┴────────────────────────────────┴──────────────────┴────────────────┤
.{
.fields
  ddate               ddocument                dsumma              dsummav           kdate               kdocument                ksumma              ksummav
.endfields
│@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&││@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&│
.}
└───────────────────────┬───────────────────────────────────────────────────────┤└──────────────────────┬────────────────────────────────────────────────────────┤
.fields
                                               dsummadoc           dsummadocv                                                     ksummadoc       ksummadocv
                                               ddolgdoc            ddolgdocv                                                      kdolgdoc        kdolgdocv
                                               dprosdoc            dprosdocv                                                      kprosdoc        kprosdocv
.endfields
                        │ Итого получено:    &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&│                       │ Итого отправлено:   &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&│
                        │ Долг контрагента:  &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&│                       │ Наш долг:           &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&│
                        │ В т.ч.просроченный:&'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&│                       │ В т.ч.просроченный: &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&│
                        └───────────────────────────────────────────────────────┘                       └────────────────────────────────────────────────────────┘
.fields
  remark
.endfields
 ^
───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── Р
.}

.fields           kontrname
                  dolgkon             valtar   dolgkonv             valbas
                  proskon             valtar   proskonv             valbas
                  dolgour             valtar   dolgourv             valbas
                  prosour             valtar   prosourv             valbas
.endfields
 Б Итого по контрагенту ^ Б
  его долг нам : &'&&&&&&&&&&&&&&&&&& @@@@@@   &'&&&&&&&&&&&&&&&&&& @@@@@@
  просроченный : &'&&&&&&&&&&&&&&&&&& @@@@@@   &'&&&&&&&&&&&&&&&&&& @@@@@@

  наш долг     : &'&&&&&&&&&&&&&&&&&& @@@@@@   &'&&&&&&&&&&&&&&&&&& @@@@@@
  просроченный : &'&&&&&&&&&&&&&&&&&& @@@@@@   &'&&&&&&&&&&&&&&&&&& @@@@@@
────────────────────────────────────────────────────────────────────────────────────────

.}
════════════════════════════════════════════════════════════════════════════════════════

.fields
                              dateot
                   totkon             valtar   totkonv              valbas
                   totproskon         valtar   totproskonv          valbas
                   totour             valtar   totourv              valbas
                   totprosour         valtar   totprosourv          valbas
.endfields
 Б Итого по всем контрагентам на ^ Б
  их долг нам :  &'&&&&&&&&&&&&&&&&&& @@@@@@   &'&&&&&&&&&&&&&&&&&& @@@@@@
  просроченный : &'&&&&&&&&&&&&&&&&&& @@@@@@   &'&&&&&&&&&&&&&&&&&& @@@@@@

  наш долг    :  &'&&&&&&&&&&&&&&&&&& @@@@@@   &'&&&&&&&&&&&&&&&&&& @@@@@@
  просроченный : &'&&&&&&&&&&&&&&&&&& @@@@@@   &'&&&&&&&&&&&&&&&&&& @@@@@@
───────────────────────────────────────────────────────────────────────────────────────
.endform
!
!=============================================================================
!
#doc
Реестр исполняемых ДО (с суммами в валюте операции)
#end
.linkform 'IspDogov_01_1' prototype is 'ISPDOGOV'
.nameinlist 'Реестр исполняемых ДО (с суммами в валюте операции)'
.group 'В национальной валюте и валюте для отчетов'
.DEFO LANDSCAPE
.fields
  CommonFormHeader
   header1
   OtHeader
.endfields
^
              БРеестр документов-оснований, находящихся в состоянии исполнения
@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б

.{
════════════════════════════════════════════════════════════════════════════════════════
.fields
kontrname
.endfields
 Контрагент:  Б^ Б
────────────────────────────────────────────────────────────────────────────────────────
.{
.fields
dogname dognumb dogdate dogsum valtar dogsumv valbas v1 v2
dogprim
Num_Dogovor       // номер договора
Date_Dogovor      // дата договора
maxDdate maxKdate
valtar valbas valtar valbas
.endfields
 Р ^ N ^ от ^ на сумму ^' ^, в валюте отчета: ^' ^ ^ ^
 ^ Р
.{?Internal;Num_Dogovor<>'';
 Договор № ^ от ^
.}
 Р
 И┌────────────────────────────────────────────────────────────────────────────────────────────────────────┐┌────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│          ДЕБЕТ (поступления товаров/денег)     регламентный срок @@@@@@@@@@                            ││                      КРЕДИТ (наши платежи/поставки товаров)     регламентный срок @@@@@@@@@@           │
├──────────┬─────────────────────────────────┬──────────────────┬────────────────┬───────────────────────┤├──────────┬─────────────────────────────────┬──────────────────┬────────────────┬───────────────────────┤
│   Дата   │             Документ            │  Сумма в @~@@@@  │ Сумма в @~@@@@ │     По документу      ││   Дата   │             Документ            │  Сумма в @~@@@@  │ Сумма в @~@@@@ │     По документу      │
├──────────┴─────────────────────────────────┴──────────────────┴────────────────┴───────────────────────┤├──────────┴─────────────────────────────────┴──────────────────┴────────────────┴───────────────────────┤ Ш
 Р.{
.fields
  ddate               ddocument                dsumma              dsummav      dsumvaldoc   dnamvaldoc      kdate               kdocument                ksumma            ksummav     ksumvaldoc   knamvaldoc
.endfields
 И│@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&& &'&&&&&&&&&&&&&& @@@@@@││@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&& &'&&&&&&&&&&&&&& @@@@@@│ И
.}
 И└────────────────────────┬────────────────────────────────────────────────────────┬──────────────────────┘└─────────────────────┬─────────────────────────────────────────────────────────┬────────────────────────┘ И
.fields
                                               dsummadoc           dsummadocv                                                                             ksummadoc       ksummadocv
                                               ddolgdoc            ddolgdocv                                                                              kdolgdoc        kdolgdocv
                                               dprosdoc            dprosdocv                                                             kprosdoc        kprosdocv
.endfields
 И                         │ Итого получено:    &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&& │                                             │ Итого отправлено:   &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&& │
                         │ Долг контрагента:  &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&& │                                             │ Наш долг:           &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&& │
                         │ В т.ч.просроченный:&'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&& │                                             │ В т.ч.просроченный: &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&& │
                         └────────────────────────────────────────────────────────┘                                             └─────────────────────────────────────────────────────────┘ Ш
 Р.fields
  remark
.endfields
 ^
 И──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── Ш
.}

.fields           kontrname
                  dolgkon             valtar   dolgkonv             valbas
                  proskon             valtar   proskonv             valbas
                  dolgour             valtar   dolgourv             valbas
                  prosour             valtar   prosourv             valbas
.endfields
 Б Итого по контрагенту ^ Б

  его долг нам : &'&&&&&&&&&&&&&&&&&& @@@@@@   &'&&&&&&&&&&&&&&&&&& @@@@@@
  просроченный : &'&&&&&&&&&&&&&&&&&& @@@@@@   &'&&&&&&&&&&&&&&&&&& @@@@@@

  наш долг     : &'&&&&&&&&&&&&&&&&&& @@@@@@   &'&&&&&&&&&&&&&&&&&& @@@@@@
  просроченный : &'&&&&&&&&&&&&&&&&&& @@@@@@   &'&&&&&&&&&&&&&&&&&& @@@@@@
──────────────────────────────────────────────────────────────────────────────────────────

.}
══════════════════════════════════════════════════════════════════════════════════════════

.fields
                              dateot
                   totkon             valtar   totkonv              valbas
                   totproskon         valtar   totproskonv          valbas
                   totour             valtar   totourv              valbas
                   totprosour         valtar   totprosourv          valbas
.endfields
 Б Итого по всем контрагентам на ^ Б
  их долг нам :  &'&&&&&&&&&&&&&&&&&& @@@@@@   &'&&&&&&&&&&&&&&&&&& @@@@@@
  просроченный : &'&&&&&&&&&&&&&&&&&& @@@@@@   &'&&&&&&&&&&&&&&&&&& @@@@@@

  наш долг    :  &'&&&&&&&&&&&&&&&&&& @@@@@@   &'&&&&&&&&&&&&&&&&&& @@@@@@
  просроченный : &'&&&&&&&&&&&&&&&&&& @@@@@@   &'&&&&&&&&&&&&&&&&&& @@@@@@
──────────────────────────────────────────────────────────────────────────────────────────
.endform
!
!=============================================================================
!
#doc
Реестр исполняемых ДО (с суммами в валюте документа)
#end
.linkform 'IspDogov_01_2' prototype is 'ISPDOGOV'
.nameinlist 'Реестр исполняемых ДО (с суммами в валюте документа)'
.group 'В национальной валюте и валюте для отчетов'
.DEFO LANDSCAPE
.fields
  CommonFormHeader
   header1
   OtHeader
.endfields
^
              БРеестр документов-оснований, находящихся в состоянии исполнения
@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б

.{
 Р══════════════════════════════════════════════════════════════════════════════════════════ Р
.fields
kontrname
.endfields
  БКонтрагент: Б  Р^ Р
 Р───────────────────────────────────────────────────────────────────────────────────────── Р
.{
.fields
dogname dognumb dogdate dogsum valtar dogsumv valbas v1 v2
dogprim
Num_Dogovor       // номер договора
Date_Dogovor      // дата договора
maxDdate maxKdate
valtar valbas dogsimval valtar valbas dogsimval
.endfields
 Р ^ N ^ от ^ на сумму ^' ^, в валюте отчета: ^' ^ ^ ^
 ^ Р
.{?Internal;Num_Dogovor<>'';
 Договор № ^ от ^
.}
 Р
 И┌─────────────────────────────────────────────────────────────────────────────────────────────────┐┌─────────────────────────────────────────────────────────────────────────────────────────────────┐
│          ДЕБЕТ (поступления товаров/денег)     регламентный срок @@@@@@@@@@                     ││                      КРЕДИТ (наши платежи/поставки товаров)     регламентный срок @@@@@@@@@@    │
├──────────┬─────────────────────────────────┬──────────────────┬────────────────┬────────────────┤├──────────┬─────────────────────────────────┬──────────────────┬────────────────┬────────────────┤
│   Дата   │             Документ            │  Сумма в @~@@@@  │ Сумма в @~@@@@ │ Сумма в @~@@@@ ││   Дата   │             Документ            │  Сумма в @~@@@@  │ Сумма в @~@@@@ │ Сумма в @~@@@@ │
├──────────┴─────────────────────────────────┴──────────────────┴────────────────┴────────────────┤├──────────┴─────────────────────────────────┴──────────────────┴────────────────┴────────────────┤ Ш
 Р.{
.fields
  ddate               ddocument                dsumma              dsummav          dsummao           kdate               kdocument                ksumma            ksummav         ksummao
.endfields
 И│@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&││@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&│ И
.}
 И└────────────────────────┬────────────────────────────────────────────────────────────────────────┤└───────────────────────┬─────────────────────────────────────────────────────────────────────────┤ И
.fields
                                               dsummadoc           dsummadocv       dsummadoco                                                     ksummadoc       ksummadocv        ksummadoco
                                               ddolgdoc            ddolgdocv        ddolgdoco                                                      kdolgdoc        kdolgdocv         kdolgdoco
                                               dprosdoc            dprosdocv        dprosdoco                                     kprosdoc        kprosdocv                          kprosdoco
.endfields
 И                         │ Итого получено:    &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&│                        │ Итого отправлено:   &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&│
                         │ Долг контрагента:  &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&│                        │ Наш долг:           &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&│
                         │ В т.ч.просроченный:&'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&│                        │ В т.ч.просроченный: &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&│
                         └────────────────────────────────────────────────────────────────────────┘                        └─────────────────────────────────────────────────────────────────────────┘ Ш
 Р.fields
  remark
.endfields
 ^
 И────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── Ш
.}

.fields           kontrname
                  dolgkon             valtar   dolgkonv             valbas
                  proskon             valtar   proskonv             valbas
                  dolgour             valtar   dolgourv             valbas
                  prosour             valtar   prosourv             valbas
.endfields
 Б Итого по контрагенту ^ Б

  его долг нам : &'&&&&&&&&&&&&&&&&&& @@@@@@   &'&&&&&&&&&&&&&&&&&& @@@@@@
  просроченный : &'&&&&&&&&&&&&&&&&&& @@@@@@   &'&&&&&&&&&&&&&&&&&& @@@@@@

  наш долг     : &'&&&&&&&&&&&&&&&&&& @@@@@@   &'&&&&&&&&&&&&&&&&&& @@@@@@
  просроченный : &'&&&&&&&&&&&&&&&&&& @@@@@@   &'&&&&&&&&&&&&&&&&&& @@@@@@
───────────────────────────────────────────────────────────────────────────────────────────

.}
═══════════════════════════════════════════════════════════════════════════════════════════

.fields
                              dateot
                   totkon             valtar   totkonv              valbas
                   totproskon         valtar   totproskonv          valbas
                   totour             valtar   totourv              valbas
                   totprosour         valtar   totprosourv          valbas
.endfields
 Б Итого по всем контрагентам на ^ Б
  их долг нам :  &'&&&&&&&&&&&&&&&&&& @@@@@@   &'&&&&&&&&&&&&&&&&&& @@@@@@
  просроченный : &'&&&&&&&&&&&&&&&&&& @@@@@@   &'&&&&&&&&&&&&&&&&&& @@@@@@

  наш долг    :  &'&&&&&&&&&&&&&&&&&& @@@@@@   &'&&&&&&&&&&&&&&&&&& @@@@@@
  просроченный : &'&&&&&&&&&&&&&&&&&& @@@@@@   &'&&&&&&&&&&&&&&&&&& @@@@@@
───────────────────────────────────────────────────────────────────────────────────────────
.endform
!
!=============================================================================
!
#doc
Реестр исполняемых ДО (самый подробный: со всеми суммами)
#end
.linkform 'IspDogov_01_3' prototype is 'ISPDOGOV'
.nameinlist 'Реестр исполняемых ДО (самый подробный: со всеми суммами)'
.group 'В национальной валюте и валюте для отчетов'
.DEFO LANDSCAPE
.fields
  CommonFormHeader
   header1
   OtHeader
.endfields
^
              БРеестр документов-оснований, находящихся в состоянии исполнения
@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б

.{
 Р═══════════════════════════════════════════════════════════════════════════════════════════ Р
.fields
kontrname
.endfields
 Контрагент:  Б^ Б
 Р─────────────────────────────────────────────────────────────────────────────────────────── Р
.{
.fields
dogname dognumb dogdate dogsum valtar dogsumv valbas v1 v2
dogprim
Num_Dogovor       // номер договора
Date_Dogovor      // дата договора
maxDdate maxKdate
valtar valbas dogsimval valtar valbas dogsimval
.endfields
 Р ^ N ^ от ^ на сумму ^' ^, в валюте отчета: ^' ^ ^ ^
 ^ Р
.{?Internal;Num_Dogovor<>'';
 Договор № ^ от ^
.}
 Р
 И┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│          ДЕБЕТ (поступления товаров/денег)     регламентный срок @@@@@@@@@@                                             ││                      КРЕДИТ (наши платежи/поставки товаров)    регламентный срок @@@@@@@@@@                             │
├──────────┬─────────────────────────────────┬───────────────────────┬──────────────────┬────────────────┬────────────────┤├──────────┬─────────────────────────────────┬───────────────────────┬──────────────────┬────────────────┬────────────────┤
│   Дата   │             Документ            │  Сумма по документу   │  Сумма в @~@@@@  │ Сумма в @~@@@@ │ Сумма в @~@@@@ ││   Дата   │             Документ            │  Сумма по документу   │  Сумма в @~@@@@  │ Сумма в @~@@@@ │ Сумма в @~@@@@ │
├──────────┴─────────────────────────────────┴───────────────────────┴──────────────────┴────────────────┴────────────────┤├──────────┴─────────────────────────────────┴───────────────────────┴──────────────────┴────────────────┴────────────────┤ Ш
 Р.{
.fields
  ddate               ddocument             dsumvaldoc   dnamvaldoc    dsumma              dsummav          dsummao           kdate               kdocument          ksumvaldoc   knamvaldoc       ksumma            ksummav          ksummao
.endfields
 И│@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&&&& @@@@@@ &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&││@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&&&& @@@@@@ &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&│ И
.}
 И└───────────────────────────────────────────────┬─────────────────────────────────────────────────────────────────────────┤└──────────────────────────────────────────────┬──────────────────────────────────────────────────────────────────────────┤ И
.fields
                                                                      dsummadoc           dsummadocv       dsummadoco                                                                             ksummadoc       ksummadocv       ksummadoco
                                                                      ddolgdoc            ddolgdocv        ddolgdoco                                                                              kdolgdoc        kdolgdocv        kdolgdoco
                                                                      dprosdoc            dprosdocv        dprosdoco                                                                              kprosdoc        kprosdocv        kprosdoco
.endfields
 И                                                │ Итого получено:     &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&│                                               │ Итого отправлено:    &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&│
                                                │ Долг контрагента:   &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&│                                               │ Наш долг:            &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&│
                                                │ В т.ч.просроченный: &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&│                                               │ В т.ч.просроченный:  &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&│
                                                └─────────────────────────────────────────────────────────────────────────┘                                               └──────────────────────────────────────────────────────────────────────────┘ Ш
 Р.fields
  remark
.endfields
 ^
 И────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── Ш
.}

.fields           kontrname
                  dolgkon             valtar   dolgkonv             valbas
                  proskon             valtar   proskonv             valbas
                  dolgour             valtar   dolgourv             valbas
                  prosour             valtar   prosourv             valbas
.endfields
 Б Итого по контрагенту ^ Б

  его долг нам : &'&&&&&&&&&&&&&&&&&& @@@@@@   &'&&&&&&&&&&&&&&&&&& @@@@@@
  просроченный : &'&&&&&&&&&&&&&&&&&& @@@@@@   &'&&&&&&&&&&&&&&&&&& @@@@@@

  наш долг     : &'&&&&&&&&&&&&&&&&&& @@@@@@   &'&&&&&&&&&&&&&&&&&& @@@@@@
  просроченный : &'&&&&&&&&&&&&&&&&&& @@@@@@   &'&&&&&&&&&&&&&&&&&& @@@@@@
──────────────────────────────────────────────────────────────────────────────────────────

.}
══════════════════════════════════════════════════════════════════════════════════════════

.fields
                              dateot
                   totkon             valtar   totkonv              valbas
                   totproskon         valtar   totproskonv          valbas
                   totour             valtar   totourv              valbas
                   totprosour         valtar   totprosourv          valbas
.endfields
 Б Итого по всем контрагентам на ^ Б
  их долг нам :  &'&&&&&&&&&&&&&&&&&& @@@@@@   &'&&&&&&&&&&&&&&&&&& @@@@@@
  просроченный : &'&&&&&&&&&&&&&&&&&& @@@@@@   &'&&&&&&&&&&&&&&&&&& @@@@@@

  наш долг    :  &'&&&&&&&&&&&&&&&&&& @@@@@@   &'&&&&&&&&&&&&&&&&&& @@@@@@
  просроченный : &'&&&&&&&&&&&&&&&&&& @@@@@@   &'&&&&&&&&&&&&&&&&&& @@@@@@
──────────────────────────────────────────────────────────────────────────────────────────
.endform
!
!=============================================================================
!
#doc
Отчет по долгам в разрезе ДО (в национальной валюте)
#end
.linkform 'IspDogov_02' prototype is 'ISPDOGOV'
.NameInList 'Отчет по долгам в разрезе ДО (в национальной валюте)'
.group 'В национальной валюте'
.DEFO LANDSCAPE
.var
  dogsum_k
, dsumma_k
, ksumma_k
, dogsum_t
, dsumma_t
, ksumma_t
  : double;
.endvar
.begin
  dogsum_t := 0;
  dsumma_t := 0;
  ksumma_t := 0;
end.
.fields
  CommonFormHeader
   header2 OtHeader
.endfields
^
           БОтчет по документам-основаниям, находящимся в состоянии исполнения
@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
 Ш
──────────────────────────────────┬──────────┬────────────┬──────────────────┬──────────────────┬──────────────────┬──────────────────┬──────────────────┬──────────────────┬──────────────────┬────────────────────────────────────────────────────────────
         Наименование ДО          │   Дата   │   Номер    │   Сумма по ДО    │Оплатил контрагент│  Оплачено нами   │ Долг контрагента │в т.ч.просроченный│     Наш долг     │в т.ч.просроченный│  Примечания
──────────────────────────────────┴──────────┴────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┴────────────────────────────────────────────────────────────
.{
.begin
  dogsum_k := 0;
  dsumma_k := 0;
  ksumma_k := 0;
end.
.fields
kontrname
.endfields
 Контрагент: ^
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.{
.{
.}
.begin
  dogsum_k := dogsum_k + double(dogsum);
  dsumma_k := dsumma_k + double(dsummadoc);
  ksumma_k := ksumma_k + double(ksummadoc);
  dogsum_t := dogsum_t + double(dogsum);
  dsumma_t := dsumma_t + double(dsummadoc);
  ksumma_t := ksumma_t + double(ksummadoc);
end.
.fields
            dogname                dogdate    dognumb          dogsum           dsummadoc        ksummadoc           ddolgdoc           dprosdoc           kdolgdoc           kprosdoc        remark
.endfields
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@ @~@@@@@@@@@@ &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& ^
.}
.fields
 DoubleToStr(dogsum_k, '[|-]3666`666`666.88')             DoubleToStr(dsumma_k, '[|-]3666`666`666.88')         DoubleToStr(ksumma_k, '[|-]3666`666`666.88')            dolgkon            proskon            dolgour            prosour
.endfields
           ВСЕГО по контрагенту                          &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.}
.fields
 DoubleToStr(dogsum_t, '[|-]3666`666`666.88')              DoubleToStr(dsumma_t, '[|-]3666`666`666.88')          DoubleToStr(ksumma_t, '[|-]3666`666`666.88')            totkon             totproskon         totour             totprosour
.endfields
           ИТОГО по контрагентам                         &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& Ш
 А.endform
!
!=============================================================================
!
#doc
Отчет по долгам в разрезе ДО (в валюте для отчетов)
#end
.linkform 'ISPDOGOV_02_1' prototype is 'ISPDOGOV'
.NameInList 'Отчет по долгам в разрезе ДО (в валюте для отчетов)'
.group 'В валюте для отчетов'
.DEFO LANDSCAPE
.var
  dogsum_k
, dsumma_k
, ksumma_k
, dogsum_t
, dsumma_t
, ksumma_t
  : double;
.endvar
.begin
  dogsum_t := 0;
  dsumma_t := 0;
  ksumma_t := 0;
end.
.fields
  CommonFormHeader
  header3 OtHeader
.endfields
^
           БОтчет по документам-основаниям, находящимся в состоянии исполнения
@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
 Р
 И──────────────────────────────────┬──────────┬────────────┬──────────────────┬──────────────────┬──────────────────┬──────────────────┬──────────────────┬──────────────────┬──────────────────┬────────────────────────────────────────────────────────────
         Наименование ДО          │   Дата   │   Номер    │   Сумма по ДО    │Оплатил контрагент│  Оплачено нами   │ Долг контрагента │в т.ч.просроченный│     Наш долг     │в т.ч.просроченный│  Примечания
──────────────────────────────────┴──────────┴────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┴────────────────────────────────────────────────────────────
.{
.begin
  dogsum_k := 0;
  dsumma_k := 0;
  ksumma_k := 0;
end.
.fields
kontrname
.endfields
 Контрагент: ^
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.{
.{
.}
.begin
  dogsum_k := dogsum_k + double(dogsumv);
  dsumma_k := dsumma_k + double(dsummadocv);
  ksumma_k := ksumma_k + double(ksummadocv);
  dogsum_t := dogsum_t + double(dogsumv);
  dsumma_t := dsumma_t + double(dsummadocv);
  ksumma_t := ksumma_t + double(ksummadocv);
end.
.fields
            dogname                dogdate    dognumb          dogsumv          dsummadocv       ksummadocv          ddolgdocv          dprosdocv          kdolgdocv          kprosdocv       remark
.endfields
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@@@ &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& ^
.}
.fields
DoubleToStr(dogsum_k, '[|-]3666`666`666.88')            DoubleToStr(dsumma_k, '[|-]3666`666`666.88')         DoubleToStr(ksumma_k, '[|-]3666`666`666.88')           dolgkonv           proskonv          dolgourv           prosourv
.endfields
           ВСЕГО по контрагенту                          &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.}
.fields
DoubleToStr(dogsum_t, '[|-]3666`666`666.88')             DoubleToStr(dsumma_t, '[|-]3666`666`666.88')         DoubleToStr(ksumma_t, '[|-]3666`666`666.88')           totkonv            totproskonv      totourv            totprosourv
.endfields
           ИТОГО по контрагентам                         &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& Ш
.endform
!
!=====================================================================================================================
!
#doc
Отчет по долгам в разрезе ДО (в валюте документа)
#end
.linkform 'ISPDOGOV_02_2' prototype is 'ISPDOGOV'
.NameInList 'Отчет по долгам в разрезе ДО (в валюте документа)'
.group 'В валюте документа'
.DEFO LANDSCAPE
.var
  dogsum_k
, dsumma_k
, ksumma_k
, dogsum_t
, dsumma_t
, ksumma_t
  : double;
.endvar
.begin
  dogsum_t := 0;
  dsumma_t := 0;
  ksumma_t := 0;
end.
.fields
  CommonFormHeader
  header1 OtHeader
.endfields
^
           БОтчет по документам-основаниям, находящимся в состоянии исполнения
@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
 Ш
──────────────────────────────────┬──────────┬────────────┬──────┬──────────────────┬──────────────────┬──────────────────┬──────────────────┬──────────────────┬──────────────────┬──────────────────┬────────────────────────────────────────────────────
         Наименование ДО          │   Дата   │   Номер    │Валюта│   Сумма по ДО    │Оплатил контрагент│  Оплачено нами   │ Долг контрагента │в т.ч.просроченный│     Наш долг     │в т.ч.просроченный│  Примечания
──────────────────────────────────┴──────────┴────────────┴──────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┴────────────────────────────────────────────────────
.{
.begin
  dogsum_k := 0;
  dsumma_k := 0;
  ksumma_k := 0;
end.
.fields
kontrname
.endfields
 Контрагент: ^
───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.{
.{
.}
.begin
  dogsum_k := dogsum_k + double(dogsumo);
  dsumma_k := dsumma_k + double(dsummadoco);
  ksumma_k := ksumma_k + double(ksummadoco);
  dogsum_t := dogsum_t + double(dogsumo);
  dsumma_t := dsumma_t + double(dsummadoco);
  ksumma_t := ksumma_t + double(ksummadoco);
end.
.fields
            dogname                dogdate    dognumb   dogsimval     dogsumo          dsummadoco       ksummadoco          ddolgdoco          dprosdoco          kdolgdoco          kprosdoco       remark
.endfields
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@@@ @@@@@@ &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& ^
.}
.fields
valbas        DoubleToStr(dogsum_k, '[|-]3666`666`666.88')      DoubleToStr(dsumma_k, '[|-]3666`666`666.88')     DoubleToStr(ksumma_k, '[|-]3666`666`666.88')         dolgkonv           proskonv          dolgourv           prosourv
.endfields
           ВСЕГО по контрагенту в базовой валюте       @@@@@@   &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&
───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.}
.fields
valbas       DoubleToStr(dogsum_t, '[|-]3666`666`666.88')      DoubleToStr(dsumma_t, '[|-]3666`666`666.88')      DoubleToStr(ksumma_t, '[|-]3666`666`666.88')          totkonv            totproskonv      totourv            totprosourv
.endfields
           ИТОГО по контрагентам в базовой валюте      @@@@@@   &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& Ш
.endform
!
!=====================================================================================================================
!
#doc
Oтчет по долгам в разрезе Kонтрагентов (в национальной валюте)
#end
.linkform 'ISPDOGOV_03' prototype is 'ISPDOGOV'
.NameInList 'Oтчет по долгам в разрезе Kонтрагентов (в национальной валюте)'
.group 'В национальной валюте'
.DEFO PORTRAIT
.fields
  CommonFormHeader
  header2 OtHeader
.endfields
^
       БОтчет по долгам контрагентов в рамках исполняемых документов-оснований
@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
 Р
─────────────────────────────────────┬───────────────────┬───────────────────┬───────────────────┬───────────────────
      Наименование контрагента       │ Долг контрагента  │в т.ч.просроченный │     Наш долг      │в т.ч.просроченный
─────────────────────────────────────┴───────────────────┴───────────────────┴───────────────────┴───────────────────

.{
.{
.{
.}
.}
.fields
               KontrName                    dolgkon             proskon             dolgour             prosour
.endfields
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&
.}
.fields
                                            totkon              totproskon          totour              totprosour
.endfields

       БИТОГО по всем контрагентам:     &'&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&& С
.endform
!
!=====================================================================================================================
!
#doc
Oтчет по долгам в разрезе Kонтрагентов (в валюте для отчетов)
#end
.linkform 'IspDogov_03_1' prototype is 'ISPDOGOV'
.NameInList 'Oтчет по долгам в разрезе Kонтрагентов (в валюте для отчетов)'
.group 'В валюте для отчетов'
.DEFO LANDSCAPE
.fields
  CommonFormHeader
  header3 OtHeader
.endfields
^
       БОтчет по долгам контрагентов в рамках исполняемых документов-оснований
@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
 Р
─────────────────────────────────────┬───────────────────┬───────────────────┬───────────────────┬───────────────────
      Наименование контрагента       │ Долг контрагента  │в т.ч.просроченный │     Наш долг      │в т.ч.просроченный
─────────────────────────────────────┴───────────────────┴───────────────────┴───────────────────┴───────────────────

.{
.{
.{
.}
.}
.fields
               KontrName                    dolgkonv            proskonv            dolgourv            prosourv
.endfields
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&
.}
.fields
                                            totkonv             totproskonv         totourv             totprosourv
.endfields

 Б      ИТОГО по всем контрагентам:     &'&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&& С
.endform
!
!====================================================================================================================
! А

#include ispdogov.frn
