/*
 ╔═══════════════════════════════════════════════════════════════════════════╗
 ║                     (c) 1995, 2003 корпорация ГАЛАКТИКА                   ║
 ║ Проект        : ГАЛАКТИКА                                                 ║
 ║ Система       : УКС - Управление капитальным строительством               ║
 ║ Версия        : 5.8x                                                      ║
 ║ Назначение    : Ведомость движения МЦ по контрагентам и объектам строит-ва║
 ║ Ответственный : Окуневич Руслан Васильевич (RusLAN)                       ║
 ╚═══════════════════════════════════════════════════════════════════════════╝
*/
#doc
Ведомость движения МЦ по контрагентам и объектам строительства
#end
.Set Name = 'KontrObj'
.Hide
.Fields
 dStart dStop sNDE_1 /* рублях        */
              sNDE_2 /* руб.          */
              sVal_r /* валюта отчета */
              sEdMode sOperMode sSortMode
 Esc
 TmpE1 TmpP1 TmpR1
 TmpE2 TmpP2 TmpR2
 TmpE3 TmpP3 TmpR3
 TmpE4 TmpP4 TmpR4
 TmpE5 TmpP5 TmpR5
!.{ Цикл по контрагентам
 sKontrag
!.{ Цикл по операциям в разрезе контрагента
 sMC sBarKod sEdIzm dOper nSopr sObject
!                fK_x - количество
!                fPxx - цена
!                fSxx - сумма
!                fTotKonSxx - итого сумма по контрагенту
!                fTotalSxx  - итого сумма по предприятию

!                fxNx - в НДЕ
!                fxVx - в валюте документа
!                fxRx - в валюте для отчетов

!                fxxP - приход
!                fxxR - расход
          fK_P    fPNP  fPVP    fSNP  fSVP   sValP /* валюта приходного документа */
 sSklFrom fK_R    fPNR  fPVR    fSNR  fSVR   sValR /* валюта расходного документа */
!.} Конец цикла по операциям
 TmpE7 TmpP7 TmpR7
 TmpE8 fTotKonSNP fTotKonSRP fTotKonSNR fTotKonSRR
!.} Конец цикла по контрагентам
!.if engkontr02  Если формирование по всем контрагентам
 TmpE9 fTotalSNP fTotalSRP fTotalSNR fTotalSRR
!.end
.EndFields
 dStart ^ dStop ^
 sNDE_1 "^" sNDE_2 "^" sVal_r "^" sEdMode "^" sOperMode "^" sSortMode "^"
 Esc ^ Форматирование
 .{.?koe1; TmpE1 ^.} .{.?kop1; TmpP1 ^.} .{.?kor1; TmpR1 ^.}
 .{.?koe2; TmpE2 ^.} .{.?kop2; TmpP2 ^.} .{.?kor2; TmpR2 ^.}
 .{.?koe3; TmpE3 ^.} .{.?kop3; TmpP3 ^.} .{.?kor3; TmpR3 ^.}
 .{.?koe4; TmpE4 ^.} .{.?kop4; TmpP4 ^.} .{.?kor4; TmpR4 ^.}
 .{.?koe5; TmpE5 ^.} .{.?kop5; TmpP5 ^.} .{.?kor5; TmpR5 ^.}
.{
 sKontrag "^"
.{
 sMC "^" sBarKod "^"
 .{.?koe6; sEdIzm "^".} dOper ^ nSopr "^" sObject "^"
                     .{.?kop6;              fK_P ^ fPNP ^ fPVP ^ fSNP ^ fSVP ^ sValP "^" .}
                     .{.?kor6; sSklFrom "^" fK_R ^ fPNR ^ fPVR ^ fSNR ^ fSVR ^ sValR "^" .}
.}
 .{.?koe7; TmpE7 ^.} .{.?kop7; TmpP7 ^.} .{.?kor7; TmpR7 ^.}
 .{.?koe8; TmpE8 ^.} .{.?kop8; fTotKonSNP ^ fTotKonSRP ^.}
                     .{.?kor8; fTotKonSNR ^ fTotKonSRR ^.}
.}
.if engkontr02
 .{.?koe9; TmpE9 ^.} .{.?kop9; fTotalSNP ^ fTotalSRP ^.}
                     .{.?kor9; fTotalSNR ^ fTotalSRR ^.}
.end
.EndForm


!*****************************************************************************
#doc
Ведомость движения МЦ по контрагентам и объектам строительства
#end
.LinkForm 'KontrObj_01' Prototype is 'KontrObj'
.NameInList 'Ведомость движения МЦ по контрагентам и объектам строительства'
.Group 'A1'
.Fields
 dStart dStop sEdMode
 Esc TmpE1 TmpP1 TmpR1
        TmpE2 TmpP2 TmpR2
        TmpE3 TmpP3 TmpR3
        TmpE4 sNDE_1 sNDE_1 sNDE_1 sNDE_1
        TmpE5 TmpP5 TmpR5
!.{
 Esc sKontrag Esc
!.{
 sMC sBarKod sEdIzm dOper nSopr sObject
          fK_P fPNP fSNP
 sSklFrom fK_R fPNR fSNR
!.}
 TmpE7 TmpP7 TmpR7
 TmpE8 fTotKonSNP fTotKonSNR
!.}
!.if engkontr02
 TmpE9 fTotalSNP fTotalSNR
!.end
.EndFields

                  БВЕДОМОСТЬ ДВИЖЕНИЯ МАТЕРИАЛЬНЫХ ЦЕННОСТЕЙ
                 В ПЕРИОД С ^ г. ПО ^ г. Б

 В^ В^
───────────────────────────┬────────────.{.?koe1;┬────────@.}┬──────────┬─────────┬──────────────────.{.?kop1;┬────────────────────────────────────────────────@.}.{.?kor1;┬─────────────────────────────────────────────────────────────────────@.}
                           │ Номенклат. .{.?koe2;│ Единица@.}│   Дата   │  Номер  │     Объект       .{.?kop2;│                      П Р И Х О Д               @.}.{.?kor2;│                            Р А С Х О Д                              @.}
  Наименование матценности │   номер    .{.?koe3;│измерени@.}│ операции │накладной│  строительства   .{.?kop3;├──────────┬────────────────┬────────────────────@.}.{.?kor3;┼──────────────────┬──────────┬──────────────────┬────────────────────@.}
                           │            .{.?koe4;│        @.}│          │         │                  .{.?kop4;│Количество│Цена в @@@@@@@@@│Стоимость в @@@@@@@@@.}.{.?kor4;│      Откуда      │Количество│Цена в @@@@@@@@@@@│Стоимость в @@@@@@@@@.}
───────────────────────────┴────────────.{.?koe5;┴────────@.}┴──────────┴─────────┴──────────────────.{.?kop5;┴──────────┴────────────────┴────────────────────@.}.{.?kor5;┴──────────────────┴──────────┴──────────────────┴────────────────────@.}
.{
^ И    Контрагент:  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Й^
.{
 @@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@.{.?koe6; @@@@@@@@@.} @@@@@@@@@@ @@@@@@@@@ @@@@@@@@@@@@@@@@@@.{.?kop6; &&&&&&.&&& &'&&&&&&&&&&&.&& &'&&&&&&&&&&&&&&&&.&& .}.{.?kor6;@@@@@@@@@@@@@@@@@@ &&&&&&.&&& &'&&&&&&&&&&&&&.&& &'&&&&&&&&&&&&&&&&.&& .}
.}
────────────────────────────────────────.{.?koe7;─────────@.}────────────────────────────────────────.{.?kop7;─────────────────────────────────────────────────@.}.{.?kor7;──────────────────────────────────────────────────────────────────────@.}
 ИТОГО ПО КОНТРАГЕНТУ :                 .{.?koe8;         @.}                                        .{.?kop8;                             &'&&&&&&&&&&&&&&&&.&& .}.{.?kor8;                                                 &'&&&&&&&&&&&&&&&&.&& .}

.}
.if engkontr02
 ИТОГО ПО ПРЕДПРИЯТИЮ :                 .{.?koe9;         @.}                                        .{.?kop9;                             &'&&&&&&&&&&&&&&&&.&& .}.{.?kor9;                                                 &'&&&&&&&&&&&&&&&&.&& .}
.end
.EndForm
!
!
!
!*****************************************************************************
#doc
Ведомость движения МЦ по контрагентам и объектам строительства
#end
.LinkForm 'KontrObj_02' Prototype is 'KontrObj'
.NameInList 'Ведомость движения МЦ по контрагентам и объектам строительства'
.Group 'A2'
.Fields
 dStart dStop sEdMode
 Esc TmpE1 TmpP1 TmpR1
        TmpE2 TmpP2 TmpR2
        TmpE3 TmpP3 TmpR3
        TmpE4 TmpP4 TmpR4
        TmpE5 TmpP5 TmpR5
!.{
 Esc sKontrag Esc
!.{
 sMC sBarKod sEdIzm dOper nSopr sObject
          fK_P   fPVP sValP   fSVP sValP
 sSklFrom fK_R   fPVR sValR   fSVR sValR
!.}
 TmpE7 TmpP7 TmpR7
 TmpE8 fTotKonSRP sVal_r fTotKonSRR sVal_r
!.}
!.if engkontr02
 TmpE9 fTotalSRP  sVal_r fTotalSRR  sVal_r
!.end
.EndFields

                  БВЕДОМОСТЬ ДВИЖЕНИЯ МАТЕРИАЛЬНЫХ ЦЕННОСТЕЙ
                 В ПЕРИОД С ^ г. ПО ^ г. Б

 В^ В^
───────────────────────────┬────────────.{.?koe1;┬────────@.}┬──────────┬─────────┬──────────────────.{.?kop1;┬───────────────────────────────────────────────@.}.{.?kor1;┬──────────────────────────────────────────────────────────────────@.}
                           │ Номенклат. .{.?koe2;│ Единица@.}│   Дата   │  Номер  │     Объект       .{.?kop2;│                    П Р И Х О Д                @.}.{.?kor2;│                            Р А С Х О Д                           @.}
  Наименование матценности │   номер    .{.?koe3;│измерени@.}│ операции │накладной│  строительства   .{.?kop3;├──────────┬───────────────┬────────────────────@.}.{.?kor3;┼──────────────────┬──────────┬───────────────┬────────────────────@.}
                           │            .{.?koe4;│        @.}│          │         │                  .{.?kop4;│Количество│ Цена в валюте │ Стоимость в валюте @.}.{.?kor4;│      Откуда      │Количество│ Цена в валюте │ Стоимость в валюте @.}
───────────────────────────┴────────────.{.?koe5;┴────────@.}┴──────────┴─────────┴──────────────────.{.?kop5;┴──────────┴───────────────┴────────────────────@.}.{.?kor5;┴──────────────────┴──────────┴───────────────┴────────────────────@.}
.{
^ И    Контрагент:  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Й^
.{
 @@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@.{.?koe6; @@@@@@@@@.} @@@@@@@@@@ @@@@@@@@@ @@@@@@@@@@@@@@@@@@.{.?kop6; &&&&&&.&&& &&&&&.&& @@@@@@ &&&&&&&&&&&.&& @@@@@@.}.{.?kor6; @@@@@@@@@@@@@@@@@@ &&&&&&.&&& &&&&&.&& @@@@@@ &&&&&&&&&&&.&& @@@@@@.}
.}
────────────────────────────────────────.{.?koe7;─────────@.}────────────────────────────────────────.{.?kop7;────────────────────────────────────────────────@.}.{.?kor7;───────────────────────────────────────────────────────────────────@.}
 ИТОГО ПО КОНТРАГЕНТУ :                 .{.?koe8;         @.}                                        .{.?kop8;                      &'&&&&&&&&&&&&&&&.&& @@@@@@.}.{.?kor8;                                         &'&&&&&&&&&&&&&&&.&& @@@@@@.}

.}
.if engkontr02
 ИТОГО ПО ПРЕДПРИЯТИЮ :                 .{.?koe9;         @.}                                        .{.?kop9;                      &'&&&&&&&&&&&&&&&.&& @@@@@@.}.{.?kor9;                                         &'&&&&&&&&&&&&&&&.&& @@@@@@.}
.end
.EndForm
!
!
!
!*****************************************************************************
#doc
Ведомость движения МЦ по контрагентам и объектам строительства
#end
.LinkForm 'KontrObj_03' Prototype is 'KontrObj'
.NameInList 'Ведомость движения МЦ по контрагентам и объектам строительства'
.Group 'A3'
.Fields
 dStart dStop sEdMode
 Esc TmpE1 TmpP1 TmpR1
        TmpE2 TmpP2 TmpR2
        TmpE3 TmpP3 TmpR3
        TmpE4 sNDE_1 sNDE_1 TmpP4 sNDE_1 sNDE_1 TmpR4
        TmpE5 TmpP5 TmpR5
!.{
 Esc sKontrag Esc
!.{
 sMC sBarKod sEdIzm dOper nSopr sObject
          fK_P   fPNP fPVP sValP   fSNP fSVP sValP
 sSklFrom fK_R   fPNR fPVR sValR   fSNR fSVR sValR
!.}
 TmpE7 TmpP7 TmpR7
 TmpE8   fTotKonSNP fTotKonSRP sVal_r   fTotKonSNR fTotKonSRR sVal_r
!.}
!.if engkontr02
 TmpE9   fTotalSNP  fTotalSRP  sVal_r   fTotalSNR  fTotalSRR  sVal_r
!.end
.EndFields

                  БВЕДОМОСТЬ ДВИЖЕНИЯ МАТЕРИАЛЬНЫХ ЦЕННОСТЕЙ
                 В ПЕРИОД С ^ г. ПО ^ г. Б

 В^ В^
───────────────────────────┬────────────.{.?koe1;┬────────@.}┬──────────┬─────────┬──────────────────.{.?kop1;┬──────────────────────────────────────────────────────────────────────────────────────@.}.{.?kor1;┬───────────────────────────────────────────────────────────────────────────────────────────────────────────@.}
                           │ Номенклат. .{.?koe2;│ Единица@.}│   Дата   │  Номер  │     Объект       .{.?kop2;│                                       П Р И Х О Д                                    @.}.{.?kor2;│                                                    Р А С Х О Д                                            @.}
  Наименование матценности │   номер    .{.?koe3;│измерени@.}│ операции │накладной│  строительства   .{.?kop3;├──────────┬────────────────┬───────────────┬─────────────────────┬────────────────────@.}.{.?kor3;┼──────────────────┬──────────┬──────────────────┬───────────────┬─────────────────────┬────────────────────@.}
                           │            .{.?koe4;│        @.}│          │         │                  .{.?kop4;│Количество│Цена в @@@@@@@@@│ Цена в валюте │Стоимость в @@@@@@@@@│ Стоимость в валюте @.}.{.?kor4;│      Откуда      │Количество│Цена в @@@@@@@@@@@│ Цена в валюте │Стоимость в @@@@@@@@@│ Стоимость в валюте @.}
───────────────────────────┴────────────.{.?koe5;┴────────@.}┴──────────┴─────────┴──────────────────.{.?kop5;┴──────────┴────────────────┴───────────────┴─────────────────────┴────────────────────@.}.{.?kor5;┴──────────────────┴──────────┴──────────────────┴───────────────┴─────────────────────┴────────────────────@.}
.{
^ И    Контрагент:  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Й^
.{
 @@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@.{.?koe6; @@@@@@@@@.} @@@@@@@@@@ @@@@@@@@@ @@@@@@@@@@@@@@@@@@.{.?kop6; &&&&&&.&&& &'&&&&&&&&&&&.&& &&&&&.&& @@@@@@ &'&&&&&&&&&&&&&&&&.&& &&&&&&&&&&&.&& @@@@@@.}.{.?kor6; @@@@@@@@@@@@@@@@@@ &&&&&&.&&& &'&&&&&&&&&&&&&.&& &&&&&.&& @@@@@@ &'&&&&&&&&&&&&&&&&.&& &&&&&&&&&&&.&& @@@@@@.}
.}
────────────────────────────────────────.{.?koe7;─────────@.}────────────────────────────────────────.{.?kop7;───────────────────────────────────────────────────────────────────────────────────────@.}.{.?kor7;────────────────────────────────────────────────────────────────────────────────────────────────────────────@.}
 ИТОГО ПО КОНТРАГЕНТУ :                 .{.?koe8;         @.}                                        .{.?kop8;                                             &'&&&&&&&&&&&&&&&&.&& &&&&&&&&&&&.&& @@@@@@.}.{.?kor8;                                                                  &'&&&&&&&&&&&&&&&&.&& &&&&&&&&&&&.&& @@@@@@.}

.}
.if engkontr02
 ИТОГО ПО ПРЕДПРИЯТИЮ :                 .{.?koe9;         @.}                                        .{.?kop9;                                             &'&&&&&&&&&&&&&&&&.&& &&&&&&&&&&&.&& @@@@@@.}.{.?kor9;                                                                  &'&&&&&&&&&&&&&&&&.&& &&&&&&&&&&&.&& @@@@@@.}
.end
.EndForm
