/*
 ╔════════════════════════════════════════════════════════════════════════════╗
 ║                     (c) Корпорация ГАЛАКТИКА, 1997,98                      ║
 ║ Проект        : ГАЛАКТИКА                                                  ║
 ║ Система       : Оперативный контур                                         ║
 ║ Версия        : 5.20                                                       ║
 ║ Назначение    : Отчеты по закупкам / продажам                              ║
 ║ Ответственный : Шукан Александр Леонидович (SAL)                           ║
 ╚════════════════════════════════════════════════════════════════════════════╝

*/
#doc
Графический отчет по номенклатуре
#end
.linkform 'Rep_BS_G11' prototype is 'Rep_BS'
.NameInList 'Графический отчет по номенклатуре'
.group 'GT'
GraphReport "График по номенклатуре"
.{ CheckEnter ParNastr
.}
.fields
  headgr
.endfields
{
  Query "Настройка отчета"
  {
    aGraphType GraphType "Способ ~и~зображения диаграммы"   "Bar";
    aEffects3D GraphDim  "Э~ф~фект трехмерности диаграммы " "3D";
    aGoodSort  Sort      "~С~ортировка"                       "-";
    aGoodSelect Number   "Сколько выводить ~п~ервых величин"  "15";
  }
  Page
  {
    Graph as aGraphType as aEffects3D Bounds (0,0,3000,1100)
    {
      UpTitle '^ ' { Color Blue; Font TRIP; }
      Legend On Bounds (3000,0,4000,3000) {
        Font {
          Font Small 4;
        }
      }
      Arguments Off;
      Serie
      {
        Sort as aGoodSort;
        Select as aGoodSelect { SumOthers On; }
        Title  "количество" { Color Red; }
      } // serie
    } // Graph
    Graph as aGraphType as aEffects3D Bounds (0,1100,3000,2000)
    {
.fields
  otcval
.endfields
      Legend Off;
      Arguments Off;
      Serie
      {
        Sort as aGoodSort;
        Select as aGoodSelect { SumOthers On; }
        Title  "суммы - в ^" { Color Red; }
      } // serie
    } // Graph
    Graph as aGraphType as aEffects3D Bounds (0,2000,3000,3000)
    {
.fields
  head2 basval
.endfields
      DnTitle  "^" { Color Blue; }
      Legend Off;
      Arguments Off;
      Serie
      {
        Sort as aGoodSort;
        Select as aGoodSelect { SumOthers On; }
        Title  "суммы - в ^" { Color Red; }
      } // serie
    } // Graph
Data
{
.{
.{
.{
.{
.{
.}
.}
.{
.}
.}
.fields
NameMC NomenklN TovKol TovCostKupl TovCostKuplVal
.endfields
"^ (^)", ^, ^, ^;
.{
.}
.{
.}
.}
.{
.}
.}
.{
.}
}  //data
  } // Page
}  // GraphReport
.endform
!
!
!
#doc
Графический отчет по номенклатуре по интервалам периода
#end
.linkform 'Rep_BS_G12' prototype is 'Rep_BS'
.nameinlist 'Графический отчет по номенклатуре по интервалам периода'
.Group 'GT'
GraphReport "График по номенклатуре"
.{ CheckEnter ParNastr
.}
.fields
  Intdate1 Intdate2
  IntKol IntCostKupl IntCostKuplVal
  substr(IntDate1,7,4) + substr(intdate1,4,2) + substr(intdate1,1,2)
  headgr
  head2
  upcase(NameUchEd)
  upcase(otcval)
  NameMC NomenklN
  upcase(basval)
.endfields
{
  Query "Настройка отчета по интервалам"
  {
    aGraphType GraphType "Способ ~и~зображения диаграммы"   "Bar";
    aEffects3D GraphDim  "Э~ф~фект трехмерности диаграммы " "3D";
    aGoodSelect Number   "Сколько выводить ~п~ервых величин"  "15";
  }
.{   // цикл по группам
.{   // цикл по номенклатуре
  Page
  {
    Data
    {
.{  // накладные
.{  // интервалы
.{  // налоги в накладном
.}
.}  // конец цикла по интервалам
      "@@@@@@@@@@..@@@@@@@@@@", ^, ^, ^ key "^";
.{  // налоги по интервалам
.}
.}  // конец цикла по накладным
.{  // налоги по номенклатуре
.}
.{
.}
    }  //data
    Graph XY 2D Bounds (0,0,4000,160)
    {
      UpTitle '^^ ' { Color Blue; }
      Legend OFF;
      Arguments OFF;
    } // Graph
    Graph as aGraphType as aEffects3D Bounds (0,160,3000,1000)
    {
      Legend On Bounds (3000,160,4000,3000) {
        Font {
        Font Small 4;
        }
      }
      Arguments OFF;
      Serie
      {
        Select as aGoodSelect { SumOthers On; }
        Title "количество (единица измерения: ^)" { Color Red; }
      } // serie
    } // Graph
    Graph as aGraphType as aEffects3D Bounds (0,1000,3000,2000)
    {
      Legend OFF;
      Arguments OFF;
      Serie
      {
        Select as aGoodSelect { SumOthers On; }
        Title "суммы в ^" { Color Red; }
      } // serie
    } // Graph
    Graph as aGraphType as aEffects3D Bounds (0,2000,3000,3000)
    {
      Legend OFF;
      Arguments OFF;
      DnTitle  "^ - ^" { Color Black; Font Default 1; }
      Serie
      {
        Select as aGoodSelect { SumOthers On; }
        Title  "суммы в ^" { Color Red; }
      } // serie
    } // Graph
  } // Page
.}  // конец цикла по номенклатуре
.{
.}
.}  // конец цикла по группам
.{  // итоговые налоги и т.п.
.}
}  // GraphReport
.endform
!
!
!
#doc
Графический отчет с учетом группировки
#end
.linkform 'Rep_BS_G21' prototype is 'Rep_BS'
.nameinlist 'Графический отчет с учетом группировки'
.group 'GG'
GraphReport "Графический отчет"
.{ CheckEnter ParNastr
.}
.fields
  NameGroup GroupKol GroupCostKupl GroupCostKuplVal
  headgr
  upcase(NameUchEd)
  upcase(otcval)
  head2
  upcase(basval)
.endfields
{
  Query "Настройка отчета"
  {
    aGraphType GraphType "~С~пособ изображения диаграммы"   "Bar";
    aEffects3D GraphDim  "Э~ф~фект трехмерности диаграммы "   "3D";
    aGoodSelect Number   "Сколько выводить ~п~ервых величин"  "15";
  }
  Page
  {
Data
{
.{   // цикл по группам
.{   // цикл по номенклатуре
.{  // накладные
.{  // интервалы
.{  // налоги в накладном
.}
.}  // конец цикла по интервалам
.{  // налоги по интервалам
.}
.}  // конец цикла по накладным
.{  // налоги по номенклатуре
.}
.{
.}
.}  // конец цикла по номенклатуре
"^", ^, ^, ^;
.{
.}
.}  // конец цикла по группам
.{  // итоговые налоги и т.п.
.}
}  //data
    Graph XY 2D Bounds (0,0,4000,180)
    {
      UpTitle  "^" { Color BLUE; Font TRIP;}
      Legend OFF;
      Arguments OFF;
    } // Graph
    Graph as aGraphType as aEffects3D Bounds (0,180,3000,1000)
    {
      Legend On Bounds (3000,180,4000,3000) {
        Font {
          Font Small 4;
        }
      }
      Arguments Off;
      Serie
      {
        Select as aGoodSelect { SumOthers On; }
        Title  "количество (единица измерения: ^)" { Color Red; }
      } // serie
    } // Graph
    Graph as aGraphType as aEffects3D Bounds (0,1000,3000,2000)
    {
      Legend Off;
      Arguments Off;
      Serie
      {
        Select as aGoodSelect { SumOthers On; }
        Title  "суммы в ^" { Color Red; }
      } // serie
    } // Graph


    Graph as aGraphType as aEffects3D Bounds (0,2000,3000,3000)
    {
      DnTitle "^" { Color Blue; }
      Legend Off;
      Arguments Off;
      Serie
      {
        Select as aGoodSelect { SumOthers On; }
        Title  "суммы в ^" { Color Red; }
      } // serie
    } // Graph
  } // Page
}  // GraphReport
.endform
!
!
!
#doc
Графический отчет с учетом группировки (подробный)
#end
.linkform 'Rep_BS_G22' prototype is 'Rep_BS'
.group 'GG'
.nameinlist 'Графический отчет с учетом группировки (подробный)'
GraphReport "Графический отчет"
.{ CheckEnter ParNastr
.}
.fields
  NameMC  NameUchEd TovKol TovCostKupl TovCostKuplVal
  headgr
  head2
  upcase(NameUchEd)
  upcase(otcval)
  NameGroup
  upcase(basval)
.endfields
{
  Query "Настройка подробного отчета"
  {
    aGraphType GraphType "~С~пособ изображения диаграммы"   "Bar";
    aEffects3D GraphDim  "Э~ф~фект трехмерности диаграммы "   "3D";
    aGoodSelect Number   "Сколько выводить ~п~ервых величин"  "15";
  }
.{   // цикл по группам
  Page
  {
    Data
    {
.{   // цикл по номенклатуре
.{  // накладные
.{  // интервалы
.{  // налоги в накладном
.}
.}  // конец цикла по интервалам
.{  // налоги по интервалам
.}
.}  // конец цикла по накладным
          '^ (^) ',    ^, ^, ^ ;
.{  // налоги по номенклатуре
.}
.{
.}
.}  // конец цикла по номенклатуре
.{
.}
    }  //data
    Graph XY 2D Bounds (0,0,4000,160)
    {
      UpTitle  "^^" { Color BLUE; Font Small 4; }
      Legend OFF;
      Arguments OFF;
    } // Graph
    Graph as aGraphType as aEffects3D Bounds (0,160,3000,1000)
    {
      Legend On Bounds (3000,160,4000,3000) {
        Font { Font Small 4; }
      }
      Arguments OFF;
      Serie
      {
        Select as aGoodSelect { SumOthers On; }
        Title "количество (единица измерения: ^)" { Color Red; }
      } // serie
    } // Graph
    Graph as aGraphType as aEffects3D Bounds (0,1000,3000,2000)
    {
      Legend OFF;
      Arguments OFF;
      Serie
      {
        Select as aGoodSelect { SumOthers On; }
        Title "суммы в ^" { Color Red; }
      } // serie
    } // Graph
    Graph as aGraphType as aEffects3D Bounds (0,2000,3000,3000)
    {
      Legend OFF;
      Arguments OFF;
      DnTitle "^" { Color Blue; }
      Serie
      {
        Select as aGoodSelect { SumOthers On; }
        Title  "суммы в ^" { Color Red; }
      } // serie
    } // Graph
  } // Page
.}  // конец цикла по группам
.{  // итоговые налоги и т.п.
.}
}  // GraphReport
.endform
!
!
!
#doc
Графический отчет по накладным
#end
.linkform 'Rep_BS_G31' prototype is 'Rep_BS'
.nameinlist 'Графический отчет по накладным'
.group 'GN'
GraphReport "Графический отчет"
.{ CheckEnter ParNastr
.}
.fields
  NameGroup GroupKol GroupCostKupl GroupCostKuplVal
  headgr
  upcase(NameUchEd)
  upcase(otcval)
  head2
  upcase(basval)
.endfields
{
  Query "Настройка отчета"
  {
    aGraphType GraphType "~С~пособ изображения диаграммы"   "Bar";
    aEffects3D GraphDim  "Э~ф~фект трехмерности диаграммы "   "3D";
    aGoodSelect Number   "Сколько выводить ~п~ервых величин"  "15";
  }
  Page
  {
Data
{
.{   // цикл по группам
.{   // цикл по номенклатуре
.{  // накладные
.{  // интервалы
.{  // налоги в накладном
.}
.}  // конец цикла по интервалам
.{  // налоги по интервалам
.}
.}  // конец цикла по накладным
.{  // налоги по номенклатуре
.}
.{
.}
.}  // конец цикла по номенклатуре
"^", ^, ^, ^;
.{
.}
.}  // конец цикла по группам
.{  // итоговые налоги и т.п.
.}
}  //data
    Graph XY 2D Bounds (0,0,4000,180)
    {
      UpTitle  "^" { Color BLUE; Font TRIP;}
      Legend OFF;
      Arguments OFF;
    } // Graph
    Graph as aGraphType as aEffects3D Bounds (0,180,3000,1000)
    {
      Legend On Bounds (3000,180,4000,3000) {
        Font {
          Font Small 4;
        }
      }
      Arguments Off;
      Serie
      {
        Select as aGoodSelect { SumOthers On; }
        Title  "количество (единица измерения: ^)" { Color Red; }
      } // serie
    } // Graph
    Graph as aGraphType as aEffects3D Bounds (0,1000,3000,2000)
    {
      Legend Off;
      Arguments Off;
      Serie
      {
        Select as aGoodSelect { SumOthers On; }
        Title  "суммы в ^" { Color Red; }
      } // serie
    } // Graph
    Graph as aGraphType as aEffects3D Bounds (0,2000,3000,3000)
    {
      DnTitle "^" { Color Blue; }
      Legend Off;
      Arguments Off;
      Serie
      {
        Select as aGoodSelect { SumOthers On; }
        Title  "суммы в ^" { Color Red; }
      } // serie
    } // Graph
  } // Page
}  // GraphReport
.endform
!
!
!
#doc
Графический отчет по накладным (подробный)
#end
.linkform 'Rep_BS_G32' prototype is 'Rep_BS'
.group 'GN'
.nameinlist 'Графический отчет по накладным (подробный)'
GraphReport "Графический отчет"
.{ CheckEnter ParNastr
.}
.fields
  Nomer_Nakl Date_Nakl TovKol TovCostKupl TovCostKuplVal
  headgr
  head2
  upcase(NameUchEd)
  upcase(otcval)
  NameGroup
  upcase(basval)
.endfields
{
  Query "Настройка подробного отчета"
  {
    aGraphType GraphType "~С~пособ изображения диаграммы"   "Bar";
    aEffects3D GraphDim  "Э~ф~фект трехмерности диаграммы "   "3D";
    aGoodSelect Number   "Сколько выводить ~п~ервых величин"  "15";
  }
.{   // цикл по группам
  Page
  {
    Data
    {
.{   // цикл по номенклатуре
.{  // накладные
.{  // интервалы
.{  // налоги в накладном
.}
.}  // конец цикла по интервалам
.{  // налоги по интервалам
.}
.}  // конец цикла по накладным
        'N ^ от ^ ', ^, ^, ^;
.{  // налоги по номенклатуре
.}
.{
.}
.}  // конец цикла по номенклатуре
.{
.}
    }  //data
    Graph XY 2D Bounds (0,0,4000,160)
    {
      UpTitle  "^^" { Color BLUE; Font Small 4; }
      Legend OFF;
      Arguments OFF;
    } // Graph
    Graph as aGraphType as aEffects3D Bounds (0,160,3000,1000)
    {
      Legend On Bounds (3000,160,4000,3000) {
        Font { Font Small 4; }
      }
      Arguments OFF;
      Serie
      {
        Select as aGoodSelect { SumOthers On; }
        Title "количество (единица измерения: ^)" { Color Red; }
      } // serie
    } // Graph
    Graph as aGraphType as aEffects3D Bounds (0,1000,3000,2000)
    {
      Legend OFF;
      Arguments OFF;
      Serie
      {
        Select as aGoodSelect { SumOthers On; }
        Title "суммы в ^" { Color Red; }
      } // serie
    } // Graph
    Graph as aGraphType as aEffects3D Bounds (0,2000,3000,3000)
    {
      Legend OFF;
      Arguments OFF;
      DnTitle "^" { Color Blue; }
      Serie
      {
        Select as aGoodSelect { SumOthers On; }
        Title  "суммы в ^" { Color Red; }
      } // serie
    } // Graph
  } // Page
.}  // конец цикла по группам
.{  // итоговые налоги и т.п.
.}
}  // GraphReport
.endform

