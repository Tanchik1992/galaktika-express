!  ╔═══════════════════════════════════════════════════════════════════════╗
!  ║                     (c) 1994,99 корпорация ГАЛАКТИКА                  ║
!  ║ Проект        : ГАЛАКТИКА                                             ║
!  ║ Система       : Бухгалтерский контур                                  ║
!  ║ Версия        : 7.1                                                   ║
!  ║ Назначение    : Переменные с форматами Excel-я для печатных форм slk  ║
!  ║ Ответственный : Кузнецов Александр Николаевич                         ║
!  ╚═══════════════════════════════════════════════════════════════════════╝
.var
// объявление следующей переменной нужно делать в базовой форме
!  iExcelFormat : ExcelFormat;
! в присоедененных формах:
! ****************************************************************************
! * Ниже перечислены новые возможности которые дает использование методов    *
! * объекта ExcelFormat. (Возможности перечислены на данный момент,          *
! * а полное и свежее описание всегда можно найти в файле ExcelFormat.vih)   *
! * Причем эффективнее, не подключая данный файл, а просто объявить          *
! * переменную, в секции .var базовой формы, дабы не объявлять ее каждый раз *
! * в каждой link-форме, в которой хотите использовать данный функционал.    *
! * (для этого, естественно, у вас в текущих исходниках должен быть виден    *
! *  файл: ExcelFormat.vih, для чего в GloTypes.inc должно присутствовать    *
! * подключение #include ExcelFormat.vih, а ресурсах собран ExcelFormat.vip  *
! * За консультацией можно обращаться по адресу:  Kuznetsov@galaktika.by     *
! ****************************************************************************
!
!-------------------------------------------------------------------------------------
! Функция удаляет все типы разделителя из строки
! и заменяет запятую на точку
!-------------------------------------------------------------------------------------
! function EraseSeparator (NumberInString : string) : string;
!
!-------------------------------------------------------------------------------------
! Функция удаляет все типы разделителя из строки,
! заменяет запятую на точку,
! и преобразует полученную строку к типу double
!-------------------------------------------------------------------------------------
! function NumInStrToDouble (NumberInString : string) : double;
!
!-------------------------------------------------------------------------------------
! Функция удаляет все типы разделителя из строки,
! заменяет запятую на точку,
! Функция выполняет те же действия, что и EraseSeparator, просто имеет такое название
! для аналогии с NumInStrEraseSeparatorNotNul
!-------------------------------------------------------------------------------------
! function NumInStrEraseSeparator (NumberInString : string) : string;
!
!-------------------------------------------------------------------------------------
! Функция удаляет все типы разделителя из строки,
! заменяет запятую на точку,
! а если строка преобразованная к числу = 0, то выводится пустая строка
!-------------------------------------------------------------------------------------
! function NumInStrEraseSeparatorNotNul (NumberInString : string) : string;
!
!-------------------------------------------------------------------------------------
! Функция возвращает формат для вывода чисел с количеством знаков после запятой
! указанном в принимаемом параметре
!   ColDecimalDigit - количество знаков после запятой
!     Например: efFormatExcel(2) = '\2p[|-]3666666666666666666.88'
!                                    ^                        └──┘
!-------------------------------------------------------------------------------------
! function efFormatExcel (ColDecimalDigit : word ) : string;
!
!-------------------------------------------------------------------------------------
! Функция преобразует число формата double к строке формата efFormatExcel
! с указанным количеством знаков после запятой
!   Sum             - преобразуемое число
!   ColDecimalDigit - количество знаков после запятой
!-------------------------------------------------------------------------------------
! function DoubleToStrFormatExcel (Sum : double; ColDecimalDigit : word) : string;
!
!-------------------------------------------------------------------------------------
! Функция преобразует число формата double к строке заданного формата
! И в отличии от DoubleToStr, если результат нулю возвращает не ноль
! по формату, а пустую строку!
!   Sum     - преобразуемое число
!   _Format - Формат
!-------------------------------------------------------------------------------------
! function DoubleToStrFormatNotNul (Sum : double; _Format : string) : string;
!
!-------------------------------------------------------------------------------------
! Функция преобразует число формата double к строке формата efFormatExcel
! с указанным количеством знаков после запятой
! И в отличии от DoubleToStrFormatExcel если результат нулю возвращает не ноль
! по формату, а пустую строку!
!   Sum             - преобразуемое число
!   ColDecimalDigit - количество знаков после запятой
!-------------------------------------------------------------------------------------
! function DoubleToStrFormatExcelNotNul (Sum : double; ColDecimalDigit : word) : string;
!
!-------------------------------------------------------------------------------------
! Функция удаляет все типы разделителя из строки,
! заменяет запятую на точку,
! и преобразует полученную строку к строке формата efFormatExcel
!   NumberInString  - преобразуемое число в виде строки с разделителями
!   ColDecimalDigit - количество знаков после запятой
!-------------------------------------------------------------------------------------
! function NumInStrToFormatExcel (NumberInString : string; ColDecimalDigit : word ) : string;
!
!-------------------------------------------------------------------------------------
! Функция удаляет все типы разделителя из строки,
! заменяет запятую на точку,
! и преобразует полученную строку к строке формата efFormatExcel,
! а если строка преобразованная к числу = 0, то выводится пустая строка
!   NumberInString  - преобразуемое число в виде строки с разделителями
!   ColDecimalDigit - количество знаков после запятой
!-------------------------------------------------------------------------------------
! function NumInStrToFormatExcelNotNul (NumberInString : string; ColDecimalDigit : word ) : string;
!
!-------------------------------------------------------------------------------------
! Функция возвращает формат для вывода дат = 'DD.MM.YYYY'
!-------------------------------------------------------------------------------------
! function efDateFormatExcel : string; // efFormatExcelDate
!
!-------------------------------------------------------------------------------------
! Функция преобразует дату в строку в формате = 'DD.MM.YYYY'
!-------------------------------------------------------------------------------------
! function DateToStrFormatExcel (_Date : date ): string;
!
!-------------------------------------------------------------------------------------
! Функция преобразует дату в строку в формате = 'DD.MM.YYYY',
! а если дата нулевая возвращается пустая строка
!-------------------------------------------------------------------------------------
! function DateToStrFormatExcelNotNul (_Date : date ): string;
!
!-------------------------------------------------------------------------------------
! Функция возвращает стандартный для Галактики формат для вывода дат = 'DD/MM/YYYY'
!-------------------------------------------------------------------------------------
! function efDateStandartFormatExcel : string;
!
!-------------------------------------------------------------------------------------
! Функция преобразует дату в строку в формате = 'DD.MM.YYYY'
!-------------------------------------------------------------------------------------
! function DateStandartToStrFormatExcel (_Date : date ): string;
!
!-------------------------------------------------------------------------------------
! Функция преобразует дату в строку в формате = 'DD.MM.YYYY',
! а если дата нулевая возвращается пустая строка
!-------------------------------------------------------------------------------------
! function DateStandartToStrFormatExcelNotNul (_Date : date ): string;
!
!-------------------------------------------------------------------------------------
! Функция возвращает формат для вывода месяцев в формате дата (период) = 'MM.YYYY'
!-------------------------------------------------------------------------------------
! function efPeriodFormatExcel : string; // efFormatExcelPeriod
!
!-------------------------------------------------------------------------------------
! Функция преобразует дату в строку в формате = 'MM.YYYY'
!-------------------------------------------------------------------------------------
! function PeriodToStrFormatExcel (_Date : date ): string;
!
!-------------------------------------------------------------------------------------
! Функция преобразует дату в строку в формате = 'MM.YYYY',
! а если дата нулевая возвращается пустая строка
!-------------------------------------------------------------------------------------
! function PeriodToStrFormatExcelNotNul (_Date : date ): string;
!
! ***************************************************************************
! * Весь нижеследующий функционал устарел:                                  *
! * Для для работы лучше, не подключая данный файл использовать переменную: *
! * iExcelFormat типа vip-интерфейс ExcelFormat, смотри выше по тексту.     *
! * Подключение данного файла также возможно, хотя его оставили только для  *
! * поддержки уже разработанных пользователями и партнерами форм которые,   *
! * уже используют старый подход.                                           *
! ***************************************************************************
!
! P.S.1:
! - Чем занять программиста? Читай строчкой ниже!
! - Чем занять программиста? Читай строчкой выше!
!
! P.S.2:
! !!! Кто вдруг дочитал до сюда, заканчивайте этим заниматься и займитесь
! делом. ;)
!
!      Этот файл необходим пока не будет решена проблема 102.31867
!  После ее решения, рекомендуется подключать и использовать ExcelFormat.inc
!  Совет для использования:
!      Этот файл рекомендуется подключать в форме прототипе после .EndFields
!  и до начала главного цикла
  efSumFormatExcel    : string
  efKolFormatExcel    : string
  efDateFormatExcel   : string
  efPeriodFormatExcel : string
  efCoefficientFormatExcel : string
  efMassOfPreciousMetalsFormatExcel : string
.endvar
.begin

! // Формат для вывода сумм
  efSumFormatExcel := '\2p[|-]3666666666666666666.88';

! // Формат для вывода Количественных чисел
  efKolFormatExcel := '\0p[|-]3666666666666666666';

! // Формат для вывода дат 'DD/MM/YYYY'
  efDateFormatExcel := 'DD.MM.YYYY';

! // Формат для вывода месяцев в формате дата (период)
  efPeriodFormatExcel := 'MM.YYYY';

! // Формат для вывода коэффициента
  efCoefficientFormatExcel := '\6p[|-]3666666666666.888888';

! // Формат для вывода массы драгоценных металлов
  efMassOfPreciousMetalsFormatExcel := '\12p[|-]366666.888888888888';

end.
