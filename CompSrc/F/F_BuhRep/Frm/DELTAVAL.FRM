//------------------------------------------------------------------------------
//                                                      (C) Корпорация Галактика
// Галактика 7.12 - Бухгалтерский контур
// Обороты по курсовой разнице валют
//------------------------------------------------------------------------------

//------------------------------------------------------------------------------
// Информация об изменениях в форме отчета в порядке убывания дат
//------------------------------------------------------------------------------
// DD-MM-YYYY
//------------------------------------------------------------------------------
// 16-06-2005
//
// В прототип добавлены поля
// Имя_Фильтра - выводится наименование группы фильтров
// Элемент_Фильтра - выводится наименование фильтров для каждой группы фильтров
// Для этих полей добавился цикл срабатывающий по учловию DeltaValFilter
//
// Имя_Настр_КР - выводится наименование группировки:
//                      "Настройки пересчета курсовых разниц на конец месяца"
//                 либо "Настройки пересчета курсовых разниц при ежедневном
//                      пересчете"
// Для вывода группировок добавился цикл
//
// Итого_НДЕ Итого_ВО - выводится итого по группировке (для поля
//                      Имя_Настр_КР) в НДЕ и валюте отчетов соответственно
// Всего_НДЕ Всего_ВО - выводится итого по ведомости в НДЕ и валюте отчетов
//                      соответсвенно
//
// cOborot - NRec таблицы Oborot, по которой сформирована текущая строка отчета
//
// Изменены названия полей
//
//  c0p1 - Период_Отчета
//  c0p2 - Имя_НДЕ                        c0p3 - Симв_НДЕ
//  c0p4 - Имя_Вал_Отч                    c0p5 - Символ_Вал_Отч
//
//  c1p1 - Счет_Групп_Д                   c1p2 - Имя_Счет_Групп_Д
//  c2p1 - СубСчет_Групп_Д                c2p2 - Имя_СубСчет_Групп_Д
//  c3p1 - Счет_Групп_К                   c3p2 - Имя_Счет_Групп_К
//  c4p1 - СубСчет_Групп_К                c4p2 - Имя_СубСчет_Групп_К
//
//  c5p1 - Счет_Д                         c5p2 - СубСчет_Д
//  c5p3 - КАУ_Д
//  c5p4 - Счет_К                         c5p5 - СубСчет_К
//  c5p6 - КАУ_К
//  c5p7 - Сумма_Проводки                c5p7v - Сумма_Проводки_ВО
//  c5p8 - Сод_Опер
//
// c4_p1 - Итого_СубСчет_К              c4_p1v - Итого_СубСчет_К_ВО
// c3_p1 - Итого_Счет_К                 c3_p1v - Итого_Счет_К_ВО
// c2_p1 - Итого_СубСчет_Д              c2_p1v - Итого_СубСчет_Д_ВО
// c1_p1 - Итого_Счет_Д                 c1_p1v - Итого_Счет_Д_ВО
//
//------------------------------------------------------------------------------
#doc
Базовая форма отчета "Обороты по курсовой разнице валют"
#end
.set name = 'DeltaVal'
.hide
.fields
Период_Отчета: date
Имя_НДЕ     Симв_НДЕ
Имя_Вал_Отч Символ_Вал_Отч
! Фильтры
Имя_Фильтра
Элемент_Фильтра
Имя_Настр_КР
Счет_Групп_Д     Имя_Счет_Групп_Д
СубСчет_Групп_Д  Имя_СубСчет_Групп_Д
Счет_Групп_К     Имя_Счет_Групп_К
СубСчет_Групп_К  Имя_СубСчет_Групп_К

cOborot : comp

Счет_Д       СубСчет_Д
КАУ_Д        Счет_К
СубСчет_К    КАУ_К
Сумма_Проводки    : double
Сумма_Проводки_ВО : double
Сод_Опер

Итого_СубСчет_К : double Итого_СубСчет_К_ВО : double
Итого_Счет_К    : double Итого_Счет_К_ВО    : double
Итого_СубСчет_Д : double Итого_СубСчет_Д_ВО : double
Итого_Счет_Д    : double Итого_Счет_Д_ВО    : double
Итого_НДЕ       : double Итого_ВО           : double
Всего_НДЕ       : double Всего_ВО           : double
.endfields
Период_Отчета                 ^
Имя_НДЕ                       ^
Симв_НДЕ                      ^
Имя_Вал_Отч                   ^
Символ_Вал_Отч                ^
.if DeltaValFilter
.{
Имя_Фильтра                   ^
.{
Элемент_Фильтра               ^
.}
.}
.end
.{
Имя_Настр_КР                  ^
.{
Счет_Групп_Д                  ^
Имя_Счет_Групп_Д              ^
.{
СубСчет_Групп_Д               ^
Имя_СубСчет_Групп_Д           ^
.{
Счет_Групп_К                  ^
Имя_Счет_Групп_К              ^
.{
СубСчет_Групп_К               ^
Имя_СубСчет_Групп_К           ^
.{
cOborot                       ^
Счет_Д                        ^
СубСчет_Д                     ^
КАУ_Д                         ^
Счет_К                        ^
СубСчет_К                     ^
КАУ_К                         ^
Сумма_Проводки                ^
Сумма_Проводки_ВО             ^
Сод_Опер                      ^
.}
Итого_СубСчет_К               ^
Итого_СубСчет_К_ВО            ^
.}
Итого_Счет_К                  ^
Итого_Счет_К_ВО               ^
.}
Итого_СубСчет_Д               ^
Итого_СубСчет_Д_ВО            ^
.}
Итого_Счет_Д                  ^
Итого_Счет_Д_ВО               ^
.}
Итого_НДЕ                     ^
Итого_ВО                      ^
.}
Всего_НДЕ                     ^
Всего_ВО                      ^
.endform
!==============================================================================
.linkform 'DeltaVal_01' prototype is 'DeltaVal'
.NameInList '1. Обороты по курсовой разнице валют'
.fields
CommonFormHeader
Период_Отчета
Имя_НДЕ
! Фильтры
Имя_Фильтра
Элемент_Фильтра

Имя_Настр_КР
Счет_Д         СубСчет_Д    КАУ_Д
Счет_К         СубСчет_К    КАУ_К
Сумма_Проводки Сод_Опер
Счет_Групп_Д Имя_Счет_Групп_Д
Итого_Счет_Д Имя_Настр_КР Итого_НДЕ
Всего_НДЕ
.endfields
 Ш^
                         БВедомость по курсовой разнице валют Б
                         Б        за ^ г. Б
 БВедомость сформирована в ^ Б

.if DeltaValFilter
 ВПрименен фильтр
.{
   Б^ Б
.{
    ^
.}
.} В
.end

───────────────────────────────────────┬───────────────────────────────────────┬──────────────────┬───────────────────────────────────────────────
           Д Е Б Е Т                   │           К Р Е Д И Т                 │                  │
────┬─────┬────────────────────────────┼────┬─────┬────────────────────────────┤    С у м м а     │        Разница курсов валют проведена
Счет│Суб -│            КАУ             │Счет│Суб- │            КАУ             │  о б о р о т а   │              согласно документам
    │счет │                            │    │счет │                            │                  │
────┴─────┴────────────────────────────┴────┴─────┴────────────────────────────┴──────────────────┴───────────────────────────────────────────────
.{
 Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.{
.{
.{
.{
.{
@@@@ @@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@ @@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&&&&&& @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.}
.}
.}
.}
 БИтого по @@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@   &'&&&&&&&&&&&&&&&& Б
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.}
 БИтого по @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@   &'&&&&&&&&&&&&&&&& Б
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.}
 БИтого по ведомости                                                              &'&&&&&&&&&&&&&&&& Б
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 ББухгалтер Б
 БОтветственный за выпуск Щ
.endform
!==============================================================================
.linkform 'DeltaVal_02' prototype is 'DeltaVal'
.NameInList '2. Обороты по курсовой разнице валют (в валюте отчетов)'
.fields
CommonFormHeader
Период_Отчета
Имя_Вал_Отч
! Фильтры
Имя_Фильтра
Элемент_Фильтра
Имя_Настр_КР
Счет_Д СубСчет_Д  КАУ_Д
Счет_К СубСчет_К  КАУ_К
Сумма_Проводки_ВО Сод_Опер
Счет_Групп_Д      Имя_Счет_Групп_Д
Итого_Счет_Д_ВО   Имя_Настр_КР   Итого_ВО
Всего_ВО
.endfields
 Ш^
                         БВедомость по курсовой разнице валют Б
                         Б        за ^ г. Б
 БВедомость сформирована в ^ Б

.if DeltaValFilter
 ВПрименен фильтр
.{
   Б^ Б
.{
    ^
.}
.} В
.end

───────────────────────────────────────┬───────────────────────────────────────┬──────────────────┬───────────────────────────────────────────────
           Д Е Б Е Т                   │           К Р Е Д И Т                 │                  │
────┬─────┬────────────────────────────┼────┬─────┬────────────────────────────┤    С у м м а     │        Разница курсов валют проведена
Счет│Суб- │            КАУ             │Счет│Суб- │            КАУ             │  о б о р о т а   │              согласно документам
    │счет │                            │    │счет │                            │                  │
────┴─────┴────────────────────────────┴────┴─────┴────────────────────────────┴──────────────────┴───────────────────────────────────────────────
.{
 Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.{
.{
.{
.{
.{
@@@@ @@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@ @@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&&&&&& @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.}
.}
.}
.}
 БИтого по @@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@   &'&&&&&&&&&&&&&&&& Б
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.}
 БИтого по @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@   &'&&&&&&&&&&&&&&&& Б
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.}
 БИтого по ведомости                                                              &'&&&&&&&&&&&&&&&& Б
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 ББухгалтер Б
 БОтветственный за выпуск Щ
.endform
!==============================================================================
.linkform 'DeltaVal_03' prototype is 'DeltaVal'
.NameInList '3. Свернутая ведомость оборотов по курсовой разнице валют'
.fields
CommonFormHeader
Период_Отчета
! Фильтры
Имя_Фильтра
Элемент_Фильтра
Симв_НДЕ Символ_Вал_Отч
Имя_Настр_КР
Счет_Групп_Д Имя_Счет_Групп_Д Итого_Счет_Д Итого_Счет_Д_ВО
Имя_Настр_КР Итого_НДЕ        Итого_ВО
Всего_НДЕ    Всего_ВО
.endfields
 И^
                         БВедомость по курсовой разнице валют Б
                         Б        за ^ г. Б

.if DeltaValFilter
 ВПрименен фильтр
.{
   Б^ Б
.{
    ^
.}
.} В
.end

───────────────────────────────────────────────────┬─────────────────────────────────────
                                                   │             сумма оборота
       НАСТРОЙКА ПО КУРСОВОЙ РАЗНИЦЕ ВАЛЮТ         ├──────────────────┬──────────────────
                                                   │     в @@@@@@     │     в @@@@@@
───────────────────────────────────────────────────┴──────────────────┴──────────────────
.{
 Б @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
─────────────────────────────────────────────────────────────────────────────────────────
.{
.{
.{
.{
.{
.}
.}
.}
.}
@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&
.}
─────────────────────────────────────────────────────────────────────────────────────────
 БИтого по @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& Б
─────────────────────────────────────────────────────────────────────────────────────────
.}
 БИтого по ведомости                                  &'&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&& Б
─────────────────────────────────────────────────────────────────────────────────────────
 ББухгалтер Б
 БОтветственный за выпуск Й
.endform
!========================================================================================
