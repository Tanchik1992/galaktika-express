//------------------------------------------------------------------------------
//                                                      (c) Корпорация ГАЛАКТИКА
//------------------------------------------------------------------------------
// Галактика 5.8 - ФРО
// Кассовая книга, валютная кассовая книга для Беларуси
//------------------------------------------------------------------------------

.linkform 'KO4BOOKBY' prototype is 'dayuchved'
.group 'kassabel_f1'
.nameinlist '1. Кассовая книга для Беларуси(форма КО-4)'
.p 80
! Функция вывода заданного количества знаков после запятой
#include printfunc.frn
.var
  СумСтрНДЕПрих : double
  СумСтрНДЕРасх : double
  СтраницМес : integer
  СтраницГод : integer
.endvar
.fields
c1f1  c2f1  c2f2
ДатаКассы
ВхСалНДЕ
НоДок СодОпер КорСчет КорСуб ПрихНДЕ РасхНДЕ
PrintSumma(СумСтрНДЕПрих) PrintSumma(СумСтрНДЕРасх)
PrintSumma(ИсхПрихНДЕ) PrintSumma(ИсхРасхНДЕ) PrintSumma(ИсхСалНДЕ)
ЗарплНДЕ
'true':'s'
if(МесяцДаты=12,
               'Листов за месяц: '+ UpCase(trim(NumToString(СтраницМес,''))) +'. Листов за год: ' + UpCase(trim(NumToString(СтраницГод,'')))+'.',
               'Листов за месяц: ' + UpCase(trim(NumToString(СтраницМес,'')))+'.'
  )
ФИОКассира
UpCase(КолДокПрих) UpCase(КолДокРасх)
ГлавБух
.endfields
 Р.if OkFilDch
 ВПрименен фильтр... В
.{
 В   ^ В
.{
 В      ^ ^ В
.}
.}
.end
.begin
  СтраницГод := НомЛиста-1;
  СтраницМес := КолЛистов;
end.
.{
.[h
                                                                               Вкладной лист кассовой книги  @np@
.]h
.{
.[h
.begin
   СумСтрНДЕПрих := 0;
   СумСтрНДЕРасх := 0;
end.
 Б        Касса за ^ г.
────────┬──────────────────────────────────────────────────────────────┬────────────┬─────────────────┬─────────────────
        │                                                              │ Номер кор- │                 │
 Номер  │                      От кого получено                        │ респонди-  │     Приход,     │    Расход,
докумен-│                      или кому выдано                         │  рующего   │       руб.      │      руб.
  та    │                                                              │   счета,   │                 │
        │                                                              │  субсчета  │                 │
────────┼──────────────────────────────────────────────────────────────┼────────────┼─────────────────┼─────────────────
   1    │                              2                               │     3      │        4        │       5
────────┼──────────────────────────────────────────────────────────────┼────────────┼─────────────────┼───────────────── Б
.]h
.if KassaVhSaldoDay
        │                                                    Остаток на начало дня  │&'&&&&&&&&&&&&&&&│       X
        ├──────────────────────────────────────────────────────────────┬────────────┼─────────────────┼─────────────────
.end
.{
! ИТОГО
.begin
   СумСтрНДЕПрих := СумСтрНДЕПрих + ПрихНДЕ;
   СумСтрНДЕРасх := СумСтрНДЕРасх + РасхНДЕ;
end.
@@@@@@@@│ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│ @@@@@ @@@@ │&#'&&&&&&&&&&&&&&│&#'&&&&&&&&&&&&&&
.[f
 Б────────┴──────────────────────────────────────────────────────────────┴────────────┼─────────────────┼─────────────────
                                                                  Итого по странице │&'&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&
                                                                                    └─────────────────┴───────────────── Б
.begin
  СтраницГод := СтраницГод+1;
  СтраницМес := СтраницМес+1;
end.
.]f
.}
 Б────────────────────────────────────────────────────────────────────────────────────┬─────────────────┬─────────────────
                                                                                    │                 │
                                                                      Итого за день │&'&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&
                                                                                    ├─────────────────┼─────────────────
                                                                                    │                 │
                                                               Остаток на конец дня │&'&&&&&&&&&&&&&&&│        X Б
 Б                                                                                    ├─────────────────┼─────────────────
                                                       в том числе на оплату труда  │&'&&&&&&&&&&&&&&&│        X
                                                                                    └─────────────────┴───────────────── Б
.if BreakPage
^
.end
.}
.if duPrintPage
 ^

.end

 Кассир     ___________________     Д^ Д
                (подпись)             (расшифровка подписи)

 Записи  в  кассовой  книге  проверил  и  документы  в  количестве
 @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ приходных и
 ------------------------------------------------------
                       (прописью)
 @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ расходных
 ------------------------------------------------------
                       (прописью)
 получил.

 Бухгалтер  ___________________    Д^ Д
                (подпись)            (расшифровка подписи) Р
.}
.endform

!---------------------------------------------------------------------------------------------------
.linkform 'KO4bookReportBY' prototype is 'dayuchved'
.group 'kassabel_f1'
.nameinlist '2. Отчет кассира для Беларуси(форма КО-4)'
.p 80
! Функция вывода заданного количества знаков после запятой
#include printfunc.frn
.var
  СумСтрНДЕПрих : double
  СумСтрНДЕРасх : double
  СтраницМес : integer
  СтраницГод : integer
.endvar
.fields
c1f1  c2f1  c2f2
ДатаКассы
ВхСалНДЕ
НоДок СодОпер КорСчет КорСуб ПрихНДЕ РасхНДЕ
PrintSumma(СумСтрНДЕПрих) PrintSumma(СумСтрНДЕРасх)
PrintSumma(ИсхПрихНДЕ) PrintSumma(ИсхРасхНДЕ) PrintSumma(ИсхСалНДЕ)
ЗарплНДЕ
'true':'s'
if(МесяцДаты=12,
               'Листов за месяц: '+ UpCase(trim(NumToString(СтраницМес,''))) +'. Листов за год: ' + UpCase(trim(NumToString(СтраницГод,'')))+'.',
               'Листов за месяц: ' + UpCase(trim(NumToString(СтраницМес,'')))+'.'
  )
ФИОКассира
UpCase(КолДокПрих) UpCase(КолДокРасх)
ГлавБух
.endfields
 Р.if OkFilDch
 ВПрименен фильтр... В
.{
 В   ^ В
.{
 В      ^ ^ В
.}
.}
.end
.begin
  СтраницГод := НомЛиста-1;
  СтраницМес := КолЛистов;
end.
.{
.[h
                                                                                                     лист @np@
.]h
.{
.[h
.begin
   СумСтрНДЕПрих := 0;
   СумСтрНДЕРасх := 0;
end.
 Б        Отчет кассира за ^ г.
────────┬──────────────────────────────────────────────────────────────┬────────────┬─────────────────┬─────────────────
        │                                                              │ Номер кор- │                 │
 Номер  │                      От кого получено                        │ респонди-  │     Приход,     │    Расход,
докумен-│                      или кому выдано                         │  рующего   │       руб.      │      руб.
  та    │                                                              │   счета,   │                 │
        │                                                              │  субсчета  │                 │
────────┼──────────────────────────────────────────────────────────────┼────────────┼─────────────────┼─────────────────
   1    │                              2                               │     3      │        4        │       5
────────┼──────────────────────────────────────────────────────────────┼────────────┼─────────────────┼───────────────── Б
.]h
.if KassaVhSaldoDay
        │                                                    Остаток на начало дня  │&'&&&&&&&&&&&&&&&│       X
        ├──────────────────────────────────────────────────────────────┬────────────┼─────────────────┼─────────────────
.end
.{
! ИТОГО
.begin
   СумСтрНДЕПрих := СумСтрНДЕПрих + ПрихНДЕ;
   СумСтрНДЕРасх := СумСтрНДЕРасх + РасхНДЕ;
end.
@@@@@@@@│ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│ @@@@@ @@@@ │&#'&&&&&&&&&&&&&&│&#'&&&&&&&&&&&&&&
.[f
 Б────────┴──────────────────────────────────────────────────────────────┴────────────┼─────────────────┼─────────────────
                                                                  Итого по странице │&'&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&
                                                                                    └─────────────────┴───────────────── Б
.begin
  СтраницГод := СтраницГод+1;
  СтраницМес := СтраницМес+1;
end.
.]f
.}
 Б────────────────────────────────────────────────────────────────────────────────────┬─────────────────┬─────────────────
                                                                                    │                 │
                                                                      Итого за день │&'&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&
                                                                                    ├─────────────────┼─────────────────
                                                                                    │                 │
                                                               Остаток на конец дня │&'&&&&&&&&&&&&&&&│        X Б
 Б                                                                                    ├─────────────────┼─────────────────
                                                       в том числе на оплату труда  │&'&&&&&&&&&&&&&&&│        X
                                                                                    └─────────────────┴───────────────── Б
.if BreakPage
^
.end
.}
.if duPrintPage
 ^

.end

 Кассир     ___________________     Д^ Д
                (подпись)             (расшифровка подписи)

 Записи  в  кассовой  книге  проверил  и  документы  в  количестве
 @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ приходных и
 ------------------------------------------------------
                       (прописью)
 @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ расходных
 ------------------------------------------------------
                       (прописью)
 получил.

 Бухгалтер  ___________________    Д^ Д
                (подпись)            (расшифровка подписи) Р
.}
.endform

!---------------------------------------------------------------------------------------------------
! Титульный лист для рублевой кассовой книги. (для Беларуси)
!---------------------------------------------------------------------------------------------------
.linkform 'KO4titleBY' prototype is 'dayuchved'
.group 'kassabel_f1'
.nameinlist '3. Обложка, титульный лист, последняя страница для Беларуси (КО-4)'
.p 80
.Create view Kassa
var
from
  KatOrg    (ReadOnly)
where
((
    coGetTune('MYORG') == KatOrg.nRec
))
;
.begin
  Kassa.GetFirst KatOrg;
end.
.fields
  Kassa.KatOrg.Name
  Year(StrToDate(ИнтерДат,'DD/MM/YYYY'))
.endfields
!------------------------------------------------------------------------------
.if OkFilDch
.{
.{
.}
.}
.end
.{
.{
.if KassaVhSaldoDay
.end
.{
.}
.if BreakPage
.end
.}
.if duPrintPage
.end
.}
!------------------------------------------------------------------------------
 И                                                   Приложение 4
                                                   к постановлению Министерства
                                                   финансов Республики Беларусь
                                                   19.04.2001 N 43

                                                                       Форма N КО-4





 Б@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
──────────────────────────────────────────────────────────────────────────────
                    (полное наименование предприятия)


                                  БКАССОВАЯ КНИГА Б

                                 на  Б@~@@@@@@@ Б г.
                                ─────────────────


!---------------------------------------------------------------------------
 И.fields
 И  'true':'s' И
  Kassa.KatOrg.Name
  Year(StrToDate(ИнтерДат,'DD/MM/YYYY'))
.endfields И
^


 Б@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
──────────────────────────────────────────────────────────────────────────────
                    (полное наименование предприятия)


                                  БКАССОВАЯ КНИГА Б

                                 на  Б@~@@@@@@@ Б г.
                                ─────────────────

.fields
'true':'s'
РукПред
ГлавБух
.endfields
^






















































                       Б   В настоящей книге пронумеровано, Б
                          Бпрошнуровано            листов, Б
                           Б            ─────────── Б
                          Бкнига опечатана сургучной (мастичной) печатью Б

                          БМ.П.(штампа) Б


                          БРуководитель       Б           Б@~@@@@@@@@@@@@@@@@@@@@@@@@@ Б
                                       Б────────────── ─────────────────────────── Б
                                         Б(подпись)        (расшифровка подписи) Б

                          БГлавный бухгалтер Б                  Б@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
                                            Б─────────────── ────────────────────────────── Б
                                               Б(подпись)         (расшифровка подписи) Б

                                  Б "____" ______________  ______ г. Й
.endform

!---------------------------------------------------------------------------------------------------
! Кассовая книга валютная
!---------------------------------------------------------------------------------------------------

.linkform 'dayuchbelKO4V' prototype is 'dayuchved'
.group 'dayuchbel'
.nameinlist '1. Валютная кассовая книга для Беларуси (КО-4в)'
.p 60
! Функция вывода заданного количества знаков после запятой
#include printfunc.frn
.defo landscape
.var
  myPlansNo,
  cBuh,
  cKassir,
  TempNRec,
  myKodvalut : comp;
  SimVal     : array[1..4] of string[4];
  cMyVal     : array[1..4] of comp;
  SaldoVhD,
  SaldoIsh,
  Prihod,
  Rashod,
  PageItogPr,
  PageItogRas,
  DayItogPr,
  DayItogRas,
  Curs,
  ZarplSum,
  ZarplVhSal,
  ZarplObor   : array[1..4] of double;
  Itogobor    : array[1..8] of double;
  SumRubD, SumRubK : double;
  ValCount, i, Result,
  PageNumber,
  PrihodKol,
  RashodKol : integer;
  MyDate      : date;
  DateChanged,
  isZarplTune : boolean;
  wParam3,
  TempTiDk : word;
  Schet      : string;
  ListNumber : string;
  СтраницМес : integer
  СтраницГод : integer
.endvar
.create view vDayUch
as select *
from
  DayUch DayUchCount(DayUch01),
  DayUch(DayUch02)
order by DayUch.KodValut
;
.fields
ИнтерДат
c1f1
c2f1 c2f2
SimVal[1] SimVal[2] SimVal[3] SimVal[4] SimVal[1] SimVal[2] SimVal[3] SimVal[4]
PrintSumma(SaldoVhD[1]) PrintSumma(SaldoVhD[2]) PrintSumma(SaldoVhD[3]) PrintSumma(SaldoVhD[4])
DayUch.NoDok DayUch.NameOper SubStr(DayUch.SchetK,2,21) DayUch.SubSchK
PrintSummaZero(Prihod[1]) PrintSummaZero(Prihod[2]) PrintSummaZero(Prihod[3]) PrintSummaZero(Prihod[4])
PrintSummaZero(Rashod[1]) PrintSummaZero(Rashod[2]) PrintSummaZero(Rashod[3]) PrintSummaZero(Rashod[4])

PrintSumma(PageItogpr[1]) PrintSumma(PageItogpr[2]) PrintSumma(PageItogpr[3]) PrintSumma(PageItogpr[4])
PrintSumma(PageItogRas[1]) PrintSumma(PageItogRas[2]) PrintSumma(PageItogRas[3]) PrintSumma(PageItogRas[4])

PrintSumma(DayItogPr[1]) PrintSumma(DayItogPr[2]) PrintSumma(DayItogPr[3]) PrintSumma(DayItogPr[4])
PrintSumma(DayItogRas[1]) PrintSumma(DayItogRas[2]) PrintSumma(DayItogRas[3]) PrintSumma(DayItogRas[4])

PrintSumma(SaldoIsh[1]) PrintSumma(SaldoIsh[2]) PrintSumma(SaldoIsh[3]) PrintSumma(SaldoIsh[4])
PrintSumma(ZarplSum[1]) PrintSumma(ZarplSum[2]) PrintSumma(ZarplSum[3]) PrintSumma(ZarplSum[4])
PrintSumma(Curs[1]) PrintSumma(Curs[2]) PrintSumma(Curs[3]) PrintSumma(Curs[4])
PrintSumma(ItogObor[1]) PrintSumma(ItogObor[2]) PrintSumma(ItogObor[3]) PrintSumma(ItogObor[4])
PrintSumma(ItogObor[5]) PrintSumma(ItogObor[6]) PrintSumma(ItogObor[7]) PrintSumma(ItogObor[8])
ListNumber
ФИОКассира
DoubleToStr(PrihodKol,'4') DoubleToStr(RashodKol,'4')
ГлавБух
.endfields
.begin
  if (GetFirst DayUch <> tsOk)
    dayuchbelKO4V.fBreak;
  ReadMyDsk(Schet,'BuhDlg01_DlgSchet',DateChanged);
  myPlansNo := coGetTune('Fin.User.cPlansSch');
  if myPlansNo = 0 {
    myPlansNo := coGetTune('Konsolid.cPlansSch');
  }
  if myPlansNo = 0
    Message('Задайте текущий план счетов!');

  BuhgTuneInit;
  isZarplTune := BuhgTuneInitFilter(1, myPlansNo, Schet);
  InitGetCur;
  ValCount := 1;
  MyKodValut := DayUch.KodValut;
  cMyVal[1] := DayUch.KodValut;
  SimVal[ValCount] := pGetSimvCurrency(DayUch.KodValut);
  _Loop DayUch {
    if DayUch.KodValut <> myKodValut {
      ValCount := ValCount + 1;
      myKodValut := DayUch.KodValut;
      cMyVal[ValCount] :=  DayUch.KodValut;
      SimVal[ValCount] := pGetSimvCurrency(DayUch.KodValut);
    }
  }
  for(i:=ValCount + 1;i<=4;i:= i+1) {
    SimVal[i] := '';
    cMyVal[i] := comp(0);
  }
  // Получение входящего сальдо на день
  for (i := 1; i <= ValCount; i := i + 1) {
    SaldoVhD[i] := 0;
    ZarplVhSal[i] := 0;
  }
  _Loop DayUch where ((comp(0) == DayUch.DatOb)) {
    for(i := 1; i <= ValCount; i := i + 1)
      if DayUch.Kodvalut = cMyVal[i] {
        SaldoVhD[i] := SaldoVhD[i] + DayUch.SaldoVhdV;
        ZarplVhSal[i] := ZarplVhSal[i] + DayUch.SaldoIshDV;
      }
  }
  PageNumber := 0;
  PrihodKol := 0;
  RashodKol := 0;
  if GetFirst DayUchCount = 0 {
    TempTiDk := DayUchCount.TiDk;
    TempNRec := DayUchCount.nRec;
    if (SubStr(DayUchCount.NoDok,1,1) <> '#') and (DayUchCount.OborDeb <> 0)
      PrihodKol := PrihodKol + 1;
    else
      if (DayUchCount.OborKred <> 0)
        RasHodKol := RashodKol + 1;
    do {
      if (DayUchCount.nRec <> TempNRec) or (DayUchCount.TiDk <> TempTiDk) {
        if (SubStr(DayUchCount.NoDok,1,1) <> '#') and (DayUchCount.OborDeb <> 0)
          PrihodKol := PrihodKol + 1;
        else
          if (DayUchCount.OborKred <> 0)
            RasHodKol := RashodKol + 1;
        TempTiDk := DayUchCount.TiDk;
        TempNRec := DayUchCount.nRec;
      }
      else continue;
    } while GetNext DayUchCount = 0;
  }
  DoneGetCur;

  // подписи кассира и бухгалтера.
  // из-за нестандартного поведения формы (использования fBreak внутри самой формы)
  // нарушается синхронизация выводимого в форму потока, и на момент печати
  // поля ГлавБух и ФИОКассира оказываются еще не выгруженными
  // поэтому заполним эти поля прямо в форме
  cBuh := coGetTune('MainBuh');
  if (cBuh <> 0)
    if (GetFirst Persons where ((cBuh == Persons.nRec)) = tsOk)
      ГлавБух := Persons.FIO;
  if (ГлавБух = '')
    ГлавБух := sGetTune('MainBuh');

  if (not boGetTune('Fin.ManyKass')) {
    ФИОКассира := sGetTune('MainCashier');
  }
  else {
    if (wGetTune('Fin.KassaOborot') = 0) {
      _Loop CashBank {
        if GetFirst SpCash where ((CashBank.nRec == SpCash.cCashBank )) = tsOk {
          if (SpCash.SchetO = Schet)
            if (SpCash.cVal <> comp(0))
              if (GetFirst Persons where ((CashBank.cPersons == Persons.nRec)) = tsOk) {
                ФИОКассира := Persons.FIO;
                break;
              }
        }
      }
      if ФИОКассира = ''
        ФИОКассира := sGetTune('MainCashier');
    }
    else {
      // считываем из Desk ссылку на настройку кассы, которая была сохранена в интерфейсе BuhDlg01
      ReadMyDsk(cKassir,'BuhDlg01_DlgCashBank',datechanged);
      if (GetFirst CashBank where ((cKassir == CashBank.nRec)) = tsOk) {
        if (GetFirst Persons where ((CashBank.cPersons == Persons.nRec)) = tsOk)
          ФИОКассира := Persons.FIO;
        else
          ФИОКассира := sGetTune('MainCashier');
      }
      else
        ФИОКассира := sGetTune('MainCashier');
    }
  }
end.




 Ш                                                   БКасса за @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
.if OkFilDch
 ВПрименен фильтр... В
.{
 В   ^ В
.{
 В      ^ ^ В
.}
.}
.end
.begin
  СтраницГод := НомЛиста-1;
  СтраницМес := КолЛистов;
  for (i := 1; i <= 4; i := i + 1) {
    DayItogPr[i] := 0;
    DayItogRas[i] := 0;
    SaldoIsh[i] := 0;
    Curs[i] := 0;
    ZarplSum[i] := 0;
    ZarplObor[i] := 0;
  }
  for (i := 1; i <= 8; i := i + 1)
    ItogObor[i] := 0;
end.
.{
.[h
                                                                                                                                                                             Вкладной лист кассовой книги   @np@
.]h
.{
.[h
.begin
  if (PageNumber <> 0) dayuchbelKO4V.fBreak;
  for (i := 1; i <= 4; i := i + 1) {
    PageItogPr[i] := 0;
    PageItogras[i] := 0;
  }
end.

 Б      ──────┬──────────────────────────────────┬─────────────┬───────────────────────────────────────────────────────────────────────────┬────────────────────────────────────────────────────────────────────────────
        №№  │ От кого получено или кому выдано │№№ корреспон-│                                                                           │
       доку-│                                  │ дирующего   │                                   Приход                                  │                                   Расход
       мента│                                  │ счета       │                                                                           │
            │                                  │             ├───────────────────────────────────────────────────────────────────────────┼────────────────────────────────────────────────────────────────────────────
            │                                  │             │                                 Виды валют                                │                                 Виды валют
            │                                  │             ├──────────────────┬──────────────────┬──────────────────┬──────────────────┼──────────────────┬──────────────────┬──────────────────┬───────────────────
            │                                  │             │       @~@@       │       @~@@       │        @~@@      │        @~@@      │       @~@@       │       @~@@       │        @~@@      │        @~@@
      ──────┼──────────────────────────────────┼─────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤──────────────────┼──────────────────┼──────────────────┼───────────────────
         1  │                2                 │      3      │        4         │        5         │         6        │         7        │        8         │        9         │         10       │         11
      ──────┴──────────────────────────────────┴─────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┴─────────────────── Щ
 Ш.]h
.begin
  if (PageNumber <> 0) dayuchbelKO4V.fBreak;
end.
.if KassaVhSaldoDay
 Б            │                       Остаток на начало дня    │&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│        X         │        X         │         X        │         X Б
            ├────────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼───────────────────
.end
.{
.}
.begin
  Result := GetFirst DayUch;
  while (DayUch.TiDk = 0) and (Result = 0) {
    Result := GetNext DayUch;
  }
end.
.{ while (Result = 0) and (PageNumber = 0)
.begin
  // цикл по валютам
  for (i := 1; i <= ValCount; i := i + 1) {
    if (DayUch.KodValut = cMyVal[i]) {
      Prihod[i] := DayUch.OborDebV;
      Rashod[i] := DayUch.OborKredV;
      SumRubD := DayUch.OborDeb;
      SumRubK := DayUch.OborKred;
      // зарплатные суммы
      if (isZarplTune)
        if BuhgTuneFoundFilter(1, Schet, DayUch.SubOsSch,
                               DayUch.KauOs[1],DayUch.KauOs[2],DayUch.KauOs[3],
                               DayUch.KauOs[4],DayUch.KauOs[5],DayUch.KauOs[6])
          ZarplObor[i] := ZarplObor[i] + DayUch.OborDebV - DayUch.OborKredV;
    }
    else {
      Prihod[i] := 0;
      Rashod[i] := 0;
      SumRubD := 0;
      SumRubK := 0;
    }

    PageItogPr[i] := PageItogPr[i] + Prihod[i];
    PageItogRas[i] := PageItogRas[i] + Rashod[i];
    DayItogPr[i] := DayItogPr[i] + Prihod[i];
    DayItogRas[i] := DayItogRas[i] + Rashod[i];
    ItogObor[i] := ItogObor[i] + SumRubD;
    ItogObor[i+4] := ItogObor[i+4] + SumRubK;
    MyDate := DayUch.DatOb;
  }
end.
      @@@@@@│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│ @@@@@ @@@@@ │&#'&&&&&&&&&&&&&&&│&#'&&&&&&&&&&&&&&&│&#'&&&&&&&&&&&&&&&│&#'&&&&&&&&&&&&&&&│&#'&&&&&&&&&&&&&&&│&#'&&&&&&&&&&&&&&&│&#'&&&&&&&&&&&&&&&│&#'&&&&&&&&&&&&&&&
.begin
  do {
    Result := GetNext DayUch;
  } while (DayUch.TiDk = 0) and (Result = 0);
end.
.[f
      ──────┴────────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────
 Б                                         Итого по странице   │&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&& Б
                                                             └──────────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────
.begin
  СтраницГод := СтраницГод+1;
  СтраницМес := СтраницМес+1;
end.
.]f
.}
      ───────────────────────────────────────────────────────┬──────────────────┬──────────────────┬──────────────────┬──────────────────┬──────────────────┬──────────────────┬──────────────────┬──────────────────
 Б                                             Итого за день   │&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&& Б
                                                             ├──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────
.begin
  for (i := 1; i <= 4; i := i + 1) {
    SaldoIsh[i] := SaldoVhD[i] + DayItogPr[i] - DayItogRas[i];
  }
end.
 Б                                       Остаток на конец дня  │&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│        X         │        X         │         X        │         X Б
.begin
  for(i :=  1; i <= 4; i := i + 1) {
    ZarplSum[i] := ZarplVhSal[i] + ZarplObor[i];
  }
end.
                                                             ├──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────
 Б                               в том числе на оплату труда   │&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│        X         │        X         │         X        │         X Б
.begin
  InitGetCur;
  for (i := 1; i <= 4; i := i + 1) {
     if cMyVal[i] <> comp(0) {
       Curs[i] := pGetAnyCurrency(cMyVal[i],1,myDate,comp(0));
    }
  }
  DoneGetCur;
end.
                                                             ├──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────
 Б                                                Курс валют   │&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│        X         │        X         │         X        │         X Б
                                                             ├──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────
 Б                          Эквивалент в денежных единицах РБ  │                  │                  │                  │                  │                  │                  │                  │ Б
 Б                                      оборота валют за день  │&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&& Б
                                                             └──────────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────
.if BreakPage
.end
.begin
  PageNumber := 1;
  if not ReadMyDsk(wParam3,'PrintListNumber_wParam3',DateChanged) then
    wParam3 := 0;
  ListNumber := '';
  if (wParam3 and 1) = 1 then
    ListNumber := if(МесяцДаты=12,
                 'Листов за месяц: '+ UpCase(trim(NumToString(СтраницМес,''))) +'. Листов за год: ' + UpCase(trim(NumToString(СтраницГод,'')))+'.',
                 'Листов за месяц: ' + UpCase(trim(NumToString(СтраницМес,'')))+'.'
    );
end.
.if duPrintPage
.end
        ^
.}
.begin
  if (PageNumber = 1)
    PageNumber := 2
  else
    dayuchbelKO4V.fBreak;
end.
 Ш
 Р        Кассир     ___________________   ^
                       (подпись)          (расшифровка подписи)

        Записи  в  кассовой  книге  проверил  и  документы  в количестве
        @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ приходных и
        ------------------------------------------------------
                              (прописью)
        @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ расходных
        ------------------------------------------------------
                              (прописью)
        получил.

        Бухгалтер  ___________________   ^
                        (подпись)            (расшифровка подписи) Р
.}
.begin
  BuhgTuneDone;
end.
.endform

!---------------------------------------------------------------------------------------------------
.linkform 'dayuchbelrep' prototype is 'dayuchved'
.group 'dayuchbel'
.nameinlist '2. Отчет кассира для Беларуси (КО-4в)'
.p 60
! Функция вывода заданного количества знаков после запятой
#include printfunc.frn
.defo landscape
.var
  myPlansNo,
  cKassir,
  cBuh,
  TempNRec,
  myKodvalut : comp;
  SimVal     : array[1..4] of string[4];
  cMyVal       : array[1..4] of comp;
  SaldoVhD,
  SaldoIsh,
  Prihod,
  Rashod,
  PageItogPr,
  PageItogRas,
  DayItogPr,
  DayItogRas,
  Curs,
  ZarplSum,
  ZarplVhSal,
  ZarplObor   : array[1..4] of double;
  Itogobor    : array[1..8] of double;
  SumRubD, SumRubK : double;
  ValCount, i, Result,
  PageNumber,
  PrihodKol,
  RashodKol : integer;
  MyDate      : date;
  DateChanged,
  isZarplTune : boolean;
  wParam3,
  TempTiDk : word;
  Schet      : string;
  ListNumber : string;
  СтраницМес : integer
  СтраницГод : integer
.endvar
.create view vDayUchReport
as select *
from
  DayUch DayUchCountRep(DayUch01),
  DayUch DayUchRep(DayUch02)
order by DayUchRep.KodValut
;
.fields
ИнтерДат
c1f1
c2f1 c2f2
SimVal[1] SimVal[2] SimVal[3] SimVal[4] SimVal[1] SimVal[2] SimVal[3] SimVal[4]
PrintSumma(SaldoVhD[1]) PrintSumma(SaldoVhD[2]) PrintSumma(SaldoVhD[3]) PrintSumma(SaldoVhD[4])
DayUchRep.NoDok DayUchRep.NameOper SubStr(DayUchRep.SchetK,2,21) DayUchRep.SubSchK
PrintSummaZero(Prihod[1]) PrintSummaZero(Prihod[2]) PrintSummaZero(Prihod[3]) PrintSummaZero(Prihod[4])
PrintSummaZero(Rashod[1]) PrintSummaZero(Rashod[2]) PrintSummaZero(Rashod[3]) PrintSummaZero(Rashod[4])

PrintSumma(PageItogpr[1]) PrintSumma(PageItogpr[2]) PrintSumma(PageItogpr[3]) PrintSumma(PageItogpr[4])
PrintSumma(PageItogRas[1]) PrintSumma(PageItogRas[2]) PrintSumma(PageItogRas[3]) PrintSumma(PageItogRas[4])

PrintSumma(DayItogPr[1]) PrintSumma(DayItogPr[2]) PrintSumma(DayItogPr[3]) PrintSumma(DayItogPr[4])
PrintSumma(DayItogRas[1]) PrintSumma(DayItogRas[2]) PrintSumma(DayItogRas[3]) PrintSumma(DayItogRas[4])

PrintSumma(SaldoIsh[1]) PrintSumma(SaldoIsh[2]) PrintSumma(SaldoIsh[3]) PrintSumma(SaldoIsh[4])
PrintSumma(ZarplSum[1]) PrintSumma(ZarplSum[2]) PrintSumma(ZarplSum[3]) PrintSumma(ZarplSum[4])
PrintSumma(Curs[1]) PrintSumma(Curs[2]) PrintSumma(Curs[3]) PrintSumma(Curs[4])
PrintSumma(ItogObor[1]) PrintSumma(ItogObor[2]) PrintSumma(ItogObor[3]) PrintSumma(ItogObor[4])
PrintSumma(ItogObor[5]) PrintSumma(ItogObor[6]) PrintSumma(ItogObor[7]) PrintSumma(ItogObor[8])
ListNumber
ФИОКассира
DoubleToStr(PrihodKol,'4') DoubleToStr(RashodKol,'4')
ГлавБух
.endfields
.begin
  if (GetFirst DayUchRep <> tsOk)
    dayuchbelrep.fBreak;
  ReadMyDsk(Schet,'BuhDlg01_DlgSchet',DateChanged);
  myPlansNo := coGetTune('Fin.User.cPlansSch');
  if myPlansNo = 0 {
    myPlansNo := coGetTune('Konsolid.cPlansSch');
  }
  if myPlansNo = 0
    Message('Задайте текущий план счетов!');

  BuhgTuneInit;
  isZarplTune := BuhgTuneInitFilter(1, myPlansNo, Schet);
  InitGetCur;
  ValCount := 1;
  MyKodValut := DayUchRep.KodValut;
  cMyVal[1] := DayUchRep.KodValut;
  SimVal[ValCount] := pGetSimvCurrency(DayUchRep.KodValut);
  _Loop DayUchRep {
    if DayUchRep.KodValut <> myKodValut {
      ValCount := ValCount + 1;
      myKodValut := DayUchRep.KodValut;
      cMyVal[ValCount] :=  DayUchRep.KodValut;
      SimVal[ValCount] := pGetSimvCurrency(DayUchRep.KodValut);
    }
  }
  for(i:=ValCount + 1;i<=4;i:= i+1) {
    SimVal[i] := '';
    cMyVal[i] := comp(0);
  }
  // Получение входящего сальдо на день
  for (i := 1; i <= ValCount; i := i + 1) {
    SaldoVhD[i] := 0;
    ZarplVhSal[i] := 0;
  }
  _Loop DayUchRep where ((comp(0) == DayUchRep.DatOb)) {
    for(i := 1; i <= ValCount; i := i + 1)
      if DayUchRep.Kodvalut = cMyVal[i] {
        SaldoVhD[i] := SaldoVhD[i] + DayUchRep.SaldoVhdV;
        ZarplVhSal[i] := ZarplVhSal[i] + DayUchRep.SaldoIshDV;
      }
  }
  PageNumber := 0;
  PrihodKol := 0;
  RashodKol := 0;
  if GetFirst DayUchCountRep = 0 {
    TempTiDk := DayUchCountRep.TiDk;
    TempNRec := DayUchCountRep.nRec;
    if (SubStr(DayUchCountRep.NoDok,1,1) <> '#') and (DayUchCountRep.OborDeb <> 0)
      PrihodKol := PrihodKol + 1;
    else
      if (DayUchCountRep.OborKred <> 0)
        RasHodKol := RashodKol + 1;
    do {
      if (DayUchCountRep.nRec <> TempNRec) or (DayUchCountRep.TiDk <> TempTiDk) {
        if (SubStr(DayUchCountRep.NoDok,1,1) <> '#') and (DayUchCountRep.OborDeb <> 0)
          PrihodKol := PrihodKol + 1;
        else
          if (DayUchCountRep.OborKred <> 0)
            RasHodKol := RashodKol + 1;
        TempTiDk := DayUchCountRep.TiDk;
        TempNRec := DayUchCountRep.nRec;
      }
      else continue;
    } while GetNext DayUchCountRep = 0;
  }
  DoneGetCur;

  // подписи кассира и бухгалтера.
  // из-за нестандартного поведения формы (использования fBreak внутри самой формы)
  // нарушается синхронизация выводимого в форму потока, и на момент печати
  // поля ГлавБух и ФИОКассира оказываются еще не выгруженными
  // поэтому заполним эти поля прямо в форме
  cBuh := coGetTune('MainBuh');
  if (cBuh <> 0)
    if (GetFirst Persons where ((cBuh == Persons.nRec)) = tsOk)
      ГлавБух := Persons.FIO;
  if (ГлавБух = '')
    ГлавБух := sGetTune('MainBuh');

  if (not boGetTune('Fin.ManyKass')) {
    ФИОКассира := sGetTune('MainCashier');
  }
  else {
    if (wGetTune('Fin.KassaOborot') = 0) {
      _Loop CashBank {
        if GetFirst SpCash where ((CashBank.nRec == SpCash.cCashBank )) = tsOk {
          if (SpCash.SchetO = Schet)
            if (SpCash.cVal <> comp(0))
              if (GetFirst Persons where ((CashBank.cPersons == Persons.nRec)) = tsOk) {
                ФИОКассира := Persons.FIO;
                break;
              }
        }
      }
      if ФИОКассира = ''
        ФИОКассира := sGetTune('MainCashier');
    }
    else {
      // считываем из Desk ссылку на настройку кассы, которая была сохранена в интерфейсе BuhDlg01
      ReadMyDsk(cKassir,'BuhDlg01_DlgCashBank',datechanged);
      if (GetFirst CashBank where ((cKassir == CashBank.nRec)) = tsOk) {
        if (GetFirst Persons where ((CashBank.cPersons == Persons.nRec)) = tsOk)
          ФИОКассира := Persons.FIO;
        else
          ФИОКассира := sGetTune('MainCashier');
      }
      else
        ФИОКассира := sGetTune('MainCashier');
    }
  }
end.




 Ш                                   БОтчет кассира за @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
.if OkFilDch
 ВПрименен фильтр... В
.{
 В   ^ В
.{
 В      ^ ^ В
.}
.}
.end
.begin
  СтраницГод := НомЛиста-1;
  СтраницМес := КолЛистов;
  for (i := 1; i <= 4; i := i + 1) {
    DayItogPr[i] := 0;
    DayItogRas[i] := 0;
    SaldoIsh[i] := 0;
    Curs[i] := 0;
    ZarplSum[i] := 0;
    ZarplObor[i] := 0;
  }
  for (i := 1; i <= 8; i := i + 1)
    ItogObor[i] := 0;
end.
.{
.[h
                                                                                                                                                                                                    лист    @np@
.]h
.{
.[h
.begin
  if (PageNumber <> 0) dayuchbelrep.fBreak;
  for (i := 1; i <= 4; i := i + 1) {
    PageItogPr[i] := 0;
    PageItogras[i] := 0;
  }
end.

 Б      ──────┬──────────────────────────────────┬─────────────┬───────────────────────────────────────────────────────────────────────────┬────────────────────────────────────────────────────────────────────────────
        №№  │ От кого получено или кому выдано │№№ корреспон-│                                                                           │
       доку-│                                  │ дирующего   │                                   Приход                                  │                                   Расход
       мента│                                  │ счета       │                                                                           │
            │                                  │             ├───────────────────────────────────────────────────────────────────────────┼────────────────────────────────────────────────────────────────────────────
            │                                  │             │                                 Виды валют                                │                                 Виды валют
            │                                  │             ├──────────────────┬──────────────────┬──────────────────┬──────────────────┼──────────────────┬──────────────────┬──────────────────┬───────────────────
            │                                  │             │       @~@@       │       @~@@       │        @~@@      │        @~@@      │       @~@@       │       @~@@       │        @~@@      │        @~@@
      ──────┼──────────────────────────────────┼─────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤──────────────────┼──────────────────┼──────────────────┼───────────────────
         1  │                2                 │      3      │        4         │        5         │         6        │         7        │        8         │        9         │         10       │         11
      ──────┴──────────────────────────────────┴─────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┴─────────────────── Щ
 Ш.]h
.begin
  if (PageNumber <> 0) dayuchbelrep.fBreak;
end.
.if KassaVhSaldoDay
 Б            │                       Остаток на начало дня    │&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│        X         │        X         │         X        │         X Б
            ├────────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼───────────────────
.end
.{
.}
.begin
  Result := GetFirst DayUchRep;
  while (DayUchRep.TiDk = 0) and (Result = 0) {
    Result := GetNext DayUchRep;
  }
end.
.{ while (Result = 0) and (PageNumber = 0)
.begin
  // цикл по валютам
  for (i := 1; i <= ValCount; i := i + 1) {
    if (DayUchRep.KodValut = cMyVal[i]) {
      Prihod[i] := DayUchRep.OborDebV;
      Rashod[i] := DayUchRep.OborKredV;
      SumRubD := DayUchRep.OborDeb;
      SumRubK := DayUchRep.OborKred;
      // зарплатные суммы
      if (isZarplTune)
        if BuhgTuneFoundFilter(1, Schet, DayUchRep.SubOsSch,
                               DayUchRep.KauOs[1],DayUchRep.KauOs[2],DayUchRep.KauOs[3],
                               DayUchRep.KauOs[4],DayUchRep.KauOs[5],DayUchRep.KauOs[6])
          ZarplObor[i] := ZarplObor[i] + DayUchRep.OborDebV - DayUchRep.OborKredV;
    }
    else {
      Prihod[i] := 0;
      Rashod[i] := 0;
      SumRubD := 0;
      SumRubK := 0;
    }

    PageItogPr[i] := PageItogPr[i] + Prihod[i];
    PageItogRas[i] := PageItogRas[i] + Rashod[i];
    DayItogPr[i] := DayItogPr[i] + Prihod[i];
    DayItogRas[i] := DayItogRas[i] + Rashod[i];
    ItogObor[i] := ItogObor[i] + SumRubD;
    ItogObor[i+4] := ItogObor[i+4] + SumRubK;
          MyDate := DayUchRep.DatOb;
  }
end.
      @@@@@@│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│ @@@@@ @@@@@ │&#'&&&&&&&&&&&&&&&│&#'&&&&&&&&&&&&&&&│&#'&&&&&&&&&&&&&&&│&#'&&&&&&&&&&&&&&&│&#'&&&&&&&&&&&&&&&│&#'&&&&&&&&&&&&&&&│&#'&&&&&&&&&&&&&&&│&#'&&&&&&&&&&&&&&&
.begin
  do {
    Result := GetNext DayUchRep;
  } while (DayUchRep.TiDk = 0) and (Result = 0);
end.
.[f
      ──────┴────────────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────
 Б                                         Итого по странице   │&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&& Б
                                                             └──────────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────
.begin
  СтраницГод := СтраницГод+1;
  СтраницМес := СтраницМес+1;
end.
.]f
.}
      ───────────────────────────────────────────────────────┬──────────────────┬──────────────────┬──────────────────┬──────────────────┬──────────────────┬──────────────────┬──────────────────┬──────────────────
 Б                                             Итого за день   │&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&& Б
                                                             ├──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────
.begin
  for (i := 1; i <= 4; i := i + 1) {
    SaldoIsh[i] := SaldoVhD[i] + DayItogPr[i] - DayItogRas[i];
  }
end.
 Б                                       Остаток на конец дня  │&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│        X         │        X         │         X        │         X Б
.begin
  for(i :=  1; i <= 4; i := i + 1) {
    ZarplSum[i] := ZarplVhSal[i] + ZarplObor[i];
  }
end.
                                                             ├──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────
 Б                               в том числе на оплату труда   │&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│        X         │        X         │         X        │         X Б
.begin
  InitGetCur;
  for (i := 1; i <= 4; i := i + 1) {
     if cMyVal[i] <> comp(0) {
       Curs[i] := pGetAnyCurrency(cMyVal[i],1,myDate,comp(0));
    }
  }
  DoneGetCur;
end.
                                                             ├──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────
 Б                                                Курс валют   │&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│        X         │        X         │         X        │         X Б
                                                             ├──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────
 Б                          Эквивалент в денежных единицах РБ  │                  │                  │                  │                  │                  │                  │                  │ Б
 Б                                      оборота валют за день  │&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&&│&'&&&&&&&&&&&&&&&& Б
                                                             └──────────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────
.if BreakPage
.end
.begin
  PageNumber := 1;
  if not ReadMyDsk(wParam3,'PrintListNumber_wParam3',DateChanged) then
    wParam3 := 0;
  ListNumber := '';
  if (wParam3 and 1) = 1 then
    ListNumber := if(МесяцДаты=12,
                 'Листов за месяц: '+ UpCase(trim(NumToString(СтраницМес,''))) +'. Листов за год: ' + UpCase(trim(NumToString(СтраницГод,'')))+'.',
                 'Листов за месяц: ' + UpCase(trim(NumToString(СтраницМес,'')))+'.'
    );
end.
.if duPrintPage
.end
        ^
.}
.begin
  if (PageNumber = 1)
    PageNumber := 2
  else
    dayuchbelrep.fBreak;
end.
 Ш
 Р        Кассир     ___________________   ^
                       (подпись)          (расшифровка подписи)

        Записи  в  кассовой  книге  проверил  и  документы  в количестве
        @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ приходных и
        ------------------------------------------------------
                              (прописью)
        @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ расходных
        ------------------------------------------------------
                              (прописью)
        получил.

        Бухгалтер  ___________________   ^
                        (подпись)            (расшифровка подписи)
.} Р
.begin
  BuhgTuneDone;
end.
.endform

!---------------------------------------------------------------------------------------------------
! титульный лист для валютной кассовой книги (для Беларуси)
!---------------------------------------------------------------------------------------------------
.linkform 'KO4titleBYVal' prototype is 'dayuchved'
.group 'dayuchbel'
.nameinlist '3. Обложка, титульный лист, последняя страница для Беларуси (КО-4в)'
.p 80
.Create view Kassa
var
from
  KatOrg    (ReadOnly)
where
((
    coGetTune('MYORG') == KatOrg.nRec
))
;
.begin
  Kassa.GetFirst KatOrg;
end.
.fields
  Kassa.KatOrg.Name
  Year(StrToDate(ИнтерДат,'DD/MM/YYYY'))
.endfields
!------------------------------------------------------------------------------
.if OkFilDch
.{
.{
.}
.}
.end
.{
.{
.if KassaVhSaldoDay
.end
.{
.}
.if BreakPage
.end
.}
.if duPrintPage
.end
.}
!------------------------------------------------------------------------------
 И                                                   Приложение 5
                                                   к постановлению Министерства
                                                   финансов Республики Беларусь
                                                   19.04.2001 N 43

                                                                       Форма N КО-4в





 Б@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
───────────────────────────────────────────────────────────────────────────────
                    (полное наименование предприятия)



                                  БКАССОВАЯ КНИГА Б
                                 на  Б@~@@@@@@@ Б г.
                                ─────────────────


!---------------------------------------------------------------------------
.fields
  'true':'s'
  Kassa.KatOrg.Name
  Year(StrToDate(ИнтерДат,'DD/MM/YYYY'))
.endfields
^



 Б@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
───────────────────────────────────────────────────────────────────────────────
                    (полное наименование предприятия)



                                  БКАССОВАЯ КНИГА Б

                                 на  Б@~@@@@@@@ Б г.
                                ─────────────────
.fields
'true':'s'
РукПред
ГлавБух
.endfields
^



















































 Б                            В настоящей книге пронумеровано,
                            прошнуровано            листов,
                                        ───────────
                            книга опечатана сургучной (мастичной) печатью

                            М.П.(штампа)


                            Руководитель               @~@@@@@@@@@@@@@@@@@@@@@@@@@
                                        ────────────── ───────────────────────────
                                          (подпись)      (расшифровка подписи)

                            Главный бухгалтер                 @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                                              ─────────────── ──────────────────────────────
                                                         (подпись)        (расшифровка подписи)

                                                 "____" ________________  _______ г. Й
.endform
