//-----------------------------------------------------------------------------------
//                                                           (c) корпорация ГАЛАКТИКА
// Галактика 5.5 - Касса
// Печать реестра командировок
//-----------------------------------------------------------------------------------

#doc
Печать реестра командировок.
#end
.set name='RKomUd'
.nameinlist 'Базовая форма'
.hide
.fields
! фильтры
  strFilters
  FilterName
! информация о сотруднике
  Podr
  FIO
  TabNmb
! информация о приказе
  D_doc
  N_Doc
  State
  City
  ADR
  Srok
  Osnov
  Soderg
  dStart
  dEnd
  NomKU 
! информация о этапе
  StateEtap
  CityEtap
  ADREtap
  SrokEtap
  OsnovEtap
  SodergEtap
  dStartEtap
  dEndEtap
.endfields

strFilters ^ 
.{ CheckEnter FilterKomud
 FilterName ^
.}
.{
^ ^ ^
.{
^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^
.{ CheckEnter PrEtapKomud
^ ^ ^ ^ ^ ^ ^ ^
.}
.}
.}
.endform
!
!
!
.linkform 'RKomUd01' prototype is 'RKomUd'
.group 'Реестр'
.fields
  CommonFormHeader
  strFilters
  FilterName
  Podr
  FIO
  D_doc
  N_Doc
  NomKU
  State
  City
  ADR
  Srok
! информация о этапе
  StateEtap
  CityEtap
  ADREtap
  SrokEtap
.endfields
^
 Й                            Реестр командировочных удостоверений Й
 И^
.{ CheckEnter FilterKomud
  ^
.}
───────────────────────────────────────┬──────────────────────────────────────────────────────
            Подразделение              │           ФИО командированного сотрудника
─────────┬───────────┬────────┬────────┴────────────────────┬───────────────────────────┬─────
  Дата   │   Номер   │  Номер │     Страна/Город            │       Куда                │Срок
 приказа │  приказа  │   КУ   │                             │                           │(дн.)
─────────┴───────────┴────────┴─────────────────────────────┴───────────────────────────┴─────
.{
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.{
@@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@ @@@@@@@@@@@@@@ @@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@
.{ CheckEnter PrEtapKomud
                                @@@@@@@@@@@@@@ @@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@
.}
.}
  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .
.}
.endform



.linkform 'RKomUd02' prototype is 'RKomUd'
.group 'Пересечение командировок'
.fields
  CommonFormHeader
! фильтры
  strFilters
  FilterName
! информация о сотруднике
  TabNmb
  FIO
  Podr
! информация о приказе
  D_doc
  N_Doc
  State
  City
  ADR
  dStart
  dEnd  
! информация о этапе
  StateEtap
  CityEtap
  ADREtap
  dStartEtap
  dEndEtap
.endfields
^
 Й                            Отчет о пересечении командировок Й
 И^
.{ CheckEnter FilterKomud
  ^
.}
 И──────────┬─────────┬──────────────────────────┬───────────────────────┬──────────────────────
   Дата   │  Номер  │    Страна/Город          │         Куда          │         Срок
  приказа │ приказа │                          │                       ├───────────┬──────────
          │         │                          │                       │Дата начала│Дата конца
──────────┴─────────┴──────────────────────────┴───────────────────────┴───────────┴────────── И
.{
 И@@@@@@@@@@@@  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@ И
.{
 И@@@@@@@@@@ @@@@@@@@@ @@@@@@@@@@@ @@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@ И
.{ CheckEnter PrEtapKomud
 И                     @@@@@@@@@@@ @@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@ И
.}
.}
 И .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . И
.}
.endform
