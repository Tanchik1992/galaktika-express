//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 5.00 - Касса
// Подотчетные лица
//------------------------------------------------------------------------------

#doc
Отчеты по подотчетным лицам.
#end
.set name = 'Podotchet'
.hide
.fields
c0p1
c1p2 c1p3 c1p4 c1p5 c1p6 c1p7 c1p8 c1p9 c1p10
c2p1 c2p2 c2p3 c2p4 c2p5 c2p6 c2p7
ItgDoc1 ItgVal ItgSum1 ItgSum2 ItgSum3 ItgDoc2
.endfields
c0p1  Конечная дата для документов ^
.{
c1p2  Сотрудник  ^
c1p3  Табельный номер ^
c1p4  Подразделение ^
      Входящее сальдо для пересчета...
c1p5          на: ^
c1p6       сумма: ^
c1p7  Дата последнего расчета сальдо ^
c1p8  Сальдо на дату последнего расчета  ^
c1p9  Текущее сальдо ^
c1p10 Валюта сальдо^
.if OkDocPodotchet
.{
c2p1  Тип документа ^
c2p2  Номер док-та ^
c2p3  Дата обработки док-та ^
c2p4  Сумма по док-ту ^
c2p5  Как сумма учитывается в расчетах (+/-) ^
c2p6  Содержание док-та ^
c2p7  Валюта документа^
.}
.end
.}
.{
ItgDoc1 ^
ItgVal  ^
ItgSum1 ^
ItgSum2 ^
ItgSum3 ^
ItgDoc2 ^
.}
.endform
!==============================================================================
.linkform 'Podotchet_01' prototype is 'Podotchet'
.nameinlist '1. Подотчетные лица, сальдо и документы по ним'
.fields
CommonFormHeader
c0p1
c1p2 c1p3 c1p4 c1p5 c1p10 c1p6 c1p7 c1p8 c1p9
c2p1 c2p3 c2p2 c2p7 c2p4 c2p5 c2p6
ItgDoc1 ItgVal ItgSum1 ItgSum2 ItgSum3 ItgDoc2
.endfields
 Р^
                                  Б        Подотчетные лица и документы по ним Б
                                  Бс даты сальдо для пересчета по ^ включительно Б
──────────────────────────┬──────┬───────────────┬─────────────────────────────────┬────────────────────────────┬─────────────────
         Сотрудник        │ Таб. │ Подразделение │       Входящее сальдо           │   Сальдо на дату расчета   │  Текущее сальдо
                          │номер │               ├──────────┬────┬─────────────────┼──────────┬─────────────────┼─────────────────
                          │      │               │   дата   │Вал.│      сумма      │   дата   │      сумма      │      сумма
──────────────────────────┴──────┴───────────────┴──────────┴────┴─────────────────┴──────────┴─────────────────┴─────────────────
   ────┬──────────┬────────┬────┬─────────────────┬───┬───────────────────────────────────────────────────────────────────────────
    Тип│   Дата   │ Номер  │Вал.│    Сумма        │+/-│            Содержание документа
   ────┴──────────┴────────┴────┴─────────────────┴───┴───────────────────────────────────────────────────────────────────────────
.{
@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@ @@@@@@@@@@@@@@@ @@@@@@@@@@ @@@@ &'&&&&&&&&&&&&&&& @@@@@@@@@@ &'&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&
.if OkDocPodotchet
.{
   @@@@ @@@@@@@@@@ @@@@@@@@ @@@@ &'&&&&&&&&&&&&&&&  @  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.}
.else
   По подотчетному лицу нет документов
.end
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.}
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 БИтого по документу: Б
.{
                               &'&&&&&&&&&&&&&&&&&  +         Б@@@@ &'&&&&&&&&&&&&&&&          &'&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&& Б
                               &'&&&&&&&&&&&&&&&&&  -
.}
 Р
.endform
!==============================================================================
.linkform 'Podotchet_02' prototype is 'Podotchet'
.nameinlist '2. Подотчетные лица'
.fields
CommonFormHeader
c1p2 c1p3 c1p4 c1p5 c1p10 c1p6 c1p7 c1p8 c1p9
ItgVal ItgSum1 ItgSum2 ItgSum3
.endfields
 Р^
                                                     БСальдо по подотчетным лицам Б
──────────────────────────┬──────┬───────────────┬─────────────────────────────────┬────────────────────────────┬─────────────────
         Сотрудник        │ Таб. │ Подразделение │       Входящее сальдо           │   Сальдо на дату расчета   │  Текущее сальдо
                          │номер │               ├──────────┬────┬─────────────────┼──────────┬─────────────────┼─────────────────
                          │      │               │   дата   │Вал.│      сумма      │   дата   │      сумма      │      сумма
──────────────────────────┴──────┴───────────────┴──────────┴────┴─────────────────┴──────────┴─────────────────┴─────────────────
.{
@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@ @@@@@@@@@@@@@@@ @@@@@@@@@@ @@@@ &'&&&&&&&&&&&&&&& @@@@@@@@@@ &'&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&
.if OkDocPodotchet
.{
.}
.else
.end
.}
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 БИтого по документу: Б
.{
                                                              Б@@@@ &'&&&&&&&&&&&&&&&            &'&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&& Б
.}
 Р
.endform
!==============================================================================
.linkform 'Podotchet_03' prototype is 'Podotchet'
.nameinlist '3. Документы по подотчетным лицам'
.fields
CommonFormHeader
c0p1
c1p2 c1p3 c1p4 c1p7 c1p9 c1p10
c2p1 c2p3 c2p2 c2p7 c2p4 c2p5 c2p6
.endfields
 Р^
                                  Б        Подотчетные лица и документы по ним Б
                                  Бс даты сальдо для пересчета по ^ включительно Б
────┬──────────┬────────┬────┬──────────────┬───┬─────────────────────────────────────────────────────────────
 Тип│   Дата   │ Номер  │Вал.│    Сумма     │+/-│            Содержание документа
────┴──────────┴────────┴────┴──────────────┴───┴─────────────────────────────────────────────────────────────
.{
    Сотрудник  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б Таб.номер  Б@@@@@@ Б Подразделение @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    Исходящее сальдо на @@@@@@@@@@ равно &'&&&&&&&&&&&& валюта @@@@
.if OkDocPodotchet
.{
@@@@ @@@@@@@@@@ @@@@@@@@ @@@@ &'&&&&&&&&&&&&  @  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.}
.else
   По подотчетному лицу нет документов
.end
──────────────────────────────────────────────────────────────────────────────────────────────────────────────
.}
.{
.}
 Р
.endform
!==============================================================================
.linkform 'Podotchet_04' prototype is 'Podotchet'
.nameinlist '4. Текущее сальдо по подотчетным лицам'
.fields
CommonFormHeader
c1p2 c1p3 c1p4 c1p10 c1p9
.endfields
 И^
                                БСальдо по подотчетным лицам Б
───────────────────────────────┬──────┬──────────────────┬────────────────────────────────
         Сотрудник             │ Таб. │   Подразделение  │         Текущее сальдо
                               │номер │                  ├────┬───────────────────────────
                               │      │                  │Вал.│           сумма
───────────────────────────────┴──────┴──────────────────┴────┴───────────────────────────
.{
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@ @@@@@@@@@@@@@@@@@@ @@@@ &'&&&&&&&&&&&&&&&&&&&&&&&&&
.if OkDocPodotchet
.{
.}
.end
.}
.{
.}
 И
.endform
!==============================================================================
