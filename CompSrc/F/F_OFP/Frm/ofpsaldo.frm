//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 5.80 - модуль "Платежный календарь"
// Отчеты по платежным средствам
//------------------------------------------------------------------------------

#doc
Отчеты по платежным средствам (прототип).<br>
#end
.set name = 'ofpsaldo'
.hide
.Fields
  Saldo_NameType:string:'t:r' // тип ПС (не удалит пробелы слева)

  Saldo_Name     // ПС
  Saldo_Val      // валюта
  Saldo_Summa    // их сумма

  Sald_Date      // дата фактических/плановых остатков

  SaldR_Oborot   // фин.поток ПС
  SaldR_Rest     // сумма остатка
  SaldR_Deficit  // дефицит

//  LimitDate              // дата лимита
//  LimitSumma             // сумма

  NameClearing:string:'t:r' // финоперации

.endFields
.{

.{ OfpSaldo_Begin CheckEnter
 ^
.{ OfpSaldo_Plan CheckEnter
 ^ ^ ^  ^  ^ ^ ^
.{ OfpSaldo_Fop CheckEnter
 ^
.}
.}
.}

.}
.endform

//------------------------------------------------------------------------------
#doc
Рассчитанные остатки.<br>
#end
.linkform 'ofpsaldo01' prototype is 'ofpsaldo'
.group 'Рассчитанные остатки'
.p 55
.defo landscape
.Fields
  CommonFormHeader       // название отчета

  Saldo_NameType:'t:r'

  Saldo_Name
  Saldo_Val
  Saldo_Summa

  Sald_Date             // дата фактических/плановых остатков

  SaldR_Oborot
  SaldR_Rest
  SaldR_Deficit

//  LimitDate
//  LimitSumma

  NameClearing:'t:r'

.endFields
 Ш^

                                                   Рассчитанные остатки платежных средств
.{
.[H
                                                                                                                            лист @np@
──────────────────────────────┬──────────┬────────────────────┬──────────┬─────────────────────┬─────────────────────┬────────────────────
     Платежное средство       │  Валюта  │ Начальный остаток  │   Дата   │ Финансовый поток    │       Остаток       │      Дефицит
──────────────────────────────┴──────────┴────────────────────┴──────────┴─────────────────────┴─────────────────────┴────────────────────
.]H
.{ OfpSaldo_Begin CheckEnter
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.{ OfpSaldo_Plan CheckEnter
  @@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@~@@@@@@ &'&&&&&&&&&&&&&&&&&& @@@@@@@@@@ &'&&&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&&& &'&&&&&&&&&&&&&&&&&&
.{ OfpSaldo_Fop CheckEnter
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.}
.}
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
.} Ш
.}

.endform

//------------------------------------------------------------------------------
#doc
Начальные остатки.<br>
#end
.linkform 'ofpsaldo02' prototype is 'ofpsaldo'
.group 'Начальные остатки'
.p 80
.defo portrait
.Fields
  CommonFormHeader       // название отчета

  Saldo_NameType:'t:r' // тип ПС

  Saldo_Name     // ПС
  Saldo_Val      // валюта
//  Sald_Date      // дата актуальных остатков
  Saldo_Summa    // их сумма

.endFields
^

               БНачальные остатки платежных средств Б
.{
.[H
                                                  лист @np@
──────────────────────────────┬──────────┬────────────────────
     Платежное средство       │  Валюта  │ Начальный остаток
──────────────────────────────┴──────────┴────────────────────
.]H
.{ OfpSaldo_Begin CheckEnter
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.{ OfpSaldo_Plan CheckEnter
  @@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@~@@@@@@ &'&&&&&&&&&&&&&&&&&&
.{ OfpSaldo_Fop CheckEnter
.}
.}
──────────────────────────────────────────────────────────────
.}
.}

.endform

//------------------------------------------------------------------------------
