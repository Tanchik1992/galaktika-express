//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 7.12 - Спецодежда
// Печать Личной карточки учета СФО
//------------------------------------------------------------------------------

#doc
Формирование различных печатных вариантов ЛК учета СФО.<br>
#end
.Set Name = 'PersCardProt'
.Hide
.Var
  IsCustom : boolean;
.endVar
.Begin
  if (Lic_ItemExists('Custom'))
    IsCustom := True;
end.
.Fields
  OrgName : String  ОКПО : String  CardNo : String  sostDate : Date
  FIO : String  TabN : String  Pol : String  Cex : String  Podr : String
  Prof : String  InDate : Date chDate : Date uvDate : Date
  Rost : String  Od1 : String  Od2 : String  Ob : String
  GUb : String  Perch : String  ISZ : String Pog : String
  frmFlag : Boolean  spcFlag : Boolean
.endFields
  ^ ^ ^ ^
  ^ ^ ^ ^ ^ ^
  ^ ^ ^
  ^ ^ ^ ^ ^ ^ ^ ^
  ^ ^

.{ frmCircle checkenter
.Fields
  frName : String  frKod : String  frIsSIZ : Boolean frEd : String
  frPar : String   frKol : String  frSrok : String
.endFields
  ^ ^ ^ ^ ^ ^ ^
.}

.{ spcCircle checkenter
.Fields
  spName : String  spKod : String  spIsSIZ : Boolean spEd : String
  spPar : String   spKol : String  spSrok : String
.endFields
  ^ ^ ^ ^ ^ ^ ^
.}
.Fields
  frStr : String
.endFields
 ^
.{
.Fields
  sfName : String  sfKod : String  sfIsSIZ : Boolean sfGive : Date  sfGiveKol : Double
  sfPrice : Double  sfPercGodnIn : Double
  SrokInUse: String DopInfo: String MBPInNRec : Comp
  spisType : String  sfSpis : Date  sfSpisKol : Double
  sfSpisPrice : Double  sfPercGodnOut : Double
  NumAct: String
.endFields
 ^ ^ ^ ^ ^ ^ ^
 ^ ^ ^
 ^ ^ ^ ^ ^
 ^
.}
.endForm

!------------------------------------------------------------

.LinkFORM PersCard Prototype Is PersCardProt
.Group 'Личные карточки учета СФО'
.NameInList 'Личная карточка учета СФО'
.Var
  totSum : double;
.endVar
.Fields
  CommonFormHeader
  OrgName  CardNo  FIO TabN  Pol  Cex
  Podr  Rost
  Prof  Od1
  DateToStr( InDate, 'DD/MM/YYYY')  Od2
  DateToStr( chDate, 'DD/MM/YYYY')  Ob
  DateToStr( uvDate, 'DD/MM/YYYY')  Perch
  GUb     ISZ
.endFields
  ^
  ^

                        ЛИЧНАЯ КАРТОЧКА №  Б^ Б
            УЧЕТА ФОРМЕННОЙ И СПЕЦИАЛЬНОЙ ОДЕЖДЫ, ОБУВИ,
                  ПРЕДОХРАНИТЕЛЬНЫХ ПРИСПОСОБЛЕНИЙ

Фамилия И.О.   Б^ Б
Табельный номер  @@@@@@@@@@                             Пол         @@@
Цех(Отдел)  &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
Вышестоящее &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&          Рост      &&&&&
Профессия (должность) &&&&&&&&&&&&&&&&&&&&&&&&  Размеры:одежды1   &&&&&
Дата поступления на работу          @@@@@@@@@@          одежды2   &&&&&
Дата изменения норм (проф., должн.) @#@@@@@@@@          обуви     &&&&&
Дата увольнения                     @#@@@@@@@@          перчаток  &&&&&
                                                        гол.убора &&&&&
                                                        ИСЗ       &&&&&
.{?INTERNAL; (IsCustom)
.Fields
  Pog
.endFields
                                                        погон     &&&&&
.}

Предусмотрено по утвержденным нормам
.{?Internal;(frmFlag=True);

 Форменная одежда и обувь
┌───────────┬─────────────────────┬──────────┬──────────┬────────┬─────────┐
│    Код    │     Наименование    │  Ед.изм. │ Пар.норм │ Кол-во │   Срок  │
├───────────┼─────────────────────┼──────────┼──────────┼────────┼─────────┤
.{ frmCircle checkenter
.Fields
  frKod  frName  frEd  frPar  frKol  frSrok
.endFields
│@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@│@@@@@@@@@@│&&&&&&&&│&&&&&&&&&│
.}
└───────────┴─────────────────────┴──────────┴──────────┴────────┴─────────┘
.}
.{?Internal;(spcFlag=True);

 Специальная одежда и обувь
┌───────────┬─────────────────────┬──────────┬──────────┬────────┬─────────┐
│    Код    │     Наименование    │  Ед.изм. │ Пар.норм │ Кол-во │   Срок  │
├───────────┼─────────────────────┼──────────┼──────────┼────────┼─────────┤
.{ spcCircle checkenter
.Fields
  spKod  spName  spEd  spPar  spKol  spSrok
.endFields
│@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@│@@@@@@@@@@│&&&&&&&&│&&&&&&&&&│
.}
└───────────┴─────────────────────┴──────────┴──────────┴────────┴─────────┘
.}

Начальник ОТБ                               Бухгалтер
Инженер ОТ и ТБ                             Начальник цеха (отдела)


.Fields
  frStr  DateToStr( sostDate, 'DD/MM/YYYY')
.endFields
.begin
  totSum := 0;
end.

 РВыдача и возврат форменной и специальной одежды и обуви, предохранит. приспособлений.
Выдано ^. Cостояние на ^.
┌──────────────────────────────────┬─────────────────────────────────────────────────────────┬────────────────────────────────────────┐
│ Форм. и спецодежда,обувь, присп. │                         Выдано                          │            Возвращено, списано         │
├──────────────────────┬───────────┼──────────┬──────┬──────────┬─────────────┬──────────────┼───────┬──────────┬──────┬──────────────┤
│     Наименование     │ Номенкл.№ │   Дата   │ К-во │   Цена   │  Стоимость  │Прим.(подпись)│Отметка│   Дата   │ К-во │Прим.(подпись)│
├──────────────────────┼───────────┼──────────┼──────┼──────────┼─────────────┼──────────────┼───────┼──────────┼──────┼──────────────┤
.{
.Fields
  sfName  sfKod  if ( LongInt( sfGive)=0, ' ', DateToStr( sfGive, 'DD/MM/YYYY'))  sfGiveKol  sfPrice  sfGiveKol*sfPrice
  spisType  if ( LongInt( sfSpis)=0, ' ', DateToStr( sfSpis, 'DD/MM/YYYY'))  sfSpisKol
.endFields
.begin
  totSum := totSum + (sfGiveKol * sfPrice - sfSpisKol * sfSpisPrice);
end.
│@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@│@@@@@@@@@@│&#&&&&│&#&&&&&.&&│&#&&&&&&&&.&&│              │@@~@@@@│@@@@@@@@@@│&#&&&&│              │
.}
└──────────────────────┴───────────┴──────────┴──────┴──────────┴─────────────┴──────────────┴───────┴──────────┴──────┴──────────────┘
 Р
.Fields
  totSum
.endFields
 БИтого по находящимся в использовании : &'#&&&&&&&&.&& Б

.endForm

!===================================================================================================
.LinkFORM PersCard_MB_2 Prototype Is PersCardProt
.Group 'Личные карточки учета СФО'
.NameInList 'Личная карточка учета МБП'
.P 40
.PAPER PA4
.ORIENT PORTRAIT
.LL 80
.Fields
  CommonFormHeader
  CardNo
  OrgName
  ОКПО
  Cex
  DateToStr( sostDate, 'DD/MM/YYYY')
  Cex
  TabN
  FIO
  Prof
.endFields
.var
  PrintObr : Boolean;
.endvar
.begin
  PrintObr := True;
end.
 Ш ^
                                                                                                            Типовая межотраслевая форма № МБ-2
                                                                                                            Утверждена постановлением Госкомстата России
                                                                                                            от 30.10.97 № 71а
                                               БКАРТОЧКА №  Д@~@@@@@@@@ Е                                                                       ┌─────────────┐
                              Бучета малоценных и быстроизнашивающихся предметов Б                                                            │    Коды     │
                                                                                                                                           Б├─────────────┤ Б
                                                                                                                            Форма по ОКУД  Б│   0320001   │ Б
                                                                                                                                           Б├ Б───────────── Б┤ Б
 Организация   Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е            по ОКПО  Б│@~@@@@@@@@@@@│ Б
 Структурное подразделение   Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е                     Б└─────────────┘ Б
                                                 ┌──────────┬──────────┬───────────────────────────┬──────────────┬──────────────────────────┬──────────┐
                                                 │   Дата   │          │        Cтруктурное        │     Вид      │  Корреспондирующий счет  │Табельный │
                                                 │  состав- │ Код вида │       подразделение       │ деятельности ├─────────┬────────────────┤  номер   │
                                                 │   ления  │ операции │                           │              │  счет,  │  код аналити-  │получателя│
                                                 │          │          │                           │              │ субсчет │ ческого учета  │          │
                                                 ├──────────┼──────────┼───────────────────────────┼──────────────┼─────────┼────────────────┼──────────┤
                                                 │@@@@@@@@@@│          │@~@@@@@@@@@@@@@@@@@@@@@@@@@│              │         │                │@~@@@@@@@@│
                                                 └──────────┴──────────┴───────────────────────────┴──────────────┴─────────┴────────────────┴──────────┘
 Фамилия И.,О.  Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
  ДПрофессия  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
 Должность
.var // Номер паспорта
  infWOsfo : String
  Pass : String
  PasOff : Integer
  InvOff : Integer
  eOff : Integer
.endvar
.{ frmCircle checkenter
.}
.{ spcCircle checkenter
.}
.{
.[h1
╔══════════════════════════════════════════╦════════════════════════════════════╦══════════════════════════════╦════════════════════╦════════╦══════════╗
║                   Предмет                ║              Выдано                ║           Возвращено         ║     Акт выбытия    ║        ║          ║
╟───────────────────────────┬──────────────╫──────────┬────────┬────────────────╫──────────┬────────┬──────────╫─────────┬──────────╢  Срок  ║  Номер   ║
║       Наименование,       │ Номенклатур- ║   Дата   │ Кол-во │Подпись работни-║   Дата   │ Кол-во │ Подпись  ║  Номер  │   Дата   ║ службы ║ паспорта ║
║       марка, размер       │   ный номер  ║          │        │ ка (бригадира) ║          │        │кладовщика║         │          ║        ║          ║
╟───────────────────────────┼──────────────╫──────────┼────────┼────────────────╫──────────┼────────┼──────────╫─────────┼──────────╫────────╫──────────╢
║             1             │      2       ║     3    │    4   │       5        ║     6    │    7   │     8    ║    9    │    10    ║   11   ║    12    ║
╠═══════════════════════════╪══════════════╬══════════╪════════╪════════════════╬══════════╪════════╪══════════╬═════════╪══════════╬════════╬══════════╣
.]h
.[h2
                                                                                                                          Оборотная сторона формы № МБ-2
╔══════════════════════════════════════════╦════════════════════════════════════╦══════════════════════════════╦════════════════════╦════════╦══════════╗
║                   Предмет                ║              Выдано                ║           Возвращено         ║     Акт выбытия    ║        ║          ║
╟───────────────────────────┬──────────────╫──────────┬────────┬────────────────╫──────────┬────────┬──────────╫─────────┬──────────╢  Срок  ║  Номер   ║
║       Наименование,       │ Номенклатур- ║   Дата   │ Кол-во │Подпись работни-║   Дата   │ Кол-во │ Подпись  ║  Номер  │   Дата   ║ службы ║ паспорта ║
║       марка, размер       │   ный номер  ║          │        │ ка (бригадира) ║          │        │кладовщика║         │          ║        ║          ║
╟───────────────────────────┼──────────────╫──────────┼────────┼────────────────╫──────────┼────────┼──────────╫─────────┼──────────╫────────╫──────────╢
║             1             │      2       ║     3    │    4   │       5        ║     6    │    7   │     8    ║    9    │    10    ║   11   ║    12    ║
╠═══════════════════════════╪══════════════╬══════════╪════════╪════════════════╬══════════╪════════╪══════════╬═════════╪══════════╬════════╬══════════╣
.]h
.begin
 if ( InStr('/', DopInfo) > 0) then
   infWOsfo := Substr( DopInfo, 1, InStr('/', DopInfo) - 1)
 else
   infWOsfo := DopInfo;
 Pass := '';
 PasOff := InStr('ПАСПОРТ:', Upcase( infWOsfo));
 InvOff := InStr('ИНВ:', Upcase( infWOsfo));
 if (PasOff > 0) then
 {
   eOff := PasOff + 8
   Pass := Substr( infWOsfo, eOff, Length( infWOsfo) -eOff +1);
   if (PasOff < InvOff)
     Pass := Trim( Substr( Pass, 1, InvOff-eOff));
 }
end.
.Fields
  sfName
  sfKod
  if (LongInt(sfGive) > 0, DateToStr( sfGive, 'DD/MM/YYYY'), '')
  sfGiveKol
  if (LongInt(sfSpis) >0, DateToStr( sfSpis, 'DD/MM/YYYY'), '')
  sfSpisKol
  NumAct
  if (LongInt(sfSpis) >0, DateToStr( sfSpis, 'DD/MM/YYYY'), '')
  SrokInUse
  Pass
.endFields
║@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@║@@@@@@@@@@│&#&&&.&&│                ║@@@@@@@@@@│&#&&&.&&│          ║@~@@@@@@@│@~@@@@@@@@║@~@@#@@@║@@@@@@@@@@║
.[f1
.begin
  PrintObr := True;
end.
╚═══════════════════════════╧══════════════╩══════════╧════════╧════════════════╩══════════╧════════╧══════════╩═════════╧══════════╩════════╩══════════╝

.]f
.[f2
.begin
  PrintObr := False;
end.
╚═══════════════════════════╧══════════════╩══════════╧════════╧════════════════╩══════════╧════════╧══════════╩═════════╧══════════╩════════╩══════════╝
Карточку заполнил _________________  _________  _____________________
                      должность       подпись    расшифровка подписи

                  "  "  ___________  20  г.

.]f
.}
.{?INTERNAL;PrintObr
                                                                                                                           Оборотная сторона формы № МБ-2
╔══════════════════════════════════════════╦════════════════════════════════════╦══════════════════════════════╦════════════════════╦════════╦══════════╗
║                   Предмет                ║              Выдано                ║           Возвращено         ║     Акт выбытия    ║        ║          ║
╟───────────────────────────┬──────────────╫──────────┬────────┬────────────────╫──────────┬────────┬──────────╫─────────┬──────────╢  Срок  ║  Номер   ║
║       Наименование,       │ Номенклатур- ║   Дата   │ Кол-во │Подпись работни-║   Дата   │ Кол-во │ Подпись  ║  Номер  │   Дата   ║ службы ║ паспорта ║
║       марка, размер       │   ный номер  ║          │        │ ка (бригадира) ║          │        │кладовщика║         │          ║        ║          ║
╟───────────────────────────┼──────────────╫──────────┼────────┼────────────────╫──────────┼────────┼──────────╫─────────┼──────────╫────────╫──────────╢
║             1             │      2       ║     3    │    4   │       5        ║     6    │    7   │     8    ║    9    │    10    ║   11   ║    12    ║
╠═══════════════════════════╪══════════════╬══════════╪════════╪════════════════╬══════════╪════════╪══════════╬═════════╪══════════╬════════╬══════════╣
║                           │              ║          │        │                ║          │        │          ║         │          ║        ║          ║
╠═══════════════════════════╪══════════════╬══════════╪════════╪════════════════╬══════════╪════════╪══════════╬═════════╪══════════╬════════╬══════════╣
║                           │              ║          │        │                ║          │        │          ║         │          ║        ║          ║
╠═══════════════════════════╪══════════════╬══════════╪════════╪════════════════╬══════════╪════════╪══════════╬═════════╪══════════╬════════╬══════════╣
║                           │              ║          │        │                ║          │        │          ║         │          ║        ║          ║
╠═══════════════════════════╪══════════════╬══════════╪════════╪════════════════╬══════════╪════════╪══════════╬═════════╪══════════╬════════╬══════════╣
║                           │              ║          │        │                ║          │        │          ║         │          ║        ║          ║
╠═══════════════════════════╪══════════════╬══════════╪════════╪════════════════╬══════════╪════════╪══════════╬═════════╪══════════╬════════╬══════════╣
║                           │              ║          │        │                ║          │        │          ║         │          ║        ║          ║
╚═══════════════════════════╧══════════════╩══════════╧════════╧════════════════╩══════════╧════════╧══════════╩═════════╧══════════╩════════╩══════════╝
Карточку заполнил _________________  _________  _____________________
                      должность       подпись    расшифровка подписи

                  "  "  ___________  20  г.
.}
 Ш
.endForm

!===================================================================================================
.LinkFORM PersCard_M37_p Prototype Is PersCardProt
.Group 'Личные карточки учета СФО (Беларусь)'
.NameInList 'Личная карточка учета СФО (Форма № M-37п)'
.f "MBPM_37p.OUT"
.P 40
.PAPER PA4
.ORIENT PORTRAIT
.LL 80
.var
  totSum : Double;
  Counter1 : Longint;
  Counter2 : Longint;
  PrintObr : Boolean;
.endVar
.Fields
  CommonFormHeader
  OrgName
  ОКПО
  Cex
  CardNo
  sostDate
  FIO
  Prof
  //------
  TabN
  Cex
  InDate
  chDate
  Pol
  Rost
  Od1
  Ob
  GUb
  'true' : 's'
.endFields
.begin
  totSum := 0;
  Counter1 := 0;
  PrintObr := True;
end.
 Р ^
                                                                                                                      Форма № М-37п
                                                                                                                      ┌────────────┐
                                                                                                                      │    Коды    │
                                                                                                                      ├────────────┤
                                                                                                        Форма по ОКУД │            │
                                                                                                                      ├────────────┤
   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д по ОКЮЛП │@~@@@@@@@@@@│
                                              наименование организации                                                ├────────────┤
   Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д          │            │
                                      наименование структурного подразделения                                         └────────────┘

                                            БЛИЧНАЯ КАРТОЧКА Б                               ┌─────────────────┬──────────────────┐
                                      БУЧЕТА СПЕЦОДЕЖДЫ, СПЕЦОБУВИ Б                         │      Номер      │       Дата       │
                                  БИ ПРЕДОХРАНИТЕЛЬНЫХ ПРИСПОСОБЛЕНИЙ Б                      │    документа    │    составления   │
                                                                                         ├─────────────────┼──────────────────┤
                                                                                         │@~@@@@@@@@@@@@@@@│@~@@@@@@@@@@@@@@@@│
                                                                                         └─────────────────┴──────────────────┘

  Фамилия, и., о. работника  Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е

   Д Профессия  Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
   Должность

   БИнформация о работнике Б
 ┌────────────┬─────────────────────────────────────────────────────┬──────────────────────────┬─────┬─────┬───────────────────────┐
 │            │                Подразделения организации            │            Дата          │     │     │         Размер        │
 │  Табельный ├─────────────────┬─────────────────┬─────────────────┼─────────────┬────────────┤ Пол │Рост ├──────┬─────┬──────────┤
 │    номер   │                 │                 │                 │ поступления │ изменения  │     │     │одежды│обуви│ головного│
 │            │                 │                 │                 │  на работу  │ профессии  │     │     │      │     │   убора  │
 ├────────────┼─────────────────┼─────────────────┼─────────────────┼─────────────┼────────────┼─────┼─────┼──────┼─────┼──────────┤
 │     1      │        2        │        3        │         4       │      5      │      6     │  7  │  8  │  9   │ 10  │    11    │
 ├────────────┼─────────────────┼─────────────────┼─────────────────┼─────────────┼────────────┼─────┼─────┼──────┼─────┼──────────┤
 │@~@@@@@@@@@@│@@@@@@@@@@@@@@@@@│                 │                 │@~@@@@@@@@@@@│@~@@@@@@@@@@│@~@@@│&&&&&│&&&&&&│&&&&&│&&&&&&&&&&│
 └────────────┴─────────────────┴─────────────────┴─────────────────┴─────────────┴────────────┴─────┴─────┴──────┴─────┴──────────┘
^
 Б Предусмотрено по утвержденным нормам: Б
.{ frmCircle checkenter
.[h
 ┌─────────────────────────────────────────────────────────────────────────────────────┬───────────┬─────────┬──────────┬──────────┐
 │                                                                                     │ Основание │         │          │          │
 │                            Наименование спецодежды, спецобуви,                      │(ссылка на │ Единица │Количество│Срок носки│
 │                             предохранительных приспособлений                        │нормативный│измерения│          │          │
 │                                                                                     │ документ) │         │          │          │
 ├─────────────────────────────────────────────────────────────────────────────────────┼───────────┼─────────┼──────────┼──────────┤
 │                                          1                                          │     2     │    3    │    4     │     5    │
 ├─────────────────────────────────────────────────────────────────────────────────────┼───────────┼─────────┼──────────┼──────────┤
.]h
.Fields
 frName
 frEd
 frKol
 frSrok
 'true' : 's'
.endFields
 │@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│           │@@@@@@@@@│&&&&&&&&&&│&&&&&&&&&&│
.[f
.begin
  PrintObr := False;
  Counter1 := Counter1 + 1;
end.
 └─────────────────────────────────────────────────────────────────────────────────────┴───────────┴─────────┴──────────┴──────────┘

  БСОГЛАСОВАНО Б  __________________________   ____________________    ____________________________________________
                    должность                    подпись                      фамилия, инициалы
              __________________________   ____________________    ____________________________________________
                    должность                    подпись                      фамилия, инициалы
              __________________________   ____________________    ____________________________________________
                    должность                    подпись                      фамилия, инициалы
^
.]f
.}
.{ spcCircle checkenter
.[h
 ┌─────────────────────────────────────────────────────────────────────────────────────┬───────────┬─────────┬──────────┬──────────┐
 │                                                                                     │ Основание │         │          │          │
 │                            Наименование спецодежды, спецобуви,                      │(ссылка на │ Единица │Количество│Срок носки│
 │                             предохранительных приспособлений                        │нормативный│измерения│          │          │
 │                                                                                     │ документ) │         │          │          │
 ├─────────────────────────────────────────────────────────────────────────────────────┼───────────┼─────────┼──────────┼──────────┤
 │                                          1                                          │     2     │    3    │    4     │     5    │
 ├─────────────────────────────────────────────────────────────────────────────────────┼───────────┼─────────┼──────────┼──────────┤
.]h
.Fields
 spName
 spEd
 spKol
 spSrok
 'true' : 's'
.endFields
 │@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│           │@@@@@@@@@│&&&&&&&&&&│&&&&&&&&&&│
.[f
.begin
  PrintObr := False;
  Counter1 := Counter1 + 1;
end.
 └─────────────────────────────────────────────────────────────────────────────────────┴───────────┴─────────┴──────────┴──────────┘

  БСОГЛАСОВАНО Б  __________________________   ____________________    ____________________________________________
                    должность                    подпись                      фамилия, инициалы
              __________________________   ____________________    ____________________________________________
                    должность                    подпись                      фамилия, инициалы
              __________________________   ____________________    ____________________________________________
                    должность                    подпись                      фамилия, инициалы
^
.]f
.}
.{?INTERNAL;PrintObr
.begin
  Counter1 := 1;
end.
.fields
  'true' : 's'
.endfields
 ┌─────────────────────────────────────────────────────────────────────────────────────┬───────────┬─────────┬──────────┬──────────┐
 │                                                                                     │ Основание │         │          │          │
 │                            Наименование спецодежды, спецобуви,                      │(ссылка на │ Единица │Количество│Срок носки│
 │                             предохранительных приспособлений                        │нормативный│измерения│          │          │
 │                                                                                     │ документ) │         │          │          │
 ├─────────────────────────────────────────────────────────────────────────────────────┼───────────┼─────────┼──────────┼──────────┤
 │                                          1                                          │     2     │    3    │    4     │     5    │
 ├─────────────────────────────────────────────────────────────────────────────────────┼───────────┼─────────┼──────────┼──────────┤
 └─────────────────────────────────────────────────────────────────────────────────────┴───────────┴─────────┴──────────┴──────────┘

  БСОГЛАСОВАНО Б  __________________________   ____________________    ____________________________________________
                    должность                    подпись                      фамилия, инициалы
              __________________________   ____________________    ____________________________________________
                    должность                    подпись                      фамилия, инициалы
              __________________________   ____________________    ____________________________________________
                    должность                    подпись                      фамилия, инициалы
^
.}
.begin
  PrintObr := False;
  Counter2 := 0; // Отследить начало следующей таблицы
end.
.{
.[h
.{?INTERNAL;((Counter1 mod 2) = 0) // На четных страницах
                                                                                                     Оборотная сторона формы № М-37п
.}
.{?INTERNAL;(((Counter1 mod 2) > 0) or (Counter2 = 0)) // На НЕчетных и в начале таблицы
  БВыдача и возврат форменной и спецодежды, спецобуви и предохранительных приспособлений Б
 ┌──────────────────┬──────────┬──────────────────────────────────────────────────┬─────────────────────────────────────────────────┐
 │   Наименование   │    Код   │                      Выдано                      │                   Возвращено                    │
 │    спецодежды,   │(номенкла-├──────────┬──────┬────────┬─────────────┬─────────┼──────────┬──────┬────────┬──────────────────────┤
 │    спецобуви,    │  турный  │          │      │        │             │ подпись │          │      │        │       подпись        │
 │предохранительных │  номер)  │   дата   │ коли-│процент │  стоимость, │  лица в │   дата   │ коли-│процент ├──────────┬───────────┤
 │ приспособлений   │          │          │чество│годности│     руб.    │получении│          │чество│годности│работника │кладовщика │
 │                  │          │          │      │        │             │         │          │      │        │о возврате│в получении│
 ├──────────────────┼──────────┼──────────┼──────┼────────┼─────────────┼─────────┼──────────┼──────┼────────┼──────────┼───────────┤
 │         1        │     2    │     3    │   4  │    5   │      6      │    7    │     8    │   9  │   10   │    11    │     12    │
 ├──────────────────┼──────────┼──────────┼──────┼────────┼─────────────┼─────────┼──────────┼──────┼────────┼──────────┼───────────┤
.}
.{?INTERNAL;(((Counter1 mod 2) = 0) and ((Counter2 > 0))) // На четных, но не в начале таблицы
 ┌──────────────────┬──────────┬──────────┬──────┬────────┬─────────────┬─────────┬──────────┬──────┬────────┬──────────┬───────────┐
 │         1        │     2    │     3    │   4  │    5   │      6      │    7    │     8    │   9  │   10   │    11    │     12    │
 ├──────────────────┼──────────┼──────────┼──────┼────────┼─────────────┼─────────┼──────────┼──────┼────────┼──────────┼───────────┤
.}
.]h
.Fields
  sfName
  sfKod
  if ( LongInt( sfGive)=0, ' ', DateToStr( sfGive, 'DD/MM/YYYY'))
  sfGiveKol
  sfPercGodnIn
  sfGiveKol*sfPrice
    if ( LongInt( sfSpis)=0, ' ', DateToStr( sfSpis, 'DD/MM/YYYY'))
  sfSpisKol
  sfPercGodnOut
.endFields
.begin
  totSum := totSum + (sfGiveKol * sfPrice - sfSpisKol * sfSpisPrice);
end.
 │@@@@@@@@@@@@@@@@@@│@@@@@@@@@@│@~@@@@@@@@│&#&&&&│&#&&&.&&│&#&&&&&&&&.&&│         │@@~@@@@@@@│&#&&&&│&#&&&.&&│          │           │
.[f1
.begin
  PrintObr := True;
  Counter1 := Counter1 + 1;
  Counter2 := Counter2 + 1;
end.
 └──────────────────┴──────────┴──────────┴──────┴────────┴─────────────┴─────────┴──────────┴──────┴────────┴──────────┴───────────┘

.]f
.[f2
.begin
  PrintObr := False;
  Counter1 := Counter1 + 1
  Counter2 := Counter2 + 1;
end.
 └──────────────────┴──────────┴──────────┴──────┴────────┴─────────────┴─────────┴──────────┴──────┴────────┴──────────┴───────────┘

  БКарточку оформил кладовщик Б __________________________  _________________________________________________
                                     подпись                           фамилия, инициалы
  БПроверил бухгалтер Б         __________________________  _________________________________________________
                                     подпись                           фамилия, инициалы

.]f
.}
.{?INTERNAL;PrintObr
                                                                                                     Оборотная сторона формы № М-37п
  БВыдача и возврат форменной и спецодежды, спецобуви и предохранительных приспособлений Б
 ┌──────────────────┬──────────┬──────────────────────────────────────────────────┬─────────────────────────────────────────────────┐
 │   Наименование   │    Код   │                      Выдано                      │                   Возвращено                    │
 │    спецодежды,   │(номенкла-├──────────┬──────┬────────┬─────────────┬─────────┼──────────┬──────┬────────┬──────────────────────┤
 │    спецобуви,    │  турный  │          │      │        │             │ подпись │          │      │        │       подпись        │
 │предохранительных │  номер)  │   дата   │ коли-│процент │  стоимость, │  лица в │   дата   │ коли-│процент ├──────────┬───────────┤
 │ приспособлений   │          │          │чество│годности│     руб.    │получении│          │чество│годности│работника │кладовщика │
 │                  │          │          │      │        │             │         │          │      │        │о возврате│в получении│
 ├──────────────────┼──────────┼──────────┼──────┼────────┼─────────────┼─────────┼──────────┼──────┼────────┼──────────┼───────────┤
 │         1        │     2    │     3    │   4  │    5   │      6      │    7    │     8    │   9  │   10   │    11    │     12    │
 ├──────────────────┼──────────┼──────────┼──────┼────────┼─────────────┼─────────┼──────────┼──────┼────────┼──────────┼───────────┤
 │                  │          │          │      │        │             │         │          │      │        │          │           │
 ├──────────────────┼──────────┼──────────┼──────┼────────┼─────────────┼─────────┼──────────┼──────┼────────┼──────────┼───────────┤
 │                  │          │          │      │        │             │         │          │      │        │          │           │
 ├──────────────────┼──────────┼──────────┼──────┼────────┼─────────────┼─────────┼──────────┼──────┼────────┼──────────┼───────────┤
 │                  │          │          │      │        │             │         │          │      │        │          │           │
 ├──────────────────┼──────────┼──────────┼──────┼────────┼─────────────┼─────────┼──────────┼──────┼────────┼──────────┼───────────┤
 │                  │          │          │      │        │             │         │          │      │        │          │           │
 ├──────────────────┼──────────┼──────────┼──────┼────────┼─────────────┼─────────┼──────────┼──────┼────────┼──────────┼───────────┤
 │                  │          │          │      │        │             │         │          │      │        │          │           │
 └──────────────────┴──────────┴──────────┴──────┴────────┴─────────────┴─────────┴──────────┴──────┴────────┴──────────┴───────────┘

  БКарточку оформил кладовщик Б __________________________  _________________________________________________
                                     подпись                           фамилия, инициалы
  БПроверил бухгалтер Б         __________________________  _________________________________________________
                                     подпись                           фамилия, инициалы

.} Р
.endForm
!===================================================================================================
.LinkFORM PersCard_MB_3 Prototype Is PersCardProt
.Group 'Личные карточки учета СФО'
.NameInList 'Личная карточка учета выдачи СИЗ'
.P 40
.PAPER PA4
.ORIENT PORTRAIT
.LL 80
.var
  Array_Of_Norms1 : array [1..50] of string;
  Array_Of_Norms2 : array [1..50] of string;
  Array_Of_Norms3 : array [1..50] of string;
  Count_Of_Array : integer;
  Number_Of_Array : integer;
.endvar
.function GetNameFromFIO(sFIO : string; wNumName : word) : string;
var
  tmpFIO : string;
  posFIO : byte;
begin
  GetNameFromFIO := '';
  sFIO := Trim(sFIO);

  case (wNumName) of
  //----------------
    1 : // Фамилия
    {
      posFIO := Pos(' ', sFIO);
      GetNameFromFIO := SubStr(sFIO, 1, if(posFIO = 0, Length(sFIO), posFIO));
    }
  //----------------
    2 : // Имя
    {
      posFIO := Pos(' ', sFIO);

      if (posFIO = 0) // задана только фамилия
        GetNameFromFIO := '';
      else
      {
        tmpFIO := Trim(SubStr(sFIO, Pos(' ', sFIO) + 1, Length(sFio)));
        GetNameFromFIO := SubStr(tmpFIO, 1, Pos(' ', tmpFIO));
      }
    }
  //----------------
    3 : // Отчество
    {
      posFIO := Pos(' ', sFIO);

      if (posFIO = 0) // задана только фамилия
        GetNameFromFIO := '';
      else
      {
        tmpFIO := Trim(SubStr(sFIO, Pos(' ', sFIO) + 1, Length(sFio)));
        posFIO := Pos(' ', tmpFIO);

        if (posFIO = 0) // задана только фамилия и имя
          GetNameFromFIO := '';
        else
        {
          tmpFIO := Trim(SubStr(tmpFIO, Pos(' ', tmpFIO) + 1, Length(tmpFio)));
          GetNameFromFIO := SubStr(tmpFIO, 1, Length(tmpFIO));
        }
      }
    }
  //----------------
  end;
end.
.function YearEdIzmWord(YearNumberInMonth : double) : string;
var
  ModYearNumber : integer;
  tmpDouble : double;
begin
  YearEdIzmWord := '';
  ModYearNumber := Integer(YearNumberInMonth) mod 12;

  if (ModYearNumber <> 0) // дробное число
    YearEdIzmWord := String(YearNumberInMonth / 12) + ' года';
  else                    // целое число
  {
    ModYearNumber := Integer(YearNumberInMonth / 12);

    if (length(string(ModYearNumber)) > 1)
    {
      tmpDouble := integer(SubStr(string(ModYearNumber), length(string(ModYearNumber)) - 1, 2));

      if (tmpDouble > 9)
        if (tmpDouble >= 11) and (tmpDouble <= 19)
          YearEdIzmWord := 'лет';
    }

    if (YearEdIzmWord = '')
    {
      tmpDouble := integer(SubStr(string(ModYearNumber), length(string(ModYearNumber)), 1));

      if ((tmpDouble >= 5) and (tmpDouble <= 9)) or (tmpDouble = 0)
        YearEdIzmWord := 'лет';
      else
      {
        if (tmpDouble >= 2) and (tmpDouble <= 4)
          YearEdIzmWord := 'года';
        else
          YearEdIzmWord := 'год';
      }
    }

    YearEdIzmWord := String(ModYearNumber) + ' ' + YearEdIzmWord;
  }
end.
.begin
  for(Count_Of_Array := 1; Count_Of_Array <= Count(Array_Of_Norms1); Count_Of_Array := Count_Of_Array + 1)
  {
    Array_Of_Norms1 [Count_Of_Array] := 0;
    Array_Of_Norms2 [Count_Of_Array] := 0;
    Array_Of_Norms3 [Count_Of_Array] := 0;
  }

  Number_Of_Array := 0;
  Count_Of_Array := 0;
end.
.Fields
  CommonFormHeader
  CardNo
  GetNameFromFIO(FIO, 1)
  Pol
  GetNameFromFIO(FIO, 2)
  Rost
  GetNameFromFIO(FIO, 3)
  TabN
  Od1
  Cex
  Ob
  Prof
  GUb
  if(Longint(InDate) = 0, '', DateToStr(InDate, 'DD/MM/YYYY'))
  if(Longint(chDate) = 0, '', DateToStr(chDate, 'DD/MM/YYYY'))
  Perch
.endFields
 Ш^
.{?internal;wGetTune('Country') = ccRus;
                                                                                                                                               Приложение
                                                                                                            к Правилам обеспечения работников специальной
                                                                                                                    одеждой, специальной обувью и другими
                                                                                                           средствами индивидуальной защиты, утвержденным
                                                                                                                               постановлением Минтруда РФ
                                                                                                                               от 18 декабря 1998 г. N 51
.}
                                               БЛИЧНАЯ КАРТОЧКА №  Д@~@@@@@@@@ Е
                                        Бучета выдачи средств индивидуальной защиты Б

  Фамилия  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д Пол  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
  Имя  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д Рост  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
  Отчество  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д Размер:
  Табельный номер  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  одежды  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
  Структурное подразделение  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  обуви  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
  Профессия (должность)  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  головного убора  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
  Дата поступления на работу  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  противогаза _____________________________________________________________
  Дата изменнения профессии (должности)                                         респиратора _____________________________________________________________
  или перевода в другое структурное                                             рукавиц _________________________________________________________________
  подразделение  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  перчаток  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д

    Предусмотрено по Типовым отраслевым нормам:

.{ frmCircle checkenter
.begin
  if (frIsSIZ)
  {
    Count_Of_Array := Count_Of_Array + 1;
    Array_Of_Norms1 [Count_Of_Array] := frName;
    Array_Of_Norms2 [Count_Of_Array] := frEd;
    Array_Of_Norms3 [Count_Of_Array] := frKol + if(trim(frSrok) = '12', '', ' на ' + YearEdIzmWord(double(frSrok)));
  }
end.
.}
.{ spcCircle checkenter
.begin
  if (spIsSIZ)
  {
    Count_Of_Array := Count_Of_Array + 1;
    Array_Of_Norms1 [Count_Of_Array] := spName;
    Array_Of_Norms2 [Count_Of_Array] := spEd;
    Array_Of_Norms3 [Count_Of_Array] := spKol + if(trim(spSrok) = '12', '', ' на ' + YearEdIzmWord(double(spSrok)));
  }
end.
.}
.{ while Number_Of_Array < Count_Of_Array
.[h
┌────────────────────────────────────────────────────────────────────────────────────┬─────────────────────────┬─────────────────┬──────────────────────┐
│                               Наименование средств                                 │      Пункт типовых      │     Единица     │      Количество      │
│                              индивидуальной защиты                                 │     отраслевых норм     │    измерения    │        на год        │
├────────────────────────────────────────────────────────────────────────────────────┼─────────────────────────┼─────────────────┼──────────────────────┤
.]h
.begin
  Number_Of_Array := Number_Of_Array + 1;
end.
.Fields
  Array_Of_Norms1 [Number_Of_Array]
  Array_Of_Norms2 [Number_Of_Array]
  Array_Of_Norms3 [Number_Of_Array]
  'true' : 's'
.endFields
│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│                         │@@@@@@@@@@@@@@@@@│&&&&&&&&&&&&&&&&&&&&&&│
.[f
└────────────────────────────────────────────────────────────────────────────────────┴─────────────────────────┴─────────────────┴──────────────────────┘
.]f
.}
.{?Internal;(Count_Of_Array <= 0);
┌────────────────────────────────────────────────────────────────────────────────────┬─────────────────────────┬─────────────────┬──────────────────────┐
│                               Наименование средств                                 │      Пункт типовых      │     Единица     │      Количество      │
│                              индивидуальной защиты                                 │     отраслевых норм     │    измерения    │        на год        │
├────────────────────────────────────────────────────────────────────────────────────┼─────────────────────────┼─────────────────┼──────────────────────┤
└────────────────────────────────────────────────────────────────────────────────────┴─────────────────────────┴─────────────────┴──────────────────────┘
.}

Руководитель структурного
подразделения

^
.{
.[h
┌───────────────────────┬──────────┬───────────────────────────────────────────────────┬────────────────────────────────────────────────────────────────┐
│                       │ГОСТ, ОСТ,│                      Выдано                       │                          Возвращено                            │
│  Наименование средств │ТУ, серти ├──────────┬──────┬──────┬─────────────┬────────────┼──────────┬──────┬──────┬─────────────┬────────────┬────────────┤
│ индивидуальной защиты │фикат со- │   Дата   │ К-во │  %   │  Стоимость  │ Расписка в │   Дата   │ К-во │  %   │  Стоимость  │  Расписка  │  Расписка  │
│                       │ответствия│          │      │износа│             │ получении  │          │      │износа│             │  сдавшего  │  в приеме  │
├───────────────────────┼──────────┼──────────┼──────┼──────┼─────────────┼────────────┼──────────┼──────┼──────┼─────────────┼────────────┼────────────┤
│           1           │    2     │    3     │  4   │  5   │      6      │     7      │    8     │  9   │  10  │     11      │     12     │     13     │
├───────────────────────┼──────────┼──────────┼──────┼──────┼─────────────┼────────────┼──────────┼──────┼──────┼─────────────┼────────────┼────────────┤
.]h
.Fields
  sfName
  if(Longint(sfGive) = 0, '', DateToStr(sfGive, 'DD/MM/YYYY'))
  sfGiveKol
  if(Longint(sfGive) = 0, '', 100 - sfPercGodnIn)
  sfGiveKol * sfPrice
  if(Longint(sfSpis) = 0, '', DateToStr(sfSpis, 'DD/MM/YYYY'))
  sfSpisKol
  if(Longint(sfSpis) = 0, '', 100 - sfPercGodnOut)
  sfSpisKol * sfSpisPrice
.endFields
.{?Internal;(sfIsSIZ);
│@@@@@@@@@@@@@@@@@@@@@@@│          │@~@@@@@@@@│&#&&&&│&#&.&&│&#&&&&&&&&.&&│            │@~@@@@@@@@│&#&&&&│&#&.&&│&#&&&&&&&&.&&│            │            │
.}
.[f
└───────────────────────┴──────────┴──────────┴──────┴──────┴─────────────┴────────────┴──────────┴──────┴──────┴─────────────┴────────────┴────────────┘
.]f
.}
 Ш
.endForm

!===================================================================================================
.LinkFORM 'PersCard_MB_4' Prototype Is 'PersCardProt'
.Group 'Синхронизация с лицевыми счетами'
.NameInList 'Список ЛК учета СФО с измененными параметрами'
.Fields
  CommonFormHeader
.endFields
^

                           ЛИЧНЫЕ КАРТОЧКИ УЧЕТА СФО,
                      рассогласованные с лицевыми счетами

.{ frmCircle checkenter
.[h
  ┌────────────────────┬──────────────────────────┬──────────────────────────┐
  │      Название      │         Значение         │         Значение         │
  │      параметра     │      в ЛК учета СФО      │     в лицевых счетах     │
  └────────────────────┴──────────────────────────┴──────────────────────────┘
.]h
.Fields
  frName
  frKod
  frEd
  frPar
  frKol
  frSrok
.endFields
.{?Internal;(frIsSIZ);
    Б ЛК учета СФО №^: ^, ^ Б
.}
   @@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@
.[f
  ────────────────────────────────────────────────────────────────────────────
.]f
.}
.{ spcCircle checkenter
.}
.{
.}
.endForm