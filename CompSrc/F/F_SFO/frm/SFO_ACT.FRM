//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 7.12 - Спецодежда
// Печать Акта выбытия СФО
//------------------------------------------------------------------------------

#doc
Формирование различных печатных вариантов документа Акт выбытия.<br>
#end
.Set Name = 'SFO_Act'
.Hide
.Fields
  OrgName : String  OrgOKPO : String  ActNo : String  dDate : Date
  FIO : String  TabN : String  spisReason : String
  frPodr : String  frMol : String
  toPodr : String  toMol : String
.endFields
.{ sfoNxtAct checkenter
  ^ ^ ^ ^
  ^ ^ ^
  ^ ^ ^ ^
.{ spcSfoAct checkenter
.Fields
  sfName : String  sfKod : String  Ed : String
  giveDate : Date  KolVo : Double  Price : Double
  dopInfo : String percNach : Double
  spPrKod : String spPrName : String
! Для нового Акта выбытия МБП расчет амортизации по алгоритму Справки о задолженности.
  newPrice : Double  endDate : Date  DolgSum : Double
.endFields
 ^ ^ ^ ^ ^ ^ ^ ^  ^ ^  ^ ^ ^
.}
.}
.endForm

!----------------------------------------------------------------------------

.LinkFORM SFOActOfOut Prototype Is SFO_Act
.Group 'Акт выбытия СФО'
.NameInList 'Акт выбытия СФО'
.var
  totSum : Double
.endVar
.Fields
  CommonFormHeader
  OrgName  ActNo
  DateToStr( dDate, 'DD')
  DateToStr( dDate, 'Mon')
  DateToStr( dDate, 'YYYY')
  frMol  FIO  spisReason
.endFields
.{ sfoNxtAct checkenter
.begin
  totSum := 0;
end.
  ^
  ^
                                                      Утверждаю


                             АКТ №  Б^ Б

        на выбытие малоценных и быстроизнашивающихся предметов,
                 форменной и специальной одежды, обуви

  Б"^" ^ ^ г. Б

 Комиссия в составе : ___________________________________________________
 ________________________________________________________________________
 ________________________________________________________________________
 назначенная приказом (распоряжением) от "__"_____________20__г. №_______
 произвела проверку состояния нижепоименованных предметов, находящихся на
 ответственном хранении у  Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
 (в использовании у  Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е),
 и установила непригодность их к дальнейшей эксплуатации по причине:
  Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
 Р┌─────────────────────┬────────────┬─────────┬────────┬──────────┬──────────┬──────────┬────────────┐
│     Наименование    │ Номенкл. № │ Ед.изм. │ Кол-во │   Цена   │  Сумма   │Дата выдач│ Примечание │
├─────────────────────┼────────────┼─────────┼────────┼──────────┼──────────┼──────────┼────────────┤
.{ spcSfoAct CheckEnter
.fields
  sfName  sfKod  Ed  KolVo  Price  KolVo*Price  DateToStr( giveDate, 'DD/MM/YYYY')
.endFields
.begin
  totSum := totSum + (Price * KolVo);
end.
│@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@│@@@@@@@@@│&#&&&&&&│&#&&&&&.&&│&#&&&&&.&&│&&&&&&&&&&│            │
.}
└─────────────────────┴────────────┴─────────┴────────┴──────────┴──────────┴──────────┴────────────┘ Р
.fields
  frMol
.endFields

   Председатель комиссии:
   Члены комиссии:

   Материально-ответственное лицо:  Б^ Б
.}
.endForm

!----------------------------------------------------------------------------

.linkform 'SFOActOfOutRos' prototype is 'SFO_Act'
.Group 'Акт выбытия СФО'
.Group 'Акт выбытия СФО (Россия)'
.NameInList 'Акт выбытия МБП (форма № МБ-4 Россия)'
.P 40
.PAPER PA4
.ORIENT PORTRAIT
.LL 80
.var
  CurSum :  Double;
  TotSum :  Double;
  IznSum :  Double;
  CountPage,
  i, j,
  KolStr   :  Integer;
  arKolStr : array[1..2] of integer;
  arDate   : array[1..2] of String;
  arPerc   : array[1..2] of Double;
  arOstSt  : array[1..2] of Double;
  arDolg   : array[1..2] of Double;
.endvar
.fields
 CommonFormHeader
 ActNo  OrgName  orgOKPO
 frPodr
 DateToStr( dDate, 'DD/MM/YYYY')
 frPodr
.endfields
.{ sfoNxtAct checkenter
.begin
  for (i := 1; i <= Count(arKolStr); i := i + 1)
    arKolStr[i] := 0;

  for (i := 1; i <= Count(arDate); i := i + 1)
    arDate[i] := '';

  for (i := 1; i <= Count(arPerc); i := i + 1)
    arPerc[i] := 0;

  for (i := 1; i <= Count(arOstSt); i := i + 1)
    arOstSt[i] := 0;

  for (i := 1; i <= Count(arDolg); i := i + 1)
    arDolg[i] := 0;

  KolStr := 0;
  TotSum := 0;
  IznSum := 0;
  CountPage := 0;
end.
.{ spcSfoAct CheckEnter
.[h
 Р ^
                                                                                      Типовая межотраслевая форма № МБ-4
                                                                                      Утверждена постановлением Госкомстата России
                                                                                      от 30.10.97 № 71а
                                       БАКТ №  Д@@@@@@@@@@ Е                                                              ┌─────────────┐
                    Бвыбытия малоценных и быстроизнашивающихся предметов Б                                              │    Коды     │
                                                                                                                    ├─────────────┤
                                                                                                      Форма по ОКУД │   0320002   │
                                                                                                                    ├─────────────┤
 Организация   Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е          по ОКПО │@~@@@@@@@@@@@│
 Структурное подразделение   Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е                  └─────────────┘
                      ┌──────────┬──────────┬────────────────────────────┬──────────────┬──────────────────────────┬──────────────┐
                      │   Дата   │   Код    │       Cтруктурное          │     Вид      │  Корреспондирующий счет  │ Учетная еди- │
                      │  состав- │   вида   │      подразделение         │ деятельности ├─────────┬────────────────┤ ница выпуска │
                      │   ления  │ операции │                            │              │  счет,  │  код аналити-  │  продукции   │
                      │          │          │                            │              │ субсчет │ ческого учета  │(работ, услуг)│
                      ├──────────┼──────────┼────────────────────────────┼──────────────┼─────────┼────────────────┼──────────────┤
                      Б │@@@@@@@@@@│          │@@@@@@@@@@@@@@@@@@@@@@@@@@@@│              │         │                │              │
                      └──────────┴──────────┴────────────────────────────┴──────────────┴─────────┴────────────────┴──────────────┘ Б
┌────────────────────────────────┬───────────────────┬──────┬──────────────┬───────────────────────────┬──────────────────────────┐
│            Предмет             │ Единица измерения │      │              │      Сумма, руб. коп.     │      Причина выбытия     │
├───────────────────┬────────────┼─────┬─────────────┤ Коли-│    Цена,     ├─────────────┬─────────────┼─────────┬────────────────┤
│   Наименование,   │Номенклатур-│ Код │ Наименование│чество│   руб.коп.   │  Без учета  │   Аморти-   │         │                │
│ сорт,размер,марка │ ный  номер │     │             │      │              │     НДС     │   зации     │   Код   │  Наименование  │
├───────────────────┼────────────┼─────┼─────────────┼──────┼──────────────┼─────────────┼─────────────┼─────────┼────────────────┤
│         1         │     2      │  3  │      4      │   5  │      6       │      7      │      8      │    9    │       10       │
├───────────────────┼────────────┼─────┼─────────────┼──────┼──────────────┼─────────────┼─────────────┼─────────┼────────────────┤
.]h
.begin
  KolStr := KolStr + 1;

  CurSum := KolVo * Price;
  TotSum := TotSum + CurSum;
  IznSum := IznSum + (CurSum * percNach / 100);

  arKolStr [CountPage + 1] := arKolStr [CountPage + 1] + 1;
  arDate   [KolStr] := if(LongInt(giveDate) > 0, DateToStr(giveDate, 'DD/MM/YYYY'), '');
  arPerc   [KolStr] := percNach;
  arOstSt  [KolStr] := CurSum - (CurSum * percNach / 100);
  arDolg   [KolStr] := DolgSum;
end.
.fields
 sfName  sfKod  Ed  KolVo  Price  CurSum  (CurSum * percNach / 100)  spPrKod  spPrName
.endfields
│@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@│     │@@@@@@@@@@@@@│&&&.&&│&'&&&&&&&&&.&&│&'#&&&&&&&.&&│&'#&&&&&&&.&&│@@@@@@@@@│@@@@@@@@@@@@@@@@│
.[f
.fields
  TotSum
  IznSum
  spisReason
.endfields
└───────────────────┴────────────┴─────┴─────────────┴──────┴──────────────┼─────────────┼─────────────┼─────────┴────────────────┘
                                                                    БИтого Б   │ Б&'#&&&&&&&.&& Б│ Б&'#&&&&&&&.&& Б│
                                                                           └─────────────┴─────────────┘
  Причина выбытия    Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е
 Б                     Б_______________________________________________________________________________________________________________ Б
                     Б_______________________________________________________________________________________________________________ Б
  Мастер (исполнитель работ) Б  _____________________   ____________________________________
                                  И     Иподпись                    расшифровка подписи
.begin
  TotSum := 0;
  IznSum := 0;
  CountPage := CountPage + 1;
end.

.]f
.}
.begin
  i := 0;
  KolStr := 0;
end.
.{While (i < CountPage)
                                                                                                  Оборотная сторона формы № МБ-4
┌───────────────────────┬─────────┬──────────┬──────────────┬───────────────────────────────────────────────────────┬─────────────┐
│                       │         │          │              │               Расчет удержания с виновных             │             │
│                       │         │          │              │                 Вид и способ удержания                │             │
│   Фамилия, И., О.     │Табельный│   Дата   │   Подпись    ├───────┬────────────┬──────────────────────┬───────────┤   Подпись   │
│                       │  номер  │  выдачи  │   сдавшего   │       │ стоимость  │  код вида удержания  │   сумма   │  виновного  │
│                       │         │          │  малоценные  │процент│ за вычетом ├──────────────────────┤  ежеме-   │  в поломке  │
│                       │         │          │  и быстроиз- │аморти-│амортизации,├─────────┬────────────┤  сячного  │   (утере)   │
│                       │         │          │ нашивающиеся │ зации │ руб. коп.  │ размер  │   cумма    │  взноса,  │             │
│                       │         │          │   предметы   │       │            │(процент)│ удержания, │  руб.коп  │             │
│                       │         │          │              │       │            │удержания│  руб. коп. │           │             │
├───────────────────────┼─────────┼──────────┼──────────────┼───────┼────────────┼─────────┼────────────┼───────────┼─────────────┤
│           1           │    2    │    3     │       4      │   5   │     6      │    7    │      8     │     9     │     10      │
├───────────────────────┼─────────┼──────────┼──────────────┼───────┼────────────┼─────────┼────────────┼───────────┼─────────────┤
.begin
  j := 0;
  i := i + 1;
end.
.{While (j < arKolStr [i])
.begin
  j := j + 1;
  KolStr := KolStr + 1;
end.
.fields
  FIO
  TabN
  arDate  [KolStr]
  arPerc  [KolStr]
  arOstSt [KolStr]
  arDolg  [KolStr]
.endfields
│@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@│@~@@@@@@@@│              │&'#&.&&│&'#&&&&&&.&&│         │&'#&&&&&&.&&│           │             │
.}
└───────────────────────┴─────────┴──────────┴──────────────┴───────┴────────────┴─────────┴────────────┴───────────┴─────────────┘
  БРуководитель подразделения Б _________________  _____________  ___________________
                                должность         подпись     расшифровка подписи
  БКладовщик Б  _____________   ___________________
               подпись      расшифровка подписи
  ББухгалтер Б  _____________   ___________________
               подпись      расшифровка подписи
    "  " ___________20   г. Р
 Р
.}
.}
.endform

!----------------------------------------------------------------------------

.linkform 'SFOReturn' prototype is SFO_ACT
.Group 'Приходная накладная'
.NameInList 'Приходная накладная'
.var
  Npp, totSum : Double
.endVar
.fields
 CommonFormHeader
 ActNo
 DateToStr( dDate, 'DD')
 DateToStr( dDate, 'Mon')
 DateToStr( dDate, 'YYYY')
 toPodr  toMol
.endfields
.{ sfoNxtAct checkenter
.begin
  Npp := 0; totSum := 0;
end.
  ^

                        ПРИХОДНАЯ НАКЛАДНАЯ  № ^
                             "^" ^ ^ г.

  Подразделение : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  МОЛ           : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 Р
┌───┬────────────┬───────────────────────────┬───────────┬──────────┬────────────┬───────────────┬─────────────┬───────┬──────────────┐
│ № │ Номенклат. │     Наименование СФО      │  Единица  │  Размер  │ Количество │     Цена      │    Сумма    │ износ │  Примечание  │
│п/п│   номер    │                           │ измерения │  (рост)  │            │               │             │   %   │              │
├───┼────────────┼───────────────────────────┼───────────┼──────────┼────────────┼───────────────┼─────────────┼───────┼──────────────┤
.{ spcSfoAct checkenter
.Fields
  Npp  sfKod  sfName  Ed  dopInfo  KolVo  Price
  Price * KolVo * if ( wGetTune( 'Fin.MBP.OstStoim') = 0, 1, 1 - PercNach/100)
  percNach
.endFields
.begin
  Npp := Npp + 1;
  totSum := totSum + Price * KolVo * if ( wGetTune( 'Fin.MBP.OstStoim') = 0, 1, 1 - PercNach/100);
end.
│&&&│@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@│@@@@@@@@@@│&#&&&&&&&.&&│&#'&&&&&&&&&.&&│&#'&&&&&&&.&&│&&&&.&&│              │
.}
└───┴────────────┴───────────────────────────┴───────────┴──────────┴────────────┴───────────────┴─────────────┴───────┴──────────────┘ Р
.Fields
  totSum
.endFields

 С  Итого :                                                                                         &#'&&&&&&&.&& С


  Начальник отдела _________________     Главный бухгалтер _________________
.}
.endform
