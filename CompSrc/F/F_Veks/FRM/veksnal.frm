//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Галактика 5.85 - Векселя и кредиты
// Печать отчетов о наличии векселей и ценных бумаг
//------------------------------------------------------------------------------

#doc
Печать отчетов о наличии векселей и ценных бумаг
#end

.Form 'VeksNal'
.Hide
.Fields
ТипДокументов : word        // 81 -  векселя, 83 - кредиты
Субъект_отчета_имен
Субъект_отчета_родит
Субъект_отчета_дат
Субъект_отчета_творит
Субъект_отчета_предл
UserDeskRep_NRec : Comp
Способ_формирования : Word  //'0-тек.сост.картотеки, 1-на дату которая на след строке
Дата_на : Date
Собственная_организация_nRec : comp
Собственная_организации_наим
Собственная_организации_ОКПО
Валюта_реестра
Валюта_отчетов_nRec : comp
Валюта_отчетов
Формат_сумм
Формат_кол
Группировка
Сортировка
!---------------- FilterVeks
Фильтр
!---------------- GruppaVeks
Head_TempDescr_NRec
Head_TempDescr_TableCode : word // код таблицы по которой постоена данная группировка
Head_TempDescr_CRecKat   : comp // номер записи в таблице по которой построена группировка
Ветка
Итого_верх_сумма_НДЕ
Итого_верх_сумма_вал_отч
Итого_верх_сумма_гаш_НДЕ
Итого_верх_сумма_гаш_вал_отч
Валюта_верх
!---------------- NameVeks
Body_TempDescr_NRec
Body_Tobot_NRec
Номер_по_порядку
Veksl_NRec
Серия
Номер
Конечный_номер
Бланк
Количество
Дата_выписки
Дата_закрытия
Дата_оборота
Вид_nRec : comp
Вид
Статус_nRec : comp
Статус_наим
Статус_символ
Статус_код
Условие_nRec
Период
Условие_наим
BInDate        //если True, то план предъявления в дату, иначе - не ранее даты
Плановая_дата_предъявления : date
f_Veksl_cPlat_nRec : comp
f_Veksl_cPlat
f_Veksl_cPl_nRec : comp
f_Veksl_cPl
f_Veksl_cPol_nRec : comp
f_Veksl_cPol
f_Veksl_cPlh_nRec : comp
f_Veksl_cPlh
f_Veksl_cPolh_nRec : comp
f_Veksl_cPolh
Место_выдачи
Место_платежа
Процент_годовых
Npp
Сумма_НДЕ
Сумма_вал
Сумма_гаш_НДЕ
Сумма_гаш_вал
Валюта_документа
!---------------- ItogVeks
Tail_TempDescr_NRec
Tail_TempDescr_TableCode : word // код таблицы по которой постоена данная группировка
Tail_TempDescr_CRecKat   : comp // номер записи в таблице по которой построена группировка
Итого
Итого_сумма_НДЕ
Итого_сумма_вал_отч
Итого_сумма_гаш_НДЕ
Итого_сумма_гаш_вал_отч
Валюта_низ
.EndFields
^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^
.{ CheckEnter FilterVeks1
^
.}
.{
.{ CheckEnter GruppaVeks1
^ ^ ^ ^ ^ ^ ^ ^ ^
.}
.{ CheckEnter NameVeks1
^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^
.}
.{ CheckEnter ItogVeks1
^ ^ ^ ^ ^ ^ ^ ^ ^
.}
.}
.EndForm

!=============================================================================
.LinkForm 'VeksNal_01' Prototype is 'VeksNal'
!=============================================================================
.NameInList 'Реестр векселей (ценных бумаг)'
.Group 'Реестры векселей и ценных бумаг'
.p 80
.defo portrait
.Fields
CommonFormHeader
UpCase(Субъект_отчета_родит)
if (Способ_формирования=0, '(текущее состояние картотеки)',
  '(по состоянию на '
    +if (longint(Дата_на)<>0,DateToStr(Дата_на, 'DD/MM/YYYY'),'')
    +')')
Валюта_реестра
Группировка
Сортировка
!---------------- FilterVeks
Фильтр
!---------------- GruppaVeks
Ветка
DoubleToStr( Double(Итого_верх_сумма_НДЕ),          Формат_сумм )
if( Double(Итого_верх_сумма_вал_отч)=0, '',
 DoubleToStr( Double(Итого_верх_сумма_вал_отч),     Формат_сумм ) )
DoubleToStr( Double(Итого_верх_сумма_гаш_НДЕ),      Формат_сумм )
if( Double(Итого_верх_сумма_гаш_вал_отч)=0, '',
 DoubleToStr( Double(Итого_верх_сумма_гаш_вал_отч), Формат_сумм ) )
Валюта_верх
!---------------- NameVeks
Серия
Номер
Дата_выписки
DoubleToStr( Double(Сумма_НДЕ),      Формат_сумм )
if( Double(Сумма_вал)=0, '',
 DoubleToStr( Double(Сумма_вал),     Формат_сумм ) )
DoubleToStr( Double(Сумма_гаш_НДЕ),  Формат_сумм )
if( Double(Сумма_гаш_вал)=0, '',
 DoubleToStr( Double(Сумма_гаш_вал), Формат_сумм ) )
Валюта_документа
!---------------- ItogVeks
Итого
DoubleToStr(Double( Итого_сумма_НДЕ),          Формат_сумм )
if( Double( Итого_сумма_вал_отч)=0, '',
 DoubleToStr(Double( Итого_сумма_вал_отч),     Формат_сумм ) )
DoubleToStr(Double( Итого_сумма_гаш_НДЕ),      Формат_сумм )
if( Double( Итого_сумма_гаш_вал_отч)=0, '',
 DoubleToStr(Double( Итого_сумма_гаш_вал_отч), Формат_сумм ) )
Валюта_низ
.EndFields
 Р.[h
                                                              Лист @Np@
.]h
^

           РЕЕСТР ^ ^

Валюта:               ^
Группировка:          ^
Сортировка:           ^
Фильтры:
.{ CheckEnter FilterVeks1
 ^
.}
.{
.[h
──────────┬────────────────────┬──────────┬────────────────────┬────────────────────┬────────────────────┬────────────────────┬──────
  Серия   │      Номер         │   Дата   │    Сумма в НДЕ     │   Сумма в валюте   │Сумма гашения в НДЕ │Сумма гашения в вал │ Вал
──────────┴────────────────────┴──────────┴────────────────────┴────────────────────┴────────────────────┴────────────────────┴──────
.]h
.{ CheckEnter GruppaVeks1
 Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б &&&&&&&&&&&&&&&&&&&& &&&&&&&&&&&&&&&&&&&& &&&&&&&&&&&&&&&&&&&& &&&&&&&&&&&&&&&&&&&& @@@@@@
.}
.{ CheckEnter NameVeks1
@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@ &&&&&&&&&&&&&&&&&&&& &&&&&&&&&&&&&&&&&&&& &&&&&&&&&&&&&&&&&&&& &&&&&&&&&&&&&&&&&&&& @@@@@@
.}
.{ CheckEnter ItogVeks1
 Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б &&&&&&&&&&&&&&&&&&&& &&&&&&&&&&&&&&&&&&&& &&&&&&&&&&&&&&&&&&&& &&&&&&&&&&&&&&&&&&&& @@@@@@
.}
.}


Бухгалтер

Ответственный за выпуск Р
.EndForm

!=============================================================================
.LinkForm 'VeklNal_02' Prototype is 'VeksNal'
!=============================================================================
.NameInList 'Инвентаризационная опись'
.Group 'Реестры векселей и ценных бумаг'
.defo landscape
.P 54
.Var
Itog_kol : double
Itog_sum : double
PageItog_kol : double
PageItog_sum : double
.EndVar
.Fields
Собственная_организации_наим
Собственная_организации_ОКПО
!
Ветка
DoubleToStr( Double(Итого_верх_сумма_НДЕ), Формат_сумм )
!
Номер_по_порядку
Вид
Бланк
Номер
Серия
DoubleToStr( Double(Сумма_НДЕ)/Double(Количество), Формат_сумм )
DoubleToStr( Double(Количество),                   Формат_кол  )
DoubleToStr( Double(Сумма_НДЕ),                    Формат_сумм )
!
Итого
DoubleToStr( Double(Итого_сумма_НДЕ), Формат_сумм )
!
DoubleToStr( PageItog_kol, Формат_кол  )
DoubleToStr( PageItog_sum, Формат_сумм )
DoubleToStr( Itog_kol, Формат_кол  )
DoubleToStr( Itog_sum, Формат_сумм )
.EndFields
.Begin
  Itog_kol := 0;
  Itog_sum := 0;
End.

 Ш
                                                                                                                                                                                  Унифицированная форма N ИНВ-16
                                                                                                                                                                                  Утверждена постановлением Госкомстата
                                                                                                                                                                                  России от 18.08.98  N 88
                                                                                                                                                                                                ┌─────────────────────┐
                                                                                                                                                                                                │         КОД         │
                                                                                                                                                                                                ├─────────────────────┤
                                                                                                                                                                                  Форма по ОКУД │        0317014      │
                                                                                                                                                                                                ├─────────────────────┤
     @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@             по ОКПО │@~@@@@@@@@@@@@@@@@@@@│
     ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────         ├─────────────────────┤
                                                                                                                                                                                                │                     │
     ───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┼─────────────────────┤
                                                                                                  структурное подразделение                                                    Вид деятельности │                     │
                                                                                                                                                                                        ┌───────┼─────────────────────┤
          Основание для проведения инвентаризации:                                             приказ,     постановление,     распоряжение                                              │ Номер │                     │
                                                   ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┼───────┼─────────────────────┤
                                                                                                        ненужное зачеркнуть                                                             │ Дата  │                     │
                                                                                                                                                                                        └───────┼─────────────────────┤
                                                                                                                                                                     Дата начала инвентаризации │                     │
                                                                                                                                                                                                ├─────────────────────┤
                                                                                                                                                                  Дата окончания инвентаризации │                     │
                                                                                                                                                                                                ├─────────────────────┤
                                                                                                                                                                                   Вид операции │                     │
                                                                                                                                                                                                └─────────────────────┘
                                                                                                                                            ┌───────────────────────────┬────────────────────────────┐
                                                                                                                                            │      Номер документа      │      Дата составления      │
                                                                                                                                            ├───────────────────────────┼────────────────────────────┤
                                                                                        И Н В Е Н Т А Р И З А Ц И О Н Н А Я   О П И С Ь     │                           │                            │
                                                                                      ценных бумаг и бланков документов строгой отчетности  └───────────────────────────┴────────────────────────────┘

                                                                                                      Р А С П И С К А

 Р         К началу проведения инвентаризации все расходные и приходные документы  на ценные бумаги  и бланки документов  строгой
     отчетности  сданы  в  бухгалтерию  и все ценные бумаги и бланки документов  строгой  отчетности, поступившие  на  мою(нашу)
     ответственность, оприходованы ,а выбывшие списаны в расход.


 Р          Материально ответственное (ые) лицо (а):
                                                             ________________________       ________________________        ___________________________________________________________________________________________
                                                                    (должность)                    (подпись)                                                   (расшифровка подписи)

                                                             ________________________       ________________________        ___________________________________________________________________________________________
                                                                    (должность)                    (подпись)                                                   (расшифровка подписи)
 Ш
 И     В результате  проведения  инвентаризации произведен подсчет фактического наличия ценных бумаг и бланков документов строгой
     отчетности по состоянию на "____" __________________ г.

     При проведении инвентаризации установлено следующее: И

 И
   
 Р
.{ CheckEnter FilterVeks1
.}
.{
.[h
┌─────┬────────────────────────────────────┬──────────┬─────────────────────────────────────────────┬─────────────────────────────────────────────────────────────────┬───────────────────────────────────────────────────────┐
│Номер│            Ценная бумага,          │  Единица │              Фактическое наличие            │           Числятся по данным бухгалтерского учета               │                Результаты инвентаризации              │
│ по  │       бланк строгой отчетности     │ измерения│                                             │                                                                 ├────────── излишек ────────┬──────── недостача ────────┤
│ по- ├────────────────────────┬───────┬───┼─────┬────┼────────┬─────┬─────┬───────────┬────┬───────┼──────────┬────────┬────────┬──────────────┬──────┬──────────────┼────────┬─────┬────┬───────┼────────┬─────┬────┬───────┤
│рядку│   Наименование, вид,   │ номер │код│наиме│код │  номер │  по │серия│номинальная│кол-│ сумма │   номер  │по номер│  серия │  номинальная │ кол- │     сумма    │  номер │  по │кол-│ сумма │  номер │  по │кол-│ сумма │
│     │      категория         │ формы │   │нован│ОКЕИ│с номера│номер│     │ стоимость │ во │руб.коп│ с номера │        │        │   стоимость  │  во  │    руб.коп   │с номера│номер│ во │руб.коп│с номера│номер│ во │руб.коп│
├─────┼────────────────────────┼───────┼───┼─────┼────┼────────┼─────┼─────┼───────────┼────┼───────┼──────────┼────────┼────────┼──────────────┼──────┼──────────────┼────────┼─────┼────┼───────┼────────┼─────┼────┼───────┤
│  1  │          2             │   3   │ 4 │  5  │  6 │    7   │  8  │  9  │    10     │ 11 │   12  │    13    │   14   │   15   │      16      │  17  │      18      │   19   │  20 │ 21 │   22  │   23   │  24 │ 25 │   26  │
├─────┼────────────────────────┼───────┼───┼─────┼────┼────────┼─────┼─────┼───────────┼────┼───────┼──────────┼────────┼────────┼──────────────┼──────┼──────────────┼────────┼─────┼────┼───────┼────────┼─────┼────┼───────┤
.Begin
  PageItog_kol := 0;
  PageItog_sum := 0;
End.
.]h
.{ CheckEnter GruppaVeks1
│ Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б│        │     │     │           │    │       │          │        │        │              │      │&&&&&&&&&&&&&&│        │     │    │       │        │     │    │       │
.}
.{ CheckEnter NameVeks1
.Begin
  PageItog_kol := PageItog_kol + Double(Количество);
  PageItog_sum := PageItog_sum + Double(Сумма_НДЕ);
  Itog_kol := Itog_kol + Double(Количество);
  Itog_sum := Itog_sum + Double(Сумма_НДЕ);
End.
│&&&&&│@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@│   │ шт. │    │        │     │     │           │    │       │@@@@@@@@@@│        │@@@@@@@@│&&&&&&&&&&&&&&│&&&&&&│&&&&&&&&&&&&&&│        │     │    │       │        │     │    │       │
.}
.{ CheckEnter ItogVeks1
│ Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б│        │     │     │           │    │       │          │        │        │              │      │&&&&&&&&&&&&&&│        │     │    │       │        │     │    │       │
.}
.[f
└─────┴────────────────────────┴───────┴───┴─────┴────┴────────┴─────┴─────┴───────────┼────┼───────┼──────────┼────────┼────────┼──────────────┼──────┼──────────────┼────────┼─────┼────┼───────┼────────┼─────┼────┼───────┤
                                                                     Итого по странице │    │       │          │        │        │              │&&&&&&│&&&&&&&&&&&&&&│        │     │    │       │        │     │    │       │
                                                                                       └────┴───────┴──────────┴────────┴────────┴──────────────┴──────┴──────────────┴────────┴─────┴────┴───────┴────────┴─────┴────┴───────┘
.]f
.}
                                                                                 Итого │    │       │          │        │        │              │&&&&&&│&&&&&&&&&&&&&&│        │     │    │       │        │     │    │       │
                                                                                       └────┴───────┴──────────┴────────┴────────┴──────────────┴──────┴──────────────┴────────┴─────┴────┴───────┴────────┴─────┴────┴───────┘

     Итого по описи:
                    а) количество порядковых номеров      ______________________________________________________________________________________________________________________________________________________________
                    б) общее количество единиц фактически ______________________________________________________________________________________________________________________________________________________________
                    в) на сумму, фактически               ______________________________________________________________________________________________________________________________________________________________
                                                                                                                             (прописью)
                     _____________________________________________________________________________________________________________________________________________________________  руб  __________________________ коп

     Все подсчеты итогов по строкам, страницам и в целом по инвентаризационной описи проверены.

     Председатель комиссии: __________________________________        __________________________________        ________________________________________________________________________________________________________
                                       (Должность)                                 (подпись)                                                                (расшифровка подписи)
     Члены комиссии:        __________________________________        __________________________________        ________________________________________________________________________________________________________
                                       (Должность)                                 (подпись)                                                                (расшифровка подписи)
                            __________________________________        __________________________________        ________________________________________________________________________________________________________
                                       (Должность)                                 (подпись)                                                                (расшифровка подписи)
                            __________________________________        __________________________________        ________________________________________________________________________________________________________
                                       (Должность)                                 (подпись)                                                                (расшифровка подписи)

     Все ценные бумаги и бланки строгой отчетности, поименованные в настоящей инвентаризационной описи с N                         по N                        комиссией проверены в натуре в моем (нашем) присутствии и
                                                                                                           ───────────────────────      ───────────────────────
     внесены в опись, в связи с чем претензий к инвентаризационной комиссии не имею(не имеем). Ценные бумаги и бланки документов строгой отчетности, перечисленные в описи, находятся на моем(нашем) ответственном хранении.

     Материально ответственное(ые) лицо(а):
                                            ________________________        ________________________        _______________________________________________________________________________________
                                                   (Должность)                       (подпись)                                              (расшифровка подписи)
                                            ________________________        ________________________        _______________________________________________________________________________________
                                                   (Должность)                       (подпись)                                              (расшифровка подписи)

                                                                                  "       "  _________________________            г.

     Указаные в настоящей описи данные и подсчеты проверил      _________________________        ________________________        _______________________________________________________________________________________
                                                                       (Должность)                       (подпись)                                              (расшифровка подписи)

                                                                            "       "  _________________________            г.
     Объяснения причин излишков или недостач ___________________________________________________________________________________________________________________________________________________________________________
     ___________________________________________________________________________________________________________________________________________________________________________________________________________________
     ___________________________________________________________________________________________________________________________________________________________________________________________________________________

     Материально ответственное(ые) лицо(а):
                                            ________________________        ________________________        _______________________________________________________________________________________
                                                   (Должность)                       (подпись)                                              (расшифровка подписи)
                                              ________________________        ________________________        _______________________________________________________________________________________
                                                   (Должность)                       (подпись)                                              (расшифровка подписи)
     Решение руководителя организации:
     ___________________________________________________________________________________________________________________________________________________________________________________________________________________
     ___________________________________________________________________________________________________________________________________________________________________________________________________________________

                                            ________________________        ________________________        _______________________________________________________________________________________
                                                   (Должность)                       (подпись)                                              (расшифровка подписи)

                                                                            "       "  _________________________            г.
 Р
.EndForm

!=============================================================================
.LinkForm 'VeksNal_03' Prototype is 'VeksNal'
!=============================================================================
.NameInList 'Наличие векселей (ценных бумаг)'
.Group 'Реестры векселей и ценных бумаг'
.p 80
.defo portrait
.Fields
CommonFormHeader
UpCase(Субъект_отчета_родит)
if (Способ_формирования=0, '(текущее состояние картотеки)',
  '(по состоянию на '
  + if (longint(Дата_на)<>0,DateToStr(Дата_на, 'DD/MM/YYYY'),'')
  +')')
Группировка
Сортировка
!---------------- FilterVeks
Фильтр
!---------------- GruppaVeks
Ветка
DoubleToStr( Double(Итого_верх_сумма_НДЕ), Формат_сумм )
!---------------- NameVeks
Вид
f_Veksl_cPl
Номер
Серия
Дата_выписки
DoubleToStr( Double(Сумма_НДЕ), Формат_сумм )
Дата_закрытия
Процент_годовых
!---------------- ItogVeks
Итого
DoubleToStr(Double( Итого_сумма_НДЕ),          Формат_сумм )
.EndFields
 Р.[h
                                                              Лист @Np@
.]h
^

           ВЕДОМОСТЬ НАЛИЧИЯ ^ ^

Группировка:          ^
Сортировка:           ^
Фильтры:
.{ CheckEnter FilterVeks1
 ^
.}
.{
.[h
──────────┬──────────────────────────────┬────────────────────┬──────────┬──────────┬────────────────────┬──────────┬───────
   Вид    │          Плательщик          │       Номер        │  Серия   │   Дата   │       Номинал      │   Срок   │Процент
          │          (эмитент)           │                    │          │ выписки  │                    │ гашения  │
──────────┴──────────────────────────────┴────────────────────┴──────────┴──────────┴────────────────────┴──────────┴───────
.]h
.{ CheckEnter GruppaVeks1
 Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б &&&&&&&&&&&&&&&&&&&&
.}
.{ CheckEnter NameVeks1
@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@ &&&&&&&&&&&&&&&&&&&& @@@@@@@@@@ &&&.&&&
.}
.{ CheckEnter ItogVeks1
 Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б &&&&&&&&&&&&&&&&&&&&
.}
.} Р
.EndForm

!=============================================================================
.LinkForm 'VeksNal_04' Prototype is 'VeksNal'
!=============================================================================
.NameInList 'Справка по векселям (ценным бумагам) в кассе'
.Group 'Реестры векселей и ценных бумаг'
.p 80
.defo portrait
 Р.[h
                                                              Лист @Np@
.]h
.var
  Дата_Приобр      : date
  Сумма_Приобр_НДЕ : double
  Сумма_Приобр_Вал : double
  Получен_От       : string
.endvar
.create view loApp
var
  cVekslNRec : comp;
  wAppTiDk   : word;
As select *
From
  SpApp,
  AppVeks,
  KatOrg
Where
  ((
    cVekslNRec     == SpApp.cVeksl
and wAppTiDk       == SpApp.TiDk   (noIndex)
and SpApp.cAppVeks == AppVeks.NRec
and AppVeks.cOrg   == KatOrg.NRec
  ))
;
.fields
  CommonFormHeader
  UpCase(Субъект_отчета_дат)
  if (Способ_формирования=0, '(текущее состояние картотеки)',
    '(по состоянию на '
    + if (longint(Дата_на)<>0, DateToStr(Дата_на, 'DD/MM/YYYY'),'')
    +')')
  Группировка
  Сортировка
!---------------- FilterVeks
  Фильтр
.endfields
^

           СПРАВКА ПО ^ В КАССЕ ^

Группировка:          ^
Сортировка:           ^
Фильтры:
.{ CheckEnter FilterVeks1
 ^
.}
.{
.[h
──────────────────────────────┬──────────┬──────────────────────────────┬──────────┬──────────┬──────────┬────────────────────┬────────────────────┬──────┬──────────
         Плательщик           │   Дата   │          Получен от          │  Номер   │  Серия   │  Бланк   │      Номинал       │       Сумма        │Валюта│   Срок
         (эмитент)            │ получения│                              │          │          │          │                    │    приобретения    │      │  гашения
──────────────────────────────┴──────────┴──────────────────────────────┴──────────┴──────────┴──────────┴────────────────────┴────────────────────┴──────┴──────────
.]h
.{ CheckEnter GruppaVeks1
.fields
!---------------- GruppaVeks
  Ветка
  DoubleToStr( if( Double(Итого_верх_сумма_вал_отч) != 0, Double(Итого_верх_сумма_вал_отч), Double(Итого_верх_сумма_НДЕ)), Формат_сумм )
  if( Double(Итого_верх_сумма_вал_отч) != 0, Валюта_Верх, '')
.endfields
 Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б &&&&&&&&&&&&&&&&&&&&                      @@@@@@
.}
.{ CheckEnter NameVeks1
.begin
  loApp.cVekslNRec := comp(Veksl_NRec);
  loApp.wAppTiDk   := if( ТипДокументов = 81, 84, if( ТипДокументов = 83, 88, 0));
  Дата_Приобр      := date(0,0,0);
  Сумма_Приобр_НДЕ := 0;
  Сумма_Приобр_Вал := 0;
  Получен_От       := '';
  loApp._loop SpApp
    {
    if Способ_формирования = 1
      if Дата_на <= loApp.AppVeks.DatVip
        Continue;
    if Дата_Приобр <= loApp.AppVeks.DatVip
      {
      Дата_Приобр      := loApp.AppVeks.DatVip;
      Сумма_Приобр_НДЕ := loApp.SpApp.SumPl;
      Сумма_Приобр_Вал := loApp.SpApp.SumPlV;
      Получен_От       := loApp.KatOrg.Name;
      }
    }
end.
.fields
!---------------- NameVeks
  f_Veksl_cPl
  if( double(Дата_Приобр) = 0, '', string(Дата_Приобр) )
  Получен_От
  Номер
  Серия
  Бланк
  DoubleToStr( if( Double(Сумма_Вал) != 0, Double(Сумма_Вал), Double(Сумма_НДЕ)), Формат_сумм )
  DoubleToStr( if( Double(Сумма_Приобр_Вал) != 0, Double(Сумма_Приобр_Вал), Double(Сумма_Приобр_НДЕ)), Формат_сумм )
  Валюта_документа
  if( double(Дата_закрытия) = 0, '', string(Дата_закрытия))
.endfields
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@ &&&&&&&&&&&&&&&&&&&& &&&&&&&&&&&&&&&&&&&& @@@@@@ @@@@@@@@@@
.}
.{ CheckEnter ItogVeks1
.Fields
!---------------- ItogVeks
  Итого
  DoubleToStr( if( Double(Итого_сумма_вал_отч) != 0, Double(Итого_сумма_вал_отч), Double(Итого_сумма_НДЕ)), Формат_сумм )
  if( Double(Итого_сумма_вал_отч) != 0, Валюта_низ, '')
.EndFields
 Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б &&&&&&&&&&&&&&&&&&&&                      @@@@@@
.}
.} Р
.EndForm

!=============================================================================
.LinkForm 'VeksNal_05' Prototype is 'VeksNal'
!=============================================================================
.NameInList 'Справка по переданным векселям (ценным бумагам)'
.Group 'Реестры векселей и ценных бумаг'
.p 80
.defo portrait
 Р.[h
                                                              Лист @Np@
.]h
.var
  Дата_Передачи : date
  Кому_Передан  : string
.endvar
.create view loApp
var
  cVekslNRec : comp;
As select *
From
  SpApp,
  AppVeks,
  KatOrg
Where
  ((
    cVekslNRec     == SpApp.cVeksl
and SpApp.cAppVeks == AppVeks.NRec
and AppVeks.cOrg   == KatOrg.NRec
  ))
;
.fields
  CommonFormHeader
  UpCase(Субъект_отчета_дат)
  if (Способ_формирования=0, '(текущее состояние картотеки)',
    '(по состоянию на '
    + if (longint(Дата_на)<>0, DateToStr(Дата_на, 'DD/MM/YYYY'),'')
    +')')
  Группировка
  Сортировка
!---------------- FilterVeks
  Фильтр
.endfields
^

           СПРАВКА ПО ПЕРЕДАННЫМ ^ ^

Группировка:          ^
Сортировка:           ^
Фильтры:
.{ CheckEnter FilterVeks1
 ^
.}
.{
.[h
──────────────────────────────┬──────────┬──────────┬──────────┬──────────┬────────────────────┬──────┬──────────
           Передан            │   Дата   │  Номер   │  Серия   │  Бланк   │       Сумма        │Валюта│   Срок
                              │ передачи │          │          │          │                    │      │  гашения
──────────────────────────────┴──────────┴──────────┴──────────┴──────────┴────────────────────┴──────┴──────────
.]h
.{ CheckEnter GruppaVeks1
.fields
!---------------- GruppaVeks
  Ветка
  DoubleToStr( if( Double(Итого_верх_сумма_вал_отч) != 0, Double(Итого_верх_сумма_вал_отч), Double(Итого_верх_сумма_НДЕ)), Формат_сумм )
  if( Double(Итого_верх_сумма_вал_отч) != 0, Валюта_Верх, '')
.endfields
 Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б &&&&&&&&&&&&&&&&&&&& @@@@@@
.}
.{ CheckEnter NameVeks1
.begin
  loApp.cVekslNRec := comp(Veksl_NRec);
  Дата_Передачи    := date(0,0,0);
  Кому_Передан     := '';
  loApp._loop SpApp
    {
    if Способ_формирования = 1
      if Дата_на <= loApp.AppVeks.DatVip
        Continue;

    case loApp.AppVeks.TiDk of
      81, 83, 85, 87:
        if Дата_Передачи <= loApp.AppVeks.DatVip
          {
          Дата_Передачи := loApp.AppVeks.DatVip;
          Кому_Передан  := loApp.KatOrg.Name;
          }
    end;

    }
end.
.fields
!---------------- NameVeks
  Кому_Передан
  if( double(Дата_Передачи) = 0, '', string(Дата_Передачи) )
  Номер
  Серия
  Бланк
  DoubleToStr( if( Double(Сумма_Вал) != 0, Double(Сумма_Вал), Double(Сумма_НДЕ)), Формат_сумм )
  Валюта_документа
  if( double(Дата_закрытия) = 0, '', string(Дата_закрытия))
.endfields
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@ &&&&&&&&&&&&&&&&&&&& @@@@@@ @@@@@@@@@@
.}
.{ CheckEnter ItogVeks1
.Fields
!---------------- ItogVeks
  Итого
  DoubleToStr( if( Double(Итого_сумма_вал_отч) != 0, Double(Итого_сумма_вал_отч), Double(Итого_сумма_НДЕ)), Формат_сумм )
  if( Double(Итого_сумма_вал_отч) != 0, Валюта_низ, '')
.EndFields
 Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б &&&&&&&&&&&&&&&&&&&& @@@@@@
.}
.} Р
.EndForm

!=============================================================================
.LinkForm 'VeksNal_06' Prototype is 'VeksNal'
!=============================================================================
.NameInList 'Справка по полученным векселям (ценным бумагам)'
.Group 'Реестры векселей и ценных бумаг'
.p 80
.defo portrait
 Р.[h
                                                              Лист @Np@
.]h
.var
  Дата_Передачи : date
  Кем_Передан   : string
.endvar
.create view loApp
var
  cVekslNRec : comp;
As select *
From
  SpApp,
  AppVeks,
  KatOrg
Where
  ((
    cVekslNRec     == SpApp.cVeksl
and SpApp.cAppVeks == AppVeks.NRec
and AppVeks.cOrg   == KatOrg.NRec
  ))
;
.fields
  CommonFormHeader
  UpCase(Субъект_отчета_дат)
  if (Способ_формирования=0, '(текущее состояние картотеки)',
  '(по состоянию на '
  + if (longint(Дата_на)<>0, DateToStr(Дата_на, 'DD/MM/YYYY'),'')
  +')')
  Группировка
  Сортировка
!---------------- FilterVeks
  Фильтр
.endfields
^

           СПРАВКА ПО ПОЛУЧЕННЫМ ^ ^

Группировка:          ^
Сортировка:           ^
Фильтры:
.{ CheckEnter FilterVeks1
 ^
.}
.{
.[h
──────────────────────────────┬──────────┬──────────┬──────────┬──────────┬──────────┬────────────────────┬──────┬──────────
          Предъявлен          │   Дата   │  Номер   │   Дата   │  Серия   │  Бланк   │       Сумма        │Валюта│   Срок
                              │ предъявл.│          │  выписки │          │          │                    │      │  гашения
──────────────────────────────┴──────────┴──────────┴──────────┴──────────┴──────────┴────────────────────┴──────┴──────────
.]h
.{ CheckEnter GruppaVeks1
.fields
!---------------- GruppaVeks
  Ветка
  DoubleToStr( if( Double(Итого_верх_сумма_вал_отч) != 0, Double(Итого_верх_сумма_вал_отч), Double(Итого_верх_сумма_НДЕ)), Формат_сумм )
  if( Double(Итого_верх_сумма_вал_отч) != 0, Валюта_Верх, '')
.endfields
 Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б &&&&&&&&&&&&&&&&&&&& @@@@@@
.}
.{ CheckEnter NameVeks1
.begin
  loApp.cVekslNRec := comp(Veksl_NRec);
  Дата_Передачи    := date(0,0,0);
  Кем_Передан      := '';
  loApp._loop SpApp
    {
    if Способ_формирования = 1
      if Дата_на <= loApp.AppVeks.DatVip
        Continue;

    case loApp.AppVeks.TiDk of
      82, 84, 86, 88:
        if Дата_Передачи <= loApp.AppVeks.DatVip
          {
          Дата_Передачи := loApp.AppVeks.DatVip;
          Кем_Передан   := loApp.KatOrg.Name;
          }
    end;

    }
end.
.fields
!---------------- NameVeks
  Кем_Передан
  if( double(Дата_Передачи) = 0, '', string(Дата_Передачи) )
  Номер
  if( double(Дата_Выписки) = 0, '', string(Дата_Выписки))
  Серия
  Бланк
  DoubleToStr( if( Double(Сумма_Вал) != 0, Double(Сумма_Вал), Double(Сумма_НДЕ)), Формат_сумм )
  Валюта_документа
  if( double(Дата_закрытия) = 0, '', string(Дата_закрытия))
.endfields
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@ &&&&&&&&&&&&&&&&&&&& @@@@@@ @@@@@@@@@@
.}
.{ CheckEnter ItogVeks1
.Fields
!---------------- ItogVeks
  Итого
  DoubleToStr( if( Double(Итого_сумма_вал_отч) != 0, Double(Итого_сумма_вал_отч), Double(Итого_сумма_НДЕ)), Формат_сумм )
  if( Double(Итого_сумма_вал_отч) != 0, Валюта_низ, '')
.EndFields
 Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б &&&&&&&&&&&&&&&&&&&& @@@@@@
.}
.} Р
.EndForm

!=============================================================================
.LinkForm 'VeksNal_07' Prototype is 'VeksNal'
!=============================================================================
.NameInList 'Справка по векселям (ценным бумагам)'
.Group 'Реестры векселей и ценных бумаг'
.p 80
.defo portrait
 Р.[h
                                                              Лист @Np@
.]h
.var
  Дата_Передачи  : date
  Дата_Получения : date
  Кому_Передан : string
  Получен_От   : string
.endvar
.create view loApp
var
  cVekslNRec : comp;
As select *
From
  SpApp,
  AppVeks,
  KatOrg
Where
  ((
    cVekslNRec     == SpApp.cVeksl
and SpApp.cAppVeks == AppVeks.NRec
and AppVeks.cOrg   == KatOrg.NRec
  ))
;
.fields
  CommonFormHeader
  UpCase(Субъект_отчета_дат)
  if (Способ_формирования=0, '(текущее состояние картотеки)',
    '(по состоянию на '
    + if (longint(Дата_на)<>0, DateToStr(Дата_на, 'DD/MM/YYYY'), '')
    +')')
  Группировка
  Сортировка
!---------------- FilterVeks
  Фильтр
.endfields
^

           СПРАВКА ПО ^ ^

Группировка:          ^
Сортировка:           ^
Фильтры:
.{ CheckEnter FilterVeks1
 ^
.}
.{
.[h
──────────────────────────────┬──────────────────────────────┬──────────┬──────────┬──────────┬────────────────────┬──────┬──────────┬──────────
           Передан            │           Получен            │  Номер   │  Серия   │  Бланк   │       Сумма        │Валюта│   Срок   │ Погашен
                              │                              │          │          │          │                    │      │  гашения │
──────────────────────────────┴──────────────────────────────┴──────────┴──────────┴──────────┴────────────────────┴──────┴──────────┴──────────
.]h
.{ CheckEnter GruppaVeks1
.fields
!---------------- GruppaVeks
  Ветка
  DoubleToStr( if( Double(Итого_верх_сумма_вал_отч) != 0, Double(Итого_верх_сумма_вал_отч), Double(Итого_верх_сумма_НДЕ)), Формат_сумм )
  if( Double(Итого_верх_сумма_вал_отч) != 0, Валюта_Верх, '')
.endfields
 Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б &&&&&&&&&&&&&&&&&&&& @@@@@@
.}
.{ CheckEnter NameVeks1
.begin
  loApp.cVekslNRec := comp(Veksl_NRec);
  Дата_Передачи  := date(0,0,0);
  Дата_Получения := date(0,0,0);
  Кому_Передан := '';
  Получен_От   := '';
  loApp._loop SpApp
    {
    if Способ_формирования = 1
      if Дата_на <= loApp.AppVeks.DatVip
        Continue;

    case loApp.AppVeks.TiDk of
      81, 83, 85, 87:
        if Дата_Передачи <= loApp.AppVeks.DatVip
          {
          Дата_Передачи := loApp.AppVeks.DatVip;
          Кому_Передан  := loApp.KatOrg.Name;
          }
      82, 84, 86, 88:
        if Дата_Получения <= loApp.AppVeks.DatVip
          {
          Дата_Получения := loApp.AppVeks.DatVip;
          Получен_От     := loApp.KatOrg.Name;
          }
    end;

    }
end.
.fields
!---------------- NameVeks
  Кому_Передан
  Получен_От
  Номер
  Серия
  Бланк
  DoubleToStr( if( Double(Сумма_Вал) != 0, Double(Сумма_Вал), Double(Сумма_НДЕ)), Формат_сумм )
  Валюта_документа
  if( double(Дата_закрытия) = 0, '', string(Дата_закрытия))
  if( double(Дата_оборота)  = 0, '', string(Дата_оборота))
.endfields
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@ &&&&&&&&&&&&&&&&&&&& @@@@@@ @@@@@@@@@@ @@@@@@@@@@
.}
.{ CheckEnter ItogVeks1
.Fields
!---------------- ItogVeks
  Итого
  DoubleToStr( if( Double(Итого_сумма_вал_отч) != 0, Double(Итого_сумма_вал_отч), Double(Итого_сумма_НДЕ)), Формат_сумм )
  if( Double(Итого_сумма_вал_отч) != 0, Валюта_низ, '')
.EndFields
 Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б &&&&&&&&&&&&&&&&&&&& @@@@@@
.}
.} Р
.EndForm

!=============================================================================
.LinkForm 'VeksNal_08' Prototype is 'VeksNal'
!=============================================================================
.NameInList 'Справка по плановой дате предъявления'
.Group 'Реестры векселей и ценных бумаг'
.p 80
.defo portrait
 Р.[h
                                                                                                                                            Лист @Np@
.]h
.var
  Контрагент     : string
  iDate : date
.endvar
.create view loApp
var
  cVekslNRec : comp;
As select *
From
  SpApp,
  AppVeks,
  KatOrg
Where
  ((
    cVekslNRec     == SpApp.cVeksl
and SpApp.cAppVeks == AppVeks.NRec
and AppVeks.cOrg   == KatOrg.NRec
  ))
;
.fields
  CommonFormHeader
  Группировка
  Сортировка
!---------------- FilterVeks
  Фильтр
  if(ТипДокументов=81,'Векселедатель','Эмитент')
.endfields
^

           СПРАВКА ПО ПЛАНОВОЙ ДАТЕ ПРЕДЪЯВЛЕНИЯ

Группировка:          ^
Сортировка:           ^
Фильтры:
.{ CheckEnter FilterVeks1
 ^
.}
.{
.[h
────────────────────────────┬──────────────────────────────┬──────────┬──────────┬──────────┬────────────────────┬──────┬─────────────────┬──────────
         Контрагент         │ @~@@@@@@@@@@@@@@@@@@@@@@@@@@ │  Номер   │  Серия   │  Бланк   │      Номинал       │Валюта│      Срок       │Плановая
                            │                              │          │          │          │                    │      │    погашения    │  дата
                            │                              │          │          │          │                    │      │                 │предъявл.
────────────────────────────┴──────────────────────────────┴──────────┴──────────┴──────────┴────────────────────┴──────┴─────────────────┴──────────
.]h
.{ CheckEnter GruppaVeks1
.fields
!---------------- GruppaVeks
  Ветка
  DoubleToStr( if( Double(Итого_верх_сумма_вал_отч) != 0, Double(Итого_верх_сумма_вал_отч), Double(Итого_верх_сумма_НДЕ)), Формат_сумм )
  if( Double(Итого_верх_сумма_вал_отч) != 0, Валюта_верх, '')
.endfields
 Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б &&&&&&&&&&&&&&&&&&&& @@@@@@
.}
.{ CheckEnter NameVeks1
.begin
  loApp.cVekslNRec := comp(Veksl_NRec);
  Контрагент := '';
  iDate:=Date(0,0,0);
  loApp._loop SpApp
    if iDate <= loApp.AppVeks.DatVip
    {
      iDate:=loApp.AppVeks.DatVip;
      Контрагент:=loApp.KatOrg.Name;
    }
end.
.fields
!---------------- NameVeks
  Контрагент
  f_Veksl_cPl
  Номер
  Серия
  Бланк
  DoubleToStr( if( Double(Сумма_вал) != 0, Double(Сумма_вал), Double(Сумма_НДЕ)), Формат_сумм )
  Валюта_документа
  string(Условие_наим) + ' ' + if(LongInt(StrToDate(Дата_закрытия,'DD/MM/YYYY'))=0,'',Дата_закрытия)
  if (Longint(Плановая_дата_предъявления)<>0,DateToStr(Плановая_дата_предъявления,'DD/MM/YYYY'),'')
.endfields
@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@ @@@@@@@@@@ &&&&&&&&&&&&&&&&&&&& @@@@@@ @@@@@@@@@@@@@@@@@ @@@@@@@@@@
.}
.{ CheckEnter ItogVeks1
.Fields
!---------------- ItogVeks
  Итого
  DoubleToStr( if( Double(Итого_сумма_вал_отч) != 0, Double(Итого_сумма_вал_отч), Double(Итого_сумма_НДЕ)), Формат_сумм )
  if( Double(Итого_сумма_вал_отч) != 0, Валюта_низ, '')
.EndFields
 Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б &&&&&&&&&&&&&&&&&&&& @@@@@@
.}
.} Р
.EndForm



