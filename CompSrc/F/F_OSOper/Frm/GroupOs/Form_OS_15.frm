#include Commission.frn
.linkform 'GroupOs_15' prototype is 'GroupOs'
.NameInList 'Форма N ОС-15'
.group 'Внутреннее перемещение ОС <<Россия>>'
.group 'Внутреннее перемещение ОС <<Беларусь>>'
.hide
.defo landscape
.p 62
.f "OS_15.out"
.var
  Country : word;
  // ***** Объявление массивов *****

  Массив_ИК_Наименование         : array[1..2] of string; // 01
  Массив_ИК_Заводской_Номер      : array[1..2] of string; // 02
  Массив_ИК_Номер_Паспорта       : array[1..2] of string; // 03
  Массив_ИК_Модель_Тип_Марка     : array[1..2] of string; // 05
  Массив_ИК_Количество           : array[1..2] of double; // 08
  Массив_ИК_Стоимость_за_единицу : array[1..2] of double; // 09
  Массив_ИК_Стоимость_всего      : array[1..2] of double; // 10

  // ***** Переменные проверки отличий общих полей *****
  Flag                           : boolean;
  Flag_Организация_изготовитель  : boolean;
  Итог_Организация_изготовитель  : string;

  // ***** Объявление вспомогательных переменных *****
  ik                             : word; // Текущий номер элемента
  i_Max                          : word; // Количество элементов
  КолНомер_в_ИК                  : word; // Текущий элемент в ИК
.endvar
#CommissionLinkVar
.{
.begin
  Country := wGetTune('Country');

  // ***** Обнуление *****
  for (ik := 1; ik <= Count(Массив_ИК_Наименование); ik := ik + 1)
  {
    Массив_ИК_Наименование         [ik] := ''; // 01
    Массив_ИК_Заводской_Номер      [ik] := ''; // 02
    Массив_ИК_Номер_Паспорта       [ik] := ''; // 03
    Массив_ИК_Модель_Тип_Марка     [ik] := ''; // 05
    Массив_ИК_Количество           [ik] := 0;  // 08
    Массив_ИК_Стоимость_за_единицу [ik] := 0;  // 09
    Массив_ИК_Стоимость_всего      [ik] := 0;  // 10
  }

  // ***** Обнуление переменных проверки отличий общих полей *****
  Flag                          := true;
  Flag_Организация_изготовитель := true;
  Итог_Организация_изготовитель := '';

  ik                            := 0;
  i_Max                         := 0;
end.
! ***** Заполнение массивов *****
#CommissionLinkInit(GroupOs)
.{ CheckEnter CycleByGroupIK
.begin
  // ***** Заполнение массивов *****
  ik    := ik    + 1;
  i_Max := i_Max + 1;

  Массив_ИК_Наименование         [ik] := Наименование;         // 01
  Массив_ИК_Заводской_Номер      [ik] := Заводской_Номер;      // 02
  Массив_ИК_Номер_Паспорта       [ik] := Номер_Паспорта;       // 03
  Массив_ИК_Модель_Тип_Марка     [ik] := Модель_Тип_Марка;     // 05
  Массив_ИК_Количество           [ik] := Количество;           // 08
  Массив_ИК_Стоимость_за_единицу [ik] := Стоимость_за_единицу; // 09
  Массив_ИК_Стоимость_всего      [ik] := Стоимость_всего;      // 10

  // ***** Проверка соответствия общих полей *****
  if (ik = 1)
  {
    Итог_Организация_изготовитель := Организация_изготовитель;
  }
  else
    if (ik > 1)
    {
      if (Итог_Организация_изготовитель <> Организация_изготовитель)
      {
        Flag := false;
        Итог_Организация_изготовитель := '';
        Flag_Организация_изготовитель := false;
      }
    }
end.
.{ CheckEnter FormGroupOsMemo
.}
.{ CheckEnter FormGroupOs_NalDrag
.}
.}
! ***** Вывод в форму *****
.begin
  ik            := 0;
  КолНомер_в_ИК := 0;

  if (not Flag)
  {
    Message ('Значения в карточках для поля:'#13 +
             if (not Flag_Организация_изготовитель , 'Организация-изготовитель,'#13 , '') +
             'отличаются.'                         , Information+CancelButton);
  }
end.
! ***** Вывод заголовков формы *****
.{?INTERNAL; (Country = 1)
.fields
  '(Метод учета: ' +Метод_Учета +')'
.endfields
 Ш@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                                                                                                                                         Приложение 12
                                                                                                                                                                                                      к постановлению МФ РБ
                                                                                                                                                                                                           08.12.2003 № 168
                                                                                                                                                                                                              Б Форма № ОС-15 Б Ш
.}
.{?INTERNAL; (Country <> 1)
.fields
  '(Метод учета: ' +Метод_Учета +')'
.endfields
 Ш@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                                                                                                                         Унифицированная форма № ОС-15

                                                                                                                                                                                                                 Утверждена
                                                                                                                                                                                                             Постановлением
                                                                                                                                                                                                         Госкомстата России
                                                                                                                                                                                                          от 21.01.2003 № 7 Ш
.}
.fields
// ***** Вывод общей для операции информации *****
  if (Country = 1, '0501037', '0306007')                        // Форма по ОКУД
  Поставщик                                                     // 01
    + ' ИНН:' + Поставщик_УНН
    + ' Адрес:' + Поставщик_Адрес
    + ' Банк:' + Поставщик_БАНК_Имя
    + ' р/с ' + Поставщик_БАНК_Счет
    + if (Country = 1, ' МФО:', ' БИК:') + Поставщик_БАНК_Мфо
    + ' тел.: ' + Поставщик_Тел
  if (Country = 1, 'ОКЮЛП', ' ОКПО')                            // ОКПО
  Поставщик_ОКПО                                                // 02
  Структурное_подразделение_Поставщика                          // 03
  Основание_для_составления_акта                                // 05
  Номер_приказа                                                 // 04
  iExcelFormat.DateToStrFormatExcelNotNul (Дата_приказа)        // 06
  Номер_документа                                               // 07
  iExcelFormat.DateToStrFormatExcelNotNul (Дата_документа)      // 08
  Поставщик                                                     // 09
    + ' ИНН:' + Поставщик_УНН
    + ' Адрес:' + Поставщик_Адрес
    + ' Банк:' + Поставщик_БАНК_Имя
    + ' р/с ' + Поставщик_БАНК_Счет
    + if (Country = 1, ' МФО:', ' БИК:') + Поставщик_БАНК_Мфо
    + ' тел.: ' + Поставщик_Тел
  if (Country = 1, 'ОКЮЛП', ' ОКПО')                            // ОКПО
  Поставщик_ОКПО                                                // 10
  Итог_Организация_изготовитель                                 // 11
  if (Country = 1, 'ОКЮЛП', ' ОКПО')                            // ОКПО
  Поставщик                                                     // 12
    + ' ИНН:' + Поставщик_УНН
    + ' Адрес:' + Поставщик_Адрес
    + ' Банк:' + Поставщик_БАНК_Имя
    + ' р/с ' + Поставщик_БАНК_Счет
    + if (Country = 1, ' МФО:', ' БИК:') + Поставщик_БАНК_Мфо
    + ' тел.: ' + Поставщик_Тел
  if (Country = 1, 'ОКЮЛП', ' ОКПО')                            // ОКПО
  Поставщик_ОКПО                                                // 13
  Получатель                                                    // 14
    + ' ИНН:' + Получатель_УНН
    + ' Адрес:' + Получатель_Адрес
    + ' Банк:' + Получатель_БАНК_Имя
    + ' р/с ' + Получатель_БАНК_Счет
    + if (Country = 1, ' МФО:', ' БИК:') + Получатель_БАНК_Мфо
    + ' тел.: ' + Получатель_Тел
  if (Country = 1, 'ОКЮЛП', ' ОКПО')                            // ОКПО
  Получатель_ОКПО                                               // 15
  Структурное_подразделение_Получателя                          // 14
.endfields
 Ш
                                                                                                                                                                                                              ┌────────────┐
                                                                                                                                                                                                              │     Код    │
                                                                                                                                                                                                              ├────────────┤
                                                                                                                                                                                                Форма по ОКУД │@~@@@@@@@@@@│
                                                                                                                                                                                                              ├────────────┤
   Организация-заказчик       Е@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Е по @@@@@ │@~@@@@@@@@@@│
                                                                                                       (наименование)                                                                                         ├────────────┤
    Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д│            │
                                                                                    (наименование структурного подразделения заказчика)                                                               ┌───────┼────────────┤
   Основание для составления акта  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д│ Номер │@~@@@@@@@@@@│
                                                                                                  (наименование документа)                                                                            ├───────┼────────────┤
                                                                                                                                                                                                      │  Дата │@~@@@@@@@@@@│
                                                                                                                                                                                                      └───────┼────────────┤
                                                                                                                                                                      Счет, субсчет, код аналитического учета │            │
                         Щ                        Щ                                     ┌──────────────────────────┬──────────────────┐           ┌──────┬─────────────────────────────────┼────────────┤
                         Щ          АКТ           Щ                                     │      Номер документа     │ Дата составления │           │      │                  сдачи в монтаж │            │
                         Щ  о приемке-передаче    Щ                                     ├──────────────────────────┼──────────────────┤           │      ├───────────────────┬─────────────┼────────────┤
                         Щ оборудования в монтаж  Щ                                     │ @~@@@@@@@@@@@@@@@@@@@@@@ │ @~@@@@@@@@@@@@@@ │           │ Дата │           сдачи в │ по договору │            │
                         Щ                        Щ                                     └──────────────────────────┴──────────────────┘           │      │                   ├─────────────┼────────────┤
                                                                                                                                                                     │      │      эксплуатацию │ Фактическая │            │
                                                                                                                                                                     └──────┴───────────────────┴─────────────┼────────────┤
   Место составления акта    Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д по @@@@@ │@~@@@@@@@@@@│
                                                                                                       (наименование)                                                                                         ├────────────┤
   Организация-изготовитель  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д по @@@@@ │            │
                                                                                                       (наименование)                                                                                         ├────────────┤
   Организация-поставщик     Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д по @@@@@ │@~@@@@@@@@@@│
                                                                                                       (наименование)                                                                                         ├────────────┤
   Монтажная организация     Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д по @@@@@ │@~@@@@@@@@@@│
                                                                                                       (наименование)                                                                                         └────────────┘

   1. Перечисленное ниже оборудование передано для монтажа в  Д@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
                                                                                           (наименование здания, сооружения, цеха)

   ┌──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┬────────────────────────────────┬────────────┬─────────────────────────────────────┬────────────┐
   │                                                     Оборудование                                                     │ Поступление на склад заказчика │            │           Стоимость, руб.           │ Примечание │
   ├──────────────────────────────────────────┬────────────────────────────────────────────────────────┬──────────────────┼──────────┬─────────────────────┤            ├──────────────────┬──────────────────┤            │
   │                                          │                          номер                         │                  │          │                     │ Количество,│                  │                  │            │
   │                                          ├──────────────────┬──────────────────┬──────────────────┤                  │          │     номер акта      │     шт.    │                  │                  │            │
   │               наименование               │    заводской     │     паспорта     │    позиции по    │    тип, марка    │   дата   │       приемки       │            │     единицы      │      всего       │            │
   │                                          │ (номенклатурный) │   (маркировки)   │ технологической  │                  │          │                     │            │                  │                  │            │
   │                                          │                  │                  │      схеме       │                  │          │                     │            │                  │                  │            │
   ├──────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────┼─────────────────────┼────────────┼──────────────────┼──────────────────┼────────────┤
   │                        1                 │         2        │         3        │         4        │         5        │     6    │          7          │      8     │         9        │        10        │     11     │
.begin
  ik := 1;
end.
.{While (ik <= i_Max)
   ├──────────────────────────────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────┼─────────────────────┼────────────┼──────────────────┼──────────────────┼────────────┤
.begin
  КолНомер_в_ИК := КолНомер_в_ИК + 1;
end.
.fields
  // ***** Вывод информации по карточке *****
  Массив_ИК_Наименование         [ik] // 01
  Массив_ИК_Заводской_Номер      [ik] // 02
  Массив_ИК_Номер_Паспорта       [ik] // 03
  Массив_ИК_Модель_Тип_Марка     [ik] // 05
  iExcelFormat.DoubleToStrFormatExcel (if (DuplicateRecordInGroupIK, 1, Массив_ИК_Количество [ik]), 0) // 08
  iExcelFormat.DoubleToStrFormatExcel (Массив_ИК_Стоимость_за_единицу [ik], 2) // 09
  iExcelFormat.DoubleToStrFormatExcel (if (DuplicateRecordInGroupIK, Массив_ИК_Стоимость_за_единицу [ik], Массив_ИК_Стоимость_всего [ik]), 2) // 10
.endfields
   │@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@│                  │@@@@@@@@@@@@@@@@@@│          │                     │&&&&&&&&&&&&│&&&&&&&&&&&&&&&&&&│&&&&&&&&&&&&&&&&&&│            │
.begin
  if (DuplicateRecordInGroupIK)
  {
    if (КолНомер_в_ИК >= Массив_ИК_Количество [ik])
    {
      ik := ik + 1;
      КолНомер_в_ИК := 0;
    }
  }
  else
  {
    ik := ik + 1;
  }
end.
.}
   └──────────────────────────────────────────┴──────────────────┴──────────────────┴──────────────────┴──────────────────┴──────────┴─────────────────────┴────────────┴──────────────────┴──────────────────┴────────────┘

                                                                                                                                                                                           Оборотная сторона формы № ОС-15

   При приемке оборудования в монтаж установлено:
                  соответствует
   оборудование ---------------- проектной специализации или чертежу (если не соответствует, указать в чем несоответствие) _________________________________________________________________________________________________
                не соответствует
   _________________________________________________________________________________________________________________________________________________________________________________________________________________________

   _________________________________________________________________________________________________________________________________________________________________________________________________________________________

   _________________________________________________________________________________________________________________________________________________________________________________________________________________________


.fields
  if (Country = 1, 'не', '')
.endfields
                           комплектно
   Оборудование передано -------------  ____________________________________________________________________________________________________________________________________________________________________________________
                         некомплектно     (указать состав комплекта и технической  документации, по которой произведена приемка, и какая ^комплектность)

   _________________________________________________________________________________________________________________________________________________________________________________________________________________________

   _________________________________________________________________________________________________________________________________________________________________________________________________________________________

   _________________________________________________________________________________________________________________________________________________________________________________________________________________________


                                             не обнаружены
   Дефекты при наружном осмотре оборудования -------------  ________________________________________________________________________________________________________________________________________________________________
                                               обнаружены      (если обнаружены, подробно их перечислить)

   _________________________________________________________________________________________________________________________________________________________________________________________________________________________

   _________________________________________________________________________________________________________________________________________________________________________________________________________________________



    БПримечание Б:   Дефекты, обнаруженные при приеме, монтаже, наладке и испытании оборудования, оформляются актом о выявленных дефектах оборудования (форма №ОС-16)

   Заключение о пригодности к монтажу: _____________________________________________________________________________________________________________________________________________________________________________________

   _________________________________________________________________________________________________________________________________________________________________________________________________________________________

   _________________________________________________________________________________________________________________________________________________________________________________________________________________________


.fields
  Сдал_Должность
  Сдал
  Принял_Должность
  Принял
.endfields
    БСдал Б                                                                                                           БПринял Б
   Представитель организации-заказчика                                                                           Представитель монтажной организации
    Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  ___________________   Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д                  Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д  ___________________   Д@~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Д
              (должность)                 (подпись)                (расшифровка подписи)                                     (должность)                 (подпись)               (расшифровка подписи)

   М.П.                                                                                                          М.П.
                                                                                                                                                                          "____" __________________  20___ г.


   Указанное оборудование принято на ответственное хранение

    БМатериально ответственное лицо Б __________________________________________________________________  ___________________________  ________________________________________________________________________
                                                                 (должность)                                        (подпись)                                   (расшифровка подписи)

                                                                                                                                                                          "____" __________________  20___ г.
 Ш
.}
.endform
